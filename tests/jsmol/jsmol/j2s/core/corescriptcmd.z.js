(function(Kb,Na,Oa,V,Pa,Qa,Hb,K,Ib,Lb,ba,ha,Jb,R,Mb,Nb,Ob,Pb,Qb,Rb,Sb,Tb,Ub,Vb,Wb,Xb,Yb,Zb,$b,ac,bc,cc,dc,ec,fc,gc,hc,ic,jc,kc,lc,mc,nc,oc,pc,qc,rc,sc,tc,uc,vc,wc,l,ca){Oa("JS");Pa(["JS.JmolCmdExtension"],"JS.CmdExt","java.lang.Boolean $.Float $.Long $.Short java.util.Hashtable JU.AU $.BS $.Base64 $.Lst $.M3 $.M4 $.P3 $.PT $.Quat $.SB $.V3 J.api.Interface J.atomdata.RadiusData J.c.AXES $.STER $.VDW J.i18n.GT JM.Atom $.AtomCollection $.BondSet $.LabelToken JS.SV $.ScriptCompiler $.ScriptError $.ScriptEval $.ScriptInterruption $.ScriptMathProcessor $.ScriptParam $.T JU.BSUtil $.BoxInfo $.C $.Edge $.Elements $.Escape $.Logger $.Measure $.Parser $.Point3fi $.TempArray $.Txt JV.FileManager $.JC $.StateManager $.Viewer".split(" "),
function(){c$=Hb(function(){this.sm=this.e=this.vwr=null;this.chk=!1;this.st=this.thisCommand=this.fullCommand=null;this.slen=0;this.lastData=null;Qa(this,arguments)},JS,"CmdExt",null,JS.JmolCmdExtension);Ib(c$,function(){});ca(c$,"init",function(a){this.e=a;this.vwr=this.e.vwr;this.sm=this.e.sm;return this},"~O");ca(c$,"dispatch",function(a,b,c){this.chk=this.e.chk;this.fullCommand=this.e.fullCommand;this.thisCommand=this.e.thisCommand;this.slen=this.e.slen;this.st=c;switch(a){case 4098:this.assign();
break;case 135270423:this.cache();break;case 4102:this.calculate();break;case 4103:this.capture();break;case 4105:this.centerAt();break;case 135270405:this.compare();break;case 528395:this.console();break;case 4106:this.connect(1);break;case 1095766024:this.configuration();break;case 135270408:this.data();break;case 1612189718:this.connect(0);break;case 1052700:this.mapProperty();break;case 4126:this.minimize();break;case 1276121113:this.modulation();break;case 4131:this.navigate();break;case 4133:case 135270418:case 1052714:this.plot(c);
break;case 135270926:this.show();break;case 528443:this.stereo();break;case 135270422:this.write(null);break;case 23:return this.cgo();case 25:return this.contact();case 17:return this.dipole();case 22:return this.draw();case 24:case 29:case 28:return this.isosurface(a);case 26:return this.lcaoCartoon();case 6:return this.measure(),!0;case 27:return this.mo(b);case 21:return this.polyhedra();case 20:this.ellipsoid();break;case 4:return this.struts()}return!1},"~N,~B,~A");l(c$,"atomExpressionAt",function(a){return this.e.atomExpressionAt(a)},
"~N");l(c$,"checkLength",function(a){this.e.checkLength(a)},"~N");l(c$,"error",function(a){this.e.error(a)},"~N");l(c$,"invArg",function(){this.e.invArg()});l(c$,"invPO",function(){this.error(23)});l(c$,"getShapeProperty",function(a,b){return this.e.getShapeProperty(a,b)},"~N,~S");l(c$,"paramAsStr",function(a){return this.e.paramAsStr(a)},"~N");l(c$,"centerParameter",function(a){return this.e.centerParameter(a)},"~N");l(c$,"floatParameter",function(a){return this.e.floatParameter(a)},"~N");l(c$,"getPoint3f",
function(a,b){return this.e.getPoint3f(a,b)},"~N,~B");l(c$,"getPoint4f",function(a){return this.e.getPoint4f(a)},"~N");l(c$,"intParameter",function(a){return this.e.intParameter(a)},"~N");l(c$,"isFloatParameter",function(a){return this.e.isFloatParameter(a)},"~N");l(c$,"setShapeProperty",function(a,b,c){this.e.setShapeProperty(a,b,c)},"~N,~S,~O");l(c$,"showString",function(a){this.e.showString(a)},"~S");l(c$,"stringParameter",function(a){return this.e.stringParameter(a)},"~N");l(c$,"getToken",function(a){return this.e.getToken(a)},
"~N");l(c$,"tokAt",function(a){return this.e.tokAt(a)},"~N");l(c$,"cache",function(){var a=this.tokAt(1),b=null,c=2;switch(a){case 1276118017:case 1073742119:b=this.e.optParameterAsString(c++);case 1073741882:this.checkLength(c);this.chk||("all".equals(b)&&(b=null),b=this.vwr.cacheFileByName(b,1276118017==a),this.showString(0>b?"cache cleared":b+" bytes "+(1276118017==a?" cached":" removed")));break;default:this.invArg()}});l(c$,"calculate",function(){var a=!1,b=!1,c=null,d=null,e=-2147483648;if(2<=
(this.e.iToken=this.e.slen))switch(this.e.clearDefinedVariableAtomSets(),this.getToken(1).tok){case 1073741824:this.checkLength(2);break;case 1632634891:this.checkLength(2);if(this.chk)return;e=this.vwr.calculateFormalCharges(null);this.showString(J.i18n.GT.i(J.i18n.GT._("{0} charges modified"),e));return;case 1076887572:this.checkLength(2);this.chk||this.vwr.ms.assignAromaticBonds();return;case 1612189718:2!=this.e.slen&&(c=(b=1641025539==this.tokAt(++this.e.iToken))?this.vwr.bsA():this.atomExpressionAt(this.e.iToken),
!b&&1641025539!=this.tokAt(++this.e.iToken)&&(d=this.atomExpressionAt(this.e.iToken)));if(this.chk)return;e=this.vwr.autoHbond(c,d,!1);-2147483648!=e&&this.e.report(J.i18n.GT.i(J.i18n.GT._("{0} hydrogen bonds"),Math.abs(e)));return;case 1613758476:c=2==this.slen?null:this.atomExpressionAt(2);this.e.checkLast(this.e.iToken);this.chk||this.vwr.addHydrogens(c,!1,!1);return;case 1112541196:this.e.iToken=1;c=2==this.slen?null:this.atomExpressionAt(2);this.e.checkLast(this.e.iToken);this.chk||this.vwr.calculatePartialCharges(c);
return;case 1073742102:this.chk||this.showString(this.vwr.calculatePointGroup());return;case 1112539150:this.checkLength(2);this.chk||(this.vwr.calculateStraightness(),this.vwr.addStateScript("set quaternionFrame '"+this.vwr.getQuaternionFrame()+"'; calculate straightness",!1,!0));return;case 1641025539:c=4>this.slen?null:this.atomExpressionAt(2);switch(this.tokAt(++this.e.iToken)){case 1052714:break;case 1073741916:if(this.chk)return;this.e.showString(this.vwr.getDSSRParser().calculateStructure(this.vwr,
c));return;case 1073741915:b=!0;break;case 0:b=this.vwr.getBoolean(603979826);break;default:this.invArg()}this.chk||this.showString(this.vwr.calculateStructures(c,b,!0));return;case 1708058:c=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):null;d=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):null;this.checkLength(++this.e.iToken);this.chk||(e=this.vwr.calculateStruts(c,d),0<e&&(this.setShapeProperty(1,"type",Integer.$valueOf(32768)),this.e.setShapePropertyBs(1,
"color",Integer.$valueOf(16777215),null),this.e.setShapeTranslucency(1,"","translucent",0.5,null),this.setShapeProperty(1,"type",Integer.$valueOf(1023))),this.showString(J.i18n.GT.i(J.i18n.GT._("{0} struts added"),e)));return;case 3145756:a=!0;case 1112539151:b=!1;switch(this.tokAt(2)){case 135266325:this.e.iToken++;break;case 0:b=!a;break;case 1073741952:b=!0;this.e.iToken++;break;default:b=!0}c=this.e.iToken+1<this.slen?this.atomExpressionAt(++this.e.iToken):this.vwr.bsA();this.checkLength(++this.e.iToken);
this.chk||this.vwr.calculateSurface(c,b?3.4028235E38:-1);return}this.e.errorStr2(53,"CALCULATE","aromatic? hbonds? hydrogen? formalCharge? partialCharge? pointgroup? straightness? structure? struts? surfaceDistance FROM? surfaceDistance WITHIN?")});l(c$,"capture",function(){if(!this.chk&&!this.vwr.allowCapture())this.showString("Cannot capture on this platform");else{var a=this.vwr.getInt(553648132),b=10,c=0,d="",e=this.vwr.captureParams,f=!this.vwr.am.animationReplayMode.name().equals("ONCE"),g=
this.tokAt(1),h="";switch(g){case 0:c=1150985;break;case 4:d=this.e.optParameterAsString(1);if(0==d.length){c=1150985;break}d.endsWith(".gif")||(d+=".gif");var g=null,c="y",k;switch(this.tokAt(2)){case 1073742129:f=!0;k=3;c=2==this.tokAt(3)?"y":this.e.optParameterAsString(k++).toLowerCase();g=0==this.tokAt(k)?5:this.intParameter(k++);g=JU.PT.rep("; rotate Y 10 10;delay 2.0; rotate Y -10 -10; delay 2.0;rotate Y -10 -10; delay 2.0;rotate Y 10 10;delay 2.0","10",""+g);break;case 1611141175:f=!0;k=3;
c=this.e.optParameterAsString(k).toLowerCase();0<c.length&&k++;g="; rotate Y 360 30;delay 15.0;";2==this.tokAt(k)&&(h=" "+(a=this.intParameter(k++)));break;case 3:b=this.floatParameter(2);break;case 2:a=this.intParameter(2)}if(null!=g){this.chk||this.vwr.setNavigationMode(!1);if(""===c||0>"xyz".indexOf(c))c="y";g=JU.PT.rep(g,"Y",c);g="capture "+JU.PT.esc(d)+h+g+";capture;";this.e.cmdScript(0,null,g);return}null!=e&&new java.util.Hashtable;c=1073742032;e=new java.util.Hashtable;f||this.showString(J.i18n.GT.o(J.i18n.GT._("Note: Enable looping using {0}"),
["ANIMATION MODE LOOP"]));this.showString(J.i18n.GT.o(J.i18n.GT._("Animation delay based on: {0}"),["ANIMATION FPS "+a]));e.put("captureFps",Integer.$valueOf(a));break;case 1073741874:case 1048589:case 1048588:this.checkLength(2);c=g;break;default:this.invArg()}this.chk||null==e||(e.put("type","GIF"),e.put("fileName",d),e.put("quality",Integer.$valueOf(-1)),e.put("endTime",Long.$valueOf(System.currentTimeMillis()+Clazz_floatToLong(1E3*b))),e.put("captureMode",JS.T.nameOf(c).toLowerCase()),e.put("captureLooping",
f?Boolean.TRUE:Boolean.FALSE),a=this.vwr.processWriteOrCapture(e),JU.Logger.info(a))}});l(c$,"centerAt",function(){var a=this.getToken(1).tok;switch(a){case 1073741826:case 96:case 1679429641:break;default:this.invArg()}var b=JU.P3.new3(0,0,0);5==this.slen?(b.x=this.floatParameter(2),b.y=this.floatParameter(3),b.z=this.floatParameter(4)):this.e.isCenterParameter(2)?(b=this.centerParameter(2),this.e.checkLast(this.e.iToken)):this.checkLength(2);!this.chk&&!this.vwr.isJmolDataFrame()&&this.vwr.tm.setCenterAt(a,
b)});l(c$,"cgo",function(){var a=this.e;this.sm.loadShape(23);if(1073742001==this.tokAt(1)&&this.listIsosurface(23))return!1;for(var b=0,c=null!=this.initIsosurface(23),d=c&&null==this.getShapeProperty(23,"ID"),e=!1,f=null,g=3.4028235E38,h=[-2147483648],k=0,E=a.iToken;E<this.slen;++E){var s=null,u=null;switch(this.getToken(E).tok){case 7:case 269484096:case 1073742195:(null!=f||d)&&this.invArg();f=a.listParameter(E,2,2147483647);E=a.iToken;continue;case 1073742138:++E>=this.slen&&this.error(34);switch(this.getToken(E).tok){case 2:k=
this.intParameter(E);continue;case 3:k=Math.round(100*this.floatParameter(E));continue}this.error(34);break;case 1766856708:case 603979967:case 1073742074:g=this.getColorTrans(a,E,!1,h);E=a.iToken;c=!0;continue;case 1074790550:this.setShapeId(23,++E,c);d=null==this.getShapeProperty(23,"ID");E=a.iToken;break;default:if(!a.setMeshDisplayProperty(23,0,a.theTok)){if(269484209==a.theTok||JS.T.tokAttr(a.theTok,1073741824)){this.setShapeId(23,E,c);E=a.iToken;break}this.invArg()}0==b&&(b=E);E=a.iToken;continue}c=
12291!=a.theTok;null!=f&&!e&&(s="points",u=Integer.$valueOf(k),e=!0,k=0);null!=s&&this.setShapeProperty(23,s,u)}this.finalizeObject(23,h[0],g,k,null!=f,f,b,null);return!0});l(c$,"compare",function(){var a=!1,b=!1,c=!1,d=!1,e=!1,f=null,g=null,h=null,k=null,E=null,s=null;this.e.iToken=0;var u=this.isFloatParameter(1)?this.floatParameter(++this.e.iToken):NaN,m=this.atomExpressionAt(++this.e.iToken),H=null,n=null;this.e.isArrayParameter(++this.e.iToken)?H=this.e.getPointArray(this.e.iToken,-1):1141899265!=
this.tokAt(this.e.iToken)&&(n=this.atomExpressionAt(this.e.iToken));var y=null,l=!1,G=null,q=JU.BSUtil.copy(m);null!=n&&q.or(n);for(var q=d=null==H&&null!=n&&q.equals(m),r=this.e.iToken+1;r<this.slen;++r)switch(this.getToken(r).tok){case 4115:q=!0;break;case 135267336:if(l=!0,4!=this.tokAt(r+1)){G="*";break}case 135267335:G=this.stringParameter(++r);break;case 1678770178:b=e=!0;G=this.paramAsStr(++r);G.equalsIgnoreCase("SMILES")&&(l=!0,G="*");break;case 3:case 2:u=Math.abs(this.floatParameter(r));
break;case 269484080:break;case 3158024:y=this.atomExpressionAt(++r);r=this.e.iToken;break;case 10:case 1048577:null!=s&&this.invArg();var h=this.atomExpressionAt(this.e.iToken),t=d?0:this.tokAt(this.e.iToken+1),k=null==H&&this.e.isArrayParameter(this.e.iToken+1)?null:10==t||1048577==t?this.atomExpressionAt(++this.e.iToken):JU.BSUtil.copy(h);null!=y&&(h.and(y),null!=k&&k.and(y));null==k?H=this.e.getPointArray(++this.e.iToken,-1):k.and(n);null==E&&(E=new JU.Lst);E.addLast([h,k]);r=this.e.iToken;break;
case 7:null!=E&&this.invArg();a=!0;f=this.e.getQuaternionArray(this.e.theToken.getList(),1073742001);this.getToken(++r);g=this.e.getQuaternionArray(this.e.theToken.getList(),1073742001);null==s&&(s=new JU.Lst);s.addLast([f,g]);break;case 1073742077:a=!0;break;case 135266320:case 1141899265:a=!1;break;case 528432:b=!0;break;case 4160:c=!0;break;default:this.invArg()}if(!this.chk){q&&(u=0);Float.isNaN(u)||0>u?u=1:!b&&!c&&(b=c=!0);d=0!=u;t=!a&&null==G||null!=H;null==E&&null==s&&(null==y?(h=t?this.vwr.getAtomBitSet("spine"):
new JU.BS,0>h.nextSetBit(0)?(h=m,k=n):(k=JU.BSUtil.copy(h),h.and(m),k.and(n))):(h=JU.BSUtil.copy(m),k=JU.BSUtil.copy(n),h.and(y),k.and(y),h.and(m),k.and(n)),E=new JU.Lst,E.addLast([h,k]));if(q){m=this.vwr.ms.getModelBS(m,!1);y=Array(m.cardinality());r=0;for(k=m.nextSetBit(0);0<=k;k=m.nextSetBit(k+1),r++)y[r]=this.vwr.getModelUndeletedAtomsBitSet(k)}else y=[m];for(k=0;k<y.length;k++){for(var m=y[k],z=R(2,0),v=null,I=new JU.Lst,D=null,F=q?new JU.Lst:E,r=0;r<E.size();++r){var S=E.get(r);q&&F.addLast(S=
[JU.BSUtil.copy(S[0]),S[1]]);S[0].and(m)}var M=null,w=null;if(t){null!=H&&(F.clear(),F.addLast([h,H]));try{D=this.vwr.getCenterAndPoints(F,!0)}catch(K){if(ba(K,Exception))this.invArg();else throw K;}v=JU.Measure.calculateQuaternionRotation(D,z,!0);r=Float.isNaN(z[1])?NaN:Math.round(100*z[0])/100;z=Float.isNaN(z[1])?NaN:Math.round(100*z[1])/100;this.showString("RMSD "+r+" --\x3e "+z+" Angstroms")}else if(a){if(null==s)for(r=0;r<F.size();r++){S=F.get(r);f=this.vwr.getAtomGroupQuaternions(S[0],2147483647);
g=this.vwr.getAtomGroupQuaternions(S[1],2147483647);for(v=0;v<f.length&&v<g.length;v++)I.addLast(g[v].div(f[v]))}else for(v=0;v<f.length&&v<g.length;v++)I.addLast(g[v].div(f[v]));z[0]=0;f=I.toArray(Array(I.size()));v=JU.Quat.sphereMean(f,z,1E-4);this.showString("RMSD = "+z[0]+" degrees")}else{r=new JU.M4;M=new JU.P3;if(("*".equals(G)||"".equals(G))&&null!=m)try{G=this.vwr.getSmiles(m)}catch(O){if(ba(O,Exception))this.e.evalError(O.getMessage(),null);else throw O;}if(e){var V;if(null==m||null==n||
null==(V=this.e.getSmilesExt().getFlexFitList(m,n,G,!l)))break;this.vwr.setDihedrals(V,null,1)}z=this.e.getSmilesExt().getSmilesCorrelation(m,n,G,null,null,r,null,!l,!1,null,M,!1,!1);if(Float.isNaN(z)){this.showString("structures do not match");break}c&&(w=new JU.V3,r.getTranslation(w));b&&(v=new JU.M3,r.getRotationScale(v),v=JU.Quat.newM(v));this.showString("RMSD = "+z+" Angstroms")}null!=D&&(M=D[0][0]);null==M&&(D=this.vwr.getCenterAndPoints(F,!0),M=D[0][0]);F=new JU.P3;z=NaN;c&&(null==w&&(w=JU.V3.newVsub(D[1][0],
M)),z=1E10);b&&(null==v&&this.e.evalError("option not implemented",null),F.add2(M,v.getNormal()),z=v.getTheta(),0==z&&c&&(0.01<w.length()?z=1E10:b=c=d=!1));if(!Float.isNaN(z)&&!Float.isNaN(F.x)&&(D=null,b&&(c&&0!=u)&&(D=this.vwr.ms.getAtomPointVector(m),r=JS.ScriptMathProcessor.getMatrix4f(v.getMatrix(),w),D=JU.Measure.transformPoints(D,r,M)),this.e.useThreads()||(d=!1),this.vwr.rotateAboutPointsInternal(this.e,M,F,z/u,z,d,m,w,D,null)&&d&&this.e.isJS))throw new JS.ScriptInterruption(this.e,"compare",
1);}}});l(c$,"configuration",function(){var a,b=this.vwr.bsA();if(1==this.slen)a=this.vwr.ms.setConformation(b),this.vwr.ms.addStateScript("select",null,b,null,"configuration",!0,!1);else{b=this.intParameter(this.e.checkLast(1));if(this.chk)return;a=this.vwr.getConformation(this.vwr.am.cmi,b-1,!0);this.vwr.addStateScript("configuration "+b+";",!0,!1)}this.chk||(this.setShapeProperty(1,"type",Integer.$valueOf(30720)),this.e.setShapeSizeBs(1,0,a),this.vwr.autoHbond(a,a,!0),this.vwr.select(a,!1,0,this.e.tQuiet))});
l(c$,"measure",function(){var a=this.e,b=null,c=0,d=null;if(2==this.slen)switch(this.tokAt(1)){case 1048588:this.setShapeProperty(6,"hideAll",Boolean.TRUE);return;case 12291:this.chk||this.vwr.clearAllMeasurements();return}this.vwr.shm.loadShape(6);switch(this.tokAt(1)){case 135267335:var e=this.stringParameter(3==this.slen?2:4);if(this.chk)return;var f=this.vwr.ms.at,b=this.vwr.getAtomCount(),c=null;try{c=this.vwr.getSmilesMatcher().getCorrelationMaps(e,f,b,this.vwr.bsA(),!0,!1)}catch(g){if(ba(g,
Exception))a.evalError(g.getMessage(),null);else throw g;}if(null==c)return;this.setShapeProperty(6,"maps",c);return}switch(this.slen){case 2:switch(this.getToken(1).tok){case 0:case 1048589:this.vwr.shm.loadShape(6);this.setShapeProperty(6,"hideAll",Boolean.FALSE);return;case 1073742001:this.chk||a.showStringPrint(this.vwr.getMeasurementInfoAsString(),!1);return;case 4:this.setShapeProperty(6,"setFormats",this.stringParameter(1));return}a.errorStr(24,"ON, OFF, DELETE");break;case 3:switch(this.getToken(1).tok){case 12291:if(1048579==
this.getToken(2).tok)this.chk||this.vwr.clearAllMeasurements();else{var h=this.intParameter(2)-1;this.chk||this.vwr.deleteMeasurement(h)}return}}for(var k=0,E=0,s=-1,u=-1,m=-1,H=ha(5,0),n=[3.4028235E38,3.4028235E38],y=!1,l=!1,G=!1,q=!0,r=null,t=null,e=269484114,z=f=null,v=new JU.Lst,I=new JU.BS,D=null,F=null,S=0,M=0,h=1;h<this.slen;++h)switch(this.getToken(h).tok){case 1074790550:1!=h&&this.invArg();b=a.optParameterAsString(++h);continue;case 1073741824:a.errorStr(24,"ALL, ALLCONNECTED, DELETE");
break;default:this.error(15);break;case 269484144:135266310!=this.tokAt(h+1)&&this.invArg();h++;G=!0;break;case 135266310:case 1073741834:case 1048579:l=1073741834==a.theTok;u=-1;y=!0;l&&G&&this.invArg();break;case 1766856708:c=JU.C.getColix(a.getArgbParam(++h));h=a.iToken;break;case 1073742066:a.isPoint3f(++h)?(d=this.getPoint3f(h,!1),d=[1,d.x,d.y,d.z,0,0,0]):d=a.floatParameterSet(h,7,7);h=a.iToken;break;case 1666189314:case 1073741917:M=K((1666189314==a.theTok?2E3:1E3)*this.floatParameter(++h));
null!=b&&0>=M&&(M=-1);break;case 3:null!=r&&this.invArg();q=y=!0;m=(m+1)%2;n[m]=this.floatParameter(h);break;case 12291:269484114!=e&&this.invArg();e=12291;break;case 4114:var w=this.floatParameter(++h),T=this.paramAsStr(++h),O=this.paramAsStr(++h);this.chk||(z=this.vwr.getFont3D(T,O,w));break;case 2:w=this.intParameter(h);if(y)q=!0,m=(m+1)%2,n[m]=w;else{u=this.vwr.getAtomIndexFromAtomNumber(w);if(!this.chk&&0>u)return;null!=D&&this.invArg();4<(H[0]=++k)&&a.bad();H[k]=u}break;case 1095761935:s=this.intParameter(++h);
break;case 1048588:269484114!=e&&this.invArg();e=1048588;break;case 1048589:269484114!=e&&this.invArg();e=1048589;break;case 1073742114:q=y=!0;u=-1;break;case 1073741989:case 1073741990:t=Boolean.$valueOf(1073741989==a.theTok);y=!0;G=1073741990==a.theTok;break;case 1649412120:0<=m&&this.invArg();r=a.encodeRadiusParameter(h,!1,!0);if(null==r)return;r.values=n;h=a.iToken;y=G=!0;t=Boolean.$valueOf(!1);1==S&&(S++,k++,w=JU.BSUtil.copy(I),JU.BSUtil.invertInPlace(w,this.vwr.getAtomCount()),w.and(this.vwr.ms.getAtomsWithinRadius(5,
I,!1,null)),v.addLast(w));break;case 10:case 1048577:case 1048586:case 8:case 1048582:(10==a.theTok||1048577==a.theTok)&&S++;0<=u&&this.invArg();a.expressionResult=Boolean.FALSE;D=this.centerParameter(h);if(V(a.expressionResult,JU.BS)&&(D=I=a.expressionResult,!this.chk&&0==I.length()))return;V(D,JU.P3)&&(k=new JU.Point3fi,k.setT(D),k.mi=s,D=k);4<(k=++E)&&a.bad();h=a.iToken;v.addLast(D);break;case 4:f=this.stringParameter(h);break;case 1073742164:F=a.tickParamAsStr(h,!1,!0,!0),h=a.iToken,e=1060866}(null!=
r&&(0<=m||2!=k)||2>k&&null==b&&(null==F||1==k))&&a.bad();null!=f&&0!=f.indexOf(k+":")&&(f=k+":"+f);q&&n[1]<n[0]&&(n[1]=n[0],n[0]=3.4028235E38==n[1]?3.4028235E38:-200);if(!this.chk)if(null!=D||null!=F)null==r&&(r=new J.atomdata.RadiusData(n,0,null,null)),null==D&&(F.id="default"),null!=D&&(null!=f&&269484114==e)&&(e=1060866),a=null,null!=z&&(a=J.api.Interface.getInterface("JM.Text").newLabel(this.vwr.gdata,z,"",c,0,0,0,null)),null!=a&&(a.pymolOffset=d),this.setShapeProperty(6,"measure",this.vwr.newMeasurementData(b,
v).set(e,null,r,f,null,F,l,G,t,y,M,c,a));else switch(a=null==b?H:b,e){case 12291:this.setShapeProperty(6,"delete",a);break;case 1048589:this.setShapeProperty(6,"show",a);break;case 1048588:this.setShapeProperty(6,"hide",a);break;default:this.setShapeProperty(6,null==f?"toggle":"toggleOn",a),null!=f&&this.setShapeProperty(6,"setFormats",f)}});l(c$,"connect",function(a){var b=this.e,c=R(2,0),d=Array(2);d[0]=d[1]=this.vwr.bsA();var e=NaN,f=[-2147483648],g=0,h=131071,k=1073742026,E=!1,s=!1,u=!1,m=3.4028235E38,
l=!1,n=0,y=0,C=new JU.BS,G=!1,q=0,r=0,t=0,z=!1;if(1==this.slen)this.chk||this.vwr.rebondState(b.$isStateScript);else{for(;a<this.slen;++a){switch(this.getToken(a).tok){case 1048589:case 1048588:this.checkLength(2);this.chk||this.vwr.rebondState(b.$isStateScript);return;case 2:case 3:if(0<n){(s||l)&&b.error(23);h=JU.Edge.getBondOrderFromFloat(this.floatParameter(a));131071==h&&this.invArg();s=!0;break}2<++y&&b.bad();var v=this.floatParameter(a);269484210==this.tokAt(a+1)&&(v=-v/100,a++);c[g++]=v;break;
case 10:case 1048577:(2<n||G&&0<n)&&b.bad();(s||l)&&this.invArg();d[n++]=this.atomExpressionAt(a);G=b.isBondSet;if(2==n){for(var v=b.iToken,I=a;I<v;I++)if(1073741824==this.tokAt(I)&&this.paramAsStr(I).equals("_1")){q=a;break}b.iToken=v}a=b.iToken;break;case 1087373318:z=!0;break;case 1766856708:case 603979967:case 1073742074:l=!0;m=this.getColorTrans(b,a,!1,f);a=b.iToken;break;case 1074790662:f=1073741852==this.tokAt(2);this.checkLength(f?3:2);if(this.chk)return;this.vwr.clearModelDependentObjects();
this.vwr.ms.deleteAllBonds();e=new JU.BS;this.vwr.ms.setPdbConectBonding(0,0,e);if(f){b=b.$isStateScript&&this.vwr.g.legacyAutoBonding;this.vwr.ms.autoBondBs4(null,null,e,null,this.vwr.getMadBond(),b);this.vwr.addStateScript(b?"set legacyAutoBonding TRUE;connect PDB AUTO;set legacyAutoBonding FALSE;":"connect PDB auto;",!1,!0);return}this.vwr.addStateScript("connect PDB;",!1,!0);return;case 1073741830:case 1073741852:case 1073741904:case 1073742025:case 1073742026:u=!0;++a!=this.slen&&this.invArg();
k=b.theTok;1073741852==k&&!(131071==h||2048==h||515==h)&&this.invArg();break;case 1708058:l||(f[0]=16777215,m=0.5,e=this.vwr.getFloat(570425406),l=!0),u||(k=1073742026),u=!0;case 1073741824:if(b.isColorParam(a)){r=-a;break}case 1076887572:case 1612189718:h=this.paramAsStr(a);131071==(h=JS.ScriptParam.getBondOrderFromString(h))&&this.invArg();s&&b.error(18);s=!0;switch(h){case 33:switch(this.tokAt(a+1)){case 3:h=JS.ScriptParam.getPartialBondOrderFromFloatEncodedInt(this.st[++a].intValue);break;case 2:h=
this.intParameter(++a)}break;case 2048:2==this.tokAt(a+1)&&(h=this.intParameter(++a)<<11,t=this.floatParameter(++a))}break;case 1666189314:e=this.floatParameter(++a);l=!0;break;case 1048587:case 12291:++a!=this.slen&&this.invArg();k=12291;E=!0;l=!1;break;default:r=a}0<a&&(r==-a||r==a&&b.isColorParam(a)?(l=!0,f[0]=b.getArgbParam(a),a=b.iToken):r==a&&this.invArg())}if(!this.chk){2>g&&(0==g&&(c[0]=1E8),c[1]=c[0],c[0]=0.1);l&&(s||(h=65535),u||(k=1073742025));s=g=0;if(0<q){t=new JU.BS;b.definedAtomSets.put("_1",
t);z=d[0];for(u=z.nextSetBit(0);0<=u;u=z.nextSetBit(u+1))t.set(u),d=this.vwr.makeConnections(c[0],c[1],h,k,t,this.atomExpressionAt(q),C,G,!1,0),g+=Math.abs(d[0]),s+=d[1],t.clear(u)}else d=this.vwr.makeConnections(c[0],c[1],h,k,d[0],d[1],C,G,z,t),g+=Math.abs(d[0]),s+=d[1];c=b.doReport();E?c&&b.report(J.i18n.GT.i(J.i18n.GT._("{0} connections deleted"),s)):(l&&(this.vwr.selectBonds(C),Float.isNaN(e)||b.setShapeSizeBs(1,Math.round(2E3*e),null),this.finalizeObject(1,f[0],m,0,!1,null,0,C),this.vwr.selectBonds(null)),
c&&b.report(J.i18n.GT.o(J.i18n.GT._("{0} new bonds; {1} modified"),[Integer.$valueOf(g),Integer.$valueOf(s)])))}}},"~N");l(c$,"console",function(){switch(this.getToken(1).tok){case 1048588:this.chk||this.vwr.showConsole(!1);break;case 1048589:this.chk||this.vwr.showConsole(!0);break;case 1073741882:this.chk||this.vwr.sm.clearConsole();break;case 135270422:this.showString(this.stringParameter(2));break;default:this.invArg()}});l(c$,"contact",function(){var a=this.e;this.sm.loadShape(25);if(1073742001==
this.tokAt(1)&&this.listIsosurface(25))return!1;var b=0;a.iToken=1;for(var c=null!=this.initIsosurface(25),d=c&&null==this.getShapeProperty(25,"ID"),e=null,f=null,g=null,h=null,k=null,E=!1,s=new JU.SB,u=2147483647,m=135266319,l=0,n=NaN,y=NaN,C=!0,G=null,q=null,r=0,t=!1,z=1<a.iToken,v=a.iToken;v<this.slen;++v){switch(g=this.getToken(v).tok){default:z=!0;if(!a.setMeshDisplayProperty(25,0,a.theTok)){269484209!=a.theTok&&!JS.T.tokAttr(a.theTok,1073741824)&&this.invArg();this.setShapeId(25,v,c);v=a.iToken;
break}0==b&&(b=v);v=a.iToken;continue;case 1074790550:z=!0;this.setShapeId(25,++v,c);d=null==this.getShapeProperty(25,"ID");v=a.iToken;break;case 1766856708:switch(this.tokAt(v+1)){case 1073741914:g=0;E=!0;s.append(" color density");v++;break;case 1141899272:g=0,t=!0,s.append(" color type"),v++}if(0==g)break;case 603979967:case 1073742074:z=!0;0==r&&(r=v);a.setMeshDisplayProperty(25,v,a.theTok);v=a.iToken;break;case 554176565:z=!0;q=this.getCapSlabObject(v,!1);this.setShapeProperty(25,"slab",q);v=
a.iToken;break;case 1073741914:E=!0;s.append(" density");this.isFloatParameter(v+1)&&(null==k&&(k=R(1,0)),k[0]=-Math.abs(this.floatParameter(++v)),s.append(" "+-k[0]));break;case 1073742122:c=this.floatParameter(++v);0<c&&(s.append(" resolution ").appendF(c),this.setShapeProperty(25,"resolution",Float.$valueOf(c)));break;case 135266325:case 1276118018:n=this.floatParameter(++v);s.append(" within ").appendF(n);break;case 269484193:case 2:case 3:h=a.encodeRadiusParameter(v,!1,!1);if(null==h)return!1;
s.append(" ").appendO(h);v=a.iToken;break;case 1073741990:case 1073741989:G=1073741989==g?Boolean.TRUE:Boolean.FALSE;s.append(" ").appendO(a.theToken.value);break;case 1073742020:u=this.intParameter(++v);break;case 1612189718:case 1073741881:case 1649412120:l=g;s.append(" ").appendO(a.theToken.value);break;case 1073742135:this.isFloatParameter(v+1)&&(y=this.floatParameter(++v));case 1074790451:case 1073742036:case 3145756:C=!1;case 1276117512:case 1073741961:case 135266319:case 4106:m=g;s.append(" ").appendO(a.theToken.value);
1073742135==g&&s.append(" ").appendF(y);break;case 1073742083:k=a.floatParameterSet(++v,1,10);v=a.iToken;break;case 10:case 1048577:(d||null!=f)&&this.invArg(),g=JU.BSUtil.copy(this.atomExpressionAt(v)),v=a.iToken,null==e?e=g:f=g,s.append(" ").append(JU.Escape.eBS(g))}c=12291!=a.theTok}!z&&null==e&&this.error(13);if(this.chk)return!1;if(null!=e){1649412120==l&&null==h&&(h=new J.atomdata.RadiusData(null,0,J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO));v=null==h?new J.atomdata.RadiusData(null,
0.26,J.atomdata.RadiusData.EnumType.OFFSET,J.c.VDW.AUTO):h;f=1073742036==m&&null==f&&null!=G&&G.booleanValue()?e:a.getMathExt().setContactBitSets(e,f,C,n,v,!0);switch(m){case 1074790451:case 1073742135:v=a.lookupIdentifierValue("solvent");e.andNot(v);f.andNot(v);f.andNot(e);break;case 3145756:f.andNot(e);break;case 1073742036:2147483647==u&&(u=100),this.setShapeProperty(25,"minset",Integer.$valueOf(u)),s.append(" minSet ").appendI(u),null==k&&(k=[0.5,2])}null!=G&&(k=null==k?R(2,0):JU.AU.ensureLengthA(k,
2),k[1]=G.booleanValue()?1:2);null!=k&&s.append(" parameters ").append(JU.Escape.eAF(k));this.setShapeProperty(25,"set",[Integer.$valueOf(l),Integer.$valueOf(m),Boolean.$valueOf(E),Boolean.$valueOf(t),e,f,h,Float.$valueOf(y),k,s.toString()]);0<r&&a.setMeshDisplayProperty(25,r,0)}0<b&&(a.setMeshDisplayProperty(25,b,0)||this.invArg());null!=q&&null!=e&&this.setShapeProperty(25,"slab",q);if(null!=e&&(1073742036==m||C)){a=this.getShapeProperty(25,"volume");if(JU.PT.isAD(a)){for(v=b=0;v<a.length;v++)b+=
Math.abs(a[v]);a=Float.$valueOf(b)}b=this.getShapeProperty(25,"nSets").intValue();if(E||1276117512!=m)this.showString((0==b?"":b+" contacts with ")+"net volume "+a+" A^3")}return!0});l(c$,"dipole",function(){var a=this.e,b=null,c=null,d=!1,e=!1,f=!1;this.sm.loadShape(17);if(1073742001==this.tokAt(1)&&this.listIsosurface(17))return!1;this.setShapeProperty(17,"init",null);if(1==this.slen)return this.setShapeProperty(17,"thisID",null),!1;for(var g=1;g<this.slen;++g){c=b=null;switch(this.getToken(g).tok){case 1048579:b=
"all";break;case 1048589:b="on";break;case 1048588:b="off";break;case 12291:b="delete";break;case 2:case 3:b="value";c=Float.$valueOf(this.floatParameter(g));break;case 10:10==this.tokAt(g+1)?this.setShapeProperty(17,"startSet",this.atomExpressionAt(g++)):b="atomBitset";case 1048577:null==b&&(b=d||e?"endSet":"startSet");c=this.atomExpressionAt(g);g=a.iToken;0==this.tokAt(g+1)&&"startSet"===b&&(b="atomBitset");d=!0;break;case 1048586:case 8:c=this.getPoint3f(g,!0);g=a.iToken;b=d||e?"endCoord":"startCoord";
e=!0;break;case 1678770178:b="bonds";break;case 4102:b="calculate";if(10==this.tokAt(g+1)||1048577==this.tokAt(g+1))c=this.atomExpressionAt(++g),g=a.iToken;break;case 1074790550:this.setShapeId(17,++g,f);g=a.iToken;break;case 135267329:b="cross";c=Boolean.TRUE;break;case 1073742040:b="cross";c=Boolean.FALSE;break;case 1073742066:this.isFloatParameter(g+1)?(c=this.floatParameter(++g),2==a.theTok?(b="offsetPercent",c=Integer.$valueOf(K(c))):(b="offset",c=Float.$valueOf(c))):(b="offsetPt",c=this.centerParameter(++g),
g=a.iToken);break;case 1073742068:b="offsetSide";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742188:b="value";c=Float.$valueOf(this.floatParameter(++g));break;case 1073742196:b="width";c=Float.$valueOf(this.floatParameter(++g));break;default:if(269484209==a.theTok||JS.T.tokAttr(a.theTok,1073741824)){this.setShapeId(17,g,f);g=a.iToken;break}this.invArg()}f=12291!=a.theTok&&4102!=a.theTok;null!=b&&this.setShapeProperty(17,b,c)}(e||d)&&this.setShapeProperty(17,"set",null);return!0});l(c$,
"draw",function(){var a=this.e;this.sm.loadShape(22);switch(this.tokAt(1)){case 1073742001:if(this.listIsosurface(22))return!1;break;case 1073742102:var b=2,a=1073742138==this.tokAt(b)?"":this.e.optParameterAsString(b);a.equals("chemicalShift")&&(a="cs");var c=1,d=0;0<a.length&&this.isFloatParameter(++b)&&(d=this.intParameter(b++));1073742138==this.tokAt(b)&&(c=this.floatParameter(++b));this.chk||this.e.runScript(this.vwr.getPointGroupAsString(!0,a,d,c));return!1;case 137363467:case 135270418:case 1052714:return this.plot(this.st),
!1}for(var e=!1,f=!1,g=!1,h=!1,k=!1,E=0,s=3.4028235E38,u=[-2147483648],m=0,l="",n=0,d=null,c=this.initIsosurface(22),y=(b=null!=c)&&null==this.getShapeProperty(22,"ID"),C=null,G=0,q=a.iToken;q<this.slen;++q){var r=null,t=null;switch(this.getToken(q).tok){case 1614417948:case 1679429641:if(this.chk)break;e=this.vwr.getPlaneIntersection(a.theTok,null,m/100,0);m=0;r="polygon";t=e;e=!0;break;case 4106:C=ha(4,0);G=4;e=a.floatParameterSet(++q,4,4);q=a.iToken;for(b=0;4>b;b++)C[b]=K(e[b]);e=!0;break;case 1678770178:case 1141899265:if(null==
C||G>(1095761924==a.theTok?2:3))G=0,C=[-1,-1,-1,-1];C[G++]=this.atomExpressionAt(++q).nextSetBit(0);q=a.iToken;C[G++]=1678770178==a.theTok?this.atomExpressionAt(++q).nextSetBit(0):-1;q=a.iToken;e=!0;break;case 554176565:switch(this.getToken(++q).tok){case 1048582:r="slab";t=a.objectNameParameter(++q);q=a.iToken;e=!0;break;default:this.invArg()}break;case 135267842:switch(this.getToken(++q).tok){case 1614417948:case 1679429641:E=a.theTok;h=!0;continue;case 1048582:r="intersect";t=a.objectNameParameter(++q);
q=a.iToken;e=h=!0;break;default:this.invArg()}break;case 1073742106:var r="polygon",e=!0,t=new JU.Lst,z=0,v=0,I=null,D=null;if(a.isArrayParameter(++q))I=a.getPointArray(q,-1),z=I.length;else{z=Math.max(0,this.intParameter(q));I=Array(z);for(b=0;b<z;b++)I[b]=this.centerParameter(++a.iToken)}switch(this.getToken(++a.iToken).tok){case 11:case 12:q=JS.SV.newT(a.theToken);q.toArray();D=q.getList();v=D.size();break;case 7:D=a.theToken.getList();v=D.size();break;default:v=Math.max(0,this.intParameter(a.iToken))}q=
JU.AU.newInt2(v);for(b=0;b<v;b++){var F=null==D?a.floatParameterSet(++a.iToken,3,4):JS.SV.flistValue(D.get(b),0);(3>F.length||4<F.length)&&this.invArg();q[b]=[K(F[0]),K(F[1]),K(F[2]),3==F.length?7:K(F[3])]}0<z?(t.addLast(I),t.addLast(q)):t=null;q=a.iToken;break;case 1297090050:f=null;g=0;h=null;switch(this.tokAt(++q)){case 4:f=this.stringParameter(q);break;case 12:f=JS.SV.sValue(this.getToken(q));break;default:a.isCenterParameter(q)||(g=this.intParameter(q++));a.isCenterParameter(q)&&(d=this.centerParameter(q));
a.isCenterParameter(a.iToken+1)&&(h=this.centerParameter(++a.iToken));if(this.chk)return!1;q=a.iToken}k=null;null==d&&q+1<this.slen&&(d=this.centerParameter(++q),k=10==this.tokAt(q)||1048577==this.tokAt(q)?this.atomExpressionAt(q):null);a.checkLast(a.iToken);this.chk||(d=this.vwr.getSymmetryInfo(k,f,g,d,h,c,135176),a.runScript(0<d.length?d:'draw ID "sym_'+c+'*" delete'));return!1;case 4115:k=!0;continue;case 1048586:case 9:case 8:if(9==a.theTok||!a.isPoint3f(q)){t=this.getPoint4f(q);if(k)return a.checkLast(a.iToken),
this.chk||a.runScript(JU.Escape.drawQuat(JU.Quat.newP4(t),null==c?"frame":c," "+l,null==d?new JU.P3:d,m/100)),!1;r="planedef"}else t=d=this.getPoint3f(q,!0),r="coord";q=a.iToken;e=!0;break;case 135267841:case 135266319:if(!e&&!h&&0==E&&135267841!=a.theTok){r="plane";break}b=135266319==a.theTok?a.planeParameter(q):a.hklParameter(++q);q=a.iToken;if(0!=E){if(this.chk)break;e=this.vwr.getPlaneIntersection(E,b,m/100,0);m=0;r="polygon";t=e}else t=b,r="planedef";e=!0;break;case 1073742E3:r="lineData";t=
a.floatParameterSet(++q,0,2147483647);q=a.iToken;e=!0;break;case 10:case 1048577:r="atomSet";t=this.atomExpressionAt(q);k&&(d=this.centerParameter(q));q=a.iToken;e=!0;break;case 7:r="modelBasedPoints";t=JS.SV.strListValue(a.theToken);e=!0;break;case 1073742195:case 269484080:break;case 269484096:t=a.xypParameter(q);if(null!=t){q=a.iToken;r="coord";e=!0;break}g&&this.invArg();g=!0;break;case 269484097:g||this.invArg();g=!1;break;case 1141899269:r="reverse";break;case 4:t=this.stringParameter(q);r=
"title";break;case 135198:r="vector";break;case 1141899267:t=Float.$valueOf(this.floatParameter(++q));r="length";break;case 3:t=Float.$valueOf(this.floatParameter(q));r="length";break;case 1095761935:r="modelIndex";t=Integer.$valueOf(this.intParameter(++q));break;case 2:g?(r="modelIndex",t=Integer.$valueOf(this.intParameter(q))):m=this.intParameter(q);break;case 1073742138:++q>=this.slen&&this.error(34);switch(this.getToken(q).tok){case 2:m=this.intParameter(q);continue;case 3:m=Math.round(100*this.floatParameter(q));
continue}this.error(34);break;case 1074790550:c=this.setShapeId(22,++q,b);y=null==this.getShapeProperty(22,"ID");q=a.iToken;break;case 1073742027:r="fixed";t=Boolean.FALSE;break;case 1060869:r="fixed";t=Boolean.TRUE;break;case 1073742066:b=this.getPoint3f(++q,!0);q=a.iToken;r="offset";t=b;break;case 1073741906:r="crossed";break;case 1073742196:t=Float.$valueOf(this.floatParameter(++q));r="width";l=r+" "+t;break;case 1073741998:r="line";t=Boolean.TRUE;break;case 1073741908:r="curve";break;case 1074790416:r=
"arc";break;case 1073741846:r="arrow";break;case 1073741880:r="circle";break;case 1073741912:r="cylinder";break;case 1073742194:r="vertices";break;case 1073742048:r="nohead";break;case 1073741861:r="isbarb";break;case 1073742130:r="rotate45";break;case 1073742092:r="perp";break;case 1666189314:case 1073741917:l=1666189314==a.theTok;F=this.floatParameter(++q);l&&(F*=2);t=Float.$valueOf(F);r=l||3==this.tokAt(q)?"width":"diameter";l=r+(3==this.tokAt(q)?" "+F:" "+K(F));break;case 1048582:if(269484096==
this.tokAt(q+2)||k){e=d=this.centerParameter(q);q=a.iToken;r="coord";t=e;e=!0;break}t=a.objectNameParameter(++q);r="identifier";e=!0;break;case 1766856708:case 603979967:case 1073742074:b=!0;s=this.getColorTrans(a,q,!1,u);q=a.iToken;continue;default:if(!a.setMeshDisplayProperty(22,0,a.theTok)){if(269484209==a.theTok||JS.T.tokAttr(a.theTok,1073741824)){c=this.setShapeId(22,q,b);q=a.iToken;break}this.invArg()}0==n&&(n=q);q=a.iToken;continue}b=12291!=a.theTok;e&&(!f&&!k)&&(this.setShapeProperty(22,"points",
Integer.$valueOf(m)),f=!0,m=0);e&&y&&this.invArg();null!=r&&this.setShapeProperty(22,r,t)}this.finalizeObject(22,u[0],s,m,e,C,n,null);return!0});l(c$,"data",function(){var a=this.e,b=null,c=null,d=!1,e;switch(a.iToken=this.slen){case 5:b=this.paramAsStr(2);case 4:case 2:c=this.paramAsStr(1);if(c.equalsIgnoreCase("clear")){this.chk||this.vwr.setData(null,null,0,0,0,0,0);return}if(0<=(e=c.indexOf("@")))b=""+a.getParameter(c.substring(e+1),4,!0),c=c.substring(0,e).trim();else if(null==b&&0<=(e=c.indexOf(" ")))b=
c.substring(e+1).trim(),c=c.substring(0,e).trim(),d=!0;break;default:a.bad()}e=c+" ";e=e.substring(0,e.indexOf(" ")).toLowerCase();if(e.equals("model")||e.equals("append"))a.cmdLoad();else if(!this.chk){var f=0<=c.toLowerCase().indexOf("(default)");if(e.equals("connect_atoms"))this.vwr.connect(this.parseDataArray(b,!1));else if(0==e.indexOf("ligand_"))this.vwr.setLigandModel(c.substring(7).toUpperCase()+"_data",b.trim());else if(0==e.indexOf("file_"))this.vwr.setLigandModel(c.substring(5)+"_file",
b.trim());else if(a=this.lastData=Array(4),e.equals("element_vdw")){a[0]=e;a[1]=b.$replace(";","\n");b=JU.Elements.elementNumberMax;e=ha(b+1,0);for(f=1;f<=b;f++)e[f]=f;a[2]=e;a[3]=Integer.$valueOf(0);this.vwr.setData("element_vdw",a,b,0,0,0,0)}else if(0==e.indexOf("data2d_"))a[0]=c,a[1]=this.parseDataArray(b,!1),a[3]=Integer.$valueOf(2),this.vwr.setData(c,a,0,0,0,0,0);else if(0==e.indexOf("data3d_"))a[0]=c,a[1]=this.parseDataArray(b,!0),a[3]=Integer.$valueOf(3),this.vwr.setData(c,a,0,0,0,0,0);else{var g=
JU.PT.getTokens(c);if(0==e.indexOf("property_")&&!(2==g.length&&g[1].equals("set"))){f=this.vwr.bsA();a[0]=e;var h=d?0:this.vwr.getP("propertyAtomNumberField").intValue(),k=d?0:this.vwr.getP("propertyAtomNumberColumnCount").intValue(),E=d?-2147483648:this.vwr.getP("propertyDataField").intValue(),s=d?0:this.vwr.getP("propertyDataColumnCount").intValue();!d&&0<=c.indexOf(" ")&&(3==g.length&&(h=JU.PT.parseInt(g[1]),E=JU.PT.parseInt(g[2])),5==g.length&&(h=JU.PT.parseInt(g[1]),k=JU.PT.parseInt(g[2]),E=
JU.PT.parseInt(g[3]),s=JU.PT.parseInt(g[4])));0>h&&(h=0);0>E&&(E=0);c=this.vwr.getAtomCount();d=null;g=JU.BS.newN(c);if(0<h){for(var d=ha(c+2,0),u=0;u<=c;u++)d[u]=-1;for(u=f.nextSetBit(0);0<=u;u=f.nextSetBit(u+1)){var m=this.vwr.getAtomNumber(u);m>c+1||(0>m||g.get(m))||(g.set(m),d[m]=u)}a[2]=d}else a[2]=JU.BSUtil.copy(f);a[1]=b;a[3]=Integer.$valueOf(0);this.vwr.setData(e,a,c,h,k,E,s)}else h=JM.AtomCollection.getUserSettableType(e),0<=h?this.vwr.setAtomData(h,e,b,f):(a[0]=c,a[1]=b,a[3]=Integer.$valueOf(0),
this.vwr.setData(e,a,0,0,0,0,0))}}});l(c$,"ellipsoid",function(){var a=this.e,b=0,c=1,d=3.4028235E38,e=!1,f=!1;this.setShapeProperty(20,"thisID",null);switch(this.getToken(1).tok){case 1048589:b=2147483647;break;case 1048588:break;case 2:b=this.intParameter(1);break;case 1085443:this.sm.loadShape(20);this.setShapeProperty(20,"select",this.paramAsStr(2));c=a.iToken;f=e=!0;break;case 1074790550:case 269484209:case 1073741824:this.sm.loadShape(20);1074790550==a.theTok&&c++;this.setShapeId(20,c,!1);c=
a.iToken;e=!0;break;default:this.invArg()}if(e){for(b=[-2147483648];++c<this.slen;){var e=this.paramAsStr(c),g=null;this.getToken(c);if(!f)switch(a.theTok){case 1048582:e="points";g=Array(3);g[0]=a.objectNameParameter(++c);if(this.chk)continue;a.getShapePropertyData(24,"getVertices",g);break;case 1611272194:for(var g=Array(3),h=0;3>h;h++)g[h]=new JU.V3,g[h].setT(this.centerParameter(++c)),c=a.iToken;break;case 12289:g=this.centerParameter(++c);c=a.iToken;break;case 1095761935:g=Integer.$valueOf(this.intParameter(++c));
break;case 12291:g=Boolean.TRUE,this.checkLength(c+1)}if(null==g)switch(a.theTok){case 1048589:e="on";g=Boolean.TRUE;break;case 1048588:e="on";g=Boolean.FALSE;break;case 1073742138:g=Float.$valueOf(this.floatParameter(++c));break;case 10:case 1048577:e="atoms";g=this.atomExpressionAt(c);c=a.iToken;break;case 1766856708:case 603979967:case 1073742074:d=this.getColorTrans(a,c,!0,b);c=a.iToken;continue;case 1073742075:g=this.paramAsStr(++c)}null==g&&this.invArg();this.setShapeProperty(20,e.toLowerCase(),
g)}this.finalizeObject(20,b[0],d,0,!1,null,0,null);this.setShapeProperty(20,"thisID",null)}else a.setShapeSizeBs(20,b,null)});l(c$,"isosurface",function(a){var b=this.e;this.sm.loadShape(a);if(1073742001==this.tokAt(1)&&this.listIsosurface(a))return!1;var c=0,d=24==a,e=28==a,f=29==a,g=26==a,h=!1,k=!1,E=!1,s=!1,u=!1,m=!1,l=!1,n=!1,y=!1,C=!1,G=!1,q=!1,r=!1,t=!1,z=null,v=null,I=-2147483648,D,F,S,M,w,T=NaN,O=NaN,ha=0,na=null,ca=2147483647,N=null,P=null,Z=null,p=new JU.SB,L,va=null,Ra=null,oa,da=0,$=null,
Q=this.chk?0:-2147483648;b.setCursorWait(!0);var la=null!=this.initIsosurface(a),jb=la&&null==this.getShapeProperty(a,"ID"),kb=!1,Sa=!1,wa=null,Ta=null,ea=null,Ua=null,sa=null,xa=null,B=new JU.Lst,lb=!1;(e||f)&&this.addShapeProperty(B,"fileType","Pmesh");for(var j=b.iToken;j<this.slen;++j){var A=null,x=null;this.getToken(j);1073741824==b.theTok&&($=this.paramAsStr(j));switch(b.theTok){case 603979871:na=1048589==this.getToken(++j).tok?Boolean.TRUE:1048588==b.theTok?Boolean.FALSE:null;null==na&&this.invArg();
continue;case 553648149:ca=this.intParameter(++j);continue;case 4128:A="moveIsosurface";12!=this.tokAt(++j)&&this.invArg();x=this.getToken(j++).value;break;case 1297090050:for(var mb=this.floatArraySet(j+2,this.intParameter(j+1),16),sa=Array(mb.length),fa=sa.length;0<=--fa;)sa[fa]=JU.M4.newA16(mb[fa]);j=b.iToken;break;case 1089470478:0>Q&&(Q=Math.min(this.vwr.am.cmi,0));var nb=null==Z;null==P&&(P=JU.BSUtil.copy(this.vwr.bsA()));P.and(this.vwr.ms.getAtoms(1297090050,Integer.$valueOf(1)));nb||P.andNot(Z);
this.addShapeProperty(B,"select",P);nb&&(Z=JU.BSUtil.copy(P),JU.BSUtil.invertInPlace(Z,this.vwr.getAtomCount()),t=!0,this.addShapeProperty(B,"ignore",Z),p.append(" ignore ").append(JU.Escape.eBS(Z)));p.append(" symmetry");0==da&&this.addShapeProperty(B,"colorRGB",Integer.$valueOf(1297090050));sa=this.vwr.ms.getSymMatrices(Q);break;case 1073742066:A="offset";x=this.centerParameter(++j);j=b.iToken;break;case 528432:A="rotate";x=1048587==this.tokAt(b.iToken=++j)?null:this.getPoint4f(j);j=b.iToken;break;
case 1610612740:A="scale3d";x=Float.$valueOf(this.floatParameter(++j));break;case 1073742090:p.append(" periodic");A="periodic";break;case 1073742078:case 266298:case 135266320:A=b.theToken.value.toString();p.append(" ").appendO(b.theToken.value);x=this.centerParameter(++j);p.append(" ").append(JU.Escape.eP(x));j=b.iToken;break;case 1679429641:if(0<=this.fullCommand.indexOf("# BBOX=")){var ob=JU.PT.split(JU.PT.getQuotedAttribute(this.fullCommand,"# BBOX"),",");oa=[JU.Escape.uP(ob[0]),JU.Escape.uP(ob[1])]}else b.isCenterParameter(j+
1)?(oa=[this.getPoint3f(j+1,!0),this.getPoint3f(b.iToken+1,!0)],j=b.iToken):oa=this.vwr.ms.getBBoxVertices();p.append(" boundBox "+JU.Escape.eP(oa[0])+" "+JU.Escape.eP(oa[oa.length-1]));A="boundingBox";x=oa;break;case 135188:e=!0;p.append(" pmesh");A="fileType";x="Pmesh";break;case 135267842:P=this.atomExpressionAt(++j);this.chk?N=new JU.BS:1048577==this.tokAt(b.iToken+1)||10==this.tokAt(b.iToken+1)?(N=this.atomExpressionAt(++b.iToken),N.and(this.vwr.ms.getAtomsWithinRadius(5,P,!1,null))):(N=this.vwr.ms.getAtomsWithinRadius(5,
P,!0,null),N.andNot(this.vwr.ms.getAtoms(1095761936,P)));N.andNot(P);p.append(" intersection ").append(JU.Escape.eBS(P)).append(" ").append(JU.Escape.eBS(N));j=b.iToken;if(135368713==this.tokAt(j+1)){j++;var ya=this.getToken(++j).value;p.append(" function ").append(JU.PT.esc(ya));this.chk||this.addShapeProperty(B,"func",ya.equals("a+b")||ya.equals("a-b")?ya:this.createFunction("__iso__","a,b",ya))}else r=!0;A="intersection";x=[P,N];break;case 1610625028:case 135266325:var Va=1610625028==b.theTok;
if(Va){p.append(" display");var c=j,ia=this.tokAt(j+1);if(0==ia)continue;j++;this.addShapeProperty(B,"token",Integer.$valueOf(1048589));if(10==ia||1048579==ia){A="bsDisplay";1048579==ia?p.append(" all"):(x=this.st[j].value,p.append(" ").append(JU.Escape.eBS(x)));b.checkLast(j);break}else 135266325!=ia&&(b.iToken=j,this.invArg())}else ha=j;var Ga,pa=null,N=null,Wa=!1;1048577==this.tokAt(j+1)?(Ga=this.floatParameter(j+3),b.isPoint3f(j+4)?(pa=this.centerParameter(j+4),Wa=!0,b.iToken+=2):b.isPoint3f(j+
5)?(pa=this.centerParameter(j+5),Wa=!0,b.iToken+=2):(N=b.atomExpression(this.st,j+5,this.slen,!0,!1,!1,!0),null==N&&this.invArg())):(Ga=this.floatParameter(++j),pa=this.centerParameter(++j));Va&&b.checkLast(b.iToken);j=b.iToken;0<=this.fullCommand.indexOf("# WITHIN=")?N=JU.BS.unescape(JU.PT.getQuotedAttribute(this.fullCommand,"# WITHIN")):Wa||(N=V(b.expressionResult,JU.BS)?b.expressionResult:null);this.chk||(null!=N&&0<=Q&&N.and(this.vwr.getModelUndeletedAtomsBitSet(Q)),null==pa&&(pa=null==N?new JU.P3:
this.vwr.ms.getAtomSetCenter(N)),this.getWithinDistanceVector(B,Ga,pa,N,Va),p.append(" within ").appendF(Ga).append(" ").append(null==N?JU.Escape.eP(pa):JU.Escape.eBS(N)));continue;case 1073742083:var A="parameters",pb=b.floatParameterSet(++j,1,10),j=b.iToken,x=pb;p.append(" parameters ").append(JU.Escape.eAF(pb));break;case 1716520985:case 1073742190:var wa=b.theToken.value,Na=1073742190==b.theTok,za=this.tokAt(j+1);null==Ua?(!h&&(!E&&!k)&&(this.addShapeProperty(B,"sasurface",Float.$valueOf(0)),
p.append(" vdw"),h=!0),A="property",null==na&&(na=JS.T.tokAttr(za,1112539136)&&1==this.vwr.getIsosurfacePropertySmoothing(!1)?Boolean.TRUE:Boolean.FALSE),this.addShapeProperty(B,"propertySmoothing",na),p.append(" isosurfacePropertySmoothing "+na),na===Boolean.TRUE&&(2147483647==ca&&(ca=this.vwr.getIsosurfacePropertySmoothing(!0)),this.addShapeProperty(B,"propertySmoothingPower",Integer.$valueOf(ca)),p.append(" isosurfacePropertySmoothingPower "+ca)),this.vwr.g.rangeSelected&&this.addShapeProperty(B,
"rangeSelected",Boolean.TRUE)):A=Ua;$=this.paramAsStr(j);p.append(" ").append($);if(0==$.toLowerCase().indexOf("property_")){z=R(this.vwr.getAtomCount(),0);if(this.chk)continue;z=this.vwr.getDataFloat($);null==z&&this.invArg();this.addShapeProperty(B,A,z);continue}var Aa=this.vwr.getAtomCount(),z=R(Aa,0);if(Na){var qb=this.paramAsStr(++j);0==qb.length?z=b.floatParameterSet(j,Aa,Aa):(z=R(Aa,0),this.chk||JU.Parser.parseStringInfestedFloatArray(""+b.getParameter(qb,4,!0),null,z));this.chk||p.append(' "" ').append(JU.Escape.eAF(z))}else{this.getToken(++j);
if(!this.chk){p.append(" "+b.theToken.value);var Oa=this.vwr.ms.at;this.vwr.autoCalculate(za);if(1766856708!=za){L=new JU.P3;for(var Xa=Aa;0<=--Xa;)z[Xa]=JM.Atom.atomPropertyFloat(this.vwr,Oa[Xa],za,L)}}1766856708==za&&(ea="inherit");if(135266325==this.tokAt(j+1)){var rb=this.floatParameter(j+=2);p.append(" within "+rb);this.addShapeProperty(B,"propertyDistanceMax",Float.$valueOf(rb))}}x=z;break;case 1095761935:case 1095766030:h&&this.invArg();Q=1095761935==b.theTok?this.intParameter(++j):b.modelNumberParameter(++j);
p.append(" modelIndex "+Q);if(0>Q){A="fixed";x=Boolean.TRUE;break}A="modelIndex";x=Integer.$valueOf(Q);break;case 135280132:var A="select",Ya=this.atomExpressionAt(++j),x=Ya,j=b.iToken;1073742072==this.tokAt(j+1)&&(j++,Z=JU.BSUtil.copy(Ya),JU.BSUtil.invertInPlace(Z,this.vwr.getAtomCount()),this.addShapeProperty(B,"ignore",Z),p.append(" ignore ").append(JU.Escape.eBS(Z)),t=!0);h||E?p.append(" select "+JU.Escape.eBS(Ya)):(P=x,0>Q&&0<=P.nextSetBit(0)&&(Q=this.vwr.getAtomModelIndex(P.nextSetBit(0))));
break;case 1085443:I=this.intParameter(++j);break;case 12289:A="center";x=this.centerParameter(++j);p.append(" center "+JU.Escape.eP(x));j=b.iToken;break;case 1073742147:case 1766856708:var la=!0,Za=1073742147==b.theTok;if(Za)p.append(" sign"),this.addShapeProperty(B,"sign",Boolean.TRUE);else{if(1073741914==this.tokAt(j+1)){j++;A="colorDensity";p.append(" color density");if(this.isFloatParameter(j+1)){var sb=this.floatParameter(++j);p.append(" "+sb);x=Float.$valueOf(sb)}break}if(4==this.getToken(j+
1).tok)ea=this.paramAsStr(++j),0<ea.indexOf(" ")&&(xa=JU.C.getColixArray(ea),null==xa&&this.error(4));else if(1073742018==b.theTok){j++;p.append(" color mesh");da=b.getArgbParam(++j);this.addShapeProperty(B,"meshcolor",Integer.$valueOf(da));p.append(" ").append(JU.Escape.escapeColor(da));j=b.iToken;continue}if(603979967==(b.theTok=this.tokAt(j+1))||1073742074==b.theTok){p.append(" color");Ta=this.setColorOptions(p,j+1,24,-2);j=b.iToken;continue}switch(this.tokAt(j+1)){case 1073741826:case 1073742114:this.getToken(++j);
p.append(" color range");this.addShapeProperty(B,"rangeAll",null);if(1048579==this.tokAt(j+1)){j++;p.append(" all");continue}var tb=this.floatParameter(++j),ub=this.floatParameter(++j);this.addShapeProperty(B,"red",Float.$valueOf(tb));this.addShapeProperty(B,"blue",Float.$valueOf(ub));p.append(" ").appendF(tb).append(" ").appendF(ub);continue}if(b.isColorParam(j+1)&&(da=b.getArgbParam(j+1),1074790746==this.tokAt(j+2))){ea=b.getColorRange(j+1);j=b.iToken;break}p.append(" color")}b.isColorParam(j+1)?
(da=b.getArgbParam(++j),p.append(" ").append(JU.Escape.escapeColor(da)),j=b.iToken,this.addShapeProperty(B,"colorRGB",Integer.$valueOf(da)),la=!0,b.isColorParam(j+1)?(da=b.getArgbParam(++j),j=b.iToken,this.addShapeProperty(B,"colorRGB",Integer.$valueOf(da)),p.append(" ").append(JU.Escape.escapeColor(da)),s=!0):Za&&this.invPO()):!Za&&null==xa&&this.invPO();continue;case 135270423:d||this.invArg();C=!this.chk;continue;case 1229984263:4!=this.tokAt(j+1)&&this.invPO();continue;case 1112541195:case 1649412120:p.append(" ").appendO(b.theToken.value);
var Ba=b.encodeRadiusParameter(j,!1,!0);if(null==Ba)return!1;p.append(" ").appendO(Ba);Float.isNaN(Ba.value)&&(Ba.value=100);x=Ba;A="radius";y=!0;E&&(h=!1);j=b.iToken;break;case 135266319:k=!0;A="plane";x=b.planeParameter(j);j=b.iToken;p.append(" plane ").append(JU.Escape.eP4(x));break;case 1073742138:A="scale";x=Float.$valueOf(this.floatParameter(++j));p.append(" scale ").appendO(x);break;case 1048579:la&&this.invArg();A="thisID";break;case 1113198596:h=!0;++j;x=this.getPoint4f(j);A="ellipsoid";
j=b.iToken;p.append(" ellipsoid ").append(JU.Escape.eP4(x));break;case 135267841:k=!0;A="plane";x=b.hklParameter(++j);j=b.iToken;p.append(" plane ").append(JU.Escape.eP4(x));break;case 135182:var h=!0,Ha=this.paramAsStr(++j);this.addShapeProperty(B,"lcaoType",Ha);p.append(" lcaocartoon ").append(JU.PT.esc(Ha));switch(this.getToken(++j).tok){case 10:case 1048577:A="lcaoCartoon";N=this.atomExpressionAt(j);j=b.iToken;if(this.chk)continue;var Ca=N.nextSetBit(0);0>Ca&&this.error(14);p.append(" ({").appendI(Ca).append("})");
Q=this.vwr.getAtomModelIndex(Ca);this.addShapeProperty(B,"modelIndex",Integer.$valueOf(Q));var $a=[new JU.V3,new JU.V3,JU.V3.newV(this.vwr.getAtomPoint3f(Ca)),new JU.V3];if(!Ha.equalsIgnoreCase("s")&&null==this.vwr.getHybridizationAndAxes(Ca,$a[0],$a[1],Ha))return!1;x=$a;break;default:this.error(14)}break;case 1183762:var Da=2147483647,ta=2147483647,ab=269484192==this.tokAt(j+1);ab&&j++;var Ea=null;switch(this.tokAt(++j)){case 0:b.bad();break;case 1073741914:p.append("mo [1] squared ");this.addShapeProperty(B,
"squareLinear",Boolean.TRUE);Ea=[1];ta=Da=0;j++;break;case 1073741973:case 1073742008:ta=this.moOffset(j);Da=0;j=b.iToken;p.append(" mo "+(ab?"-":"")+"HOMO ");0<ta&&p.append("+");0!=ta&&p.appendI(ta);break;case 2:Da=this.intParameter(j);p.append(" mo ").appendI(Da);break;default:b.isArrayParameter(j)&&(Ea=b.floatParameterSet(j,1,2147483647),j=b.iToken)}if(1073742156==this.tokAt(j+1))this.addShapeProperty(B,"squareLinear",Boolean.TRUE),p.append(" squared"),null==Ea&&(Ea=R(0,0));else if(135266320==
this.tokAt(j+1)){++j;var vb=this.intParameter(++j),wb=2==this.tokAt(j+1)?this.intParameter(++j):-System.currentTimeMillis()%1E4;this.addShapeProperty(B,"monteCarloCount",Integer.$valueOf(vb));this.addShapeProperty(B,"randomSeed",Integer.$valueOf(wb));p.append(" points ").appendI(vb).appendC(" ").appendI(wb)}this.setMoData(B,Da,Ea,ta,ab,Q,null);h=!0;continue;case 1073742036:A="nci";p.append(" "+A);var ia=this.tokAt(j+1),xb=1229984263!=ia&&4!=ia&&1073742033!=ia,x=Boolean.$valueOf(xb);xb&&(h=!0);break;
case 1073742016:case 1073742022:var yb=1073742016==b.theTok,A=yb?"mep":"mlp";p.append(" "+A);var Ia=null,bb=-1,h=!0;2==this.tokAt(j+1)&&(bb=this.intParameter(++j),p.append(" "+bb),this.addShapeProperty(B,"mepCalcType",Integer.$valueOf(bb)));if(4==this.tokAt(j+1))Ia=this.stringParameter(++j),p.append(" /*file*/"+JU.PT.esc(Ia));else if(1716520985==this.tokAt(j+1)){Ua=A;continue}if(!this.chk)try{z=null==Ia&&yb?this.vwr.getPartialCharges():this.getAtomicPotentials(P,Z,Ia)}catch(zb){if(!ba(zb,Exception))throw zb;
}!this.chk&&null==z&&this.error(32);x=z;break;case 1313866249:l=!this.chk;p.append(" volume");break;case 1074790550:this.setShapeId(a,++j,la);jb=null==this.getShapeProperty(a,"ID");j=b.iToken;break;case 1073741888:603979967==this.tokAt(j+1)&&(kb=!0,j++);ea=this.paramAsStr(++j).toLowerCase();ea.equals("sets")?p.append(' colorScheme "sets"'):b.isColorParam(j)&&(ea=b.getColorRange(j),j=b.iToken);break;case 1073741828:A="addHydrogens";x=Boolean.TRUE;p.append(" mp.addHydrogens");break;case 1073741836:A=
"angstroms";p.append(" angstroms");break;case 1073741838:A="anisotropy";x=this.getPoint3f(++j,!1);p.append(" anisotropy").append(JU.Escape.eP(x));j=b.iToken;break;case 1073741842:m=!this.chk;p.append(" area");break;case 1073741850:case 1073742076:h=!0;s&&!u&&(p.append(' phase "_orb"'),this.addShapeProperty(B,"phase","_orb"));var X=R(7,0);X[0]=this.intParameter(++j);X[1]=this.intParameter(++j);X[2]=this.intParameter(++j);X[3]=this.isFloatParameter(j+1)?this.floatParameter(++j):6;p.append(" atomicOrbital ").appendI(K(X[0])).append(" ").appendI(K(X[1])).append(" ").appendI(K(X[2])).append(" ").appendF(X[3]);
135266320==this.tokAt(j+1)&&(j+=2,X[4]=this.intParameter(j),X[5]=3==this.tokAt(j+1)?this.floatParameter(++j):0,X[6]=2==this.tokAt(j+1)?this.intParameter(++j):-System.currentTimeMillis()%1E4,p.append(" points ").appendI(K(X[4])).appendC(" ").appendF(X[5]).appendC(" ").appendI(K(X[6])));A="hydrogenOrbital";x=X;break;case 1073741866:p.append(" binary");continue;case 1073741868:p.append(" blockData");A="blockData";x=Boolean.TRUE;break;case 1074790451:case 554176565:q=!0;A=b.theToken.value;x=this.getCapSlabObject(j,
!1);j=b.iToken;break;case 1073741876:d||this.invArg();n=!0;if(this.chk)continue;var Ab=this.isFloatParameter(j+1)?this.floatParameter(++j):1.2,cb=this.isFloatParameter(j+1)?this.floatParameter(++j):10;if(10<cb)return b.integerOutOfRange(0,10),!1;p.append(" cavity ").appendF(Ab).append(" ").appendF(cb);this.addShapeProperty(B,"envelopeRadius",Float.$valueOf(cb));this.addShapeProperty(B,"cavityRadius",Float.$valueOf(Ab));A="cavity";break;case 1073741896:case 1073741900:A="contour";p.append(" contour");
switch(this.tokAt(j+1)){case 1073741920:x=b.floatParameterSet(j+2,1,2147483647);p.append(" discrete ").append(JU.Escape.eAF(x));j=b.iToken;break;case 1073741981:L=this.getPoint3f(j+2,!1);(0>=L.z||L.y<L.x)&&this.invArg();L.z==K(L.z)&&L.z>L.y-L.x&&(L.z=(L.y-L.x)/L.z);x=L;j=b.iToken;p.append(" increment ").append(JU.Escape.eP(L));break;default:x=Integer.$valueOf(2==this.tokAt(j+1)?this.intParameter(++j):0),p.append(" ").appendO(x)}break;case 3:case 2:case 269484193:case 1073741910:p.append(" cutoff ");
1073741910==b.theTok&&j++;269484193==this.tokAt(j)?(A="cutoffPositive",x=Float.$valueOf(O=this.floatParameter(++j)),p.append("+").appendO(x)):this.isFloatParameter(j)?(A="cutoff",x=Float.$valueOf(O=this.floatParameter(j)),p.appendO(x)):(A="cutoffRange",x=b.floatParameterSet(j,2,2),this.addShapeProperty(B,"cutoff",Float.$valueOf(0)),p.append(JU.Escape.eAF(x)),j=b.iToken);break;case 1073741928:A="downsample";x=Integer.$valueOf(this.intParameter(++j));p.append(" downsample ").appendO(x);break;case 1073741930:A=
"eccentricity";x=this.getPoint4f(++j);p.append(" eccentricity ").append(JU.Escape.eP4(x));j=b.iToken;break;case 1074790508:p.append(" ed");this.setMoData(B,-1,null,0,!1,Q,null);h=!0;continue;case 536870916:case 1073742041:p.append(" ").appendO(b.theToken.value);A="debug";x=536870916==b.theTok?Boolean.TRUE:Boolean.FALSE;break;case 1060869:p.append(" fixed");A="fixed";x=Boolean.TRUE;break;case 1073741962:p.append(" fullPlane");A="fullPlane";x=Boolean.TRUE;break;case 1073741966:case 1073741968:var Pa=
1073741968==b.theTok,A=""+b.theToken.value,ja=new JU.Lst,x=ja,G=h=!0;p.append(" ").append(A);var Y=this.paramAsStr(++j);if(Y.equals("=")){p.append(" =");Y=this.paramAsStr(++j);p.append(" ").append(JU.PT.esc(Y));ja.addLast(Y);this.chk||this.addShapeProperty(B,"func",this.createFunction("__iso__","x,y,z",Y));break}var db=JU.PT.getQuotedAttribute(this.fullCommand,"# DATA"+(G?"2":""));null==db?db="inline":Y=db;var Bb=0==Y.indexOf("data2d_"),Qa=0==Y.indexOf("data3d_"),Sa=Y.equals("inline");p.append(" inline");
ja.addLast(Y);var Cb=this.getPoint3f(++j,!1);p.append(" ").append(JU.Escape.eP(Cb));ja.addLast(Cb);var ka;M=++b.iToken;ja.addLast(ka=this.getPoint4f(M));p.append(" ").append(JU.Escape.eP4(ka));D=K(ka.x);w=++b.iToken;ja.addLast(ka=this.getPoint4f(w));p.append(" ").append(JU.Escape.eP4(ka));F=K(ka.x);ja.addLast(ka=this.getPoint4f(++b.iToken));p.append(" ").append(JU.Escape.eP4(ka));S=K(ka.x);(0==D||0==F||0==S)&&this.invArg();if(!this.chk){var aa=null,ga=null;if(Pa){Sa?(D=Math.abs(D),F=Math.abs(F),S=
Math.abs(S),ga=this.floatArraySetXYZ(++b.iToken,D,F,S)):ga=Qa?this.vwr.getDataFloat3D(Y):this.vwr.functionXYZ(Y,D,F,S);D=Math.abs(D);F=Math.abs(F);S=Math.abs(S);null==ga&&(b.iToken=M,b.errorStr(53,"xyzdata is null."));if(ga.length!=D||ga[0].length!=F||ga[0][0].length!=S)b.iToken=M,b.errorStr(53,"xyzdata["+ga.length+"]["+ga[0].length+"]["+ga[0][0].length+"] is not of size ["+D+"]["+F+"]["+S+"]");ja.addLast(ga);p.append(" ").append(JU.Escape.e(ga))}else{Sa?(D=Math.abs(D),F=Math.abs(F),aa=this.floatArraySet(++b.iToken,
D,F)):Bb?(aa=this.vwr.getDataFloat2D(Y),D=null==aa?0:aa.length,F=3):(aa=this.vwr.functionXY(Y,D,F),D=Math.abs(D),F=Math.abs(F));null==aa&&(b.iToken=M,b.errorStr(53,"fdata is null."));aa.length!=D&&!Bb&&(b.iToken=M,b.errorStr(53,"fdata length is not correct: "+aa.length+" "+D+"."));for(fa=0;fa<D;fa++)null==aa[fa]&&(b.iToken=w,b.errorStr(53,"fdata["+fa+"] is null.")),aa[fa].length!=F&&(b.iToken=w,b.errorStr(53,"fdata["+fa+"] is not the right length: "+aa[fa].length+" "+F+"."));ja.addLast(aa);p.append(" ").append(JU.Escape.e(aa))}}j=
b.iToken;break;case 1073741970:A="gridPoints";p.append(" gridPoints");break;case 1073741976:A="ignore";x=Z=this.atomExpressionAt(++j);p.append(" ignore ").append(JU.Escape.eBS(Z));j=b.iToken;break;case 1073741984:A="insideOut";p.append(" insideout");break;case 1073741988:case 1073741986:case 1073742100:p.append(" ").appendO(b.theToken.value);A="pocket";x=1073742100==b.theTok?Boolean.TRUE:Boolean.FALSE;break;case 1073742002:A="lobe";x=this.getPoint4f(++j);j=b.iToken;p.append(" lobe ").append(JU.Escape.eP4(x));
h=!0;break;case 1073742004:case 1073742006:A="lp";x=this.getPoint4f(++j);j=b.iToken;p.append(" lp ").append(JU.Escape.eP4(x));h=!0;break;case 1052700:(E||this.slen==j+1)&&this.invArg();E=!0;if((n||y||r)&&!h)h=!0,this.addShapeProperty(B,"bsSolvent",y||r?new JU.BS:b.lookupIdentifierValue("solvent")),this.addShapeProperty(B,"sasurface",Float.$valueOf(0));0==p.length()?(va=this.getShapeProperty(24,"plane"),null==va?null!=this.getShapeProperty(24,"contours")&&this.addShapeProperty(B,"nocontour",null):
(this.addShapeProperty(B,"plane",va),p.append("plane ").append(JU.Escape.eP4(va)),k=!0,va=null)):!h&&!k&&this.invArg();p.append("; isosurface map");this.addShapeProperty(B,"map",h?Boolean.TRUE:Boolean.FALSE);break;case 1073742014:A="maxset";x=Integer.$valueOf(this.intParameter(++j));p.append(" maxSet ").appendO(x);break;case 1073742020:A="minset";x=Integer.$valueOf(this.intParameter(++j));p.append(" minSet ").appendO(x);break;case 1073742112:h=!0;A="rad";x=this.getPoint4f(++j);j=b.iToken;p.append(" radical ").append(JU.Escape.eP4(x));
break;case 1073742027:A="fixed";x=Boolean.FALSE;p.append(" modelBased");break;case 1073742028:case 1073742135:case 1613758488:var wa=b.theToken.value,Ja;1073742028==b.theTok?(A="molecular",p.append(" molecular"),Ja=this.isFloatParameter(j+1)?this.floatParameter(++j):1.4):(this.addShapeProperty(B,"bsSolvent",b.lookupIdentifierValue("solvent")),A=1073742135==b.theTok?"sasurface":"solvent",p.append(" ").appendO(b.theToken.value),Ja=this.isFloatParameter(j+1)?this.floatParameter(++j):this.vwr.getFloat(570425394));
p.append(" ").appendF(Ja);x=Float.$valueOf(Ja);1073741961==this.tokAt(j+1)&&(this.addShapeProperty(B,"doFullMolecular",null),p.append(" full"),j++);h=!0;break;case 1073742033:this.addShapeProperty(B,"fileType","Mrc");p.append(" mrc");continue;case 1073742064:case 1073742062:this.addShapeProperty(B,"fileType","Obj");p.append(" obj");continue;case 1073742034:this.addShapeProperty(B,"fileType","Msms");p.append(" msms");continue;case 1073742094:h&&this.invArg();A="phase";u=!0;x=4==this.tokAt(j+1)?this.stringParameter(++j):
"_orb";p.append(" phase ").append(JU.PT.esc(x));break;case 1073742104:case 1073742122:A="resolution";x=Float.$valueOf(this.floatParameter(++j));p.append(" resolution ").appendO(x);break;case 1073742124:A="reverseColor";x=Boolean.TRUE;p.append(" reversecolor");break;case 1073742146:A="sigma";x=Float.$valueOf(T=this.floatParameter(++j));p.append(" sigma ").appendO(x);break;case 1113198597:A="geodesic";x=Float.$valueOf(this.floatParameter(++j));p.append(" geosurface ").appendO(x);h=!0;break;case 1073742154:A=
"sphere";x=Float.$valueOf(this.floatParameter(++j));p.append(" sphere ").appendO(x);h=!0;break;case 1073742156:A="squareData";x=Boolean.TRUE;p.append(" squared");break;case 1073741983:A=!h&&!k&&!E?"readFile":"mapColor";$=this.stringParameter(++j);null==$&&this.invArg();e&&($=JU.PT.replaceWithCharacter($,"{,}|"," "));b.debugHigh&&JU.Logger.debug("pmesh inline data:\n"+$);x=this.chk?null:$;this.addShapeProperty(B,"fileName","");p.append(" INLINE ").append(JU.PT.esc($));h=!0;break;case 4:var Ka=!h&&
!k,A=Ka&&!E?"readFile":"mapColor",W=this.paramAsStr(j);if(W.startsWith("=")&&1<W.length){var eb=this.vwr.setLoadFormat(W,"_",!1),W=eb[0],Db=!Ka||!Float.isNaN(O)?null:eb[1];if(null!=Db&&!this.chk){O=NaN;try{var La=this.vwr.getFileAsString(Db,!1);JU.Logger.info(La);La=JU.PT.split(La,"MAP_SIGMA_DENS")[1];O=JU.PT.parseFloat(La);this.showString("using cutoff = "+O)}catch(Eb){if(ba(Eb,Exception))JU.Logger.error("MAP_SIGMA_DENS -- could  not read "+eb[1]);else throw Eb;}0<O&&(Float.isNaN(T)||(O*=T,T=NaN,
this.addShapeProperty(B,"sigma",Float.$valueOf(T))),this.addShapeProperty(B,"cutoff",Float.$valueOf(O)),p.append(" cutoff ").appendF(O))}0==ha&&(wa="=xxxx",0>Q&&(Q=this.vwr.am.cmi),N=this.vwr.getModelUndeletedAtomsBitSet(Q),0<=N.nextSetBit(0)&&(this.getWithinDistanceVector(B,2,null,N,!1),p.append(" within 2.0 ").append(JU.Escape.eBS(N))));Ka&&(lb=!0)}Ka&&(this.vwr.getP("_fileType").equals("Pdb")&&Float.isNaN(T)&&Float.isNaN(O))&&(this.addShapeProperty(B,"sigma",Float.$valueOf(-1)),p.append(" sigma -1.0"));
0==W.length&&(0>Q&&(Q=this.vwr.am.cmi),W=b.getFullPathName(),x=this.vwr.getModelAuxiliaryInfoValue(Q,"jmolSurfaceInfo"));var fb=-1;null==x&&2==this.tokAt(j+1)&&this.addShapeProperty(B,"fileIndex",Integer.$valueOf(fb=this.intParameter(++j)));var Fa=4==this.tokAt(j+1)?this.stringParameter(++j):null,h=!0;if(this.chk)break;var ua,ma=null;null==x&&(0<=this.fullCommand.indexOf("# FILE0=")?(W=JU.PT.getQuotedAttribute(this.fullCommand,"# FILE0"),1073741848==this.tokAt(j+1)&&(j+=2)):1073741848==this.tokAt(j+
1)&&(ma=this.vwr.getFilePath(this.stringParameter(b.iToken=j+=2),!1),ua=this.vwr.getFullPathNameOrError(ma),ma=ua[0],""!==this.vwr.getPathForAllFiles()?(W=ma,ma=null):this.addShapeProperty(B,"localName",ma)));!W.startsWith("cache://")&&null==Fa&&(ua=this.vwr.getFullPathNameOrError(W),W=ua[0],null!=ua[1]&&b.errorStr(17,W+":"+ua[1]));this.showString("reading isosurface data from "+W);null!=Fa&&(x=this.vwr.cacheGet(W),this.addShapeProperty(B,"calculationType",Fa));null==x&&(this.addShapeProperty(B,"fileName",
W),null!=ma&&(W=ma),0<=fb&&p.append(" ").appendI(fb));p.append(" /*file*/").append(JU.PT.esc(W));null!=Fa&&p.append(" ").append(JU.PT.esc(Fa));break;case 4106:A="connections";switch(this.tokAt(++j)){case 10:case 1048577:x=[this.atomExpressionAt(j).nextSetBit(0)];break;default:x=[K(b.floatParameterSet(j,1,1)[0])]}j=b.iToken;break;case 1095761923:A="atomIndex";x=Integer.$valueOf(this.intParameter(++j));break;case 1073741999:A="link";p.append(" link");break;case 1073741994:24!=a&&this.invArg();L=this.getPoint3f(b.iToken+
1,!1);j=b.iToken;if(0>=L.x||0>=L.y||0>=L.z)break;L.x=K(L.x);L.y=K(L.y);L.z=K(L.z);p.append(" lattice ").append(JU.Escape.eP(L));E?(A="mapLattice",x=L):Ra=L;break;default:1073741824==b.theTok&&(A="thisID",x=$);if(!b.setMeshDisplayProperty(a,0,b.theTok)){if(JS.T.tokAttr(b.theTok,1073741824)&&!la){this.setShapeId(a,j,la);j=b.iToken;break}this.invArg()}0==c&&(c=j);j=this.slen-1}la=12291!=b.theTok;jb&&h&&this.invArg();null!=A&&this.addShapeProperty(B,A,x)}if(!this.chk){if((n||y)&&!h)h=!0,this.addShapeProperty(B,
"bsSolvent",y?new JU.BS:b.lookupIdentifierValue("solvent")),this.addShapeProperty(B,"sasurface",Float.$valueOf(0));k&&(!h&&!E)&&(this.addShapeProperty(B,"nomap",Float.$valueOf(0)),h=!0);-1<=I&&this.addShapeProperty(B,"getSurfaceSets",Integer.$valueOf(I-1));if(null!=xa)this.addShapeProperty(B,"colorDiscrete",xa);else if("sets".equals(ea))this.addShapeProperty(B,"setColorScheme",null);else if(null!=ea){var Ma=this.vwr.cm.getColorEncoder(ea);null!=Ma&&(Ma.isTranslucent=kb,Ma.hi=3.4028235E38,this.addShapeProperty(B,
"remapColor",Ma))}if(h&&!g&&0!=p.indexOf(";")){B.add(0,["newObject",null]);var Fb=null==P;Fb&&(P=JU.BSUtil.copy(this.vwr.bsA()));0>Q&&(Q=this.vwr.am.cmi);P.and(this.vwr.getModelUndeletedAtomsBitSet(Q));null!=wa&&(1<this.vwr.ms.getModelBS(P,!1).cardinality()&&b.errorStr(30,"ISOSURFACE "+wa),Fb&&(B.add(0,["select",P]),0==p.indexOf("; isosurface map")&&(p=(new JU.SB).append("; isosurface map select ").append(JU.Escape.eBS(P)).append(p.substring(16)))))}r&&!q&&(h||this.addShapeProperty(B,"sasurface",
Float.$valueOf(0)),E||(this.addShapeProperty(B,"map",Boolean.TRUE),this.addShapeProperty(B,"select",N),this.addShapeProperty(B,"sasurface",Float.$valueOf(0))),this.addShapeProperty(B,"slab",this.getCapSlabObject(-100,!1)));var Gb=h&&this.vwr.getBoolean(603979934);Gb&&JU.Logger.startTimer("isosurface");this.setShapeProperty(a,"setProperties",B);Gb&&this.showString(JU.Logger.getTimerMsg("isosurface",0));lb&&(this.setShapeProperty(a,"token",Integer.$valueOf(1073742018)),this.setShapeProperty(a,"token",
Integer.$valueOf(1073742046)),t=!0,p.append(" mesh nofill frontOnly"))}null!=Ra&&this.setShapeProperty(a,"lattice",Ra);null!=sa&&this.setShapeProperty(a,"symops",sa);t&&this.setShapeProperty(a,"token",Integer.$valueOf(1073741960));0<c&&(b.setMeshDisplayProperty(a,c,0)||this.invArg());if(this.chk)return!1;var qa=null,ra=null;m&&(qa=this.getShapeProperty(a,"area"),V(qa,Float)?this.vwr.setFloatProperty("isosurfaceArea",qa.floatValue()):this.vwr.g.setUserVariable("isosurfaceArea",JS.SV.getVariableAD(qa)));
l&&(ra=l?this.getShapeProperty(a,"volume"):null,V(ra,Float)?this.vwr.setFloatProperty("isosurfaceVolume",ra.floatValue()):this.vwr.g.setUserVariable("isosurfaceVolume",JS.SV.getVariableAD(ra)));if(!g){var U=null;if(E&&!h)this.setShapeProperty(a,"finalize",p.toString());else if(h&&(v=p.toString(),this.setShapeProperty(a,"finalize",(0==v.indexOf("; isosurface map")?"":" select "+JU.Escape.eBS(P)+" ")+v),U=this.getShapeProperty(a,"ID"),null!=U&&!b.tQuiet)){O=this.getShapeProperty(a,"cutoff").floatValue();
Float.isNaN(O)&&!Float.isNaN(T)&&JU.Logger.error("sigma not supported");U+=" created";d&&(U+=" with cutoff="+O);var gb=this.getShapeProperty(a,"minMaxInfo");3.4028235E38!=gb[0]&&(U+=" min="+gb[0]+" max="+gb[1]);U+="; "+JV.JC.shapeClassBases[a].toLowerCase()+" count: "+this.getShapeProperty(a,"count");U+=b.getIsosurfaceDataRange(a,"\n")}var hb,ib;if(m||l)hb=m?"isosurfaceArea = "+(V(qa,Float)?""+qa:JU.Escape.eAD(qa)):null,ib=l?"isosurfaceVolume = "+(V(ra,Float)?""+ra:JU.Escape.eAD(ra)):null,null==U?
(m&&this.showString(hb),l&&this.showString(ib)):(m&&(U+="\n"+hb),l&&(U+="\n"+ib));null!=U&&this.showString(U)}null!=Ta&&this.setShapeProperty(a,"translucency",Ta);this.setShapeProperty(a,"clear",null);C&&this.setShapeProperty(a,"cache",null);26!=a&&this.listIsosurface(a);return!0},"~N");l(c$,"lcaoCartoon",function(){var a=this.e;this.sm.loadShape(26);if(1073742001==this.tokAt(1)&&this.listIsosurface(26))return!1;this.setShapeProperty(26,"init",this.fullCommand);if(1==this.slen)return this.setShapeProperty(26,
"lcaoID",null),!1;for(var b=!1,c=null,c=1;c<this.slen;c++){var d=null,e=null;switch(this.getToken(c).tok){case 1074790451:case 554176565:d=a.theToken.value;1048588==this.tokAt(c+1)&&(a.iToken=c+1);e=this.getCapSlabObject(c,!0);c=a.iToken;break;case 12289:return this.isosurface(26),!1;case 528432:var f=e=0,g=0;switch(this.getToken(++c).tok){case 1112541205:e=0.017453292*this.floatParameter(++c);break;case 1112541206:f=0.017453292*this.floatParameter(++c);break;case 1112541207:g=0.017453292*this.floatParameter(++c);
break;default:this.invArg()}d="rotationAxis";e=JU.V3.new3(e,f,g);break;case 1048589:case 1610625028:case 3145768:d="on";break;case 1048588:case 12294:case 3145770:d="off";break;case 12291:d="delete";break;case 10:case 1048577:d="select";e=this.atomExpressionAt(c);c=a.iToken;break;case 1766856708:c=this.setColorOptions(null,c+1,26,-2);null!=c&&this.setShapeProperty(26,"settranslucency",c);c=a.iToken;b=!0;continue;case 603979967:case 1073742074:a.setMeshDisplayProperty(26,c,a.theTok);c=a.iToken;b=!0;
continue;case 1113200651:case 4:e=this.paramAsStr(c).toLowerCase();e.equals("spacefill")&&(e="cpk");d="create";a.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,d="molecular");break;case 135280132:10==this.tokAt(c+1)||1048577==this.tokAt(c+1)?(d="select",e=this.atomExpressionAt(c+1),c=a.iToken):(d="selectType",e=this.paramAsStr(++c),e.equals("spacefill")&&(e="cpk"));break;case 1073742138:d="scale";e=Float.$valueOf(this.floatParameter(++c));break;case 1073742004:case 1073742006:d="lonePair";
break;case 1073742112:case 1073742111:d="radical";break;case 1073742028:d="molecular";break;case 1073741904:e=this.paramAsStr(++c);d="create";a.optParameterAsString(c+1).equalsIgnoreCase("molecular")&&(c++,d="molecular");break;case 1074790550:e=a.setShapeNameParameter(++c);c=a.iToken;b&&this.invArg();d="lcaoID";break;default:if(269484209==a.theTok||JS.T.tokAttr(a.theTok,1073741824))269484209!=a.theTok&&(e=this.paramAsStr(c)),b&&this.invArg(),d="lcaoID"}12291!=a.theTok&&(b=!0);null==d&&this.invArg();
this.setShapeProperty(26,d,e)}this.setShapeProperty(26,"clear",null);return!0});l(c$,"mapProperty",function(){for(var a,b,c,d,e,f=0,g=0,h=0;;){if(1114638363==this.tokAt(1))a=this.vwr.bsA(),b=this.atomExpressionAt(2),c=d="selected";else{a=this.atomExpressionAt(1);if(1048583!=this.tokAt(++this.e.iToken)||!JS.T.tokAttr(f=this.tokAt(++this.e.iToken),1078984704))break;c=this.paramAsStr(this.e.iToken);b=this.atomExpressionAt(++this.e.iToken);if(1048583!=this.tokAt(++this.e.iToken)||!JS.T.tokAttr(g=this.tokAt(++this.e.iToken),
2048))break;d=this.paramAsStr(this.e.iToken)}e=JS.T.tokAttr(h=this.tokAt(this.e.iToken+1),1078984704)?this.paramAsStr(++this.e.iToken):JS.T.nameOf(h=1095763969);this.e.checkLast(this.e.iToken);if(this.chk)return;var k=null;this.showString("mapping "+c.toUpperCase()+" for "+a.cardinality()+" atoms to "+d.toUpperCase()+" for "+b.cardinality()+" atoms using "+e.toUpperCase());if(JS.T.tokAttrOr(f,1095761920,1112539136)&&JS.T.tokAttrOr(g,1095761920,1112539136)&&JS.T.tokAttrOr(h,1095761920,1112539136)){var l=
this.e.getBitsetPropertyFloat(a,f|224,NaN,NaN),s=this.e.getBitsetPropertyFloat(a,h|224,NaN,NaN),f=this.e.getBitsetPropertyFloat(b,h|224,NaN,NaN),u=1716520985==g,m=R(u?this.vwr.getAtomCount():f.length,0),k=new JU.BS;if(l.length==s.length){for(var H=new java.util.Hashtable,h=0;h<l.length;h++)H.put(Float.$valueOf(s[h]),Float.$valueOf(l[h]));l=-1;for(h=s=0;h<f.length;h++){var l=b.nextSetBit(l+1),n=H.get(Float.$valueOf(f[h]));null!=n&&(k.set(l),m[u?l:s]=n.floatValue(),s++)}u?this.vwr.setData(d,[d,m,k,
Integer.$valueOf(0),Boolean.TRUE],this.vwr.getAtomCount(),0,0,2147483647,0):this.vwr.setAtomProperty(k,g,0,0,null,m,null)}}if(null==k){c=this.getBitsetIdent(a,"{"+e+"=%["+e+"]}."+d+" = %["+c+"]",null,!1,2147483647,!1);a=new JU.SB;for(h=0;h<c.length;h++)0>c[h].indexOf("null")&&a.append(c[h]).appendC("\n");JU.Logger.debugging&&JU.Logger.debug(a.toString());c=JU.BSUtil.copy(this.vwr.getSelectionSubset());this.vwr.setSelectionSubset(b);try{this.e.runScript(a.toString())}catch(y){if(ba(y,Exception))b=
y,this.vwr.setSelectionSubset(c),this.e.errorStr(-1,"Error: "+b.getMessage());else if(ba(y,Error))b=y,this.vwr.setSelectionSubset(c),this.e.errorStr(-1,"Error: "+b.toString());else throw y;}this.vwr.setSelectionSubset(c)}this.showString("DONE");return}this.invArg()});l(c$,"minimize",function(){for(var a=null,b=2147483647,c=0,d=!1,e=!1,f=null,g=!1,h=this.vwr.getMinimizer(!1),k=1;k<this.slen;k++)switch(this.getToken(k).tok){case 1073741828:d=!0;continue;case 1073741874:case 1073742162:this.checkLength(2);
if(this.chk||null==h)return;h.setProperty(this.paramAsStr(k),null);return;case 1073741882:this.checkLength(2);if(this.chk||null==h)return;h.setProperty("clear",null);return;case 1073741894:1!=k&&this.invArg();b=a=0;c=ha(5,0);if(1073741882==this.tokAt(++k))this.checkLength(3);else{for(;4>a&&!this.isFloatParameter(k);)c[++a]=this.atomExpressionAt(k).nextSetBit(0),k=this.e.iToken+1;c[0]=a;1==a&&this.invArg();b=this.floatParameter(this.e.checkLast(k))}this.chk||this.vwr.getMinimizer(!0).setProperty("constraint",
[c,ha(a,0),Float.$valueOf(b)]);return;case 1073741905:c=this.floatParameter(++k);continue;case 1073741934:b=0;continue;case 1060869:1!=k&&this.invArg();f=this.atomExpressionAt(++k);0>f.nextSetBit(0)&&(f=null);k=this.e.iToken;this.chk||this.vwr.getMinimizer(!0).setProperty("fixed",f);if(k+1==this.slen)return;continue;case 10:case 1048577:g=!0;case 135280132:135280132==this.e.theTok&&k++;a=this.atomExpressionAt(k);k=this.e.iToken;1073742072==this.tokAt(k+1)&&(k++,g=!0);continue;case 1073742148:e=!0;
break;case 266298:b=this.intParameter(++k);continue;default:this.invArg()}this.chk||this.vwr.minimize(b,c,a,f,0,d,g,e,!1)});l(c$,"mo",function(a){var b=this.e,c=2147483647,d=!1,e=this.vwr.getVisibleFramesBitSet(),f=new JU.Lst,g=1;if(1095766030==this.tokAt(1)||4115==this.tokAt(1))g=b.modelNumberParameter(2),0>g&&this.invArg(),e.clearAll(),e.set(g),g=3;for(var h=e.nextSetBit(0);0<=h;h=e.nextSetBit(h+1)){this.sm.loadShape(27);var k=g;if(1073742001==this.tokAt(k)&&this.listIsosurface(27))break;this.setShapeProperty(27,
"init",Integer.$valueOf(h));var l=null,s=this.getShapeProperty(27,"moNumber").intValue(),u=this.getShapeProperty(27,"moLinearCombination");if(a)break;0==s&&(s=2147483647);var m=null,H=null;switch(this.getToken(k).tok){case 1074790451:case 554176565:m=b.theToken.value;H=this.getCapSlabObject(k,!1);break;case 1073741914:m="squareLinear";H=Boolean.TRUE;u=[1];c=s=0;break;case 2:s=this.intParameter(k);u=this.moCombo(f);null==u&&0>s&&(u=[-100,-s]);break;case 269484192:switch(this.tokAt(++k)){case 1073741973:case 1073742008:break;
default:this.invArg()}d=!0;case 1073741973:case 1073742008:2147483647==(c=this.moOffset(k))&&this.invArg();s=0;u=this.moCombo(f);break;case 1073742037:s=1073742037;u=this.moCombo(f);break;case 1073742108:s=1073742108;u=this.moCombo(f);break;case 1766856708:this.setColorOptions(null,k+1,27,2);break;case 135266319:m="plane";H=b.planeParameter(k);break;case 135266320:this.addShapeProperty(f,"randomSeed",2==this.tokAt(k+2)?Integer.$valueOf(this.intParameter(k+2)):null);m="monteCarloCount";H=Integer.$valueOf(this.intParameter(k+
1));break;case 1073742138:m="scale";H=Float.$valueOf(this.floatParameter(k+1));break;case 1073741910:269484193==this.tokAt(k+1)?(m="cutoffPositive",H=Float.$valueOf(this.floatParameter(k+2))):(m="cutoff",H=Float.$valueOf(this.floatParameter(k+1)));break;case 536870916:m="debug";break;case 1073742054:m="plane";break;case 1073742104:case 1073742122:m="resolution";H=Float.$valueOf(this.floatParameter(k+1));break;case 1073742156:m="squareData";H=Boolean.TRUE;break;case 1073742168:k+1<this.slen&&4==this.tokAt(k+
1)&&(m="titleFormat",H=this.paramAsStr(k+1));break;case 1073741824:this.invArg();break;default:if(b.isArrayParameter(k)){u=b.floatParameterSet(k,1,2147483647);1073742156==this.tokAt(b.iToken+1)&&(this.addShapeProperty(f,"squareLinear",Boolean.TRUE),b.iToken++);break}a=b.iToken;b.setMeshDisplayProperty(27,0,b.theTok)||this.invArg();this.setShapeProperty(27,"setProperties",f);b.setMeshDisplayProperty(27,a,this.tokAt(a));return!0}null!=m&&this.addShapeProperty(f,m,H);if(2147483647!=s||null!=u)4==this.tokAt(b.iToken+
1)&&(l=this.paramAsStr(++b.iToken)),b.setCursorWait(!0),this.setMoData(f,s,u,c,d,h,l),this.addShapeProperty(f,"finalize",null);0<f.size()&&this.setShapeProperty(27,"setProperties",f);f.clear()}return!0},"~B");l(c$,"modulation",function(){var a=null,b=!0,c=!1,d=null;switch(this.getToken(1).tok){case 1048588:b=!1;case 0:case 1048589:break;case 10:case 1048577:d=this.atomExpressionAt(1);switch(this.tokAt(this.e.iToken+1)){case 1048588:b=!1;case 1048589:this.e.iToken++}this.e.checkLast(this.e.iToken);
break;case 1048586:case 8:a=this.e.getPoint3f(1,!1);c=1048589==this.tokAt(this.e.iToken+1);break;case 3:a=this.floatParameter(1);a=JU.P3.new3(a,a,a);break;case 2:c=this.intParameter(1);a=JU.P3.new3(c,c,c);c=!0;break;case 1073742138:b=this.floatParameter(2);this.chk||this.vwr.setFloatProperty("modulationScale",b);return;default:this.invArg()}this.chk||(this.vwr.setVibrationOff(),this.vwr.setModulation(d,b,a,c))});l(c$,"navigate",function(){var a=this.e;if(1==this.slen)a.setBooleanProperty("navigationMode",
!0);else{var b=JU.V3.new3(0,1,0),c=new JU.Lst,d;if(2==this.slen)switch(this.getToken(1).tok){case 1048589:case 1048588:if(this.chk)return;a.setObjectMad(33,"axes",1);this.setShapeProperty(33,"position",JU.P3.new3(50,50,3.4028235E38));a.setBooleanProperty("navigationMode",!0);this.vwr.tm.setNavOn(1048589==a.theTok);return;case 1073742162:this.chk||this.vwr.tm.setNavXYZ(0,0,0);return;case 8:case 1113200654:break;default:this.invArg()}!this.chk&&!this.vwr.getBoolean(603979887)&&a.setBooleanProperty("navigationMode",
!0);for(var e=1;e<this.slen;e++){var f=this.isFloatParameter(e)?this.floatParameter(e++):2;0>f&&this.invArg();!this.chk&&0<f&&a.refresh(!1);switch(this.getToken(e).tok){case 8:case 1048586:d=this.getPoint3f(e,!0);a.iToken++;a.iToken!=this.slen&&this.invArg();this.chk||this.vwr.tm.setNavXYZ(d.x,d.y,d.z);return;case 554176526:d=this.floatParameter(++e);this.chk||c.addLast([Integer.$valueOf(554176526),Float.$valueOf(f),Float.$valueOf(d)]);continue;case 12289:d=this.centerParameter(++e);e=a.iToken;this.chk||
c.addLast([Integer.$valueOf(135266320),Float.$valueOf(f),d]);continue;case 528432:switch(this.getToken(++e).tok){case 1112541205:b.set(1,0,0);e++;break;case 1112541206:b.set(0,1,0);e++;break;case 1112541207:b.set(0,0,1);e++;break;case 8:case 1048586:b.setT(this.getPoint3f(e,!0));e=a.iToken+1;break;case 1073741824:this.invArg()}d=this.floatParameter(e);this.chk||c.addLast([Integer.$valueOf(528432),Float.$valueOf(f),b,Float.$valueOf(d)]);continue;case 4160:var g=d=NaN;if(this.isFloatParameter(++e))d=
this.floatParameter(e),g=this.floatParameter(++e);else switch(this.tokAt(e)){case 1112541205:d=this.floatParameter(++e);break;case 1112541206:g=this.floatParameter(++e);break;default:d=this.centerParameter(e);e=a.iToken;this.chk||c.addLast([Integer.$valueOf(4160),Float.$valueOf(f),d]);continue}this.chk||c.addLast([Integer.$valueOf(269484210),Float.$valueOf(f),Float.$valueOf(d),Float.$valueOf(g)]);continue;case 269484208:continue;case 1113200654:d=new JU.Lst;10==this.tokAt(e+1)||1048577==this.tokAt(e+
1)?(g=this.atomExpressionAt(++e),e=a.iToken):g=this.vwr.bsA();if(this.chk)return;this.vwr.getPolymerPointsAndVectors(g,d);var h;if(0<(h=d.size())){for(var g=Array(h),k=0;k<h;k++)g[k]=d.get(k);c.addLast([Integer.$valueOf(1113200654),Float.$valueOf(f),g]);continue}break;case 1073742084:if(1048582==this.getToken(e+1).tok){e++;d=a.objectNameParameter(++e);if(this.chk)return;this.setShapeProperty(22,"thisID",d);d=this.getShapeProperty(22,"vertices");a.refresh(!1);null==d&&this.invArg();g=K(this.isFloatParameter(e+
1)?this.floatParameter(++e):0);h=K(this.isFloatParameter(e+1)?this.floatParameter(++e):2147483647);c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),d,null,[g,h]]);continue}for(d=new JU.Lst;a.isCenterParameter(e+1);)d.addLast(this.centerParameter(++e)),e=a.iToken;if(0<d.size()){d=d.toArray(Array(d.size()));this.chk||c.addLast([Integer.$valueOf(1073742084),Float.$valueOf(f),d,null,[0,2147483647]]);continue}default:this.invArg()}}!this.chk&&!this.vwr.isJmolDataFrame()&&this.vwr.tm.navigateList(a,
c)}});ca(c$,"plot",function(a){this.st=this.e.st;this.chk=this.e.chk;var b=this.vwr.am.cmi;0>b&&this.e.errorStr(30,"plot");var b=this.vwr.ms.getJmolDataSourceFrame(b),c=a.length-1,d=a!==this.st,e=this.st;d&&(this.e.st=this.st=a);var f=d?135270926:a[0].tok,g=d||135270418==f||1052714==f?0:1,h=null,k=!0,l=!1;switch(f){case 135176:k=!1;l=!0;break;case 135270926:k=!1;break;case 135270422:k=!1,4==JS.CmdExt.tokAtArray(c,a)?h=this.stringParameter(c--):1048583==JS.CmdExt.tokAtArray(c-1,a)?(h=this.paramAsStr(c-
2)+"."+this.paramAsStr(c),c-=3):(this.e.st=this.st=e,this.e.iToken=this.st.length,this.error(13))}var d="",s=null,u="",m=!1,H=!1,n=!1,y=!1,C=0,G=0,q=0,r=JU.BSUtil.copy(this.vwr.bsA()),t="; select "+JU.Escape.eBS(r)+";\n ",y=this.e.optParameterAsString(c).toLowerCase(),z=null,v=null,I=JS.CmdExt.tokAtArray(g,a);4==I&&(I=JS.T.getTokFromName(a[g].value));switch(I){default:this.e.iToken=1;this.invArg();break;case 135270408:this.e.iToken=1;y="data";t="";break;case 1716520985:this.e.iToken=g+1;(!JS.T.tokAttr(C=
this.tokAt(this.e.iToken++),1078984704)||!JS.T.tokAttr(G=this.tokAt(this.e.iToken++),1078984704))&&this.invArg();JS.T.tokAttr(q=this.tokAt(this.e.iToken),1078984704)?this.e.iToken++:q=0;32==this.tokAt(this.e.iToken)&&(z=this.getPoint3f(++this.e.iToken,!1),this.e.iToken++);64==this.tokAt(this.e.iToken)&&(v=this.getPoint3f(++this.e.iToken,!1),this.e.iToken++);y="property "+JS.T.nameOf(C)+" "+JS.T.nameOf(G)+(0==q?"":" "+JS.T.nameOf(q));0>r.nextSetBit(0)&&(r=this.vwr.getModelUndeletedAtomsBitSet(b));
u="select "+JU.Escape.eBS(r)+";\n ";break;case 1052714:y.equalsIgnoreCase("draw")&&(y=this.e.optParameterAsString(--c).toLowerCase());y=c>g&&y.startsWith("r");y="ramachandran"+(y?" r":"")+(135176==f?" draw":"");break;case 135270418:case 137363467:d=' "'+this.vwr.getQuaternionFrame()+'"';u="set quaternionFrame"+d+";\n  ";m=!0;y.equalsIgnoreCase("draw")&&(l=!0,y=this.e.optParameterAsString(--c).toLowerCase());n=(H=y.startsWith("deriv")||y.startsWith("diff"))&&0<y.indexOf("2");H&&c--;if(y.equalsIgnoreCase("helix")||
y.equalsIgnoreCase("axis"))H=l=!0,c=-1;y=((c<=g?"":this.e.optParameterAsString(c))+"w").substring(0,1);if(y.equals("a")||y.equals("r"))H=!0;JU.PT.isOneOf(y,";w;x;y;z;r;a;")||this.e.evalError("QUATERNION [w,x,y,z,a,r] [difference][2]",null);y="quaternion "+y+(H?" difference":"")+(n?"2":"")+(l?" draw":"")}this.st=e;if(this.chk)return"";if(k&&(u+="plot "+y,a=this.vwr.ms.getJmolDataFrameIndex(b,u),0<a&&135270422!=f&&135270926!=f))return this.vwr.setCurrentModelIndexClear(a,!0),"";e=c=a=null;g=JU.P3.new3(1,
1,1);if(1716520985==I){a=this.e.getBitsetPropertyFloat(r,C|224,null==z?NaN:z.x,null==v?NaN:v.x);c=this.e.getBitsetPropertyFloat(r,G|224,null==z?NaN:z.y,null==v?NaN:v.y);0!=q&&(e=this.e.getBitsetPropertyFloat(r,q|224,null==z?NaN:z.z,null==v?NaN:v.z));null==z&&(z=JU.P3.new3(this.getPlotMinMax(a,!1,C),this.getPlotMinMax(c,!1,G),this.getPlotMinMax(e,!1,q)));null==v&&(v=JU.P3.new3(this.getPlotMinMax(a,!0,C),this.getPlotMinMax(c,!0,G),this.getPlotMinMax(e,!0,q)));JU.Logger.info("plot min/max: "+z+" "+v);
s=new JU.P3;s.ave(v,z);g.sub2(v,z);g.set(g.x/200,g.y/200,g.z/200);JS.T.tokAttr(C,1095761920)?(g.x=1,s.x=0):0.1<g.x&&10>=g.x&&(g.x=1);JS.T.tokAttr(G,1095761920)?(g.y=1,s.y=0):0.1<g.y&&10>=g.y&&(g.y=1);JS.T.tokAttr(q,1095761920)?(g.z=1,s.z=0):0.1<g.z&&10>=g.z&&(g.z=1);0==q&&(s.z=z.z=v.z=g.z=0);for(k=0;k<a.length;k++)a[k]=(a[k]-s.x)/g.x;for(k=0;k<c.length;k++)c[k]=(c[k]-s.y)/g.y;if(0!=q)for(k=0;k<e.length;k++)e[k]=(e[k]-s.z)/g.z;s=[r,a,c,e,z,v,g,s]}if(135270422==f)return this.vwr.writeFileData(h,"PLOT_"+
y,b,s);h=y.equals("data")?"1 0 H 0 0 0 # Jmol PDB-encoded data":this.vwr.getPdbData(b,y,null,s,null,!0);if(135270926==f)return h;JU.Logger.debugging&&JU.Logger.debug(h);if(135176==f)return this.e.runScript(h),"";f=this.vwr.getFileInfo();r=this.vwr.getBoolean(603979792);this.vwr.g.appendNew=!0;h=null!=h&&null==this.vwr.openStringInlineParamsAppend(h,null,!0);this.vwr.g.appendNew=r;this.vwr.setFileInfo(f);if(!h)return"";f=this.vwr.getModelCount();this.vwr.ms.setJmolDataFrame(u,b,f-1);1716520985!=I&&
(u+=";\n"+t);u=this.vwr.addStateScript(u,!0,!1);h=150;switch(I){default:b="frame 0.0; frame last; reset;select visible;wireframe only;";h=10;break;case 1716520985:this.vwr.setFrameTitle(f-1,y+" plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; spacefill 3; wireframe 0;draw plotAxisX"+f+' {100 -100 -100} {-100 -100 -100} "'+JS.T.nameOf(C)+'";draw plotAxisY'+f+' {-100 100 -100} {-100 -100 -100} "'+JS.T.nameOf(G)+'";';0!=q&&(b+="draw plotAxisZ"+f+' {-100 -100 100} {-100 -100 -100} "'+
JS.T.nameOf(q)+'";');break;case 1052714:this.vwr.setFrameTitle(f-1,"ramachandran plot for model "+this.vwr.getModelNumberDotted(b));b="frame 0.0; frame last; reset;select visible; color structure; spacefill 3.0; wireframe 0;draw ramaAxisX"+f+' {100 0 0} {-100 0 0} "phi";draw ramaAxisY'+f+' {0 100 0} {0 -100 0} "psi";';break;case 135270418:case 137363467:this.vwr.setFrameTitle(f-1,y.$replace("w"," ")+d+" for model "+this.vwr.getModelNumberDotted(b)),b=JU.C.getHexCode(this.vwr.getColixBackgroundContrast()),
b="frame 0.0; frame last; reset;select visible; wireframe 0; spacefill 3.0; isosurface quatSphere"+f+" color "+b+" sphere 100.0 mesh nofill frontonly translucent 0.8;draw quatAxis"+f+'X {100 0 0} {-100 0 0} color red "x";draw quatAxis'+f+'Y {0 100 0} {0 -100 0} color green "y";draw quatAxis'+f+'Z {0 0 100} {0 0 -100} color blue "z";color structure;draw quatCenter'+f+"{0 0 0} scale 0.02;"}this.e.runScript(b+t);u.setModelIndex(this.vwr.am.cmi);this.vwr.setRotationRadius(h,!0);this.sm.loadShape(30);
this.showString("frame "+this.vwr.getModelNumberDotted(f-1)+(0<y.length?" created: "+y+(m?d:""):""));return""},"~A");l(c$,"polyhedra",function(){var a=this.e,b=!1,c=!1,d=!1,e=!1,f=!1,g=0,h=0;this.sm.loadShape(21);this.setShapeProperty(21,"init",Boolean.TRUE);for(var k="centers",l="radius_",s=3.4028235E38,u=[-2147483648],m=1;m<this.slen;++m){var H=null,n=null;switch(this.getToken(m).tok){case 12291:case 1048589:case 1048588:(m+1!=this.slen||b||1<h||0==h&&"to".equals(k))&&this.error(18);H=1048588==
a.theTok?"off":1048589==a.theTok?"on":"delete";c=!0;break;case 269484436:case 269484080:continue;case 1678770178:0<h&&this.invPO();b=!0;H="bonds";break;case 1666189314:l="radius";continue;case 2:case 3:0<h&&!f&&this.invPO();if(2==a.theTok&&"radius_"===l){H="nVertices";n=Integer.$valueOf(this.intParameter(m));b=!0;break}H="radius_"===l?"radius":l;n=Float.$valueOf(this.floatParameter(m));l="radius_";f=!1;b=!0;break;case 10:case 1048577:d&&this.invPO();2<++h&&a.bad();"to".equals(k)&&(b=!0);H=k;k="to";
n=this.atomExpressionAt(m);m=a.iToken;break;case 1074790746:1<h&&this.invPO();if(10==this.tokAt(m+1)||1048577==this.tokAt(m+1)&&!b){H="toBitSet";n=this.atomExpressionAt(++m);m=a.iToken;b=!0;break}else b||this.error(19);k="to";continue;case 1073741937:b||this.error(19);l="faceCenterOffset";f=!0;continue;case 1073741924:0==h&&this.error(19);l="distanceFactor";f=!0;continue;case 1766856708:case 603979967:case 1073742074:s=this.getColorTrans(a,m,!0,u);m=a.iToken;continue;case 1073741886:case 1073741948:H=
"collapsed";n=1073741886==a.theTok?Boolean.TRUE:Boolean.FALSE;d&&this.error(18);d=!0;break;case 1073742044:case 1073741933:case 1073741956:e&&this.error(18);H=this.paramAsStr(m);e=!0;break;case 1073741964:g=a.theTok;continue;default:if(a.isColorParam(m)){u[0]=a.getArgbParam(m);m=a.iToken;continue}this.invArg()}this.setShapeProperty(21,H,n);if(c)return!1}!b&&(!d&&!e&&0==g)&&this.error(19);b&&this.setShapeProperty(21,"generate",null);-2147483648!=u[0]&&this.setShapeProperty(21,"colorThis",Integer.$valueOf(u[0]));
3.4028235E38!=s&&a.setShapeTranslucency(21,"","translucentThis",s,null);0!=g&&this.setShapeProperty(21,"token",Integer.$valueOf(g));this.setShapeProperty(21,"init",Boolean.FALSE);return!0});ca(c$,"evalParallel",function(a,b){var c=(new JS.ScriptEval).setViewer(this.vwr);c.historyDisabled=!0;c.compiler=new JS.ScriptCompiler(this.vwr);c.sm=b;try{c.restoreScriptContext(a,!0,!1,!1),c.allowJSThreads=!1,c.dispatchCommands(!1,!1)}catch(d){if(ba(d,Exception))return this.e.vwr.setStringProperty("_errormessage",
""+d),null==c.thisContext&&(JU.Logger.error("Error evaluating context "+d),this.vwr.isJS||d.printStackTrace()),!1;throw d;}return!0},"JS.ScriptContext,JV.ShapeManager");ca(c$,"write",function(a){var b=0,c=0,d,e;null==a?(a=this.st,b=c=1,d=!0,e=this.vwr.isApplet()&&!this.vwr.isSignedApplet()||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL)||0<this.vwr.getPathForAllFiles().length):(d=!1,e=!0);var f=d?this.slen:a.length,g=0,h=0,k=-1,l=-1,s=-2147483648,u=this.vwr.getBoolean(603979934),m=this.vwr.getExportDriverList(),
H="PNGJ",n=null,y="",C=null,G=null,q=null,r=null,t=null,z=null,v=Array(1),I=!1,D=!1,F=!1,K=null,M=null,w="SPT",T=d&&1==a.length?1073741884:JS.CmdExt.tokAtArray(b,a);switch(T){case 0:break;case 135271429:this.e.isArrayParameter(b+1)&&(M=this.e.stringParameterSet(++b),q=G=".",c=b=this.e.iToken+1,T=this.tokAt(b));break;default:w=JS.SV.sValue(this.tokenAt(b,a)).toUpperCase()}d&&1073741848==this.tokAt(this.slen-2)&&(w=this.paramAsStr(this.slen-1).toUpperCase(),c=f,f-=2,T=0);switch(T){case 15:case 6:w=
"VAR";z=this.tokenAt(b++,a);break;case 135270418:case 1052714:case 1716520985:t=this.plot(a);if(!d)return t;break;case 1073741983:w="INLINE";n=JS.SV.sValue(this.tokenAt(++b,a));b++;break;case 1073742102:w="PGRP";b++;y=JS.SV.sValue(this.tokenAt(b,a)).toLowerCase();y.equals("draw")&&b++;break;case 1048581:b++;I=!0;break;case 1073742158:case 135271429:for(r=JS.SV.sValue(this.tokenAt(++b,a)).toLowerCase();r.equals("localpath")||r.equals("remotepath");)r.equals("localpath")?G=JS.SV.sValue(this.tokenAt(++b,
a)):q=JS.SV.sValue(this.tokenAt(++b,a)),r=JS.SV.sValue(this.tokenAt(++b,a)).toLowerCase();w="SPT";break;case 1229984263:case 135368713:case 1610616855:case 135180:case 1073742015:case 1073742018:case 1183762:case 135188:b++;break;case 1073741991:w="ZIPALL";b++;break;case 36868:w="VAR";b+=2;break;case 4115:case 1073741824:case 1073741979:case 1073742139:case 4:case 4166:switch(T){case 1073741979:b++;break;case 4166:h=this.e.intParameterRange(++b,1,10);if(2147483647==h)return"";this.chk||(this.vwr.setVibrationOff(),
this.e.isJS||this.e.delayScript(100));b++;break;case 4115:var O;b+1<f&&1048577==a[++b].tok||10==a[b].tok?(O=this.e.atomExpression(a,b,0,!0,!1,!0,!0),b=this.e.iToken+1):O=this.vwr.getAllAtoms();this.chk||(K=this.vwr.ms.getModelBS(O,!0));break;case 1073742139:r=JS.SV.sValue(this.tokenAt(++b,a)).toUpperCase();JU.PT.isOneOf(r,";PNG;PNGJ;")&&(H=r,b++);break;default:T=1073741979}if(1073741979==T)if(T=JS.T.getTokenFromName(JS.SV.sValue(a[b]).toLowerCase()),null!=T&&(w=JS.SV.sValue(T).toUpperCase(),I=1048581==
T.tok,b++),JU.PT.isOneOf(w,m.toUpperCase())){b++;w=w.substring(0,1).toUpperCase()+w.substring(1).toLowerCase();D=!0;d&&(C="Jmol."+w.toLowerCase());break}else if(JU.PT.isOneOf(w,";ZIP;ZIPALL;SPT;STATE;")){b++;break}else I||(w="(image)");2==JS.CmdExt.tokAtArray(b,a)&&(k=JS.SV.iValue(this.tokenAt(b++,a)),l=JS.SV.iValue(this.tokenAt(b++,a)))}if(null==t){if(c<f){r=JS.SV.sValue(this.tokenAt(b,a));if(r.equalsIgnoreCase("clipboard")){if(this.chk)return""}else JU.PT.isOneOf(r.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;")?
(2==JS.CmdExt.tokAtArray(b+1,a)&&2==JS.CmdExt.tokAtArray(b+2,a)&&(k=JS.SV.iValue(this.tokenAt(++b,a)),l=JS.SV.iValue(this.tokenAt(++b,a))),2==JS.CmdExt.tokAtArray(b+1,a)&&(s=JS.SV.iValue(this.tokenAt(++b,a)))):JU.PT.isOneOf(r.toLowerCase(),";xyz;xyzrn;xyzvib;mol;sdf;v2000;v3000;json;pdb;pqr;cml;")&&(w=r.toUpperCase(),b+1==f&&b++);w.equals("(image)")&&JU.PT.isOneOf(r.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;")&&(w=r.toUpperCase(),b++)}b+2==f&&(t=JS.SV.sValue(this.tokenAt(++b,
a)),0<t.length&&"."!=t.charAt(0)&&(w=r.toUpperCase()));switch(JS.CmdExt.tokAtArray(b,a)){case 0:e=!0;break;case 1073741884:break;case 1073741824:case 4:C=JS.SV.sValue(this.tokenAt(b,a));b==f-3&&1048583==JS.CmdExt.tokAtArray(b+1,a)&&(C+="."+JS.SV.sValue(this.tokenAt(b+2,a)));if("VAR"!==w&&b==c&&!I)w="IMAGE";else if(0<C.length&&"."==C.charAt(0)&&(b==c+1||b==c+2))C=JS.SV.sValue(this.tokenAt(b-1,a))+C,"VAR"!==w&&b==c+1&&(w="IMAGE");if(C.equalsIgnoreCase("clipboard")||!this.vwr.haveAccess(JV.Viewer.ACCESS.ALL))C=
null;break;default:this.invArg()}if(w.equals("IMAGE")||w.equals("(image)")||w.equals("FRAME")||w.equals("VIBRATION"))w=null!=C&&0<=C.indexOf(".")?C.substring(C.lastIndexOf(".")+1).toUpperCase():"JPG";w.equals("MNU")?w="MENU":w.equals("WRL")||w.equals("VRML")?(w="Vrml",D=!0):w.equals("X3D")?(w="X3d",D=!0):w.equals("IDTF")?(w="Idtf",D=!0):w.equals("MA")?(w="Maya",D=!0):w.equals("JS")?(w="Js",D=!0):w.equals("OBJ")?(w="Obj",D=!0):w.equals("JVXL")?w="ISOSURFACE":w.equals("XJVXL")?w="ISOSURFACE":w.equals("JMOL")?
w="ZIPALL":w.equals("HIS")&&(w="HISTORY");if(w.equals("COORD")||w.equals("COORDS"))w=null!=C&&0<=C.indexOf(".")?C.substring(C.lastIndexOf(".")+1).toUpperCase():"XYZ";F=JU.PT.isOneOf(w.toLowerCase(),";jpg;jpeg;jpg64;jpeg64;gif;pdf;ppm;png;pngj;pngt;scene;");null!=M&&(w.equals("PNG")&&(w="PNGJ"),!w.equals("PNGJ")&&!w.equals("ZIPALL")&&this.invArg());!F&&(!D&&!JU.PT.isOneOf(w,";SCENE;JMOL;ZIP;ZIPALL;SPT;HISTORY;MO;ISOSURFACE;MESH;PMESH;VAR;FILE;FUNCTION;CML;JSON;XYZ;XYZRN;XYZVIB;MENU;MOL;PDB;PGRP;PQR;QUAT;RAMA;SDF;V2000;V3000;INLINE;"))&&
this.e.errorStr2(54,"COORDS|FILE|FUNCTIONS|HISTORY|IMAGE|INLINE|ISOSURFACE|JMOL|MENU|MO|POINTGROUP|QUATERNION [w,x,y,z] [derivative]|RAMACHANDRAN|SPT|STATE|VAR x|ZIP|ZIPALL  CLIPBOARD","CML|GIF|JPG|JPG64|JMOL|JVXL|MESH|MOL|PDB|PMESH|PNG|PNGJ|PNGT|PPM|PQR|SDF|CD|JSON|V2000|V3000|SPT|XJVXL|XYZ|XYZRN|XYZVIB|ZIP"+m.toUpperCase().$replace(";","|"));if(this.chk)return"";t=null;b=!1;if(null==n||D){n=w.intern();if(D){u&&JU.Logger.startTimer("export");h=new java.util.Hashtable;h.put("type",n);null!=C&&h.put("fileName",
C);(d||null!=C)&&h.put("fullPath",v);h.put("width",Integer.$valueOf(k));h.put("height",Integer.$valueOf(l));n=this.vwr.generateOutputForExport(h);if(null==n||0==n.length)return"";if(!d)return n;(w.equals("Povray")||w.equals("Idtf"))&&null!=v[0]?(k=w.equals("Idtf")?".tex":".ini",C=v[0]+k,d=new java.util.Hashtable,d.put("fileName",C),d.put("type",k),d.put("text",n),d.put("fullPath",v),t=this.vwr.processWriteOrCapture(d),w.equals("Idtf")&&(n=n.substring(0,n.indexOf("\\begin{comment}"))),n="Created "+
v[0]+":\n\n"+n,u&&this.showString(JU.Logger.getTimerMsg("export",0))):t=n;null!=t&&(t.startsWith("OK")||this.e.evalError(t,null),this.e.report(n));return""}if("MENU"===n)n=this.vwr.getMenu("");else if("PGRP"===n)n=this.vwr.getPointGroupAsString(y.equals("draw"),null,0,1);else if("PDB"===n||"PQR"===n)e?n=this.vwr.getPdbAtomData(null,null):b=!0;else if("FILE"===n)e?n=this.vwr.getCurrentFileAsString():b=!0,"?".equals(C)&&(C="?Jmol."+this.vwr.getP("_fileType"));else if(("SDF"===n||"MOL"===n||"V2000"===
n||"V3000"===n||"CD"===n||"JSON"===n)&&I)n=this.vwr.getModelExtract("selected",!0,!1,n),n.startsWith("ERROR:")&&(t=n);else if("XYZ"===n||"XYZRN"===n||"XYZVIB"===n||"MOL"===n||"SDF"===n||"V2000"===n||"V3000"===n||"CML"===n||"CD"===n||"JSON"===n)n=this.vwr.getData("selected",n),n.startsWith("ERROR:")&&(t=n);else if("FUNCTION"===n)n=this.vwr.getFunctionCalls(null),w="TXT";else if("VAR"===n){null==z&&(z=this.e.getParameter(JS.SV.sValue(this.tokenAt(d?2:1,a)),1073742190,!0));a=null;if(15==z.tok)a=new JU.Lst,
a.addLast(z.value.data);else if(6==z.tok&&(y=z.value,y.containsKey("$_BINARY_$")&&(a=new JU.Lst,null!=C)))for(var R,y=y.entrySet().iterator();y.hasNext()&&((R=y.next())||1);)if(G=R.getKey(),!G.equals("$_BINARY_$"))if(q=R.getValue(),t=15==q.tok?q.value.data:null,null==t&&(t=q.asString(),t=t.startsWith(";base64,")?JU.Base64.decodeBase64(t):t.getBytes()),G.equals("_DATA_")){a=null;null==t&&(t=q.value.data);break}else G.equals("_IMAGE_")?(a.add(0,G),a.add(1,t)):(a.addLast(G),a.addLast(null),a.addLast(t));
null==a?null==t&&(n=z.asString(),w="TXT"):null!=C&&null==(t=n=this.vwr.createZip(C,1==a.size()?"BINARY":"ZIPDATA",a))&&this.e.evalError("#CANCELED#",null)}else if("SPT"===n)if(I)z=this.vwr.ms.getTaintedAtoms(2),this.vwr.setAtomCoordsRelative(JU.P3.new3(0,0,0),null),n=this.vwr.getStateInfo(),this.vwr.ms.setTaintedAtoms(z,2);else{if(n=this.vwr.getStateInfo(),null!=G||null!=q)n=JV.FileManager.setScriptFileReferences(n,G,q,null)}else"ZIP"===n||"ZIPALL"===n?null!=C&&null==(t=n=this.vwr.createZip(C,w,M))&&
this.e.evalError("#CANCELED#",null):"HISTORY"===n?(n=this.vwr.getSetHistory(2147483647),w="SPT"):"MO"===n?(n=this.getMoJvxl(2147483647),w="XJVXL"):"PMESH"===n?(null==(n=this.getIsosurfaceJvxl(!0,28))&&this.error(31),w="XJVXL"):"ISOSURFACE"===n||"MESH"===n?(null==(n=this.getIsosurfaceJvxl("MESH"===n,24))&&this.error(31),w=0<=n.indexOf("<?xml")?"XJVXL":"JVXL",e||this.showString(this.getShapeProperty(24,"jvxlFileInfo"))):(g=-1,0>s&&(s=-1));null==n&&!b&&(n="");0==g&&!b&&(null==t||V(t,String));F&&(this.e.refresh(!1),
0>k&&(k=this.vwr.getScreenWidth()),0>l&&(l=this.vwr.getScreenHeight()))}if(!d)return n;if(e)return this.e.showStringPrint(n,!0),"";if(null!=t&&V(t,String))return 0!=t.indexOf("OK")&&alert(t),this.e.report(t),t;if(w.equals("SCENE"))t=H;else if(null==t&&(!F||null!=C))t=n;u&&JU.Logger.startTimer("write");b?t=this.vwr.writeFileData(C,w,0,null):(d=new java.util.Hashtable,null!=C&&d.put("fileName",C),d.put("type",w),V(t,String)&&-2147483648==s?d.put("text",t):V(t,Array)&&d.put("bytes",t),null!=M&&d.put("scripts",
M),null!=K&&d.put("bsFrames",K),d.put("fullPath",v),d.put("quality",Integer.$valueOf(s)),d.put("width",Integer.$valueOf(k)),d.put("height",Integer.$valueOf(l)),d.put("nVibes",Integer.$valueOf(h)),t=this.vwr.processWriteOrCapture(d));u&&this.showString(JU.Logger.getTimerMsg("write",0))}return!this.chk&&null!=t?(t.startsWith("OK")||(this.e.evalError(t,null),alert(t)),this.e.report(t+(F?"; width="+k+"; height="+l:"")),t):""},"~A");l(c$,"show",function(){var a=null,b=this.paramAsStr(1),c=null,d=null,
e=2,d=this.getToken(1),f=V(d,JS.SV)?0:d.tok;4==f&&(d=JS.T.getTokenFromName(b.toLowerCase()),null!=d&&(f=d.tok));1297090050!=f&&1073742158!=f&&this.checkLength(-3);if(2==this.slen&&0<=b.indexOf("?"))this.showString(this.vwr.getAllSettings(b.substring(0,b.indexOf("?"))));else{switch(f){case 0:this.chk||(c=this.e.theToken.escape());break;case 135270423:this.chk||(c=JU.Escape.e(this.vwr.cacheList()));break;case 1073741916:this.e.checkLength23();e=this.st.length;this.chk||(c=this.vwr.ms.getInfo(this.vwr.am.cmi,
"dssr"),c=null==c?"no DSSR information has been read":2<e?JS.SV.getVariable(this.vwr.extractProperty(c,this.stringParameter(2),-1)).asString():""+JS.SV.getVariable(c).asString());break;case 1073741915:this.checkLength(2);this.chk||(c=this.vwr.calculateStructures(null,!0,!1));break;case 545259571:this.checkLength(2);this.chk||(c=this.vwr.getPathForAllFiles());break;case 1073742038:if(this.e.optParameterAsString(2).equalsIgnoreCase("1H")){e=3;this.chk||(c=this.vwr.getNMRPredict(!1));break}this.chk||
this.vwr.getNMRPredict(!0);return;case 135267336:case 1073741929:case 1073741879:this.checkLength(1073741879==f?3:2);if(this.chk)return;try{c=this.vwr.getSmiles(null)}catch(g){if(ba(g,Exception))c=g.getMessage();else throw g;}switch(f){case 1073741929:if(0<c.length){this.vwr.show2D(c);return}c="Could not show drawing -- Either insufficient atoms are selected or the model is a PDB file.";break;case 1073741879:e=3,0<c.length?(c=this.vwr.getChemicalInfo(c,this.getToken(2)),0<=c.indexOf("FileNotFound")&&
(c="?")):c="Could not show name -- Either insufficient atoms are selected or the model is a PDB file."}break;case 1297090050:var d=0,h=null,k=null;3<this.slen&&4!=this.tokAt(3)?(h=this.centerParameter(2),k=this.centerParameter(++this.e.iToken)):d=2==this.tokAt(2)?this.intParameter(2):0;f=4==this.tokAt(this.e.iToken+1)?this.stringParameter(++this.e.iToken):null;this.checkLength(e=++this.e.iToken);this.chk||(c=this.vwr.getSymmetryOperation(d,h,k,f));break;case 1649412120:a=null;2<this.slen&&(a=J.c.VDW.getVdwType(this.paramAsStr(2)),
null==a&&this.invArg());this.chk||this.showString(this.vwr.getDefaultVdwNameOrData(0,a,null));return;case 135368713:this.e.checkLength23();this.chk||this.showString(this.vwr.getFunctionCalls(this.e.optParameterAsString(2)));return;case 1085443:this.checkLength(2);this.chk||this.showString(this.vwr.getAllSettings(null));return;case 1074790760:if(2==this.slen){this.chk||this.vwr.showUrl(this.e.getFullPathName());return}d=this.paramAsStr(2);this.chk||this.vwr.showUrl(d);return;case 1766856708:b="defaultColorScheme";
break;case 1610612740:b="scaleAngstromsPerInch";break;case 135270418:case 1052714:if(this.chk)return;0>this.vwr.am.cmi&&this.e.errorStr(30,"show "+this.e.theToken.value);c=this.plot(this.st);e=this.slen;break;case 14:case 1113200654:this.chk||(c=this.getContext(!1));break;case 1073741888:d=this.e.optParameterAsString(2);0<d.length&&(e=3);this.chk||(a=this.vwr.getColorSchemeList(d));break;case 1073742192:this.chk||(c=this.vwr.getAtomDefs(this.e.definedAtomSets)+this.vwr.g.getVariableList()+this.getContext(!0));
break;case 536870926:this.chk||(c=this.vwr.getTrajectoryState());break;case 553648148:a=""+this.e.commandHistoryLevelMax;break;case 553648150:a=""+JU.Logger.getLogLevel();break;case 603979825:a=""+this.vwr.getBoolean(603979825);break;case 553648178:c="set strandCountForStrands "+this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13);break;case 536875070:c=this.vwr.showTimeout(2==(e=this.slen)?null:this.paramAsStr(2));break;case 536870918:a=JU.Escape.eP(this.vwr.getDefaultLattice());
break;case 4126:this.chk||(c=this.vwr.getMinimizationInfo());break;case 1611272194:switch(this.vwr.g.axesMode){case J.c.AXES.UNITCELL:c="set axesUnitcell";break;case J.c.AXES.BOUNDBOX:c="set axesWindow";break;default:c="set axesMolecular"}break;case 1610612737:c="set bondMode "+(this.vwr.getBoolean(603979812)?"OR":"AND");break;case 1650071565:this.chk||(c="set strandCountForStrands "+this.vwr.getStrandCount(12)+"; set strandCountForMeshRibbon "+this.vwr.getStrandCount(13));break;case 1612189718:c=
"set hbondsBackbone "+this.vwr.getBoolean(603979852)+";set hbondsSolid "+this.vwr.getBoolean(603979854);break;case 1611141175:this.chk||(c=this.vwr.getSpinState());break;case 1611141176:c="set ssbondsBackbone "+this.vwr.getBoolean(603979952);break;case 1610625028:case 1611141171:c="selectionHalos "+(this.vwr.getSelectionHaloEnabled(!1)?"ON":"OFF");break;case 1613758470:c="set selectHetero "+this.vwr.getBoolean(1613758470);break;case 1073741828:c=JU.Escape.eAP(this.vwr.getAdditionalHydrogens(null,
!0,!0,null));break;case 1613758476:c="set selectHydrogens "+this.vwr.getBoolean(1613758476);break;case 553648130:case 553648142:case 536870924:case 553648176:case 553648172:case 1073741995:this.chk||(c=this.vwr.getSpecularState());break;case 1073742136:case 4146:this.chk||(c=this.vwr.stm.listSavedStates());break;case 1614417948:this.chk||(c=this.vwr.getUnitCellInfoText());break;case 1048581:if(2==(e=this.slen)){this.chk||(c=this.vwr.getCoordinateState(this.vwr.bsA()));break}f=this.paramAsStr(2);this.chk||
(c=this.vwr.stm.getSavedCoordinates(f));break;case 1073742158:!this.chk&&null==this.e.outputBuffer&&this.vwr.sm.clearConsole();if(2==(e=this.slen)){this.chk||(c=this.vwr.getStateInfo());break}d=this.paramAsStr(2);if(d.equals("/")&&4==(e=this.slen)){d=this.paramAsStr(3).toLowerCase();if(!this.chk){f=JU.PT.split(this.vwr.getStateInfo(),"\n");c=new JU.SB;for(h=0;h<f.length;h++)0<=f[h].toLowerCase().indexOf(d)&&c.append(f[h]).appendC("\n");c=c.toString()}break}else if(1229984263==this.tokAt(2)&&4==(e=
this.slen)){this.chk||(c=this.vwr.getEmbeddedFileState(this.paramAsStr(3),!0));break}e=3;this.chk||(c=this.vwr.stm.getSavedState(d));break;case 1641025539:if(2==(e=this.slen)){this.chk||(c=this.vwr.getProteinStructureState());break}f=this.paramAsStr(2);this.chk||(c=this.vwr.stm.getSavedStructure(f));break;case 135270408:f=3==(e=this.slen)?this.paramAsStr(2):null;this.chk||(c=null==f?this.lastData:this.vwr.getData(f),c=null==c?"no data":JU.Escape.encapsulateData(c[0],c[1],c[3].intValue()));break;case 1073742152:f=
null;2==(e=this.slen)?this.chk||(f=this.vwr.getSpaceGroupInfo(null)):(d=this.paramAsStr(2),this.chk||(f=this.vwr.getSpaceGroupInfo(JU.PT.rep(d,"''",'"'))));null!=f&&(c=""+f.get("spaceGroupInfo")+f.get("symmetryInfo"));break;case 1048582:e=3;c=this.e.setObjectProperty();break;case 1679429641:this.chk||(c=this.vwr.ms.getBoundBoxCommand(!0));break;case 12289:this.chk||(c="center "+JU.Escape.eP(this.vwr.tm.getRotationCenter()));break;case 135176:this.chk||(c=this.getShapeProperty(22,"command"));break;
case 1229984263:this.chk||this.vwr.sm.clearConsole();if(2==this.slen){this.chk||(c=this.vwr.getCurrentFileAsString());null==c&&(c="<unavailable>");break}e=3;a=this.paramAsStr(2);this.chk||(c=this.vwr.getFileAsString(a,!0));break;case 4115:c=1048579==this.tokAt(2)&&0<(e=3)?this.vwr.getModelFileInfoAll():this.vwr.getModelFileInfo();break;case 1610616855:f=2==(e=this.slen)?2147483647:this.intParameter(2);1>f&&this.invArg();this.chk||(this.vwr.sm.clearConsole(),0==this.e.scriptLevel&&this.vwr.removeCommand(),
c=this.vwr.getSetHistory(f));break;case 135180:this.chk||(c=this.getShapeProperty(24,"jvxlDataXml"));break;case 1183762:this.e.optParameterAsString(2).equalsIgnoreCase("list")?(c=this.vwr.getMoInfo(-1),e=3):(f=2==(e=this.slen)?-2147483648:this.intParameter(2),this.chk||(c=this.getMoJvxl(f)));break;case 1095766030:this.chk||(c=this.vwr.ms.getModelInfoAsString());break;case 537006096:this.chk||(c=this.vwr.getMeasurementInfoAsString());break;case 1073741863:e=3;!this.chk&&this.slen==e&&(c=this.vwr.getOrientationText(this.tokAt(2),
null));break;case 1073742132:f=this.tokAt(2),0==f?f=1073742132:e=3;case 1073742178:case 4130:this.chk||(c=this.vwr.getOrientationText(f,null));break;case 1073742077:e=2;if(3<this.slen)break;switch(f=this.tokAt(2)){case 1073742178:case 1073742132:case 4130:case 0:this.chk||(c=this.vwr.getOrientationText(f,null));break;default:d=this.e.optParameterAsString(2),c=this.vwr.getOrientationText(1073742035,d)}e=this.slen;break;case 1073742088:this.chk||(c=this.vwr.getPDBHeader());break;case 1073742102:this.chk||
this.showString(this.vwr.getPointGroupAsString(!1,null,0,0));return;case 1089470478:this.chk||(c=this.vwr.ms.getSymmetryInfoAsString());break;case 1073742176:this.chk||(c="transform:\n"+this.vwr.tm.getTransformText());break;case 4168:c="zoom "+(this.vwr.tm.zoomEnabled?""+this.vwr.tm.getZoomSetting():"off");break;case 1611272202:c=this.vwr.getShowFrank()?"frank ON":"frank OFF";break;case 1666189314:b="solventProbeRadius";break;case 1073741864:case 1087373316:case 1087373320:case 1073742120:case 1114638363:case 1087373318:case 1141899265:case 1073741982:c=
this.vwr.getChimeInfo(f);break;case 537022465:case 1610612738:case 1716520985:case 20482:case 1613758488:a="?";break;case 1073742031:f=2==(e=this.slen)?null:this.paramAsStr(2);this.chk||(c=this.vwr.getBindingInfo(f));break;case 1073742015:this.chk||(a=this.vwr.getMenu(""));break;case 1073741824:b.equalsIgnoreCase("fileHeader")&&(this.chk||(c=this.vwr.getPDBHeader()));break;case 1073741992:case 36868:b=this.paramAsStr(e++),c=this.e.getParameter(b,1073742190,!0),c=1073741992==f?c.toJSON():c.escape()}this.checkLength(e);
this.chk||(null!=c?this.showString(c):null!=a?this.showString(b+" = "+a):null!=b&&(0<=b.indexOf(" ")?this.showString(b):this.showString(b+" = "+this.e.getParameter(b,1073742190,!0).escape())))}});l(c$,"stereo",function(){for(var a=J.c.STER.DOUBLE,b=-5,c=!1,d=null,e=0,f=1;f<this.slen;++f)if(this.e.isColorParam(f))1<e&&this.e.bad(),0==e&&(d=ha(2,0)),c||(b=3),d[e]=this.e.getArgbParam(f),0==e++&&(d[1]=~d[0]),f=this.e.iToken;else switch(this.getToken(f).tok){case 1048589:this.e.checkLast(this.e.iToken=
1);this.e.iToken=1;break;case 1048588:this.e.checkLast(this.e.iToken=1);a=J.c.STER.NONE;break;case 2:case 3:b=this.floatParameter(f);c=!0;break;case 1073741824:if(c||(b=3),a=J.c.STER.getStereoMode(this.paramAsStr(f)),null!=a)break;default:this.invArg()}this.chk||this.vwr.setStereoMode(d,a,b)});l(c$,"struts",function(){var a=this.e,b=1073742072==this.tokAt(1)||1048589==this.tokAt(1)||1==this.slen,c=a.getMadParameter();if(2147483647==c)return!1;b&&(c=Math.round(2E3*this.vwr.getFloat(570425406)));this.setShapeProperty(1,
"type",Integer.$valueOf(32768));a.setShapeSizeBs(1,c,null);this.setShapeProperty(1,"type",Integer.$valueOf(1023));return!0});l(c$,"addShapeProperty",function(a,b,c){this.chk||a.addLast([b,c])},"JU.Lst,~S,~O");l(c$,"assign",function(){var a=this.tokAt(1),b=this.atomExpressionAt(2).nextSetBit(0),c=-1,d=null;if(!(0>b)){4106==a?c=this.atomExpressionAt(++this.e.iToken).nextSetBit(0):d=this.paramAsStr(++this.e.iToken);var e=++this.e.iToken<this.slen?this.centerParameter(this.e.iToken):null;if(!this.chk)switch(a){case 1141899265:this.e.clearDefinedVariableAtomSets();
this.assignAtom(b,e,d);break;case 1678770178:this.assignBond(b,(d+"p").charAt(0));break;case 4106:this.assignConnect(b,c)}}});l(c$,"assignAtom",function(a,b,c){c.equals("X")&&this.vwr.setRotateBondIndex(-1);if(this.vwr.ms.at[a].mi==this.vwr.ms.mc-1){this.vwr.clearModelDependentObjects();var d=this.vwr.ms.getAtomCount();if(null==b)this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,1,this.e.fullCommand),this.vwr.ms.assignAtom(a,c,!0),JU.PT.isOneOf(c,";Mi;Pl;X;")||this.vwr.ms.setAtomNamesAndNumbers(a,-d,
null),this.vwr.sm.modifySend(a,this.vwr.ms.at[a].mi,-1,"OK"),this.vwr.refresh(3,"assignAtom");else{var e=this.vwr.ms.at[a],f=JU.BSUtil.newAndSetBit(a);b=[b];var g=new JU.Lst;g.addLast(e);e=e.mi;this.vwr.sm.modifySend(a,e,3,this.e.fullCommand);try{f=this.vwr.addHydrogensInline(f,g,b),a=f.nextSetBit(0),this.vwr.ms.assignAtom(a,c,!1)}catch(h){if(!ba(h,Exception))throw h;}this.vwr.ms.setAtomNamesAndNumbers(a,-d,null);this.vwr.sm.modifySend(a,e,-3,"OK")}}},"~N,JU.P3,~S");l(c$,"assignBond",function(a,b){var c=
-1;try{c=this.vwr.getAtomModelIndex(this.vwr.ms.bo[a].getAtomIndex1());this.vwr.sm.modifySend(a,c,2,this.e.fullCommand);var d=this.vwr.ms.setBondOrder(a,b);null==d||"0"==b?this.vwr.refresh(3,"setBondOrder"):this.vwr.addHydrogens(d,!1,!0);this.vwr.sm.modifySend(a,c,-2,""+b)}catch(e){if(ba(e,Exception))JU.Logger.error("assignBond failed"),this.vwr.sm.modifySend(a,c,-2,"ERROR "+e);else throw e;}},"~N,~S");l(c$,"assignConnect",function(a,b){this.vwr.clearModelDependentObjects();var c=JU.AU.newFloat2(1);
c[0]=[a,b];var d=this.vwr.ms.at[a].mi;this.vwr.sm.modifySend(a,d,2,this.e.fullCommand);this.vwr.ms.connect(c);this.vwr.ms.assignAtom(a,".",!0);this.vwr.ms.assignAtom(b,".",!0);this.vwr.sm.modifySend(a,d,-2,"OK");this.vwr.refresh(3,"assignConnect")},"~N,~N");l(c$,"getContext",function(a){for(var b=new JU.SB,c=this.e.thisContext;null!=c;)a?null!=c.vars&&(b.append(this.getScriptID(c)),b.append(JV.StateManager.getVariableList(c.vars,80,!0,!1))):b.append(JS.ScriptError.getErrorLineMessage(c.functionName,
c.scriptFileName,this.e.getLinenumber(c),c.pc,JS.ScriptEval.statementAsString(this.vwr,c.statement,-9999,this.e.debugHigh))),c=c.parentContext;a?null!=this.e.contextVariables&&(b.append(this.getScriptID(null)),b.append(JV.StateManager.getVariableList(this.e.contextVariables,80,!0,!1))):b.append(this.e.getErrorLineMessage2());return b.toString()},"~B");l(c$,"getAtomicPotentials",function(a,b,c){var d=R(this.vwr.getAtomCount(),0),e=J.api.Interface.getOption("quantum.MlpCalculation");e.set(this.vwr);
c=null==c?null:this.vwr.getFileAsString(c,!1);e.assignPotentials(this.vwr.ms.at,d,this.vwr.getSmartsMatch("a",a),this.vwr.getSmartsMatch("/noAromatic/[$(C=O),$(O=C),$(NC=O)]",a),b,c);return d},"JU.BS,JU.BS,~S");l(c$,"getColorTrans",function(a,b,c,d){c=3.4028235E38;1766856708!=a.theTok&&--b;switch(this.tokAt(b+1)){case 603979967:b++;c=this.isFloatParameter(b+1)?a.getTranslucentLevel(++b):this.vwr.getFloat(570425354);break;case 1073742074:b++,c=0}a.isColorParam(b+1)?d[0]=a.getArgbParam(++b):1048587==
this.tokAt(b+1)?(d[0]=0,a.iToken=b+1):3.4028235E38==c?this.invArg():d[0]=-2147483648;return c},"JS.ScriptEval,~N,~B,~A");l(c$,"getCapSlabObject",function(a,b){if(0>a)return JU.TempArray.getSlabWithinRange(a,0);var c=this.e,d=null,e=554176565==this.tokAt(a),f=this.tokAt(a+1),g=null,h=g=null,k=null,l=null;if(603979967==f)switch(k=this.isFloatParameter(++a+1)?this.floatParameter(++a):0.5,c.isColorParam(a+1)?(k=Short.$valueOf(JU.C.getColixTranslucent3(JU.C.getColix(c.getArgbParam(a+1)),0!=k,k)),a=c.iToken):
k=Short.$valueOf(JU.C.getColixTranslucent3(1,0!=k,k)),f=this.tokAt(a+1)){case 1073742018:case 1073741938:l=Integer.$valueOf(f);f=this.tokAt(++a+1);break;default:l=Integer.$valueOf(1073741938)}switch(f){case 1048588:return c.iToken=a+1,Integer.$valueOf(-2147483648);case 1048587:c.iToken=a+1;break;case 1048582:a++;d=[Float.$valueOf(1),this.paramAsStr(++a)];f=1073742018;break;case 135266325:a++;if(1073742114==this.tokAt(++a))d=this.floatParameter(++a),f=this.floatParameter(++a),d=[Float.$valueOf(d),
Float.$valueOf(f)],f=1073742114;else if(this.isFloatParameter(a)){d=this.floatParameter(a);if(c.isCenterParameter(++a))if(g=this.centerParameter(a),this.chk||!V(c.expressionResult,JU.BS))g=[g];else for(var s=this.vwr.ms.at,h=c.expressionResult,g=Array(h.cardinality()),u=0,m=h.nextSetBit(0);0<=m;m=h.nextSetBit(m+1),u++)g[u]=s[m];else g=c.getPointArray(a,-1);0==g.length&&(c.iToken=a,this.invArg());d=[Float.$valueOf(d),g,h]}else d=c.getPointArray(a,4),f=1679429641;break;case 1679429641:c.iToken=a+1;
d=JU.BoxInfo.getCriticalPoints(this.vwr.ms.getBBoxVertices(),null);break;case 1073741872:case 1614417948:c.iToken=a+1;c=this.vwr.getCurrentUnitCell();if(null==c)1614417948==f&&this.invArg();else{g=JU.BoxInfo.getCriticalPoints(c.getUnitCellVertices(),c.getCartesianOffset());c=K(c.getUnitCellInfoType(6));d=h=null;switch(c){case 1:d=JU.V3.newVsub(g[2],g[0]),d.scale(1E3);case 2:h=JU.V3.newVsub(g[1],g[0]),h.scale(1E3),g[0].sub(h),g[1].scale(2E3),1==c&&(g[0].sub(d),g[2].scale(2E3))}d=g}break;case 10:case 1048577:if(d=
this.atomExpressionAt(a+1),f=3,!c.isCenterParameter(++c.iToken))break;default:if(!b&&e&&this.isFloatParameter(a+1)){d=this.floatParameter(++a);if(!this.isFloatParameter(a+1))return Integer.$valueOf(K(d));f=this.floatParameter(++a);d=[Float.$valueOf(d),Float.$valueOf(f)];f=1073742114;break}g=c.planeParameter(++a);f=this.isFloatParameter(c.iToken+1)?this.floatParameter(++c.iToken):NaN;Float.isNaN(f)||(g.w-=f);d=g;f=135266319}return JU.TempArray.getSlabObjectType(f,d,!e,null==l?null:[l,k])},"~N,~B");
l(c$,"getIsosurfaceJvxl",function(a,b){return this.chk?"":this.getShapeProperty(b,a?"jvxlMeshX":"jvxlDataXml")},"~B,~N");l(c$,"getMoJvxl",function(a){this.sm.loadShape(27);var b=this.vwr.am.cmi;0>b&&this.e.errorStr(30,"MO isosurfaces");var c=this.vwr.getModelAuxiliaryInfoValue(b,"moData");null==c&&this.error(27);var d=this.getShapeProperty(27,"moNumber");(null==d||0==d.intValue())&&this.setShapeProperty(27,"init",Integer.$valueOf(b));this.setShapeProperty(27,"moData",c);return this.getShapePropertyIndex(27,
"showMO",a)},"~N");l(c$,"getScriptID",function(a){return"\n# "+(null==a?this.e.functionName:"function "+a.functionName)+" (file "+(null==a?this.e.scriptFileName:a.scriptFileName)+(null==a?"":" context "+a.id)+")\n"},"JS.ScriptContext");l(c$,"getShapePropertyIndex",function(a,b,c){return this.sm.getShapePropertyIndex(a,b,c)},"~N,~S,~N");l(c$,"tokenAt",function(a,b){return a<b.length?b[a]:null},"~N,~A");c$.tokAtArray=l(c$,"tokAtArray",function(a,b){return a<b.length&&null!=b[a]?b[a].tok:0},"~N,~A");
l(c$,"finalizeObject",function(a,b,c,d,e,f,g,h){e&&this.setShapeProperty(a,"set",f);-2147483648!=b&&this.e.setShapePropertyBs(a,"color",Integer.$valueOf(b),h);3.4028235E38!=c&&this.e.setShapeTranslucency(a,"","translucent",c,h);0!=d&&this.setShapeProperty(a,"scale",Integer.$valueOf(d));0<g&&(this.e.setMeshDisplayProperty(a,g,0)||this.invArg())},"~N,~N,~N,~N,~B,~O,~N,JU.BS");l(c$,"moCombo",function(a){if(1073742156!=this.tokAt(this.e.iToken+1))return null;this.addShapeProperty(a,"squareLinear",Boolean.TRUE);
this.e.iToken++;return R(0,0)},"JU.Lst");l(c$,"moOffset",function(a){var b=1073741973==this.getToken(a).tok?0:1,c=this.tokAt(++a);2==c&&0>this.intParameter(a)?b+=this.intParameter(a):269484193==c?b+=this.intParameter(++a):269484192==c&&(b-=this.intParameter(++a));return b},"~N");l(c$,"setMoData",function(a,b,c,d,e,f,g){var h=this.e;if(!this.chk){0>f&&(f=this.vwr.am.cmi,0>f&&h.errorStr(30,"MO isosurfaces"));f=this.vwr.getModelAuxiliaryInfoValue(f,"moData");var k=null,l,s,u=0;if(null==c||2>c.length){null!=
c&&1==c.length&&(d=0);null==f&&this.error(27);var m=f.containsKey("lastMoNumber")?f.get("lastMoNumber").intValue():0,k=f.containsKey("lastMoCount")?f.get("lastMoCount").intValue():1;1073742108==b?b=m-1:1073742037==b&&(b=m+k);k=f.get("mos");u=null==k?0:k.size();0==u&&this.error(25);1==u&&1<b&&this.error(29);if(2147483647!=d){if(f.containsKey("HOMO"))b=f.get("HOMO").intValue()+d;else{b=-1;for(m=0;m<u;m++)if(l=k.get(m),null!=(s=l.get("occupancy"))){if(0.5>s.floatValue()){b=m;break}}else if(null!=(s=
l.get("energy"))){if(0<s.floatValue()){b=m;break}}else break;0>b&&this.error(28);b+=d}JU.Logger.info("MO "+b)}(1>b||b>u)&&h.errorStr(26,""+u)}b=Math.abs(b);f.put("lastMoNumber",Integer.$valueOf(b));f.put("lastMoCount",Integer.$valueOf(1));e&&null==c&&(c=[-100,b]);if(null!=c&&2>c.length){l=k.get(b-1);if(null==(s=l.get("energy")))c=[100,b];else{h=s.floatValue();d=JU.BS.newN(u);e=0;c=1==c.length&&1==c[0];for(m=0;m<u;m++)if(null!=(s=k.get(m).get("energy")))if(s=s.floatValue(),c?s<=h:s==h)d.set(m+1),e+=
2;c=R(e,0);for(k=m=0;m<e;m+=2)c[m]=1,c[m+1]=k=d.nextSetBit(k+1);f.put("lastMoNumber",Integer.$valueOf(d.nextSetBit(0)));f.put("lastMoCount",Integer.$valueOf(Na(e/2)))}this.addShapeProperty(a,"squareLinear",Boolean.TRUE)}this.addShapeProperty(a,"moData",f);null!=g&&this.addShapeProperty(a,"title",g);this.addShapeProperty(a,"molecularOrbital",null!=c?c:Integer.$valueOf(Math.abs(b)));this.addShapeProperty(a,"clear",null)}},"JU.Lst,~N,~A,~N,~B,~N,~S");l(c$,"getPlotMinMax",function(a,b,c){if(null==a)return 0;
switch(c){case 1112539144:case 1112539145:case 1112539146:return b?180:-180;case 1112539141:case 1112539152:return b?360:0;case 1112539150:return b?1:-1}c=b?-1E10:1E10;for(var d=a.length;0<=--d;){var e=a[d];Float.isNaN(e)||b==e>c&&(c=e)}return c},"~A,~B,~N");l(c$,"initIsosurface",function(a){var b=this.e;this.setShapeProperty(a,"init",this.fullCommand);b.iToken=0;var c=this.tokAt(1),d=this.tokAt(2);if(12291==c||12291==d&&1048579==this.tokAt(++b.iToken))return this.setShapeProperty(a,"delete",null),
b.iToken+=2,this.slen>b.iToken&&(this.setShapeProperty(a,"init",this.fullCommand),this.setShapeProperty(a,"thisID","+PREVIOUS_MESH+")),null;b.iToken=1;return!b.setMeshDisplayProperty(a,0,c)&&(this.setShapeProperty(a,"thisID","+PREVIOUS_MESH+"),22!=a&&this.setShapeProperty(a,"title",[this.thisCommand]),1074790550!=c&&(269484209==d||269484209==c&&b.setMeshDisplayProperty(a,0,d)))?(a=this.setShapeId(a,1,!1),b.iToken++,a):null},"~N");l(c$,"getWithinDistanceVector",function(a,b,c,d,e){var f=new JU.Lst,
g=Array(2);if(null==d){var h=JU.P3.new3(b,b,b),k=JU.P3.newP(c);k.sub(h);h.add(c);g[0]=k;g[1]=h;f.addLast(c)}else c=this.vwr.ms.getBoxInfo(d,-Math.abs(b)),g[0]=c.getBoundBoxVertices()[0],g[1]=c.getBoundBoxVertices()[7],1==d.cardinality()&&f.addLast(this.vwr.getAtomPoint3f(d.nextSetBit(0)));1==f.size()&&!e&&(this.addShapeProperty(a,"withinDistance",Float.$valueOf(b)),this.addShapeProperty(a,"withinPoint",f.get(0)));this.addShapeProperty(a,e?"displayWithin":"withinPoints",[Float.$valueOf(b),g,d,f])},
"JU.Lst,~N,JU.P3,JU.BS,~B");l(c$,"setColorOptions",function(a,b,c,d){var e=this.e;this.getToken(b);var f="opaque";if(603979967==e.theTok)if(f="translucent",0>d){var g=this.isFloatParameter(b+1)?this.floatParameter(++b):3.4028235E38;e.setShapeTranslucency(c,null,"translucent",g,null);null!=a&&(a.append(" translucent"),3.4028235E38!=g&&a.append(" ").appendF(g))}else e.setMeshDisplayProperty(c,b,e.theTok);else 1073742074==e.theTok?0<=d&&e.setMeshDisplayProperty(c,b,e.theTok):e.iToken--;d=Math.abs(d);
for(g=0;g<d;g++)if(e.isColorParam(e.iToken+1)){var h=e.getArgbParam(++e.iToken);this.setShapeProperty(c,"colorRGB",Integer.$valueOf(h));null!=a&&a.append(" ").append(JU.Escape.escapeColor(h))}else if(e.iToken<b)this.invArg();else break;return f},"JU.SB,~N,~N,~N");l(c$,"createFunction",function(a,b,c){var d=(new JS.ScriptEval).setViewer(this.vwr);try{d.compileScript(null,"function "+a+"("+b+") { return "+c+"}",!1);var e=new JU.Lst;for(a=0;a<b.length;a+=2)e.addLast(JS.SV.newV(3,Float.$valueOf(0)).setName(b.substring(a,
a+1)));return[d.aatoken[0][1].value,e]}catch(f){if(ba(f,Exception))return null;throw f;}},"~S,~S,~S");l(c$,"floatArraySet",function(a,b,c){var d=this.tokAt(a++);1073742195==d&&(d=this.tokAt(a++));269484096!=d&&this.invArg();for(var e=JU.AU.newFloat2(b),f=0;269484097!=d;)switch(d=this.getToken(a).tok,d){case 1073742195:case 269484097:continue;case 269484080:a++;break;case 269484096:a++;d=R(c,0);e[f++]=d;for(var g=0;g<c;g++)d[g]=this.floatParameter(a++),269484080==this.tokAt(a)&&a++;269484097!=this.tokAt(a++)&&
this.invArg();d=0;f==b&&269484097!=this.tokAt(a)&&this.invArg();break;default:this.invArg()}return e},"~N,~N,~N");l(c$,"floatArraySetXYZ",function(a,b,c,d){var e=this.e,f=this.tokAt(a++);1073742195==f&&(f=this.tokAt(a++));(269484096!=f||0>=b)&&this.invArg();for(var g=JU.AU.newFloat3(b,-1),h=0;269484097!=f;)switch(f=this.getToken(a).tok,f){case 1073742195:case 269484097:continue;case 269484080:a++;break;case 269484096:g[h++]=this.floatArraySet(a,c,d);a=++e.iToken;f=0;h==b&&269484097!=this.tokAt(a)&&
this.invArg();break;default:this.invArg()}return g},"~N,~N,~N,~N");ca(c$,"getBitsetIdent",function(a,b,c,d,e,f){var g=!V(c,JM.BondSet);g&&(null==b?b=this.vwr.getStandardLabelFormat(0):0==b.length&&(b="%[label]"));var h=null==b?-1:b.indexOf("%"),k=2147483647!=e;if(null==a||this.chk||g&&0>h)return null==b&&(b=""),f?[b]:b;var h=this.vwr.ms,l=0,s=h.getLabeler();c=g||!d?null:c.getAssociatedAtoms();null==c&&(null!=b&&0<b.indexOf("%D"))&&(c=this.vwr.ms.getAtomIndices(a));d=null==b||0==b.length;var u=g||
d?null:JM.LabelToken.getBondLabelValues();b=d?null:g?s.compile(this.vwr,b,"\x00",null):s.compile(this.vwr,b,"\u0001",u);var m=k?1:JU.BSUtil.cardinalityOf(a),H=Array(m),n=new JU.P3;for(e=k?e:a.nextSetBit(0);0<=e;e=a.nextSetBit(e+1)){var y;g?y=d?h.at[e].getInfo():s.formatLabelAtomArray(this.vwr,h.at[e],b,"\x00",c,n):(y=h.getBondAt(e),y=d?y.getIdentity():s.formatLabelBond(this.vwr,y,b,u,c,n));y=JU.Txt.formatStringI(y,"#",l+1);H[l++]=y;if(k)break}return 1==m&&!f?H[0]:H},"JU.BS,~S,~O,~B,~N,~B");l(c$,"listIsosurface",
function(a){var b=3<this.slen?"0":0==this.tokAt(2)?"":" "+this.getToken(2).value;this.chk||this.showString(this.getShapeProperty(a,"list"+b));return!0},"~N");l(c$,"setShapeId",function(a,b,c){c&&this.invArg();b=this.e.setShapeNameParameter(b).toLowerCase();this.setShapeProperty(a,"thisID",b);return b},"~N,~N,~B");l(c$,"parseDataArray",function(a,b){a=JU.Parser.fixDataString(a);var c=JU.Parser.markLines(a,"\n"),d=c.length;if(!b){for(var e=JU.AU.newFloat2(d),f=0,g=0;f<d;g=c[f++])g=JU.PT.getTokens(a.substring(g,
c[f])),JU.PT.parseFloatArrayData(g,e[f]=R(g.length,0));return e}g=JU.PT.getTokens(a.substring(0,c[0]));if(3!=g.length)return R(0,0,0,0);var h=JU.PT.parseInt(g[0]),k=JU.PT.parseInt(g[1]),l=JU.PT.parseInt(g[2]);if(1>h||1>k||1>l)return R(1,1,1,0);for(var e=JU.AU.newFloat3(h,k),s=0,u=0,f=1,g=c[0];f<d&&s<h;g=c[f++])g=JU.PT.getTokens(a.substring(g,c[f])),g.length<l||(JU.PT.parseFloatArrayData(g,e[s][u]=R(g.length,0)),++u==k&&(s++,u=0));return s!=h?(System.out.println("Error reading 3D data -- nX = "+h+
", but only "+s+" blocks read"),R(1,1,1,0)):e},"~S,~B");Jb(c$,"ERROR_invalidArgument",22)})})(Clazz,Clazz.doubleToInt,Clazz.declarePackage,Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,
Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,
Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
