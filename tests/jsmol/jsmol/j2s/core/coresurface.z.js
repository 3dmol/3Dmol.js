(function(S,v,y,F,z,A,x,E,C,W,D,t,H,u,R,G,I,X,Q,L,M,K,N,O,P,Y,Z,$,T,aa,ba,ca,da,U,V,ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa,pa,qa,ra,sa,ta,ua,e,j){y("JU");Q(JU,"Triangulator");y("JU");z(["JU.Triangulator","JU.P3i"],"JU.TriangleData",["JU.AU","$.BS","$.P3","JU.BSUtil"],function(){c$=R(JU,"TriangleData",null,JU.Triangulator);j(c$,"intersectPlane",function(a,b,c){if(null==a)return b.addLast(JU.TriangleData.fullCubePolygon),b;var d=b.get(0);0!=c&&b.clear();for(var h=u(8,0),g=Array(12),f=0,e=0;8>e;e++)h[e]=a.x*
d[e].x+a.y*d[e].y+a.z*d[e].z+a.w,0>h[e]&&(f|=JU.TriangleData.Pwr2[e]);a=JU.TriangleData.triangleTable2[f];if(null==a)return null;for(e=0;24>e;e+=2){var f=JU.TriangleData.edgeVertexes[e],k=JU.TriangleData.edgeVertexes[e+1],m=JU.P3.newP(d[k]);m.sub(d[f]);m.scale(h[f]/(h[f]-h[k]));m.add(d[f]);g[e>>1]=m}if(0==c){c=new JU.BS;b.clear();for(e=0;e<a.length;e++)c.set(a[e]),2==e%4&&e++;e=JU.BSUtil.cardinalityOf(c);h=Array(e);b.addLast(h);d=t(12,0);for(e=f=0;e<a.length;e++)k=a[e],c.get(k)&&(c.clear(k),h[f]=
g[k],d[k]=f++),2==e%4&&e++;g=JU.AU.newInt2(a.length>>2);b.addLast(g);for(e=0;e<a.length;e++)g[e>>2]=[d[a[e++]],d[a[e++]],d[a[e++]],a[e]];return b}for(e=0;e<a.length;e++)d=g[a[e++]],h=g[a[e++]],f=g[a[e++]],1==(c&1)&&b.addLast([d,h,f]),2==(c&2)&&(k=a[e],1==(k&1)&&b.addLast([d,h]),2==(k&2)&&b.addLast([h,f]),4==(k&4)&&b.addLast([d,f]));return b},"JU.P4,JU.Lst,~N");H(c$,"Pwr2",[1,2,4,8,16,32,64,128,256,512,1024,2048],"fullCubePolygon",[[0,4,5,3],[5,1,0,3],[1,5,6,2],[6,2,1,3],[2,6,7,2],[7,3,2,3],[3,7,4,
2],[4,0,3,2],[6,5,4,0],[4,7,6,0],[0,1,2,0],[2,3,0,0]]);c$.cubeVertexOffsets=c$.prototype.cubeVertexOffsets=[JU.P3i.new3(0,0,0),JU.P3i.new3(1,0,0),JU.P3i.new3(1,0,1),JU.P3i.new3(0,0,1),JU.P3i.new3(0,1,0),JU.P3i.new3(1,1,0),JU.P3i.new3(1,1,1),JU.P3i.new3(0,1,1)];H(c$,"edgeVertexes",[0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7],"triangleTable2",[null,[0,8,3,7],[0,1,9,7],[1,8,3,6,9,8,1,5],[1,2,10,7],[0,8,3,7,1,2,10,7],[9,2,10,6,0,2,9,5],[2,8,3,6,2,10,8,1,10,9,8,3],[3,11,2,7],[0,11,2,6,8,11,0,5],[1,
9,0,7,2,3,11,7],[1,11,2,6,1,9,11,1,9,8,11,3],[3,10,1,6,11,10,3,5],[0,10,1,6,0,8,10,1,8,11,10,3],[3,9,0,6,3,11,9,1,11,10,9,3],[9,8,10,5,10,8,11,6],[4,7,8,7],[4,3,0,6,7,3,4,5],[0,1,9,7,8,4,7,7],[4,1,9,6,4,7,1,1,7,3,1,3],[1,2,10,7,8,4,7,7],[3,4,7,6,3,0,4,3,1,2,10,7],[9,2,10,6,9,0,2,3,8,4,7,7],[2,10,9,3,2,9,7,0,2,7,3,6,7,9,4,6],[8,4,7,7,3,11,2,7],[11,4,7,6,11,2,4,1,2,0,4,3],[9,0,1,7,8,4,7,7,2,3,11,7],[4,7,11,3,9,4,11,1,9,11,2,2,9,2,1,6],[3,10,1,6,3,11,10,3,7,8,4,7],[1,11,10,6,1,4,11,0,1,0,4,3,7,11,4,
5],[4,7,8,7,9,0,11,1,9,11,10,6,11,0,3,6],[4,7,11,3,4,11,9,4,9,11,10,6],[9,5,4,7],[9,5,4,7,0,8,3,7],[0,5,4,6,1,5,0,5],[8,5,4,6,8,3,5,1,3,1,5,3],[1,2,10,7,9,5,4,7],[3,0,8,7,1,2,10,7,4,9,5,7],[5,2,10,6,5,4,2,1,4,0,2,3],[2,10,5,3,3,2,5,1,3,5,4,2,3,4,8,6],[9,5,4,7,2,3,11,7],[0,11,2,6,0,8,11,3,4,9,5,7],[0,5,4,6,0,1,5,3,2,3,11,7],[2,1,5,3,2,5,8,0,2,8,11,6,4,8,5,5],[10,3,11,6,10,1,3,3,9,5,4,7],[4,9,5,7,0,8,1,5,8,10,1,2,8,11,10,3],[5,4,0,3,5,0,11,0,5,11,10,6,11,0,3,6],[5,4,8,3,5,8,10,4,10,8,11,6],[9,7,8,6,
5,7,9,5],[9,3,0,6,9,5,3,1,5,7,3,3],[0,7,8,6,0,1,7,1,1,5,7,3],[1,5,3,5,3,5,7,6],[9,7,8,6,9,5,7,3,10,1,2,7],[10,1,2,7,9,5,0,5,5,3,0,2,5,7,3,3],[8,0,2,3,8,2,5,0,8,5,7,6,10,5,2,5],[2,10,5,3,2,5,3,4,3,5,7,6],[7,9,5,6,7,8,9,3,3,11,2,7],[9,5,7,3,9,7,2,0,9,2,0,6,2,7,11,6],[2,3,11,7,0,1,8,5,1,7,8,2,1,5,7,3],[11,2,1,3,11,1,7,4,7,1,5,6],[9,5,8,5,8,5,7,6,10,1,3,3,10,3,11,6],[5,7,0,1,5,0,9,6,7,11,0,1,1,0,10,5,11,10,0,1],[11,10,0,1,11,0,3,6,10,5,0,1,8,0,7,5,5,7,0,1],[11,10,5,3,7,11,5,5],[10,6,5,7],[0,8,3,7,5,10,
6,7],[9,0,1,7,5,10,6,7],[1,8,3,6,1,9,8,3,5,10,6,7],[1,6,5,6,2,6,1,5],[1,6,5,6,1,2,6,3,3,0,8,7],[9,6,5,6,9,0,6,1,0,2,6,3],[5,9,8,3,5,8,2,0,5,2,6,6,3,2,8,5],[2,3,11,7,10,6,5,7],[11,0,8,6,11,2,0,3,10,6,5,7],[0,1,9,7,2,3,11,7,5,10,6,7],[5,10,6,7,1,9,2,5,9,11,2,2,9,8,11,3],[6,3,11,6,6,5,3,1,5,1,3,3],[0,8,11,3,0,11,5,0,0,5,1,6,5,11,6,6],[3,11,6,3,0,3,6,1,0,6,5,2,0,5,9,6],[6,5,9,3,6,9,11,4,11,9,8,6],[5,10,6,7,4,7,8,7],[4,3,0,6,4,7,3,3,6,5,10,7],[1,9,0,7,5,10,6,7,8,4,7,7],[10,6,5,7,1,9,7,1,1,7,3,6,7,9,4,
6],[6,1,2,6,6,5,1,3,4,7,8,7],[1,2,5,5,5,2,6,6,3,0,4,3,3,4,7,6],[8,4,7,7,9,0,5,5,0,6,5,2,0,2,6,3],[7,3,9,1,7,9,4,6,3,2,9,1,5,9,6,5,2,6,9,1],[3,11,2,7,7,8,4,7,10,6,5,7],[5,10,6,7,4,7,2,1,4,2,0,6,2,7,11,6],[0,1,9,7,4,7,8,7,2,3,11,7,5,10,6,7],[9,2,1,6,9,11,2,2,9,4,11,1,7,11,4,5,5,10,6,7],[8,4,7,7,3,11,5,1,3,5,1,6,5,11,6,6],[5,1,11,1,5,11,6,6,1,0,11,1,7,11,4,5,0,4,11,1],[0,5,9,6,0,6,5,2,0,3,6,1,11,6,3,5,8,4,7,7],[6,5,9,3,6,9,11,4,4,7,9,5,7,11,9,1],[10,4,9,6,6,4,10,5],[4,10,6,6,4,9,10,3,0,8,3,7],[10,0,
1,6,10,6,0,1,6,4,0,3],[8,3,1,3,8,1,6,0,8,6,4,6,6,1,10,6],[1,4,9,6,1,2,4,1,2,6,4,3],[3,0,8,7,1,2,9,5,2,4,9,2,2,6,4,3],[0,2,4,5,4,2,6,6],[8,3,2,3,8,2,4,4,4,2,6,6],[10,4,9,6,10,6,4,3,11,2,3,7],[0,8,2,5,2,8,11,6,4,9,10,3,4,10,6,6],[3,11,2,7,0,1,6,1,0,6,4,6,6,1,10,6],[6,4,1,1,6,1,10,6,4,8,1,1,2,1,11,5,8,11,1,1],[9,6,4,6,9,3,6,0,9,1,3,3,11,6,3,5],[8,11,1,1,8,1,0,6,11,6,1,1,9,1,4,5,6,4,1,1],[3,11,6,3,3,6,0,4,0,6,4,6],[6,4,8,3,11,6,8,5],[7,10,6,6,7,8,10,1,8,9,10,3],[0,7,3,6,0,10,7,0,0,9,10,3,6,7,10,5],[10,
6,7,3,1,10,7,1,1,7,8,2,1,8,0,6],[10,6,7,3,10,7,1,4,1,7,3,6],[1,2,6,3,1,6,8,0,1,8,9,6,8,6,7,6],[2,6,9,1,2,9,1,6,6,7,9,1,0,9,3,5,7,3,9,1],[7,8,0,3,7,0,6,4,6,0,2,6],[7,3,2,3,6,7,2,5],[2,3,11,7,10,6,8,1,10,8,9,6,8,6,7,6],[2,0,7,1,2,7,11,6,0,9,7,1,6,7,10,5,9,10,7,1],[1,8,0,6,1,7,8,2,1,10,7,1,6,7,10,5,2,3,11,7],[11,2,1,3,11,1,7,4,10,6,1,5,6,7,1,1],[8,9,6,1,8,6,7,6,9,1,6,1,11,6,3,5,1,3,6,1],[0,9,1,7,11,6,7,7],[7,8,0,3,7,0,6,4,3,11,0,5,11,6,0,1],[7,11,6,7],[7,6,11,7],[3,0,8,7,11,7,6,7],[0,1,9,7,11,7,6,7],
[8,1,9,6,8,3,1,3,11,7,6,7],[10,1,2,7,6,11,7,7],[1,2,10,7,3,0,8,7,6,11,7,7],[2,9,0,6,2,10,9,3,6,11,7,7],[6,11,7,7,2,10,3,5,10,8,3,2,10,9,8,3],[7,2,3,6,6,2,7,5],[7,0,8,6,7,6,0,1,6,2,0,3],[2,7,6,6,2,3,7,3,0,1,9,7],[1,6,2,6,1,8,6,0,1,9,8,3,8,7,6,3],[10,7,6,6,10,1,7,1,1,3,7,3],[10,7,6,6,1,7,10,4,1,8,7,2,1,0,8,3],[0,3,7,3,0,7,10,0,0,10,9,6,6,10,7,5],[7,6,10,3,7,10,8,4,8,10,9,6],[6,8,4,6,11,8,6,5],[3,6,11,6,3,0,6,1,0,4,6,3],[8,6,11,6,8,4,6,3,9,0,1,7],[9,4,6,3,9,6,3,0,9,3,1,6,11,3,6,5],[6,8,4,6,6,11,8,3,
2,10,1,7],[1,2,10,7,3,0,11,5,0,6,11,2,0,4,6,3],[4,11,8,6,4,6,11,3,0,2,9,5,2,10,9,3],[10,9,3,1,10,3,2,6,9,4,3,1,11,3,6,5,4,6,3,1],[8,2,3,6,8,4,2,1,4,6,2,3],[0,4,2,5,4,6,2,3],[1,9,0,7,2,3,4,1,2,4,6,6,4,3,8,6],[1,9,4,3,1,4,2,4,2,4,6,6],[8,1,3,6,8,6,1,0,8,4,6,3,6,10,1,3],[10,1,0,3,10,0,6,4,6,0,4,6],[4,6,3,1,4,3,8,6,6,10,3,1,0,3,9,5,10,9,3,1],[10,9,4,3,6,10,4,5],[4,9,5,7,7,6,11,7],[0,8,3,7,4,9,5,7,11,7,6,7],[5,0,1,6,5,4,0,3,7,6,11,7],[11,7,6,7,8,3,4,5,3,5,4,2,3,1,5,3],[9,5,4,7,10,1,2,7,7,6,11,7],[6,11,
7,7,1,2,10,7,0,8,3,7,4,9,5,7],[7,6,11,7,5,4,10,5,4,2,10,2,4,0,2,3],[3,4,8,6,3,5,4,2,3,2,5,1,10,5,2,5,11,7,6,7],[7,2,3,6,7,6,2,3,5,4,9,7],[9,5,4,7,0,8,6,1,0,6,2,6,6,8,7,6],[3,6,2,6,3,7,6,3,1,5,0,5,5,4,0,3],[6,2,8,1,6,8,7,6,2,1,8,1,4,8,5,5,1,5,8,1],[9,5,4,7,10,1,6,5,1,7,6,2,1,3,7,3],[1,6,10,6,1,7,6,2,1,0,7,1,8,7,0,5,9,5,4,7],[4,0,10,1,4,10,5,6,0,3,10,1,6,10,7,5,3,7,10,1],[7,6,10,3,7,10,8,4,5,4,10,5,4,8,10,1],[6,9,5,6,6,11,9,1,11,8,9,3],[3,6,11,6,0,6,3,4,0,5,6,2,0,9,5,3],[0,11,8,6,0,5,11,0,0,1,5,3,5,
6,11,3],[6,11,3,3,6,3,5,4,5,3,1,6],[1,2,10,7,9,5,11,1,9,11,8,6,11,5,6,6],[0,11,3,6,0,6,11,2,0,9,6,1,5,6,9,5,1,2,10,7],[11,8,5,1,11,5,6,6,8,0,5,1,10,5,2,5,0,2,5,1],[6,11,3,3,6,3,5,4,2,10,3,5,10,5,3,1],[5,8,9,6,5,2,8,0,5,6,2,3,3,8,2,5],[9,5,6,3,9,6,0,4,0,6,2,6],[1,5,8,1,1,8,0,6,5,6,8,1,3,8,2,5,6,2,8,1],[1,5,6,3,2,1,6,5],[1,3,6,1,1,6,10,6,3,8,6,1,5,6,9,5,8,9,6,1],[10,1,0,3,10,0,6,4,9,5,0,5,5,6,0,1],[0,3,8,7,5,6,10,7],[10,5,6,7],[11,5,10,6,7,5,11,5],[11,5,10,6,11,7,5,3,8,3,0,7],[5,11,7,6,5,10,11,3,1,
9,0,7],[10,7,5,6,10,11,7,3,9,8,1,5,8,3,1,3],[11,1,2,6,11,7,1,1,7,5,1,3],[0,8,3,7,1,2,7,1,1,7,5,6,7,2,11,6],[9,7,5,6,9,2,7,0,9,0,2,3,2,11,7,3],[7,5,2,1,7,2,11,6,5,9,2,1,3,2,8,5,9,8,2,1],[2,5,10,6,2,3,5,1,3,7,5,3],[8,2,0,6,8,5,2,0,8,7,5,3,10,2,5,5],[9,0,1,7,5,10,3,1,5,3,7,6,3,10,2,6],[9,8,2,1,9,2,1,6,8,7,2,1,10,2,5,5,7,5,2,1],[1,3,5,5,3,7,5,3],[0,8,7,3,0,7,1,4,1,7,5,6],[9,0,3,3,9,3,5,4,5,3,7,6],[9,8,7,3,5,9,7,5],[5,8,4,6,5,10,8,1,10,11,8,3],[5,0,4,6,5,11,0,0,5,10,11,3,11,3,0,3],[0,1,9,7,8,4,10,1,8,
10,11,6,10,4,5,6],[10,11,4,1,10,4,5,6,11,3,4,1,9,4,1,5,3,1,4,1],[2,5,1,6,2,8,5,0,2,11,8,3,4,5,8,5],[0,4,11,1,0,11,3,6,4,5,11,1,2,11,1,5,5,1,11,1],[0,2,5,1,0,5,9,6,2,11,5,1,4,5,8,5,11,8,5,1],[9,4,5,7,2,11,3,7],[2,5,10,6,3,5,2,4,3,4,5,2,3,8,4,3],[5,10,2,3,5,2,4,4,4,2,0,6],[3,10,2,6,3,5,10,2,3,8,5,1,4,5,8,5,0,1,9,7],[5,10,2,3,5,2,4,4,1,9,2,5,9,4,2,1],[8,4,5,3,8,5,3,4,3,5,1,6],[0,4,5,3,1,0,5,5],[8,4,5,3,8,5,3,4,9,0,5,5,0,3,5,1],[9,4,5,7],[4,11,7,6,4,9,11,1,9,10,11,3],[0,8,3,7,4,9,7,5,9,11,7,2,9,10,11,
3],[1,10,11,3,1,11,4,0,1,4,0,6,7,4,11,5],[3,1,4,1,3,4,8,6,1,10,4,1,7,4,11,5,10,11,4,1],[4,11,7,6,9,11,4,4,9,2,11,2,9,1,2,3],[9,7,4,6,9,11,7,2,9,1,11,1,2,11,1,5,0,8,3,7],[11,7,4,3,11,4,2,4,2,4,0,6],[11,7,4,3,11,4,2,4,8,3,4,5,3,2,4,1],[2,9,10,6,2,7,9,0,2,3,7,3,7,4,9,3],[9,10,7,1,9,7,4,6,10,2,7,1,8,7,0,5,2,0,7,1],[3,7,10,1,3,10,2,6,7,4,10,1,1,10,0,5,4,0,10,1],[1,10,2,7,8,7,4,7],[4,9,1,3,4,1,7,4,7,1,3,6],[4,9,1,3,4,1,7,4,0,8,1,5,8,7,1,1],[4,0,3,3,7,4,3,5],[4,8,7,7],[9,10,8,5,10,11,8,3],[3,0,9,3,3,9,11,
4,11,9,10,6],[0,1,10,3,0,10,8,4,8,10,11,6],[3,1,10,3,11,3,10,5],[1,2,11,3,1,11,9,4,9,11,8,6],[3,0,9,3,3,9,11,4,1,2,9,5,2,11,9,1],[0,2,11,3,8,0,11,5],[3,2,11,7],[2,3,8,3,2,8,10,4,10,8,9,6],[9,10,2,3,0,9,2,5],[2,3,8,3,2,8,10,4,0,1,8,5,1,10,8,1],[1,10,2,7],[1,3,8,3,9,1,8,5],[0,9,1,7],[0,3,8,7],null])});y("J.api");Q(J.api,"VolumeDataInterface");y("J.jvxl.api");Q(J.jvxl.api,"VertexDataServer");y("J.jvxl.api");z(["J.jvxl.api.VertexDataServer"],"J.jvxl.api.MeshDataServer",null,function(){Q(J.jvxl.api,"MeshDataServer",
J.jvxl.api.VertexDataServer)});y("J.shapesurface");z(["J.jvxl.api.MeshDataServer","J.shape.MeshCollection","JU.P3i","$.P4"],"J.shapesurface.Isosurface","java.io.BufferedReader java.lang.Boolean $.Float java.util.Hashtable JU.A4 $.AU $.BS $.CU $.Lst $.M3 $.P3 $.PT $.Quat $.Rdr $.SB $.V3 J.jvxl.data.JvxlCoder $.JvxlData $.MeshData J.jvxl.readers.SurfaceGenerator J.shape.Mesh J.shapesurface.IsosurfaceMesh JU.C $.Escape $.Logger $.MeshSurface $.Txt JV.JC $.Viewer".split(" "),function(){c$=x(function(){this.actualID=
this.thisMesh=this.isomeshes=null;this.explicitContours=this.iHaveBitSets=!1;this.moNumber=this.atomIndex=0;this.moLinearCombination=null;this.meshColix=this.defaultColix=this.colorType=0;this.center=null;this.scale3d=0;this.isColorExplicit=this.isPhaseColored=!1;this.scriptAppendix="";this.jvxlData=this.sg=null;this.withinDistance2=0;this.isWithinNot=!1;this.cutoffRange=this.withinPoints=null;this.allowMesh=!0;this.script=null;this.iHaveModelIndex=!1;this.nLCAO=0;this.lcaoDir=null;this.associateNormals=
!1;this.keyXy=this.ptXY=null;A(this,arguments)},J.shapesurface,"Isosurface",J.shape.MeshCollection,J.jvxl.api.MeshDataServer);G(c$,function(){this.isomeshes=Array(4);this.lcaoDir=new JU.P4;this.ptXY=new JU.P3i});j(c$,"allocMesh",function(a,b){var c=this.meshCount++;this.meshes=this.isomeshes=JU.AU.ensureLength(this.isomeshes,2*this.meshCount);this.currentMesh=this.thisMesh=this.isomeshes[c]=null==b?new J.shapesurface.IsosurfaceMesh(a,this.colix,c):b;this.currentMesh.index=c;null!=this.sg&&this.sg.setJvxlData(this.jvxlData=
this.thisMesh.jvxlData)},"~S,J.shape.Mesh");e(c$,"initShape",function(){T(this,J.shapesurface.Isosurface,"initShape",[]);this.myType="isosurface";this.newSg()});e(c$,"newSg",function(){this.sg=new J.jvxl.readers.SurfaceGenerator(this.vwr,this,null,this.jvxlData=new J.jvxl.data.JvxlData);this.sg.getParams().showTiming=this.vwr.getBoolean(603979934);this.sg.setVersion("Jmol "+JV.Viewer.getJmolVersion())});e(c$,"clearSg",function(){this.sg=null});j(c$,"setProperty",function(a,b,c){this.setPropI(a,b,
c)},"~S,~O,JU.BS");e(c$,"setPropI",function(a,b,c){if("cache"===a){if(null!=this.currentMesh){var d=this.currentMesh.thisID;c=this.currentMesh.modelIndex;this.vwr.cachePut("cache://isosurface_"+d,this.getPropI("jvxlDataXml"));this.deleteMeshI(this.currentMesh.index);this.setPropI("init",null,null);this.setPropI("thisID",d,null);this.setPropI("modelIndex",Integer.$valueOf(c),null);this.setPropI("fileName","cache://isosurface_"+d,null);this.setPropI("readFile",null,null);this.setPropI("finalize","isosurface ID "+
JU.PT.esc(d)+(0<=c?" modelIndex "+c:"")+" /*file*/"+JU.PT.esc("cache://isosurface_"+d),null);this.setPropI("clear",null,null)}}else if("delete"===a)this.setPropertySuper(a,b,c),this.explicitID||(this.nLCAO=this.nUnnamed=0),this.currentMesh=this.thisMesh=null;else if("remapInherited"===a)for(d=this.meshCount;0<=--d;)null!=this.isomeshes[d]&&"#inherit;".equals(this.isomeshes[d].colorCommand)&&this.isomeshes[d].remapColors(this.vwr,null,NaN);else if("remapColor"===a)null!=this.thisMesh&&this.thisMesh.remapColors(this.vwr,
b,this.translucentLevel);else if("thisID"===a)null!=this.actualID&&(b=this.actualID),this.setPropertySuper("thisID",b,null);else if("params"===a){if(null!=this.thisMesh){this.ensureMeshSource();this.thisMesh.checkAllocColixes();a=b[0];var h=null;if(null!=a){for(d=0;d<a.length;d++)a[d]=a[d];h=t(c.length(),0);b=0;for(d=c.nextSetBit(0);0<=d;d=c.nextSetBit(d+1),b++)h[d]=b}this.thisMesh.setVertexColixesForAtoms(this.vwr,a,h,c);this.thisMesh.setVertexColorMap()}}else if("atomcolor"===a)null!=this.thisMesh&&
(this.ensureMeshSource(),this.thisMesh.colorVertices(JU.C.getColixO(b),c,!0));else if("pointSize"===a)null!=this.thisMesh&&(this.thisMesh.volumeRenderPointSize=b.floatValue());else if("vertexcolor"===a)null!=this.thisMesh&&this.thisMesh.colorVertices(JU.C.getColixO(b),c,!1);else if("colorPhase"===a){d=b;c=JU.C.getColix(d[0].intValue());b=JU.C.getColix(d[1].intValue());d=null!=this.thisMesh?this.thisMesh.thisID:JU.Txt.isWild(this.previousMeshID)?this.previousMeshID:null;h=this.getMeshList(d,!1);for(d=
h.size();0<=--d;)this.setColorPhase(h.get(d),c,b)}else if("color"===a){var g=JU.C.getHexCode(JU.C.getColixO(b));if(null!=this.thisMesh)this.setIsoMeshColor(this.thisMesh,g);else{h=this.getMeshList(JU.Txt.isWild(this.previousMeshID)?this.previousMeshID:null,!1);for(d=h.size();0<=--d;)this.setIsoMeshColor(h.get(d),g)}this.setPropertySuper(a,b,c)}else if("nocontour"===a)null!=this.thisMesh&&this.thisMesh.deleteContours();else if("fixed"===a)this.isFixed=b.booleanValue(),this.setMeshI();else if("newObject"===
a)null!=this.thisMesh&&this.thisMesh.clearType(this.thisMesh.meshType,!1);else if("moveIsosurface"===a)null!=this.thisMesh&&(this.thisMesh.updateCoordinates(b,null),this.thisMesh.altVertices=null);else if("refreshTrajectories"===a)for(d=this.meshCount;0<=--d;)null!=this.meshes[d].connections&&this.meshes[d].modelIndex==b[0].intValue()&&this.meshes[d].updateCoordinates(b[2],b[1]);else if("modelIndex"===a)this.iHaveModelIndex||(this.modelIndex=b.intValue(),this.isFixed=0>this.modelIndex,this.sg.setModelIndex(Math.abs(this.modelIndex)));
else if("lcaoCartoon"===a||"lonePair"===a||"radical"===a)d=b,this.explicitID||this.setPropertySuper("thisID",null,null),this.sg.setParameter("lcaoCartoonCenter",d[2])||this.drawLcaoCartoon(d[0],d[1],d[3],"lonePair"===a?2:"radical"===a?1:0);else if(!("select"===a&&this.iHaveBitSets||"ignore"===a&&this.iHaveBitSets))if("meshcolor"===a)d=b.intValue(),this.meshColix=JU.C.getColix(d),null!=this.thisMesh&&(this.thisMesh.meshColix=this.meshColix);else if("offset"===a)d=JU.P3.newP(b),d.equals(JV.JC.center)&&
(d=null),null!=this.thisMesh&&(this.thisMesh.rotateTranslate(null,d,!0),this.thisMesh.altVertices=null);else if("rotate"===a)null!=this.thisMesh&&(this.thisMesh.rotateTranslate(JU.Quat.newP4(b),null,!0),this.thisMesh.altVertices=null);else if("bsDisplay"===a)this.bsDisplay=b;else if("displayWithin"===a)d=b,this.displayWithinDistance2=d[0].floatValue(),this.isDisplayWithinNot=0>this.displayWithinDistance2,this.displayWithinDistance2*=this.displayWithinDistance2,this.displayWithinPoints=d[3],0==this.displayWithinPoints.size()&&
(this.displayWithinPoints=this.vwr.ms.getAtomPointVector(d[2]));else if("finalize"===a)null!=this.thisMesh&&(d=b,null!=d&&!d.startsWith("; isosurface map")&&(this.thisMesh.setDiscreteColixes(this.sg.getParams().contoursDiscrete,this.sg.getParams().contourColixes),this.setJvxlInfo()),this.setScriptInfo(d)),this.clearSg();else if("connections"===a)null!=this.currentMesh&&(this.connections=b,0<=this.connections[0]&&this.connections[0]<this.vwr.getAtomCount()?this.currentMesh.connections=this.connections:
this.connections=this.currentMesh.connections=null);else if("cutoffRange"===a)this.cutoffRange=b;else{if("slab"===a){if(F(b,Integer)){null!=this.thisMesh&&(this.thisMesh.jvxlData.slabValue=b.intValue());return}if(null!=this.thisMesh){switch(b[0].intValue()){case 1073742018:d=b[1];c=this.getMesh(d[1]);if(null==c)return;d[1]=c}this.slabPolygons(b);return}}if("cap"===a&&null!=this.thisMesh&&0!=this.thisMesh.pc)this.thisMesh.slabPolygons(b,!0),this.thisMesh.initialize(this.thisMesh.lighting,null,null);
else{if("map"===a&&(null!=this.sg&&(this.sg.getParams().isMapped=!0),this.setProperty("squareData",Boolean.FALSE,null),null==this.thisMesh||0==this.thisMesh.vc))return;if("deleteVdw"===a){for(d=this.meshCount;0<=--d;)null!=this.isomeshes[d].bsVdw&&(null==c||c.intersects(this.isomeshes[d].bsVdw))&&this.deleteMeshI(d);this.currentMesh=this.thisMesh=null}else{if("mapColor"===a||"readFile"===a){if(null==b){b=this.vwr.getBufferedReaderOrErrorMessageFromName(this.sg.getFileName(),null,!0);if(F(b,String)){JU.Logger.error("Isosurface: could not open file "+
this.sg.getFileName()+" -- "+b);return}if(!F(b,java.io.BufferedReader))try{b=JU.Rdr.getBufferedReader(b,"ISO-8859-1")}catch(f){if(!D(f,java.io.IOException))throw f;}}}else if("atomIndex"===a)this.atomIndex=b.intValue(),null!=this.thisMesh&&(this.thisMesh.atomIndex=this.atomIndex);else if("center"===a)this.center.setT(b);else if("colorRGB"===a)d=b.intValue(),1297090050==d?this.colorType=d:(this.colorType=0,this.defaultColix=JU.C.getColix(d));else if("contour"===a)this.explicitContours=!0;else if("functionXY"===
a)this.sg.isStateDataRead()&&this.setScriptInfo(null);else if("init"===a)this.newSg();else if("getSurfaceSets"===a)null!=this.thisMesh&&(this.thisMesh.jvxlData.thisSet=b.intValue(),this.thisMesh.calculatedVolume=null,this.thisMesh.calculatedArea=null);else if("localName"===a)b=this.vwr.getOutputChannel(b,null),a="outputChannel";else if("molecularOrbital"===a)F(b,Integer)?(this.moNumber=b.intValue(),this.moLinearCombination=null):(this.moLinearCombination=b,this.moNumber=0),this.isColorExplicit||(this.isPhaseColored=
!0);else if("phase"===a)this.isPhaseColored=!0;else if("plane"!==a&&"pocket"!==a)if("scale3d"===a)this.scale3d=b.floatValue(),null!=this.thisMesh&&(this.thisMesh.scale3d=this.thisMesh.jvxlData.scale3d=this.scale3d,this.thisMesh.altVertices=null);else if("title"===a)F(b,String)&&"-".equals(b)&&(b=null),this.setPropertySuper(a,b,c),b=this.title;else if("withinPoints"===a)d=b,this.withinDistance2=d[0].floatValue(),this.isWithinNot=0>this.withinDistance2,this.withinDistance2*=this.withinDistance2,this.withinPoints=
d[3],0==this.withinPoints.size()&&(this.withinPoints=this.vwr.ms.getAtomPointVector(d[2]));else if(("nci"===a||"orbital"===a)&&null!=this.sg)this.sg.getParams().testFlags=this.vwr.getTestFlag(2)?2:0;if(null!=this.sg&&this.sg.setProp(a,b,c)){if(this.sg.isValid())return;a="delete"}if("init"===a)this.explicitID=!1,this.scriptAppendix="",d=F(b,String)?b:null,b=null==d?-1:d.indexOf("# ID="),this.actualID=0<=b?JU.PT.getQuotedStringAt(d,b):null,this.setPropertySuper("thisID","+PREVIOUS_MESH+",null),null!=
d&&!(this.iHaveBitSets=this.getScriptBitSets(d,null))&&this.sg.setParameter("select",c),this.initializeIsosurface(),this.sg.setModelIndex(this.isFixed?-1:this.modelIndex);else if("clear"===a)this.discardTempData(!0);else if("colorDensity"===a)null!=b&&null!=this.currentMesh&&(this.currentMesh.volumeRenderPointSize=b.floatValue());else if("deleteModelAtoms"===a){a=b[2][0];h=b[2][1];b=b[2][2];for(d=this.meshCount;0<=--d;)c=this.meshes[d],null!=c&&(null!=c.connections&&(g=c.connections[0],g>=h+b?c.connections[0]=
g-b:g>=h&&(c.connections=null)),c.connections=null,c.modelIndex==a?(this.meshCount--,c===this.currentMesh&&(this.currentMesh=this.thisMesh=null),this.meshes=this.isomeshes=JU.AU.deleteElements(this.meshes,d,1)):c.modelIndex>a&&(c.modelIndex--,c.atomIndex>=h&&(c.atomIndex-=b)))}else this.setPropertySuper(a,b,c)}}}},"~S,~O,JU.BS");e(c$,"setIsoMeshColor",function(a,b){a.jvxlData.baseColor=b;a.isColorSolid=!0;a.pcs=null;a.colorEncoder=null;a.vertexColorMap=null},"J.shapesurface.IsosurfaceMesh,~S");e(c$,
"setColorPhase",function(a,b,c){a.colorPhased=!0;a.colix=a.jvxlData.minColorIndex=b;a.jvxlData.maxColorIndex=c;a.jvxlData.isBicolorMap=!0;a.jvxlData.colorDensity=!1;a.isColorSolid=!1;a.remapColors(this.vwr,null,this.translucentLevel)},"J.shapesurface.IsosurfaceMesh,~N,~N");e(c$,"ensureMeshSource",function(){var a=null!=this.thisMesh.vertexSource;if(a)for(var b=this.thisMesh.vc;0<=--b;)if(0>this.thisMesh.vertexSource[b]){a=!1;break}if(!a){var a=this.thisMesh.vertexSource,c=this.thisMesh.vcs,b=this.thisMesh.isColorSolid?
this.thisMesh.colix:0;this.setProperty("init",null,null);this.setProperty("map",Boolean.FALSE,null);this.setProperty("property",u(this.vwr.getAtomCount(),0),null);0!=b&&(this.thisMesh.colorCommand="color isosurface "+JU.C.getHexCode(b),this.setProperty("color",Integer.$valueOf(JU.C.getArgb(b)),null));if(null!=a){for(b=this.thisMesh.vc;0<=--b;)0>a[b]&&(a[b]=this.thisMesh.vertexSource[b]);this.thisMesh.vertexSource=a;this.thisMesh.vcs=c}}});e(c$,"slabPolygons",function(a){this.thisMesh.slabPolygons(a,
!1);this.thisMesh.reinitializeLightingAndColor(this.vwr)},"~A");e(c$,"setPropertySuper",function(a,b,c){"thisID"===a&&null!=this.currentMesh&&null!=this.currentMesh.thisID&&this.currentMesh.thisID.equals(b)?this.checkExplicit(b):(this.currentMesh=this.thisMesh,this.setPropMC(a,b,c),this.thisMesh=this.currentMesh,this.jvxlData=null==this.thisMesh?null:this.thisMesh.jvxlData,null!=this.sg&&this.sg.setJvxlData(this.jvxlData))},"~S,~O,JU.BS");j(c$,"getPropertyData",function(a,b){if("colorEncoder"===a){var c=
this.getMesh(b[0]);return null==c||null==(b[1]=c.colorEncoder)?!1:!0}if("intersectPlane"===a){c=this.getMesh(b[0]);if(null==c)return!1;b[3]=Integer.$valueOf(c.modelIndex);c.getIntersection(0,b[1],null,b[2],null,null,null,!1,!1,135266319,!1);return!0}if("getBoundingBox"===a){c=b[0];c=this.getMesh(c);if(null==c||null==c.vs)return!1;b[2]=c.jvxlData.boundingBox;if(null!=c.mat4){var d=Array(2);d[0]=JU.P3.newP(c.jvxlData.boundingBox[0]);d[1]=JU.P3.newP(c.jvxlData.boundingBox[1]);var h=new JU.V3;c.mat4.getTranslation(h);
d[0].add(h);d[1].add(h);b[2]=d}return!0}if("unitCell"===a)return c=this.getMesh(b[0]),null!=c&&null!=(b[1]=c.getUnitCell());if("getCenter"===a&&-2147483648==b[1].intValue()){c=b[0];c=this.getMesh(c);if(null==c||null==c.vs)return!1;d=JU.P3.newP(c.jvxlData.boundingBox[0]);d.add(c.jvxlData.boundingBox[1]);d.scale(0.5);null!=c.mat4&&(h=new JU.V3,c.mat4.getTranslation(h),d.add(h));b[2]=d;return!0}return this.getPropDataMC(a,b)},"~S,~A");j(c$,"getProperty",function(a){return this.getPropI(a)},"~S,~N");
e(c$,"getPropI",function(a){var b=this.getPropMC(a);if(null!=b)return b;if("dataRange"===a)return null==this.thisMesh||null!=this.jvxlData.jvxlPlane&&null==this.thisMesh.colorEncoder?null:[this.jvxlData.mappedDataMin,this.jvxlData.mappedDataMax,this.jvxlData.isColorReversed?this.jvxlData.valueMappedToBlue:this.jvxlData.valueMappedToRed,this.jvxlData.isColorReversed?this.jvxlData.valueMappedToRed:this.jvxlData.valueMappedToBlue];if("moNumber"===a)return Integer.$valueOf(this.moNumber);if("moLinearCombination"===
a)return this.moLinearCombination;if("nSets"===a)return Integer.$valueOf(null==this.thisMesh?0:this.thisMesh.nSets);if("area"===a)return null==this.thisMesh?Float.$valueOf(NaN):this.calculateVolumeOrArea(!0);if("volume"===a)return null==this.thisMesh?Float.$valueOf(NaN):this.calculateVolumeOrArea(!1);if(null==this.thisMesh)return null;if("cutoff"===a)return Float.$valueOf(this.jvxlData.cutoff);if("minMaxInfo"===a)return[this.jvxlData.dataMin,this.jvxlData.dataMax];if("plane"===a)return this.jvxlData.jvxlPlane;
if("contours"===a)return this.thisMesh.getContours();if("jvxlDataXml"===a||"jvxlMeshXml"===a)return b=null,this.jvxlData.slabInfo=null,"jvxlMeshXml"===a||this.jvxlData.vertexDataOnly||null!=this.thisMesh.bsSlabDisplay&&null==this.thisMesh.bsSlabGhost?(b=new J.jvxl.data.MeshData,this.fillMeshData(b,1,null),b.polygonColorData=J.shapesurface.Isosurface.getPolygonColorData(b.pc,b.pcs,b.bsSlabDisplay)):null!=this.thisMesh.bsSlabGhost&&(this.jvxlData.slabInfo=this.thisMesh.slabOptions.toString()),a=new JU.SB,
this.getMeshCommand(a,this.thisMesh.index),this.thisMesh.setJvxlColorMap(!0),J.jvxl.data.JvxlCoder.jvxlGetFile(this.jvxlData,b,this.title,"",!0,1,a.toString(),null);if("jvxlFileInfo"===a)return this.thisMesh.setJvxlColorMap(!1),J.jvxl.data.JvxlCoder.jvxlGetInfo(this.jvxlData);if("command"===a){a=new JU.SB;for(b=this.getMeshList(this.previousMeshID,!1).size();0<=--b;)this.getMeshCommand(a,b);return a.toString()}return null},"~S");e(c$,"calculateVolumeOrArea",function(a){if(a){if(null!=this.thisMesh.calculatedArea)return this.thisMesh.calculatedArea}else if(null!=
this.thisMesh.calculatedVolume)return this.thisMesh.calculatedVolume;var b=new J.jvxl.data.MeshData;this.fillMeshData(b,1,null);b.nSets=this.thisMesh.nSets;b.vertexSets=this.thisMesh.vertexSets;if(!a&&this.thisMesh.jvxlData.colorDensity)return a=this.thisMesh.jvxlData.voxelVolume,a*=null==this.thisMesh.bsSlabDisplay?this.thisMesh.vc:this.thisMesh.bsSlabDisplay.cardinality(),this.thisMesh.calculatedVolume=Float.$valueOf(a);b=b.calculateVolumeOrArea(this.thisMesh.jvxlData.thisSet,a,!1);a?this.thisMesh.calculatedArea=
b:this.thisMesh.calculatedVolume=b;return b},"~B");c$.getPolygonColorData=e(c$,"getPolygonColorData",function(a,b,c){if(null==b)return null;for(var d=new JU.SB,h=0,g=0,f=!1,e=0;e<a||!0==(f=!0);e++)if(f||null==c||c.get(e))if(f||b[e]!=g){0!=h&&d.append(" ").appendI(h).append(" ").appendI(0==g?0:JU.C.getArgb(g));if(f)break;g=b[e];h=1}else h++;d.append("\n");return d.toString()},"~N,~A,JU.BS");j(c$,"getShapeState",function(){this.clean();var a=new JU.SB;a.append("\n");for(var b=0;b<this.meshCount;b++)this.getMeshCommand(a,
b);return a.toString()});e(c$,"getMeshCommand",function(a,b){var c=this.meshes[b];if(!(null==c||null==c.scriptCommand)){var d=c.scriptCommand;1<this.vwr.getModelCount()&&J.shape.Shape.appendCmd(a,"frame "+this.vwr.getModelNumberDotted(c.modelIndex));var d=JU.PT.rep(d,";; isosurface map"," map"),d=JU.PT.rep(d,"; isosurface map"," map"),d=d.$replace("\t"," "),d=JU.PT.rep(d,";#","; #"),h=d.indexOf("; #");0<=h&&(d=d.substring(0,h));null!=c.connections&&(d+=" connect "+JU.Escape.eAI(c.connections));d=
JU.PT.trim(d,";");null!=c.linkedMesh&&(d+=" LINK");"lcaoCartoon"===this.myType&&0<=c.atomIndex&&(d+=" ATOMINDEX "+c.atomIndex);J.shape.Shape.appendCmd(a,d);h=this.myType+" ID "+JU.PT.esc(c.thisID);0<=c.jvxlData.thisSet&&J.shape.Shape.appendCmd(a,h+" set "+(c.jvxlData.thisSet+1));null!=c.mat4&&J.shape.Shape.appendCmd(a,h+" move "+JU.Escape.matrixToScript(c.mat4));0!=c.scale3d&&J.shape.Shape.appendCmd(a,h+" scale3d "+c.scale3d);-2147483648!=c.jvxlData.slabValue&&J.shape.Shape.appendCmd(a,h+" slab "+
c.jvxlData.slabValue);null!=c.slabOptions&&J.shape.Shape.appendCmd(a,c.slabOptions.toString());if("#"!=d.charAt(0)&&(this.allowMesh&&J.shape.Shape.appendCmd(a,c.getState(this.myType)),!c.isColorSolid&&(0==c.colorType&&JU.C.isColixTranslucent(c.colix))&&J.shape.Shape.appendCmd(a,"color "+this.myType+" "+J.shape.Shape.getTranslucentLabel(c.colix)),null!=c.colorCommand&&(0==c.colorType&&!c.colorCommand.equals("#inherit;"))&&J.shape.Shape.appendCmd(a,c.colorCommand),d=c.isColorSolid&&null!=c.pcs,c.isColorSolid&&
0==c.colorType&&!d?J.shape.Shape.appendCmd(a,J.shape.Shape.getColorCommandUnk(this.myType,c.colix,this.translucentAllowed)):c.jvxlData.isBicolorMap&&c.colorPhased&&J.shape.Shape.appendCmd(a,"color isosurface phase "+J.shape.Shape.encodeColor(c.jvxlData.minColorIndex)+" "+J.shape.Shape.encodeColor(c.jvxlData.maxColorIndex)),null!=c.vertexColorMap))for(var g,c=c.vertexColorMap.entrySet().iterator();c.hasNext()&&((g=c.next())||1);)d=g.getValue(),d.isEmpty()||J.shape.Shape.appendCmd(a,"color "+this.myType+
" "+JU.Escape.eBS(d)+" "+g.getKey())}},"JU.SB,~N");e(c$,"getScriptBitSets",function(a,b){this.script=a;var c;this.iHaveModelIndex=!1;this.modelIndex=-1;if(null!=a&&0<=(c=a.indexOf("MODEL({"))){var d=a.indexOf("})",c);0<d&&(c=JU.BS.unescape(a.substring(c+3,d+1)),this.modelIndex=null==c?-1:c.nextSetBit(0),this.iHaveModelIndex=0<=this.modelIndex)}if(null==a)return!1;this.getCapSlabInfo(a);c=a.indexOf("# ({");if(0>c)return!1;d=a.indexOf("})",c);if(0>d)return!1;c=JU.BS.unescape(a.substring(c+2,d+2));null==
b?this.sg.setParameter("select",c):b[0]=c;if(0>(c=a.indexOf("({",d)))return!0;d=a.indexOf("})",c);if(0>d)return!1;c=JU.BS.unescape(a.substring(c+1,d+1));null==b?this.sg.setParameter("ignore",c):b[1]=c;if((c=a.indexOf("/({",d))==d+2){if(0>(d=a.indexOf("})",c)))return!1;c=JU.BS.unescape(a.substring(c+3,d+1));null==b?this.vwr.ms.setTrajectoryBs(c):b[2]=c}return!0},"~S,~A");e(c$,"getCapSlabInfo",function(a){var b=a.indexOf("# SLAB=");0<=b&&this.sg.setParameter("slab",JU.MeshSurface.getCapSlabObject(JU.PT.getQuotedStringAt(a,
b),!1));b=a.indexOf("# CAP=");0<=b&&this.sg.setParameter("slab",JU.MeshSurface.getCapSlabObject(JU.PT.getQuotedStringAt(a,b),!0))},"~S");e(c$,"initializeIsosurface",function(){this.iHaveModelIndex||(this.modelIndex=this.vwr.am.cmi);this.atomIndex=-1;this.bsDisplay=null;this.center=JU.P3.new3(3.4028235E38,3.4028235E38,3.4028235E38);this.colix=5;this.cutoffRange=this.connections=null;this.colorType=this.defaultColix=this.meshColix=0;this.displayWithinPoints=null;this.explicitContours=!1;this.isFixed=
0>this.modelIndex;this.isPhaseColored=this.isColorExplicit=!1;this.linkedMesh=null;0>this.modelIndex&&(this.modelIndex=0);this.scale3d=0;this.title=null;this.translucentLevel=0;this.withinPoints=null;this.initState()});e(c$,"initState",function(){this.associateNormals=!0;this.sg.initState()});e(c$,"setMeshI",function(){this.thisMesh.visible=!0;this.thisMesh.modelIndex=0<=(this.thisMesh.atomIndex=this.atomIndex)?this.vwr.getAtomModelIndex(this.atomIndex):this.isFixed?-1:0<=this.modelIndex?this.modelIndex:
this.vwr.am.cmi;this.thisMesh.scriptCommand=this.script;this.thisMesh.ptCenter.setT(this.center);this.thisMesh.scale3d=null==this.thisMesh.jvxlData.jvxlPlane?0:this.scale3d});e(c$,"discardTempData",function(a){a&&(this.title=null,null!=this.thisMesh&&(this.thisMesh.surfaceSet=null))},"~B");e(c$,"getDefaultColix",function(){if(0!=this.defaultColix)return this.defaultColix;if(!this.sg.isCubeData())return this.colix;var a=0<=this.sg.getCutoff()?-11525984:-6283184;return JU.C.getColix(a)});e(c$,"drawLcaoCartoon",
function(a,b,c,d){var h=this.sg.setLcao(),g=c.x+c.y+c.z;this.defaultColix=JU.C.getColix(this.sg.getColor(1));var f=JU.C.getColix(this.sg.getColor(-1)),e=new JU.V3,k=0<h.length&&"-"==h.charAt(0);k&&(h=h.substring(1));k=k?-1:1;e.cross(a,b);if(0!=g){var m=new JU.A4;0!=c.x?m.setVA(b,g):0!=c.y?m.setVA(e,g):m.setVA(a,g);c=(new JU.M3).setAA(m);c.rotate(b);c.rotate(e);c.rotate(a)}null==this.thisMesh&&0==this.nLCAO&&(this.nLCAO=this.meshCount);c=null==this.thisMesh?(0<d?"lp":"lcao")+ ++this.nLCAO+"_"+h:this.thisMesh.thisID;
null==this.thisMesh&&this.allocMesh(c,null);h.equals("px")?(this.thisMesh.thisID+="a",h=this.thisMesh,this.createLcaoLobe(b,k,d),0<d||(this.setProperty("thisID",c+"b",null),this.createLcaoLobe(b,-k,d),this.thisMesh.colix=f,this.linkedMesh=this.thisMesh.linkedMesh=h)):h.equals("py")?(this.thisMesh.thisID+="a",h=this.thisMesh,this.createLcaoLobe(e,k,d),0<d||(this.setProperty("thisID",c+"b",null),this.createLcaoLobe(e,-k,d),this.thisMesh.colix=f,this.linkedMesh=this.thisMesh.linkedMesh=h)):h.equals("pz")?
(this.thisMesh.thisID+="a",h=this.thisMesh,this.createLcaoLobe(a,k,d),0<d||(this.setProperty("thisID",c+"b",null),this.createLcaoLobe(a,-k,d),this.thisMesh.colix=f,this.linkedMesh=this.thisMesh.linkedMesh=h)):h.equals("pza")||0==h.indexOf("sp")||0==h.indexOf("d")||0==h.indexOf("lp")?this.createLcaoLobe(a,k,d):h.equals("pzb")?this.createLcaoLobe(a,-k,d):h.equals("pxa")?this.createLcaoLobe(b,k,d):h.equals("pxb")?this.createLcaoLobe(b,-k,d):h.equals("pya")?this.createLcaoLobe(e,k,d):h.equals("pyb")?
this.createLcaoLobe(e,-k,d):h.equals("spacefill")||h.equals("cpk")?this.createLcaoLobe(null,2*this.vwr.getAtomRadius(this.atomIndex),d):this.createLcaoLobe(null,1,d)},"JU.V3,JU.V3,JU.V3,~N");e(c$,"createLcaoLobe",function(a,b,c){this.initState();JU.Logger.debugging&&JU.Logger.debug("creating isosurface ID "+this.thisMesh.thisID);null==a?this.setProperty("sphere",Float.$valueOf(b/2),null):(this.lcaoDir.x=a.x*b,this.lcaoDir.y=a.y*b,this.lcaoDir.z=a.z*b,this.lcaoDir.w=0.7,this.setProperty(2==c?"lp":
1==c?"rad":"lobe",this.lcaoDir,null));this.thisMesh.colix=this.defaultColix;this.setScriptInfo(null)},"JU.V3,~N,~N");j(c$,"invalidateTriangles",function(){this.thisMesh.invalidatePolygons()});j(c$,"setOutputChannel",function(a,b){a.setOutputChannel(b)},"javajs.api.GenericBinaryDocument,JU.OC");j(c$,"fillMeshData",function(a,b,c){if(null==a){if(null==this.thisMesh&&this.allocMesh(null,null),this.thisMesh.isMerged||this.thisMesh.clearType(this.myType,this.sg.getIAddGridPoints()),this.thisMesh.connections=
this.connections,this.thisMesh.colix=this.getDefaultColix(),this.thisMesh.colorType=this.colorType,this.thisMesh.meshColix=this.meshColix,this.isPhaseColored||this.thisMesh.jvxlData.isBicolorMap)this.thisMesh.isColorSolid=!1}else if(null==c&&(c=this.thisMesh),null!=c)switch(b){case 1:a.mergeVertexCount0=c.mergeVertexCount0;a.vs=c.vs;a.vertexSource=c.vertexSource;a.vvs=c.vvs;a.vc=c.vc;a.vertexIncrement=c.vertexIncrement;a.pc=c.pc;a.pis=c.pis;a.pcs=c.pcs;a.bsSlabDisplay=c.bsSlabDisplay;a.bsSlabGhost=
c.bsSlabGhost;a.slabColix=c.slabColix;a.slabMeshType=c.slabMeshType;a.polygonCount0=c.polygonCount0;a.vertexCount0=c.vertexCount0;a.slabOptions=c.slabOptions;break;case 2:if(null==c.vcs||c.vc>c.vcs.length)c.vcs=K(c.vc,0);a.vcs=c.vcs;break;case 3:c.surfaceSet=a.surfaceSet;c.vertexSets=a.vertexSets;c.nSets=a.nSets;break;case 4:c.vs=a.vs,c.vvs=a.vvs,c.vc=a.vc,c.vertexIncrement=a.vertexIncrement,c.vertexSource=a.vertexSource,c.pc=a.pc,c.pis=a.pis,c.pcs=a.pcs,c.bsSlabDisplay=a.bsSlabDisplay,c.bsSlabGhost=
a.bsSlabGhost,c.slabColix=a.slabColix,c.slabMeshType=a.slabMeshType,c.polygonCount0=a.polygonCount0,c.vertexCount0=a.vertexCount0,c.mergeVertexCount0=a.mergeVertexCount0,c.slabOptions=a.slabOptions}},"J.jvxl.data.MeshData,~N,J.shapesurface.IsosurfaceMesh");j(c$,"notifySurfaceGenerationCompleted",function(){this.setMeshI();this.setBsVdw();this.thisMesh.insideOut=this.sg.isInsideOut();this.thisMesh.vertexSource=this.sg.getVertexSource();this.thisMesh.spanningVectors=this.sg.getSpanningVectors();this.thisMesh.calculatedArea=
null;this.thisMesh.calculatedVolume=null;var a=this.sg.getParams();this.thisMesh.isMerged||this.thisMesh.initialize(this.sg.isFullyLit()?1073741964:1073741958,null,this.sg.getPlane());a.allowVolumeRender||(this.thisMesh.jvxlData.allowVolumeRender=!1);this.thisMesh.setColorsFromJvxlData(this.sg.getParams().colorRgb);null!=this.thisMesh.jvxlData.slabInfo&&this.vwr.runScript("isosurface "+this.thisMesh.jvxlData.slabInfo);0<this.sg.getParams().psi_monteCarloCount&&(this.thisMesh.diameter=-1)});j(c$,"notifySurfaceMappingCompleted",
function(){this.thisMesh.isMerged||(this.thisMesh.initialize(this.sg.isFullyLit()?1073741964:1073741958,null,this.sg.getPlane()),this.thisMesh.setJvxlDataRendering());this.setBsVdw();this.thisMesh.isColorSolid=!1;this.thisMesh.colorDensity=this.jvxlData.colorDensity;this.thisMesh.volumeRenderPointSize=this.jvxlData.pointSize;this.thisMesh.colorEncoder=this.sg.getColorEncoder();this.thisMesh.getContours();0!=this.thisMesh.jvxlData.nContours&&-1!=this.thisMesh.jvxlData.nContours&&(this.explicitContours=
!0);this.explicitContours&&null!=this.thisMesh.jvxlData.jvxlPlane&&(this.thisMesh.havePlanarContours=!0);this.setPropertySuper("token",Integer.$valueOf(this.explicitContours?1073742046:1073741938),null);this.setPropertySuper("token",Integer.$valueOf(this.explicitContours?1073741898:1073742039),null);var a=this.sg.getSlabInfo();null!=a&&(this.thisMesh.slabPolygonsList(a,!1),this.thisMesh.reinitializeLightingAndColor(this.vwr));this.thisMesh.setColorCommand()});e(c$,"setBsVdw",function(){var a=this.sg.geVdwBitSet();
null!=a&&(null==this.thisMesh.bsVdw&&(this.thisMesh.bsVdw=new JU.BS),this.thisMesh.bsVdw.or(a))});j(c$,"calculateGeodesicSurface",function(a,b){return this.vwr.calculateSurface(a,b)},"JU.BS,~N");j(c$,"getSurfacePointIndexAndFraction",function(){return 0},"~N,~B,~N,~N,~N,JU.P3i,~N,~N,~N,~N,JU.T3,JU.V3,~B,~A");j(c$,"addVertexCopy",function(a,b,c,d){return null!=this.cutoffRange&&(b<this.cutoffRange[0]||b>this.cutoffRange[1])?-1:null!=this.withinPoints&&!J.shape.Mesh.checkWithin(a,this.withinPoints,
this.withinDistance2,this.isWithinNot)?-1:this.thisMesh.addVertexCopy(a,b,c,this.associateNormals,d)},"JU.T3,~N,~N,~B");j(c$,"addTriangleCheck",function(a,b,c,d,h,g,f){return 0>a||0>b||0>c||g&&!J.jvxl.data.MeshData.checkCutoff(a,b,c,this.thisMesh.vvs)?-1:this.thisMesh.addTriangleCheck(a,b,c,d,h,f)},"~N,~N,~N,~N,~N,~B,~N");e(c$,"setScriptInfo",function(a){a=null==a?this.sg.getScript():a;var b=null==a?-1:a.indexOf("; isosurface map");if(0==b)null!=this.thisMesh.scriptCommand&&(b=this.thisMesh.scriptCommand.indexOf("; isosurface map"),
0<=b&&(this.thisMesh.scriptCommand=this.thisMesh.scriptCommand.substring(0,b)),this.thisMesh.scriptCommand+=a);else if(this.thisMesh.title=this.sg.getTitle(),this.thisMesh.dataType=this.sg.getParams().dataType,this.thisMesh.scale3d=this.sg.getParams().scale3d,null!=a&&" "==a.charAt(0)&&(a=this.myType+" ID "+JU.PT.esc(this.thisMesh.thisID)+a,b=a.indexOf("; isosurface map")),this.thisMesh.scriptCommand=0<b&&0<this.scriptAppendix.length?a.substring(0,b)+this.scriptAppendix+a.substring(b):a+this.scriptAppendix,
!this.explicitID&&null!=a&&0<=(b=a.indexOf("# ID=")))this.thisMesh.thisID=JU.PT.getQuotedStringAt(a,b)},"~S");j(c$,"addRequiredFile",function(a){a=' # /*file*/"'+a+'"';0>this.scriptAppendix.indexOf(a)&&(this.scriptAppendix+=a)},"~S");e(c$,"setJvxlInfo",function(){if(this.sg.getJvxlData()!==this.jvxlData||this.sg.getJvxlData()!==this.thisMesh.jvxlData)this.jvxlData=this.thisMesh.jvxlData=this.sg.getJvxlData()});j(c$,"getShapeDetail",function(){for(var a=new JU.Lst,b=0;b<this.meshCount;b++){var c=new java.util.Hashtable,
d=this.isomeshes[b];null==d||(null==d.vs||0==d.vc&&0==d.pc)||(this.addMeshInfo(d,c),a.addLast(c))}return a});e(c$,"addMeshInfo",function(a,b){b.put("ID",null==a.thisID?"<noid>":a.thisID);b.put("visible",Boolean.$valueOf(a.visible));b.put("vertexCount",Integer.$valueOf(a.vc));null!=a.calculatedVolume&&b.put("volume",a.calculatedVolume);null!=a.calculatedArea&&b.put("area",a.calculatedArea);3.4028235E38!=a.ptCenter.x&&b.put("center",a.ptCenter);null!=a.mat4&&b.put("mat4",a.mat4);0!=a.scale3d&&b.put("scale3d",
Float.$valueOf(a.scale3d));b.put("xyzMin",a.jvxlData.boundingBox[0]);b.put("xyzMax",a.jvxlData.boundingBox[1]);var c=J.jvxl.data.JvxlCoder.jvxlGetInfo(a.jvxlData);null!=c&&b.put("jvxlInfo",c.$replace("\n"," "));b.put("modelIndex",Integer.$valueOf(a.modelIndex));b.put("color",JU.CU.colorPtFromInt(JU.C.getArgb(a.colix),null));null!=a.colorEncoder&&b.put("colorKey",a.colorEncoder.getColorKey());null!=a.title&&b.put("title",a.title);(null!=a.jvxlData.contourValues||null!=a.jvxlData.contourValuesUsed)&&
b.put("contours",a.getContourList(this.vwr))},"J.shapesurface.IsosurfaceMesh,java.util.Map");j(c$,"getPlane",function(){return null},"~N");j(c$,"getValue",function(){return 0},"~N,~N,~N,~N");j(c$,"checkObjectHovered",function(a,b,c){if(null!=this.keyXy&&a>=this.keyXy[0]&&b>=this.keyXy[1]&&a<this.keyXy[2]&&b<this.keyXy[3])return this.hoverKey(a,b),!0;if(!this.vwr.getDrawHover())return!1;c=this.findValue(a,b,!1,c);if(null==c)return!1;this.gdata.isDisplayAntialiased()&&(a<<=1,b<<=1);this.vwr.hoverOnPt(a,
b,c,this.pickedMesh.thisID,this.pickedPt);return!0},"~N,~N,JU.BS");e(c$,"hoverKey",function(a,b){try{var c,d=1-1*(b-this.keyXy[1])/(this.keyXy[3]-this.keyXy[1]);if(this.thisMesh.showContourLines){var h=this.thisMesh.getContours();if(null==h){if(null==this.thisMesh.jvxlData.contourValues)return;var g=v(Math.floor(d*this.thisMesh.jvxlData.contourValues.length));if(0>g||g>this.thisMesh.jvxlData.contourValues.length)return;c=""+this.thisMesh.jvxlData.contourValues[g]}else{g=v(Math.floor(d*h.length));
if(0>g||g>h.length)return;c=""+h[g].get(2).floatValue()}}else{var f=this.thisMesh.colorEncoder.quantize(d,!0),d=this.thisMesh.colorEncoder.quantize(d,!1);c=""+f+" - "+d}this.gdata.isAntialiased()&&(a<<=1,b<<=1);this.vwr.hoverOnPt(a,b,c,null,null)}catch(e){if(!D(e,Exception))throw e;}},"~N,~N");j(c$,"checkObjectClicked",function(a,b,c,d,h){if(!h||!this.vwr.isBound(c,18))return null;c=100;this.gdata.isAntialiased()&&(a<<=1,b<<=1,c<<=1);for(var g=h=-1,f=-2147483648,e=2147483647,k=0;k<this.meshCount;k++){var m=
this.isomeshes[k];if(this.isPickable(m,d)&&(m=m.vs,null!=m))for(var p=m.length;0<=--p;){var n=m[p];null!=n&&0<=this.coordinateInRange(a,b,n,c,this.ptXY)&&(this.ptXY.z<e&&(h=k,e=this.ptXY.z,g=p),this.ptXY.z>f&&(f=this.ptXY.z))}}if(0>h)return null;this.pickedMesh=this.isomeshes[h];this.setPropertySuper("thisID",this.pickedMesh.thisID,null);this.pickedVertex=g;a=new JU.P3;a.setT(this.pickedMesh.vs[this.pickedVertex]);this.pickedModel=this.pickedMesh.modelIndex;b=this.getPickedPoint(a,this.pickedModel);
this.setStatusPicked(-4,a,b);return b},"~N,~N,~N,JU.BS,~B");e(c$,"isPickable",function(a,b){return 0!=a.visibilityFlags&&(0>a.modelIndex||b.get(a.modelIndex))&&!JU.C.isColixTranslucent(a.colix)},"J.shapesurface.IsosurfaceMesh,JU.BS");e(c$,"findValue",function(a,b,c,d){c=100;this.gdata.isAntialiased()&&(a<<=1,b<<=1,c<<=1);for(var h=-1,g=null,f=null,e=0;e<this.meshCount;e++)if(f=this.isomeshes[e],this.isPickable(f,d)){var k=f.jvxlData.vContours,m=0>f.firstRealVertex?0:f.firstRealVertex,p=0;if(null!=
k&&0<k.length){for(m=0;m<k.length;m++)for(var n=k[m],q=n.size()-1,j=6;j<q;j++){var r=n.get(j),w=this.coordinateInRange(a,b,r,c,this.ptXY);0<=w&&(c=w,g=n,p=m,this.pickedMesh=f,this.pickedPt=r)}if(null!=g)return g.get(2).toString()+(JU.Logger.debugging?" "+p:"")}else if(null!=f.jvxlData.jvxlPlane&&null!=f.vvs){k=null==f.mat4&&0==f.scale3d?f.vs:f.getOffsetVertices(f.jvxlData.jvxlPlane);for(j=f.vc;--j>=m;)r=k[j],w=this.coordinateInRange(a,b,r,c,this.ptXY),0<=w&&(c=w,h=j,this.pickedMesh=f,this.pickedPt=
r);if(-1!=h)break}else if(null!=f.vvs){for(j=f.vc;--j>=m;)r=f.vs[j],w=this.coordinateInRange(a,b,r,c,this.ptXY),0<=w&&(c=w,h=j,this.pickedMesh=f,this.pickedPt=r);if(-1!=h)break}}return-1==h?null:(JU.Logger.debugging?"$"+f.thisID+"["+(h+1)+"] "+f.vs[h]+": ":f.thisID+": ")+f.vvs[h]},"~N,~N,~B,JU.BS");e(c$,"getCmd",function(a){var b=(new JU.SB).append("\n");this.getMeshCommand(b,a);return b.toString()},"~N");H(c$,"MAX_OBJECT_CLICK_DISTANCE_SQUARED",100)});y("J.jvxl.data");z(null,"J.jvxl.data.JvxlCoder",
"java.lang.Character $.Float JU.BS $.Lst $.P3 $.PT $.SB $.XmlUtil J.jvxl.data.VolumeData JU.BSUtil $.C $.Escape $.Logger".split(" "),function(){c$=R(J.jvxl.data,"JvxlCoder");c$.jvxlGetFile=e(c$,"jvxlGetFile",function(a,b,c){var d=a.getVoxelCounts();b.nPointsX=d[0];b.nPointsY=d[1];b.nPointsZ=d[2];b.jvxlVolumeDataXml=a.setVolumetricXml();return J.jvxl.data.JvxlCoder.jvxlGetFile(b,null,c,null,!0,1,null,null)},"J.jvxl.data.VolumeData,J.jvxl.data.JvxlData,~A");c$.jvxlGetFile=e(c$,"jvxlGetFile",function(a,
b,c,d,h,g,f,e){return J.jvxl.data.JvxlCoder.jvxlGetFileXml(a,b,c,d,h,g,f,e)},"J.jvxl.data.JvxlData,J.jvxl.data.MeshData,~A,~S,~B,~N,~S,~S");c$.jvxlGetFileXml=e(c$,"jvxlGetFileXml",function(a,b,c,d,h,g,f,e){var k=new JU.SB;if("TRAILERONLY".equals(d))return JU.XmlUtil.closeTag(k,"jvxlSurfaceSet"),JU.XmlUtil.closeTag(k,"jvxl"),k.toString();var m=null!=b,p="HEADERONLY".equals(d);if(h){JU.XmlUtil.openDocument(k);JU.XmlUtil.openTagAttr(k,"jvxl",["version","2.3","jmolVersion",a.version,"xmlns","http://jmol.org/jvxl_schema",
"xmlns:cml","http://www.xml-cml.org/schema"]);null!=a.jvxlFileTitle&&JU.XmlUtil.appendCdata(k,"jvxlFileTitle",null,"\n"+a.jvxlFileTitle);null!=a.moleculeXml&&k.append(a.moleculeXml);var n=m?null:a.jvxlVolumeDataXml;null==n&&(n=(new J.jvxl.data.VolumeData).setVolumetricXml());k.append(n);JU.XmlUtil.openTagAttr(k,"jvxlSurfaceSet",["count",""+(0<g?g:1)]);if(p)return k.toString()}g=m?"pmesh":null==a.jvxlPlane?"isosurface":"plane";null!=a.jvxlColorData&&0<a.jvxlColorData.length&&(g="mapped "+g);JU.XmlUtil.openTagAttr(k,
"jvxlSurface",["type",g]);k.append(J.jvxl.data.JvxlCoder.jvxlGetInfoData(a,m));J.jvxl.data.JvxlCoder.jvxlAppendCommandState(k,e,f);if(null!=c||null!=d&&0<d.length){f=new JU.SB;null!=d&&0<d.length&&f.append(d).append("\n");if(null!=c)for(d=0;d<c.length;d++)f.append(c[d]).appendC("\n");JU.XmlUtil.appendCdata(k,"jvxlSurfaceTitle",null,f.toString())}f=new JU.SB;JU.XmlUtil.openTagAttr(f,"jvxlSurfaceData",m||null==a.jvxlPlane?null:null==a.mapLattice?["plane",JU.Escape.eP4(a.jvxlPlane)]:["plane",JU.Escape.eP4(a.jvxlPlane),
"maplattice",JU.Escape.eP(a.mapLattice)]);if(m)J.jvxl.data.JvxlCoder.appendXmlVertexOnlyData(f,a,b,!0);else{if(null==a.jvxlPlane){if(null==a.jvxlEdgeData)return"";J.jvxl.data.JvxlCoder.appendXmlEdgeData(f,a)}J.jvxl.data.JvxlCoder.appendXmlColorData(f,a.jvxlColorData,!0,a.isJvxlPrecisionColor,a.valueMappedToRed,a.valueMappedToBlue)}J.jvxl.data.JvxlCoder.appendEncodedBitSetTag(f,"jvxlInvalidatedVertexData",a.jvxlExcluded[1],-1,null);0<a.excludedVertexCount&&(J.jvxl.data.JvxlCoder.appendEncodedBitSetTag(f,
"jvxlExcludedVertexData",a.jvxlExcluded[0],a.excludedVertexCount,null),J.jvxl.data.JvxlCoder.appendEncodedBitSetTag(f,"jvxlExcludedPlaneData",a.jvxlExcluded[2],-1,null));J.jvxl.data.JvxlCoder.appendEncodedBitSetTag(f,"jvxlExcludedTriangleData",a.jvxlExcluded[3],a.excludedTriangleCount,null);JU.XmlUtil.closeTag(f,"jvxlSurfaceData");b=f.length();k.appendSB(f);null!=a.vContours&&0<a.vContours.length&&J.jvxl.data.JvxlCoder.jvxlEncodeContourData(a.vContours,k);if(null!=a.vertexColorMap){null==a.baseColor?
JU.XmlUtil.openTag(k,"jvxlVertexColorData"):JU.XmlUtil.openTagAttr(k,"jvxlVertexColorData",["baseColor",a.baseColor]);var j;for(c=a.vertexColorMap.entrySet().iterator();c.hasNext()&&((j=c.next())||1);)J.jvxl.data.JvxlCoder.appendEncodedBitSetTag(k,"jvxlColorMap",j.getValue(),-1,["color",j.getKey()]);a.vertexColorMap=null;JU.XmlUtil.closeTag(k,"jvxlVertexColorData")}JU.XmlUtil.closeTag(k,"jvxlSurface");h&&(JU.XmlUtil.closeTag(k,"jvxlSurfaceSet"),JU.XmlUtil.closeTag(k,"jvxl"));return J.jvxl.data.JvxlCoder.jvxlSetCompressionRatio(k,
a,b)},"J.jvxl.data.JvxlData,J.jvxl.data.MeshData,~A,~S,~B,~N,~S,~S");c$.appendEncodedBitSetTag=e(c$,"appendEncodedBitSetTag",function(a,b,c,d,h){0>d&&(d=JU.BSUtil.cardinalityOf(c));if(0!=d){var g=new JU.SB;g.append("\n ");J.jvxl.data.JvxlCoder.jvxlEncodeBitSetBuffer(c,-1,g);JU.XmlUtil.appendTagObj(a,b,[h,"bsEncoding","base90+35","count",""+d,"len",""+c.length()],J.jvxl.data.JvxlCoder.jvxlCompressString(g.toString(),!0))}},"JU.SB,~S,JU.BS,~N,~A");c$.jvxlSetCompressionRatio=e(c$,"jvxlSetCompressionRatio",
function(a,b,c){a=a.toString();b=E(0<b.nBytes?b.nBytes/c:13*b.nPointsX*b.nPointsY*b.nPointsZ/c);return JU.PT.rep(a,'"not calculated"',0<b?'"'+b+':1"':'"?"')},"JU.SB,J.jvxl.data.JvxlData,~N");c$.appendXmlEdgeData=e(c$,"appendXmlEdgeData",function(a,b){JU.XmlUtil.appendTagObj(a,"jvxlEdgeData",["count",""+(b.jvxlEdgeData.length-1),"encoding","base90f1","bsEncoding","base90+35c","isXLowToHigh",""+b.isXLowToHigh,"data",J.jvxl.data.JvxlCoder.jvxlCompressString(b.jvxlEdgeData,!0)],"\n"+J.jvxl.data.JvxlCoder.jvxlCompressString(b.jvxlSurfaceData,
!0))},"JU.SB,J.jvxl.data.JvxlData");c$.jvxlAppendCommandState=e(c$,"jvxlAppendCommandState",function(a,b,c){null!=b&&JU.XmlUtil.appendCdata(a,"jvxlIsosurfaceCommand",null,"\n"+(0>b.indexOf("#")?b:b.substring(0,b.indexOf("#")))+"\n");null!=c&&(0<=c.indexOf("** XML ** ")?(c=JU.PT.split(c,"** XML **")[1].trim(),JU.XmlUtil.appendTag(a,"jvxlIsosurfaceState","\n"+c+"\n")):JU.XmlUtil.appendCdata(a,"jvxlIsosurfaceState",null,"\n"+c))},"JU.SB,~S,~S");c$.appendXmlColorData=e(c$,"appendXmlColorData",function(a,
b,c,d,h,g){var f;if(!(null==b||0>(f=b.length-1)))d&&(f/=2),JU.XmlUtil.appendTagObj(a,"jvxlColorData",["count",""+f,"encoding",c?"base90f"+(d?"2":"1"):"none","min",""+h,"max",""+g,"data",J.jvxl.data.JvxlCoder.jvxlCompressString(b,!0)],null)},"JU.SB,~S,~B,~B,~N,~N");c$.jvxlGetInfo=e(c$,"jvxlGetInfo",function(a){return J.jvxl.data.JvxlCoder.jvxlGetInfoData(a,a.vertexDataOnly)},"J.jvxl.data.JvxlData");c$.jvxlGetInfoData=e(c$,"jvxlGetInfoData",function(a,b){if(null==a.jvxlSurfaceData)return"";var c=new JU.Lst,
d=a.nSurfaceInts,h=b?0:a.jvxlEdgeData.length-1,g=null==a.jvxlColorData?-1:a.jvxlColorData.length-1;if(!b){J.jvxl.data.JvxlCoder.addAttrib(c,"\n  cutoff",""+a.cutoff);J.jvxl.data.JvxlCoder.addAttrib(c,"\n  isCutoffAbsolute",""+a.isCutoffAbsolute);J.jvxl.data.JvxlCoder.addAttrib(c,"\n  pointsPerAngstrom",""+a.pointsPerAngstrom);var f=a.jvxlSurfaceData.length+h+g+1;0<f&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nBytesData",""+f);J.jvxl.data.JvxlCoder.addAttrib(c,"\n  isXLowToHigh",""+a.isXLowToHigh);null==
a.jvxlPlane&&(J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nSurfaceInts",""+d),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nBytesUncompressedEdgeData",""+h));0<g&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nBytesUncompressedColorData",""+g)}a.excludedVertexCount=JU.BSUtil.cardinalityOf(a.jvxlExcluded[0]);a.excludedTriangleCount=JU.BSUtil.cardinalityOf(a.jvxlExcluded[3]);0<a.excludedVertexCount&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nExcludedVertexes",""+a.excludedVertexCount);0<a.excludedTriangleCount&&J.jvxl.data.JvxlCoder.addAttrib(c,
"\n  nExcludedTriangles",""+a.excludedTriangleCount);f=JU.BSUtil.cardinalityOf(a.jvxlExcluded[1]);0<f&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nInvalidatedVertexes",""+f);null!=a.slabInfo&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  slabInfo",a.slabInfo);a.isJvxlPrecisionColor&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  precisionColor","true");a.colorDensity&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorDensity","true");Float.isNaN(a.pointSize)?0!=a.diameter&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  diameter",
""+a.diameter):J.jvxl.data.JvxlCoder.addAttrib(c,"\n  pointSize",""+a.pointSize);a.allowVolumeRender||J.jvxl.data.JvxlCoder.addAttrib(c,"\n  allowVolumeRender","false");null==a.jvxlPlane||b?(a.isContoured?(J.jvxl.data.JvxlCoder.addAttrib(c,"\n  contoured","true"),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorMapped","true")):a.isBicolorMap?(J.jvxl.data.JvxlCoder.addAttrib(c,"\n  bicolorMap","true"),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorNegative",JU.C.getHexCode(a.minColorIndex)),J.jvxl.data.JvxlCoder.addAttrib(c,
"\n  colorPositive",JU.C.getHexCode(a.maxColorIndex))):0<g&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorMapped","true"),null!=a.vContours&&0<a.vContours.length&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nContourData",""+a.vContours.length)):(null!=a.mapLattice&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  mapLattice",""+a.mapLattice),0!=a.scale3d&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  scale3d",""+a.scale3d),0<g&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorMapped","true"),J.jvxl.data.JvxlCoder.addAttrib(c,
"\n  plane",JU.Escape.eP4(a.jvxlPlane)));null!=a.color&&0>a.color.indexOf("null")&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  color",a.color);J.jvxl.data.JvxlCoder.addAttrib(c,"\n  translucency",""+a.translucency);null!=a.meshColor&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  meshColor",a.meshColor);null!=a.colorScheme&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  colorScheme",a.colorScheme);null!=a.rendering&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  rendering",a.rendering);0<=a.thisSet&&J.jvxl.data.JvxlCoder.addAttrib(c,
"\n  set",""+(a.thisSet+1));-2147483648!=a.slabValue&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  slabValue",""+a.slabValue);a.isSlabbable&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  slabbable","true");0<a.nVertexColors&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nVertexColors",""+a.nVertexColors);d=3.4028235E38==a.mappedDataMin?0:a.mappedDataMin;h=a.isColorReversed?a.valueMappedToRed:a.valueMappedToBlue;g=a.isColorReversed?a.valueMappedToBlue:a.valueMappedToRed;null!=a.jvxlColorData&&(0<a.jvxlColorData.length&&
!a.isBicolorMap)&&(J.jvxl.data.JvxlCoder.addAttrib(c,"\n  dataMinimum",""+d),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  dataMaximum",""+a.mappedDataMax),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  valueMappedToRed",""+g),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  valueMappedToBlue",""+h));a.isContoured&&(null==a.contourValues||null==a.contourColixes?null==a.vContours&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nContours",""+Math.abs(a.nContours)):(null!=a.jvxlPlane&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  contoured",
"true"),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  nContours",""+a.contourValues.length),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  contourValues",JU.Escape.eAF(null==a.contourValuesUsed?a.contourValues:a.contourValuesUsed)),J.jvxl.data.JvxlCoder.addAttrib(c,"\n  contourColors",a.contourColors)));a.insideOut&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  insideOut","true");a.vertexDataOnly?J.jvxl.data.JvxlCoder.addAttrib(c,"\n  note","vertex/face data only"):a.isXLowToHigh&&J.jvxl.data.JvxlCoder.addAttrib(c,"\n  note",
"progressive JVXL+ -- X values read from low(0) to high("+(a.nPointsX-1)+")");J.jvxl.data.JvxlCoder.addAttrib(c,"\n  xyzMin",JU.Escape.eP(a.boundingBox[0]));J.jvxl.data.JvxlCoder.addAttrib(c,"\n  xyzMax",JU.Escape.eP(a.boundingBox[1]));J.jvxl.data.JvxlCoder.addAttrib(c,"\n  approximateCompressionRatio","not calculated");J.jvxl.data.JvxlCoder.addAttrib(c,"\n  jmolVersion",a.version);d=new JU.SB;JU.XmlUtil.openTagAttr(d,"jvxlSurfaceInfo",c.toArray(Array(c.size())));JU.XmlUtil.closeTag(d,"jvxlSurfaceInfo");
return d.toString()},"J.jvxl.data.JvxlData,~B");c$.addAttrib=e(c$,"addAttrib",function(a,b,c){a.addLast([b,c])},"JU.Lst,~S,~S");c$.jvxlEncodeContourData=e(c$,"jvxlEncodeContourData",function(a,b){JU.XmlUtil.openTagAttr(b,"jvxlContourData",["count",""+a.length]);for(var c=0;c<a.length;c++)if(!(6>a[c].size())){var d=a[c].get(0).intValue(),h=new JU.SB;h.append("\n");var g=a[c].get(1);J.jvxl.data.JvxlCoder.jvxlEncodeBitSetBuffer(g,d,h);JU.XmlUtil.appendTagObj(b,"jvxlContour",["index",""+c,"value",""+
a[c].get(2),"color",JU.Escape.escapeColor(a[c].get(4)[0]),"count",""+g.length(),"encoding","base90iff1","bsEncoding","base90+35c","data",J.jvxl.data.JvxlCoder.jvxlCompressString(a[c].get(5).toString(),!0)],J.jvxl.data.JvxlCoder.jvxlCompressString(h.toString(),!0))}JU.XmlUtil.closeTag(b,"jvxlContourData")},"~A,JU.SB");c$.set3dContourVector=e(c$,"set3dContourVector",function(a,b,c){if(!(6>a.size()))for(var d=a.get(5),h=a.get(1),g=0,f=d.length(),e=0,k=" ",m=" ",p=h.nextSetBit(0);0<=p;p=h.nextSetBit(p+
1)){for(var n=b[p];g<f&&!Character.isDigit(k=d.charAt(g++)););for(e=k.charCodeAt(0)-48;g<f&&Character.isWhitespace(k=d.charAt(g++)););for(;g<f&&Character.isWhitespace(m=d.charAt(g++)););var j=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(k.charCodeAt(0),35,90,0),s=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(m.charCodeAt(0),35,90,0),r,w;0==(e&1)?(r=n[1],w=e=n[2],n=n[0]):(r=n[0],w=n[1],0!=(e&2)?(e=w,n=n[2]):(e=n[2],n=r));a.addLast(J.jvxl.data.JvxlCoder.getContourPoint(c,r,w,j));a.addLast(J.jvxl.data.JvxlCoder.getContourPoint(c,
e,n,s))}},"JU.Lst,~A,~A");c$.getContourPoint=e(c$,"getContourPoint",function(a,b,c,d){var h=new JU.P3;h.sub2(a[c],a[b]);h.scaleAdd2(d,h,a[b]);return h},"~A,~N,~N,~N");c$.appendContourTriangleIntersection=e(c$,"appendContourTriangleIntersection",function(a,b,c,d){d.appendI(a);d.appendC(J.jvxl.data.JvxlCoder.jvxlFractionAsCharacter(b));d.appendC(J.jvxl.data.JvxlCoder.jvxlFractionAsCharacter(c))},"~N,~N,~N,JU.SB");c$.jvxlCreateColorData=e(c$,"jvxlCreateColorData",function(a,b){if(null==b)a.jvxlColorData=
"";else{var c=a.isJvxlPrecisionColor,d=a.isTruncated,h=a.colorFractionBase,g=a.colorFractionRange,f=a.valueMappedToBlue,e=a.valueMappedToRed,k=0<a.saveVertexCount?a.saveVertexCount:a.vertexCount;k>b.length&&System.out.println("JVXLCODER ERROR");var m=a.mappedDataMin,p=a.mappedDataMax,n=new JU.SB,j=new JU.SB;b.length<k&&System.out.println("JVXLCOLOR OHOHO");for(var s=0;s<k;s++){var r=b[s];Float.isNaN(r)&&(r=m);d&&(r=0<r?0.999:-0.999);c?J.jvxl.data.JvxlCoder.jvxlAppendCharacter2(r,m,p,h,g,n,j):n.appendC(J.jvxl.data.JvxlCoder.jvxlValueAsCharacter(r,
e,f,h,g))}a.jvxlColorData=n.appendSB(j).appendC("\n").toString()}},"J.jvxl.data.JvxlData,~A");c$.appendXmlVertexOnlyData=e(c$,"appendXmlVertexOnlyData",function(a,b,c,d){var h=t(c.vc,0);J.jvxl.data.JvxlCoder.appendXmlTriangleData(a,c.pis,c.pc,c.bsSlabDisplay,h,d)&&J.jvxl.data.JvxlCoder.appendXmlVertexData(a,b,h,c.vs,c.vvs,c.vc,c.polygonColorData,c.pc,c.bsSlabDisplay,b.vertexColors,0<b.jvxlColorData.length,d)},"JU.SB,J.jvxl.data.JvxlData,J.jvxl.data.MeshData,~B");c$.appendXmlTriangleData=e(c$,"appendXmlTriangleData",
function(a,b,c,d,h,g){for(var f=new JU.SB,e=new JU.SB,k=1,m=0,p=0,n=!1,j=0,s=null!=d,r=0;r<c;)if(null==b[r]||s&&!d.get(r))r++;else{var w=b[r][m],w=0<h[w]?h[w]:h[w]=++p,t=w-k,k=w;0==t?(f.appendC("!"),n=!1):32<t?(n&&f.appendC("+"),f.appendI(t),n=!0):-32>t?(f.appendI(t),n=!0):(f.appendC(String.fromCharCode(92+t)),n=!1);0==++m%3&&(e.appendI(b[r][3]),m=0,r++,j++)}if(0==f.length())return!0;JU.XmlUtil.appendTagObj(a,"jvxlTriangleData",["count",""+j,"encoding","jvxltdiff","data",J.jvxl.data.JvxlCoder.jvxlCompressString(f.toString(),
g)],null);JU.XmlUtil.appendTagObj(a,"jvxlTriangleEdgeData",["count",""+j,"encoding","jvxlsc","data",J.jvxl.data.JvxlCoder.jvxlCompressString(e.toString(),g)],null);return!0},"JU.SB,~A,~N,JU.BS,~A,~B");c$.appendXmlVertexData=e(c$,"appendXmlVertexData",function(a,b,c,d,h,g,f,e,k,m,p,n){var j=b.colorFractionBase,s=b.colorFractionRange,r,w=b.boundingBox[0],v=b.boundingBox[1],u=new JU.SB,y=new JU.SB,A=null,x=null!=k;if(0<e){x&&(e=k.cardinality());for(var x=!1,A=t(g,0),B=0;B<g;B++)0<c[B]&&(A[c[B]-1]=B)}for(B=
c=0;B<g;B++)if(!x||k.get(B))c++,r=d[0==e?B:A[B]],J.jvxl.data.JvxlCoder.jvxlAppendCharacter2(r.x,w.x,v.x,j,s,u,y),J.jvxl.data.JvxlCoder.jvxlAppendCharacter2(r.y,w.y,v.y,j,s,u,y),J.jvxl.data.JvxlCoder.jvxlAppendCharacter2(r.z,w.z,v.z,j,s,u,y);u.appendSB(y);JU.XmlUtil.appendTagObj(a,"jvxlVertexData",["count",""+c,"min",JU.Escape.eP(w),"max",JU.Escape.eP(v),"encoding","base90xyz2","data",J.jvxl.data.JvxlCoder.jvxlCompressString(u.toString(),n)],null);null!=f&&JU.XmlUtil.appendTagObj(a,"jvxlPolygonColorData",
["encoding","jvxlnc","count",""+e],"\n"+f);if(p){u=new JU.SB;y=new JU.SB;if(null==m)for(B=0;B<g;B++){if(!x||k.get(B))J.jvxl.data.JvxlCoder.jvxlAppendCharacter2(h[0==e?B:A[B]],b.mappedDataMin,b.mappedDataMax,j,s,u,y)}else{d=0;u.appendI(c).append(" ");for(B=0;B<g;B++)if(!x||k.get(B))h=m[0==e?B:A[B]],h==d?h=0:d=h,u.appendI(h),u.append(" ")}J.jvxl.data.JvxlCoder.appendXmlColorData(a,u.appendSB(y).append("\n").toString(),null==m,!0,b.valueMappedToRed,b.valueMappedToBlue)}},"JU.SB,J.jvxl.data.JvxlData,~A,~A,~A,~N,~S,~N,JU.BS,~A,~B,~B");
c$.jvxlFractionAsCharacter=e(c$,"jvxlFractionAsCharacter",function(a){return J.jvxl.data.JvxlCoder.jvxlFractionAsCharacterRange(a,35,90)},"~N");c$.jvxlFractionAsCharacterRange=e(c$,"jvxlFractionAsCharacterRange",function(a,b,c){0.9999<a?a=0.9999:Float.isNaN(a)&&(a=1.0001);a=v(Math.floor(a*c+b));return a<b?String.fromCharCode(b):92==a?"!":String.fromCharCode(a)},"~N,~N,~N");c$.jvxlAppendCharacter2=e(c$,"jvxlAppendCharacter2",function(a,b,c,d,h,g,e){a=b==c?a:(a-b)/(c-b);b=J.jvxl.data.JvxlCoder.jvxlFractionAsCharacterRange(a,
d,h);g.appendC(b);a-=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(b.charCodeAt(0),d,h,0);e.appendC(J.jvxl.data.JvxlCoder.jvxlFractionAsCharacterRange(a*h,d,h))},"~N,~N,~N,~N,~N,JU.SB,JU.SB");c$.jvxlFractionFromCharacter=e(c$,"jvxlFractionFromCharacter",function(a,b,c,d){if(a==b+c)return NaN;a<b&&(a=92);a=(a-b+d)/c;return 0>a?0:1<a?0.999999:a},"~N,~N,~N,~N");c$.jvxlFractionFromCharacter2=e(c$,"jvxlFractionFromCharacter2",function(a,b,c,d){a=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(a,c,d,
0);b=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(b,c,d,0.5);return a+b/d},"~N,~N,~N,~N");c$.jvxlValueAsCharacter=e(c$,"jvxlValueAsCharacter",function(a,b,c,d,h){return J.jvxl.data.JvxlCoder.jvxlFractionAsCharacterRange(b==c?a:(a-b)/(c-b),d,h)},"~N,~N,~N,~N,~N");c$.jvxlValueFromCharacter2=e(c$,"jvxlValueFromCharacter2",function(a,b,c,d,h,e){a=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter2(a,b,h,e);return d==c?a:c+a*(d-c)},"~N,~N,~N,~N,~N,~N");c$.jvxlEncodeBitSet0=e(c$,"jvxlEncodeBitSet0",function(a,
b,c){var d=0,h=-1,e=0;0>b&&(b=a.length());for(var f=0,l=!1,k=b-1,m=0;m<b;++m)l==a.get(m)?d++:(d==h&&m!=k?e++:(0<e&&(c.appendC(" ").appendI(-e),e=0,f++),c.appendC(" ").appendI(d),f++,h=d),d=1,l=!l);c.appendC(" ").appendI(d).appendC("\n");return f},"JU.BS,~N,JU.SB");c$.jvxlEncodeBitSet=e(c$,"jvxlEncodeBitSet",function(a){var b=new JU.SB;J.jvxl.data.JvxlCoder.jvxlEncodeBitSetBuffer(a,-1,b);return b.toString()},"JU.BS");c$.jvxlEncodeBitSetBuffer=e(c$,"jvxlEncodeBitSetBuffer",function(a,b,c){var d=0,h=
0,e=!1;0>b&&(b=a.length());if(0==b)return 0;c.append("-");for(var f=0;f<b;++f)e==a.get(f)?d++:(J.jvxl.data.JvxlCoder.jvxlAppendEncodedNumber(c,d,35,90),h++,d=1,e=!e);J.jvxl.data.JvxlCoder.jvxlAppendEncodedNumber(c,d,35,90);c.appendC("\n");return h},"JU.BS,~N,JU.SB");c$.jvxlAppendEncodedNumber=e(c$,"jvxlAppendEncodedNumber",function(a,b,c,d){var h=b<d;for(0==b?a.appendC(String.fromCharCode(c)):h||a.appendC(String.fromCharCode(c+d));0<b;){var e=v(b/d);b=c+b-e*d;92==b&&(b=33);a.appendC(String.fromCharCode(b));
b=e}h||a.append(" ")},"JU.SB,~N,~N,~N");c$.jvxlDecodeBitSetRange=e(c$,"jvxlDecodeBitSetRange",function(a,b,c){for(var d=new JU.BS,h=0,e=0,f=!1,l=t(1,0);-2147483648!=(h=J.jvxl.data.JvxlCoder.jvxlParseEncodedInt(a,b,c,l));)f&&d.setBits(e,e+h),e+=h,f=!f;return d},"~S,~N,~N");c$.jvxlParseEncodedInt=e(c$,"jvxlParseEncodedInt",function(a,b,c,d){var h=!1,e=0,f=d[0],l=a.length;if(0>f)return-2147483648;for(;f<l&&Character.isWhitespace(a.charAt(f));)++f;if(f>=l)return-2147483648;var k=1,m=a.charCodeAt(f)==
b+c;for(m&&f++;f<l&&!Character.isWhitespace(a.charAt(f));){h=a.charCodeAt(f);h<b&&(h=92);e+=(h-b)*k;h=!0;++f;if(!m)break;k*=c}h||(e=-2147483648);d[0]=f;return e},"~S,~N,~N,~A");c$.jvxlDecodeBitSet=e(c$,"jvxlDecodeBitSet",function(a){if(a.startsWith("-"))return J.jvxl.data.JvxlCoder.jvxlDecodeBitSetRange(J.jvxl.data.JvxlCoder.jvxlDecompressString(a.substring(1)),35,90);for(var b=new JU.BS,c=0,d=0,h=0,e=0,f=!1,l=t(1,0);;){c=0>h++?c:JU.PT.parseIntNext(a,l);if(-2147483648==c)break;0>c?(h=c,c=d):(f&&b.setBits(e,
e+c),e+=c,d=c,f=!f)}return b},"~S");c$.jvxlCompressString=e(c$,"jvxlCompressString",function(a,b){if(0<=a.indexOf("~"))return a;for(var c=new JU.SB,d="\x00",h=!1,e=!1,f=0,l=a.length,k=0;k<=l;k++){var m=k==l?"\x00":a.charAt(k);switch(m){case "\n":case "\r":continue;case "&":case "<":h=b;break;default:h=!1}if(m==d)++f,m="\x00";else if(0<f||e){if(4>f&&!e||" "==d||"\t"==d)for(;0<=--f;)c.appendC(d);else e?e=!1:c.appendC("~"),c.appendI(f),c.appendC(" ");f=0}"\x00"!=m&&(h?(e=!0,c.appendC("~"),d=m,m=String.fromCharCode(m.charCodeAt(0)-
1)):d=m,c.appendC(m))}return c.toString()},"~S,~B");c$.jvxlDecompressString=e(c$,"jvxlDecompressString",function(a){if(0>a.indexOf("~"))return a;for(var b=new JU.SB,c="\x00",d=t(1,0),h=0;h<a.length;h++){var e=a.charAt(h);if("~"==e)switch(d[0]=++h,e=a.charAt(h)){case ";":case "%":d[0]++,b.appendC(c=String.fromCharCode(e.charCodeAt(0)+1));case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":h=JU.PT.parseIntNext(a,d);for(e=0;e<h;e++)b.appendC(c);h=d[0];continue;case "~":--h;
break;default:JU.Logger.error("Error uncompressing string "+a.substring(0,h)+"?")}b.appendC(e);c=e}return b.toString()},"~S");c$.jvxlCreateHeaderWithoutTitleOrAtoms=e(c$,"jvxlCreateHeaderWithoutTitleOrAtoms",function(a,b){J.jvxl.data.JvxlCoder.jvxlCreateHeader(a,b)},"J.jvxl.data.VolumeData,JU.SB");c$.jvxlCreateHeader=e(c$,"jvxlCreateHeader",function(a,b){a.setVolumetricXml();0==b.length()&&b.append("Line 1\nLine 2\n")},"J.jvxl.data.VolumeData,JU.SB");H(c$,"JVXL_VERSION1","2.0","JVXL_VERSION_XML",
"2.3","CONTOUR_NPOLYGONS",0,"CONTOUR_BITSET",1,"CONTOUR_VALUE",2,"CONTOUR_COLIX",3,"CONTOUR_COLOR",4,"CONTOUR_FDATA",5,"CONTOUR_POINTS",6,"defaultEdgeFractionBase",35,"defaultEdgeFractionRange",90,"defaultColorFractionBase",35,"defaultColorFractionRange",90)});y("J.jvxl.data");z(["J.api.VolumeDataInterface","JU.M3","$.P3","$.V3"],"J.jvxl.data.VolumeData",["java.lang.Float","java.util.Hashtable","JU.SB","JU.Escape","$.Logger"],function(){c$=x(function(){this.sr=null;this.doIterate=!0;this.voxelCounts=
this.volumetricVectors=this.origin=this.volumetricOrigin=null;this.nPoints=0;this.volumetricVectorLengths=this.voxelMap=this.voxelData=null;this.yzCount=this.minToPlaneDistance=this.maxVectorLength=0;this.thePlane=this.inverseMatrix=this.volumetricMatrix=this.unitVolumetricVectors=null;this.thePlaneNormalMag=0;this.mappingPlane=this.xmlData=this.ptXyzTemp=null;this.voxelVolume=this.maxGrid=this.minGrid=this.mappingPlaneNormalMag=0;this.spanningVectors=null;this.isSquared=this.isPeriodic=!1;this.ptTemp=
this.edgeVector=null;A(this,arguments)},J.jvxl.data,"VolumeData",null,J.api.VolumeDataInterface);G(c$,function(){this.volumetricOrigin=new JU.P3;this.origin=u(3,0);this.volumetricVectors=Array(3);this.voxelCounts=t(3,0);this.volumetricVectorLengths=u(3,0);this.unitVolumetricVectors=Array(3);this.volumetricMatrix=new JU.M3;this.inverseMatrix=new JU.M3;this.ptXyzTemp=new JU.P3;this.edgeVector=new JU.V3;this.ptTemp=new JU.P3});j(c$,"getVoxelData",function(){return this.voxelData});j(c$,"setVoxelDataAsArray",
function(a){this.voxelData=a;null!=a&&(this.sr=null)},"~A");e(c$,"hasPlane",function(){return null!=this.thePlane});C(c$,function(){this.volumetricVectors[0]=new JU.V3;this.volumetricVectors[1]=new JU.V3;this.volumetricVectors[2]=new JU.V3;this.unitVolumetricVectors[0]=new JU.V3;this.unitVolumetricVectors[1]=new JU.V3;this.unitVolumetricVectors[2]=new JU.V3});e(c$,"setMappingPlane",function(a){this.mappingPlane=a;null!=a&&(this.mappingPlaneNormalMag=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z))},"JU.P4");e(c$,
"distanceToMappingPlane",function(a){return(this.mappingPlane.x*a.x+this.mappingPlane.y*a.y+this.mappingPlane.z*a.z+this.mappingPlane.w)/this.mappingPlaneNormalMag},"JU.T3");j(c$,"setVolumetricOrigin",function(a,b,c){this.volumetricOrigin.set(a,b,c)},"~N,~N,~N");j(c$,"getOriginFloat",function(){return this.origin});e(c$,"getSpanningVectors",function(){return this.spanningVectors});e(c$,"getYzCount",function(){this.minGrid=this.volumetricVectors[0].length();this.minGrid=Math.min(this.minGrid,this.volumetricVectors[1].length());
this.minGrid=Math.min(this.minGrid,this.volumetricVectors[2].length());this.maxGrid=this.volumetricVectors[0].length();this.maxGrid=Math.max(this.maxGrid,this.volumetricVectors[1].length());this.maxGrid=Math.max(this.maxGrid,this.volumetricVectors[2].length());this.nPoints=this.voxelCounts[0]*this.voxelCounts[1]*this.voxelCounts[2];return this.yzCount=this.voxelCounts[1]*this.voxelCounts[2]});j(c$,"getVolumetricVectorLengths",function(){return this.volumetricVectorLengths});j(c$,"setVolumetricVector",
function(a,b,c,d){this.volumetricVectors[a].x=b;this.volumetricVectors[a].y=c;this.volumetricVectors[a].z=d;this.setUnitVectors()},"~N,~N,~N,~N");j(c$,"getVoxelCounts",function(){return this.voxelCounts});j(c$,"setVoxelCounts",function(a,b,c){this.voxelCounts[0]=a;this.voxelCounts[1]=b;this.voxelCounts[2]=c;return a*b*c},"~N,~N,~N");e(c$,"getVoxelDataAt",function(a){var b=v(a/this.yzCount);a-=b*this.yzCount;var c=v(a/this.voxelCounts[2]);return this.voxelData[b][c][a-c*this.voxelCounts[2]]},"~N");
e(c$,"getPointIndex",function(a,b,c){return a*this.yzCount+b*this.voxelCounts[2]+c},"~N,~N,~N");e(c$,"getPoint",function(a,b){var c=v(a/this.yzCount);a-=c*this.yzCount;var d=v(a/this.voxelCounts[2]);this.voxelPtToXYZ(c,d,a-d*this.voxelCounts[2],b)},"~N,JU.P3");e(c$,"setVoxelData",function(a,b){var c=v(a/this.yzCount);a-=c*this.yzCount;var d=v(a/this.voxelCounts[2]);this.voxelData[c][d][a-d*this.voxelCounts[2]]=b},"~N,~N");e(c$,"setVoxelMap",function(){this.voxelMap=new java.util.Hashtable;this.getYzCount()});
e(c$,"setMatrix",function(){for(var a=0;3>a;a++)this.volumetricMatrix.setColumnV(a,this.volumetricVectors[a]);try{this.inverseMatrix.invertM(this.volumetricMatrix)}catch(b){if(D(b,Exception))return JU.Logger.error("VolumeData error setting matrix -- bad unit vectors? "),!1;throw b;}return!0});j(c$,"transform",function(a,b){this.volumetricMatrix.rotate2(a,b)},"JU.V3,JU.V3");j(c$,"setPlaneParameters",function(a){this.thePlane=a;this.thePlaneNormalMag=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)},"JU.P4");j(c$,
"calcVoxelPlaneDistance",function(a,b,c){this.voxelPtToXYZ(a,b,c,this.ptXyzTemp);return this.distancePointToPlane(this.ptXyzTemp)},"~N,~N,~N");e(c$,"getToPlaneParameter",function(){return Math.sqrt(this.thePlane.x*this.thePlane.x+this.thePlane.y*this.thePlane.y+this.thePlane.z*this.thePlane.z)*this.minToPlaneDistance});e(c$,"isNearPlane",function(a,b,c,d){this.voxelPtToXYZ(a,b,c,this.ptXyzTemp);return this.thePlane.x*this.ptXyzTemp.x+this.thePlane.y*this.ptXyzTemp.y+this.thePlane.z*this.ptXyzTemp.z+
this.thePlane.w<d},"~N,~N,~N,~N");j(c$,"distancePointToPlane",function(a){return(this.thePlane.x*a.x+this.thePlane.y*a.y+this.thePlane.z*a.z+this.thePlane.w)/this.thePlaneNormalMag},"JU.T3");j(c$,"voxelPtToXYZ",function(a,b,c,d){d.scaleAdd2(a,this.volumetricVectors[0],this.volumetricOrigin);d.scaleAdd2(b,this.volumetricVectors[1],d);d.scaleAdd2(c,this.volumetricVectors[2],d)},"~N,~N,~N,JU.T3");e(c$,"setUnitVectors",function(){this.maxVectorLength=0;this.voxelVolume=1;for(var a=0;3>a;a++){var b=this.volumetricVectorLengths[a]=
this.volumetricVectors[a].length();if(0==b)return!1;b>this.maxVectorLength&&(this.maxVectorLength=b);this.voxelVolume*=b;this.unitVolumetricVectors[a].setT(this.volumetricVectors[a]);this.unitVolumetricVectors[a].normalize()}this.minToPlaneDistance=2*this.maxVectorLength;this.origin[0]=this.volumetricOrigin.x;this.origin[1]=this.volumetricOrigin.y;this.origin[2]=this.volumetricOrigin.z;this.spanningVectors=Array(4);this.spanningVectors[0]=JU.V3.newV(this.volumetricOrigin);for(a=0;3>a;a++)b=this.spanningVectors[a+
1]=new JU.V3,b.scaleAdd2(this.voxelCounts[a]-1,this.volumetricVectors[a],b);return this.setMatrix()});j(c$,"xyzToVoxelPt",function(a,b,c,d){this.ptXyzTemp.set(a,b,c);this.ptXyzTemp.sub(this.volumetricOrigin);this.inverseMatrix.rotate(this.ptXyzTemp);d.set(Math.round(this.ptXyzTemp.x),Math.round(this.ptXyzTemp.y),Math.round(this.ptXyzTemp.z))},"~N,~N,~N,JU.T3i");j(c$,"lookupInterpolatedVoxelValue",function(a,b){if(null!=this.mappingPlane)return this.distanceToMappingPlane(a);if(null!=this.sr){var c=
this.sr.getValueAtPoint(a,b);return this.isSquared?c*c:c}this.ptXyzTemp.sub2(a,this.volumetricOrigin);this.inverseMatrix.rotate(this.ptXyzTemp);var d,h=this.indexLower(this.ptXyzTemp.x,d=this.voxelCounts[0]-1),e=this.indexUpper(this.ptXyzTemp.x,h,d),f=this.indexLower(this.ptXyzTemp.y,d=this.voxelCounts[1]-1),l=this.indexUpper(this.ptXyzTemp.y,f,d),c=this.indexLower(this.ptXyzTemp.z,d=this.voxelCounts[2]-1),k=this.indexUpper(this.ptXyzTemp.z,c,d);d=J.jvxl.data.VolumeData.getFractional2DValue(this.mantissa(this.ptXyzTemp.x-
h),this.mantissa(this.ptXyzTemp.y-f),this.getVoxelValue(h,f,c),this.getVoxelValue(e,f,c),this.getVoxelValue(h,l,c),this.getVoxelValue(e,l,c));h=J.jvxl.data.VolumeData.getFractional2DValue(this.mantissa(this.ptXyzTemp.x-h),this.mantissa(this.ptXyzTemp.y-f),this.getVoxelValue(h,f,k),this.getVoxelValue(e,f,k),this.getVoxelValue(h,l,k),this.getVoxelValue(e,l,k));return d+this.mantissa(this.ptXyzTemp.z-c)*(h-d)},"JU.T3,~B");e(c$,"mantissa",function(a){return this.isPeriodic?a-Math.floor(a):a},"~N");e(c$,
"getVoxelValue",function(a,b,c){if(null==this.voxelMap)return this.voxelData[a][b][c];a=this.voxelMap.get(Integer.$valueOf(this.getPointIndex(a,b,c)));return null==a?NaN:a.floatValue()},"~N,~N,~N");c$.getFractional2DValue=e(c$,"getFractional2DValue",function(a,b,c,d,h,e){c+=a*(d-c);return c+b*(h+a*(e-h)-c)},"~N,~N,~N,~N,~N,~N");e(c$,"indexLower",function(a,b){if(this.isPeriodic&&0<b){for(;0>a;)a+=b;for(;a>=b;)a-=b;return v(Math.floor(a))}if(0>a)return 0;var c=v(Math.floor(a));return c>b?b:c},"~N,~N");
e(c$,"indexUpper",function(a,b,c){return!this.isPeriodic&&0>a||b==c?b:b+1},"~N,~N,~N");e(c$,"offsetCenter",function(a){var b=new JU.P3;b.scaleAdd2((this.voxelCounts[0]-1)/2,this.volumetricVectors[0],b);b.scaleAdd2((this.voxelCounts[1]-1)/2,this.volumetricVectors[1],b);b.scaleAdd2((this.voxelCounts[2]-1)/2,this.volumetricVectors[2],b);this.volumetricOrigin.sub2(a,b)},"JU.P3");j(c$,"setDataDistanceToPlane",function(a){this.setPlaneParameters(a);a=this.voxelCounts[0];var b=this.voxelCounts[1],c=this.voxelCounts[2];
this.voxelData=u(a,b,c,0);for(var d=0;d<a;d++)for(var h=0;h<b;h++)for(var e=0;e<c;e++)this.voxelData[d][h][e]=this.calcVoxelPlaneDistance(d,h,e)},"JU.P4");j(c$,"filterData",function(a,b){var c=!Float.isNaN(b);if(null!=this.sr)this.isSquared=a;else{var d=this.voxelCounts[0],h=this.voxelCounts[1],e=this.voxelCounts[2];if(a)for(var f=0;f<d;f++)for(var l=0;l<h;l++)for(var k=0;k<e;k++)this.voxelData[f][l][k]*=this.voxelData[f][l][k];if(c)for(f=0;f<d;f++)for(l=0;l<h;l++)for(k=0;k<e;k++)this.voxelData[f][l][k]=
b-this.voxelData[f][l][k]}},"~B,~N");j(c$,"capData",function(a,b){if(null!=this.voxelData){var c=this.voxelCounts[0],d=this.voxelCounts[1],h=this.voxelCounts[2],e=JU.V3.new3(a.x,a.y,a.z);e.normalize();for(var f=0;f<c;f++)for(var l=0;l<d;l++)for(var k=0;k<h;k++){var m=this.voxelData[f][l][k]-b;this.voxelPtToXYZ(f,l,k,this.ptXyzTemp);var p=(this.ptXyzTemp.x*e.x+this.ptXyzTemp.y*e.y+this.ptXyzTemp.z*e.z+a.w-b)/1;if(0<=p||p>m)this.voxelData[f][l][k]=p}}},"JU.P4,~N");e(c$,"setVolumetricXml",function(){var a=
new JU.SB;if(0==this.voxelCounts[0])a.append("<jvxlVolumeData>\n");else{a.append('<jvxlVolumeData origin="'+JU.Escape.eP(this.volumetricOrigin)+'">\n');for(var b=0;3>b;b++)a.append('<jvxlVolumeVector type="'+b+'" count="'+this.voxelCounts[b]+'" vector="'+JU.Escape.eP(this.volumetricVectors[b])+'"></jvxlVolumeVector>\n')}a.append("</jvxlVolumeData>\n");return this.xmlData=a.toString()});e(c$,"setVoxelMapValue",function(a,b,c,d){null!=this.voxelMap&&this.voxelMap.put(Integer.$valueOf(this.getPointIndex(a,
b,c)),Float.$valueOf(d))},"~N,~N,~N,~N");e(c$,"calculateFractionalPoint",function(a,b,c,d,h,e){var f=h-d,l=(a-d)/f;this.edgeVector.sub2(c,b);e.scaleAdd2(l,this.edgeVector,b);if(null==this.sr||!this.doIterate||h==d||0.01>l||0.99<l||0.01>this.edgeVector.length())return a;b=0;this.ptTemp.setT(e);c=this.lookupInterpolatedVoxelValue(this.ptTemp,!1);for(h=NaN;10>++b;){var k=(c-d)/f;if(0>k||1<k)break;k=(a-c)/f/2;l+=k;if(0>l||1<l)break;e.setT(this.ptTemp);h=c;if(0.005>Math.abs(k))break;this.ptTemp.scaleAdd2(k,
this.edgeVector,e);c=this.lookupInterpolatedVoxelValue(this.ptTemp,!1)}return h},"~N,JU.P3,JU.P3,~N,~N,JU.P3")});y("J.jvxl.data");z(null,"J.jvxl.data.JvxlData",["java.lang.Float","JU.SB","J.jvxl.data.JvxlCoder"],function(){c$=x(function(){this.wasCubic=this.wasJvxl=!1;this.jvxlPlane=this.jvxlExcluded=this.jvxlVolumeDataXml=this.jvxlColorData=this.jvxlEdgeData=this.jvxlSurfaceData=this.jvxlFileMessage=this.jvxlFileTitle=null;this.isColorReversed=this.jvxlDataIsColorDensity=this.jvxlDataIs2dContour=
this.jvxlDataIsColorMapped=this.isJvxlPrecisionColor=!1;this.thisSet=-2147483648;this.edgeFractionBase=35;this.edgeFractionRange=90;this.colorFractionBase=35;this.colorFractionRange=90;this.vertexDataOnly=this.isCutoffAbsolute=this.isTruncated=this.isBicolorMap=this.isContoured=this.isXLowToHigh=this.insideOut=this.dataXYReversed=!1;this.vertexCount=this.nSurfaceInts=this.nEdges=this.nContours=this.nBytes=this.nPointsZ=this.nPointsY=this.nPointsX=this.pointsPerAngstrom=this.cutoff=this.valueMappedToBlue=
this.valueMappedToRed=this.mappedDataMax=this.mappedDataMin=0;this.contourValuesUsed=this.contourValues=this.contourColors=this.contourColixes=this.vContours=null;this.scale3d=0;this.minColorIndex=-1;this.maxColorIndex=0;this.boundingBox=this.version=this.title=null;this.excludedVertexCount=this.excludedTriangleCount=0;this.colorDensity=!1;this.pointSize=0;this.moleculeXml=null;this.saveVertexCount=this.dataMax=this.dataMin=0;this.vertexColorMap=null;this.nVertexColors=0;this.meshColor=this.color=
this.vertexColors=null;this.translucency=0;this.rendering=this.colorScheme=null;this.slabValue=-2147483648;this.isSlabbable=!1;this.diameter=0;this.slabInfo=null;this.allowVolumeRender=!1;this.voxelVolume=0;this.baseColor=this.mapLattice=null;A(this,arguments)},J.jvxl.data,"JvxlData");G(c$,function(){this.jvxlExcluded=Array(4)});C(c$,function(){});e(c$,"clear",function(){this.allowVolumeRender=!0;this.jvxlVolumeDataXml=this.jvxlColorData=this.jvxlEdgeData=this.jvxlSurfaceData="";this.colorScheme=
this.color=null;this.colorDensity=!1;this.pointSize=NaN;this.contourColors=this.contourColixes=this.contourValuesUsed=this.contourValues=null;this.isSlabbable=!1;this.meshColor=this.mapLattice=null;this.nVertexColors=this.nPointsX=0;this.slabInfo=null;this.thisSet=this.slabValue=-2147483648;this.rendering=null;this.translucency=0;this.vertexColors=this.vertexColorMap=this.vContours=null;this.voxelVolume=0});e(c$,"setSurfaceInfo",function(a,b,c,d){this.jvxlSurfaceData=d;0==this.jvxlSurfaceData.indexOf("--")&&
(this.jvxlSurfaceData=this.jvxlSurfaceData.substring(2));this.jvxlPlane=a;this.mapLattice=b;this.nSurfaceInts=c},"JU.P4,JU.P3,~N,~S");e(c$,"setSurfaceInfoFromBitSet",function(a,b){this.setSurfaceInfoFromBitSetPts(a,b,null)},"JU.BS,JU.P4");e(c$,"setSurfaceInfoFromBitSetPts",function(a,b,c){var d=new JU.SB;a=null!=b?0:J.jvxl.data.JvxlCoder.jvxlEncodeBitSetBuffer(a,this.nPointsX*this.nPointsY*this.nPointsZ,d);this.setSurfaceInfo(b,c,a,d.toString())},"JU.BS,JU.P4,JU.P3");e(c$,"jvxlUpdateInfo",function(a,
b){this.title=a;this.nBytes=b},"~A,~N");c$.updateSurfaceData=e(c$,"updateSurfaceData",function(a,b,c,d,h){if(0==a.length)return"";a=a.toCharArray();for(var e=0,f=0;e<c;e+=d,f++)Float.isNaN(b[e])&&(a[f]=h);return String.copyValueOf(a)},"~S,~A,~N,~N,~S")});y("J.jvxl.data");z(["JU.MeshSurface"],"J.jvxl.data.MeshData",["java.lang.Float","java.util.Arrays","JU.AU","$.BS","$.V3"],function(){c$=x(function(){this.setsSuccessful=!1;this.vertexIncrement=1;this.polygonColorData=null;O("J.jvxl.data.MeshData.SSet")||
J.jvxl.data.MeshData.$MeshData$SSet$();O("J.jvxl.data.MeshData.SortSet")||J.jvxl.data.MeshData.$MeshData$SortSet$();A(this,arguments)},J.jvxl.data,"MeshData",JU.MeshSurface);e(c$,"addVertexCopy",function(a,b,c,d){0>c&&(this.vertexIncrement=-c);return this.addVCVal(a,b,d)},"JU.T3,~N,~N,~B");e(c$,"getSurfaceSet",function(){return null==this.surfaceSet?this.getSurfaceSetForLevel(0):this.surfaceSet});e(c$,"getSurfaceSetForLevel",function(a){0==a&&(this.surfaceSet=Array(100),this.nSets=0);this.setsSuccessful=
!0;for(var b=0;b<this.pc;b++)if(null!=this.pis[b]&&(null==this.bsSlabDisplay||this.bsSlabDisplay.get(b))){var c=this.pis[b],d=this.findSet(c[0]),h=this.findSet(c[1]),e=this.findSet(c[2]);0>d&&0>h&&0>e?this.createSet(c[0],c[1],c[2]):d==h&&h==e||(0<=d?(this.surfaceSet[d].set(c[1]),this.surfaceSet[d].set(c[2]),0<=h&&h!=d&&this.mergeSets(d,h),0<=e&&(e!=d&&e!=h)&&this.mergeSets(d,e)):0<=h?(this.surfaceSet[h].set(c[0]),this.surfaceSet[h].set(c[2]),0<=e&&e!=h&&this.mergeSets(h,e)):(this.surfaceSet[e].set(c[0]),
this.surfaceSet[e].set(c[1])))}for(b=c=0;b<this.nSets;b++)null!=this.surfaceSet[b]&&c++;d=Array(this.surfaceSet.length);for(b=c=0;b<this.nSets;b++)null!=this.surfaceSet[b]&&(d[c++]=this.surfaceSet[b]);this.nSets=c;this.surfaceSet=d;!this.setsSuccessful&&2>a&&this.getSurfaceSetForLevel(a+1);0==a&&(this.sortSurfaceSets(),this.setVertexSets(!1));return this.surfaceSet},"~N");e(c$,"sortSurfaceSets",function(){for(var a=Array(this.nSets),b=0;b<this.nSets;b++)a[b]=N(J.jvxl.data.MeshData.SSet,this,null,
this.surfaceSet[b]);java.util.Arrays.sort(a,N(J.jvxl.data.MeshData.SortSet,this,null));for(b=0;b<this.nSets;b++)this.surfaceSet[b]=a[b].bs});e(c$,"setVertexSets",function(a){if(null!=this.surfaceSet){for(var b=0,c=0;c<this.nSets;c++)null!=this.surfaceSet[c]&&0==this.surfaceSet[c].cardinality()&&(this.surfaceSet[c]=null),null==this.surfaceSet[c]&&b++;if(0<b){a=Array(this.nSets-b);for(var d=c=0;c<this.nSets;c++)null!=this.surfaceSet[c]&&(a[d++]=this.surfaceSet[c]);this.surfaceSet=a;this.nSets-=b}else if(a)return;
this.vertexSets=t(this.vc,0);for(c=0;c<this.nSets;c++)for(b=this.surfaceSet[c].nextSetBit(0);0<=b;b=this.surfaceSet[c].nextSetBit(b+1))this.vertexSets[b]=c}},"~B");e(c$,"findSet",function(a){for(var b=0;b<this.nSets;b++)if(null!=this.surfaceSet[b]&&this.surfaceSet[b].get(a))return b;return-1},"~N");e(c$,"createSet",function(a,b,c){var d;for(d=0;d<this.nSets&&null!=this.surfaceSet[d];d++);d==this.surfaceSet.length&&(this.surfaceSet=JU.AU.ensureLength(this.surfaceSet,this.surfaceSet.length+100));this.surfaceSet[d]=
new JU.BS;this.surfaceSet[d].set(a);this.surfaceSet[d].set(b);this.surfaceSet[d].set(c);d==this.nSets&&this.nSets++},"~N,~N,~N");e(c$,"mergeSets",function(a,b){this.surfaceSet[a].or(this.surfaceSet[b]);this.surfaceSet[b]=null},"~N,~N");e(c$,"invalidateSurfaceSet",function(a){for(var b=this.surfaceSet[a].nextSetBit(0);0<=b;b=this.surfaceSet[a].nextSetBit(b+1))this.vvs[b]=NaN;this.surfaceSet[a]=null},"~N");c$.checkCutoff=e(c$,"checkCutoff",function(a,b,c,d){if(0>a||0>b||0>c)return!1;a=d[a];b=d[b];c=
d[c];return 0<=a&&0<=b&&0<=c||0>=a&&0>=b&&0>=c},"~N,~N,~N,~A");e(c$,"calculateVolumeOrArea",function(a,b,c){(c||0==this.nSets)&&this.getSurfaceSet();for(var d=(c=-1<=a)||0==this.nSets?1:this.nSets,h=U(d,0),e=new JU.V3,f=new JU.V3,l=new JU.V3,k=this.pc;0<=--k;)if(this.setABC(k)){var m=0==this.nSets?0:this.vertexSets[this.iA];0<=a&&m!=a||(b?(e.sub2(this.vs[this.iB],this.vs[this.iA]),f.sub2(this.vs[this.iC],this.vs[this.iA]),l.cross(e,f),h[c?0:m]+=l.length()):(e.setT(this.vs[this.iB]),f.setT(this.vs[this.iC]),
l.cross(e,f),f.setT(this.vs[this.iA]),h[c?0:m]+=f.dot(l)))}a=b?2:6;for(k=0;k<d;k++)h[k]/=a;return c?Float.$valueOf(h[0]):h},"~N,~B,~B");e(c$,"updateInvalidatedVertices",function(a){a.clearAll();for(var b=0;b<this.vc;b+=this.vertexIncrement)Float.isNaN(this.vvs[b])&&a.set(b)},"JU.BS");e(c$,"invalidateVertices",function(a){for(var b=a.nextSetBit(0);0<=b;b=a.nextSetBit(b+1))this.vvs[b]=NaN},"JU.BS");c$.$MeshData$SSet$=function(){M(self.c$);c$=x(function(){P(this,arguments);this.bs=null;this.n=0;A(this,
arguments)},J.jvxl.data.MeshData,"SSet");C(c$,function(a){this.bs=a;this.n=a.cardinality()},"JU.BS");c$=L()};c$.$MeshData$SortSet$=function(){M(self.c$);c$=x(function(){P(this,arguments);A(this,arguments)},J.jvxl.data.MeshData,"SortSet",null,java.util.Comparator);j(c$,"compare",function(a,b){return a.n>b.n?-1:a.n<b.n?1:0},"J.jvxl.data.MeshData.SSet,J.jvxl.data.MeshData.SSet");c$=L()};H(c$,"MODE_GET_VERTICES",1,"MODE_GET_COLOR_INDEXES",2,"MODE_PUT_SETS",3,"MODE_PUT_VERTICES",4)});y("J.jvxl.readers");
z(null,"J.jvxl.readers.XmlReader",["java.lang.Character","JU.P3","$.SB","$.XmlUtil","JU.Escape"],function(){c$=x(function(){this.line=this.br=null;A(this,arguments)},J.jvxl.readers,"XmlReader");e(c$,"getLine",function(){return this.line});C(c$,function(a){this.br=a},"java.io.BufferedReader");e(c$,"toTag",function(a){this.skipTo("<"+a);if(null==this.line)return"";var b=this.line.indexOf("<"+a)+a.length+1;if(b==this.line.length||" "==this.line.charAt(b)||">"==this.line.charAt(b))return this.line;this.line=
null;return this.toTag(a)},"~S");e(c$,"skipTag",function(a){this.skipTo("</"+a+">")},"~S");e(c$,"getXmlData",function(a,b,c,d){var h="</"+a+">";a="<"+a;if(null==b){b=new JU.SB;try{null==this.line&&(this.line=this.br.readLine());for(;0>this.line.indexOf(a);)this.line=this.br.readLine()}catch(e){if(D(e,Exception))return null;throw e;}b.append(this.line);var f=!1,l=this.line.indexOf("/>"),k=this.line.indexOf(">");if(0>k||l==k-1)f=d;for(;0>this.line.indexOf(h)&&(!f||0>this.line.indexOf("/>"));)b.append(this.line=
this.br.readLine());b=b.toString()}return J.jvxl.readers.XmlReader.extractTag(b,a,h,c)},"~S,~S,~B,~B");c$.extractTagOnly=e(c$,"extractTagOnly",function(a,b){return J.jvxl.readers.XmlReader.extractTag(a,"<"+b+">","</"+b+">",!1)},"~S,~S");c$.extractTag=e(c$,"extractTag",function(a,b,c,d){b=a.indexOf(b);if(0>b)return"";var h=a.indexOf(c,b);0>h&&(h=a.indexOf("/>",b),c="/>");if(0>h)return"";if(d)return h+=c.length,a.substring(b,h);for(c=!1;b<h;b++)if('"'==(d=a.charAt(b)))c=!c;else if(c&&"\\"==d)b++;else if(!c&&
(">"==d||"/"==d))break;if(b>=h)return"";for(;Character.isWhitespace(a.charAt(++b)););return JU.XmlUtil.unwrapCdata(a.substring(b,h))},"~S,~S,~S,~B");c$.getXmlAttrib=e(c$,"getXmlAttrib",function(a,b){var c=t(1,0),d=J.jvxl.readers.XmlReader.setNext(a,b,c,1);if(2>d||2>(d=J.jvxl.readers.XmlReader.setNext(a,'"',c,0)))return"";c=J.jvxl.readers.XmlReader.setNext(a,'"',c,-1);return 0>=c?"":a.substring(d,c)},"~S,~S");e(c$,"getXmlPoint",function(a,b){var c=J.jvxl.readers.XmlReader.getXmlAttrib(a,b).$replace("(",
"{").$replace(")","}"),c=JU.Escape.uP(c);return F(c,JU.P3)?c:new JU.P3},"~S,~S");c$.setNext=e(c$,"setNext",function(a,b,c,d){var h=c[0];if(0>h||0>(h=a.indexOf(b,c[0])))return-1;h+=b.length;c[0]=h+d;return 0<d&&h<a.length&&"="!=a.charAt(h)?J.jvxl.readers.XmlReader.setNext(a,b,c,d):c[0]},"~S,~S,~A,~N");e(c$,"skipTo",function(a){null==this.line&&(this.line=this.br.readLine());for(;null!=this.line&&0>this.line.indexOf(a);)this.line=this.br.readLine()},"~S");e(c$,"isNext",function(a){if(null==this.line||
0<=this.line.indexOf("</")&&this.line.indexOf("</")==this.line.indexOf("<"))this.line=this.br.readLine();return 0<=this.line.indexOf("<"+a)},"~S")});y("J.jvxl.readers");z(["JU.P3","$.V3"],"J.jvxl.readers.SurfaceGenerator","java.lang.Float java.util.Map JU.AU $.BS $.P4 $.PT $.Rdr J.io.JmolBinary J.jvxl.data.JvxlCoder $.JvxlData $.MeshData $.VolumeData J.jvxl.readers.Parameters $.SurfaceReader JU.Logger $.Measure".split(" "),function(){c$=x(function(){this.version=this.marchingSquares=this.atomDataServer=
this.meshDataServer=this.volumeData=this.params=this.meshData=this.jvxlData=null;this.$isValid=!0;this.surfaceReader=this.out=this.fileType=null;this.colorPtr=0;this.bsVdw=this.ptRef=this.vNorm=this.vAB=this.vAC=this.readerData=null;A(this,arguments)},J.jvxl.readers,"SurfaceGenerator");G(c$,function(){this.vAC=new JU.V3;this.vAB=new JU.V3;this.vNorm=new JU.V3;this.ptRef=JU.P3.new3(0,0,1E15)});e(c$,"isValid",function(){return this.$isValid});e(c$,"getFileType",function(){return this.fileType});e(c$,
"setVersion",function(a){this.version=a},"~S");C(c$,function(a,b,c,d){this.atomDataServer=a;this.meshDataServer=b;this.params=new J.jvxl.readers.Parameters;this.meshData=null==c?new J.jvxl.data.MeshData:c;this.jvxlData=null==d?new J.jvxl.data.JvxlData:d;this.volumeData=new J.jvxl.data.VolumeData;this.initializeIsosurface()},"J.atomdata.AtomDataServer,J.jvxl.api.MeshDataServer,J.jvxl.data.MeshData,J.jvxl.data.JvxlData");e(c$,"isStateDataRead",function(){return 2==this.params.state});e(c$,"getFileName",
function(){return this.params.fileName});e(c$,"getMeshDataServer",function(){return this.meshDataServer});e(c$,"getAtomDataServer",function(){return this.atomDataServer});e(c$,"getColorEncoder",function(){return this.params.colorEncoder});e(c$,"getVertexSource",function(){return this.params.vertexSource});e(c$,"setJvxlData",function(a){this.jvxlData=a;null!=a&&(a.version=this.version)},"J.jvxl.data.JvxlData");e(c$,"getJvxlData",function(){return this.jvxlData});e(c$,"getMeshData",function(){return this.meshData});
e(c$,"setMarchingSquares",function(a){this.marchingSquares=a},"J.jvxl.calc.MarchingSquares");e(c$,"getMarchingSquares",function(){return this.marchingSquares});e(c$,"getParams",function(){return this.params});e(c$,"getScript",function(){return this.params.script});e(c$,"getTitle",function(){return this.params.title});e(c$,"getBsSelected",function(){return this.params.bsSelected});e(c$,"getBsIgnore",function(){return this.params.bsIgnore});e(c$,"getVolumeData",function(){return this.volumeData});e(c$,
"getPlane",function(){return this.params.thePlane});e(c$,"getColor",function(a){switch(a){case -1:return this.params.colorNeg;case 1:return this.params.colorPos}return 0},"~N");e(c$,"setModelIndex",function(a){this.params.modelIndex=a},"~N");e(c$,"getIAddGridPoints",function(){return this.params.iAddGridPoints});e(c$,"getIsPositiveOnly",function(){return this.params.isPositiveOnly});e(c$,"isInsideOut",function(){return this.params.insideOut!=this.params.dataXYReversed});e(c$,"getCutoff",function(){return this.params.cutoff});
e(c$,"getMoData",function(){return this.params.moData});e(c$,"isCubeData",function(){return this.jvxlData.wasCubic});e(c$,"setParameter",function(a,b){return this.setProp(a,b,null)},"~S,~O");e(c$,"setProp",function(a,b){if("debug"===a){var c=b.booleanValue();this.params.logMessages=c;this.params.logCube=c;return!0}if("init"===a)return this.initializeIsosurface(),F(b,J.jvxl.readers.Parameters)?this.params=b:(this.params.script=b,null!=this.params.script&&0<=this.params.script.indexOf(";#")&&(this.params.script=
JU.PT.rep(this.params.script,";#","; #"))),!1;if("map"===a)return this.params.resetForMapping(b.booleanValue()),null!=this.surfaceReader&&(this.surfaceReader.minMax=null),!0;if("finalize"===a)return this.initializeIsosurface(),!0;if("clear"===a)return null!=this.surfaceReader&&this.surfaceReader.discardTempData(!0),!1;if("fileIndex"===a)return this.params.fileIndex=b.intValue(),0>this.params.fileIndex&&(this.params.fileIndex=0),this.params.readAllData=!1,!0;if("blockData"===a)return this.params.blockCubeData=
b.booleanValue(),!0;if("withinPoints"===a)return this.params.boundingBox=b[1],!0;if("boundingBox"===a)return this.params.boundingBox=[JU.P3.newP(b[0]),JU.P3.newP(b[b.length-1])],!0;if("func"===a)return this.params.func=b,!0;if("intersection"===a)return this.params.intersection=b,!0;if("bsSolvent"===a)return this.params.bsSolvent=b,!0;if("select"===a)return this.params.bsSelected=b,!0;if("ignore"===a)return this.params.bsIgnore=b,!0;if("propertySmoothing"===a)return this.params.propertySmoothing=b.booleanValue(),
!0;if("propertyDistanceMax"===a)return this.params.propertyDistanceMax=b.floatValue(),!0;if("propertySmoothingPower"===a)return this.params.propertySmoothingPower=b.intValue(),!0;if("title"===a){if(null==b)this.params.title=null;else if(JU.PT.isAS(b)){this.params.title=b;for(var d=0;d<this.params.title.length;d++)0<this.params.title[d].length&&JU.Logger.info(this.params.title[d])}return!0}if("sigma"===a)return this.params.cutoff=this.params.sigma=b.floatValue(),this.params.isPositiveOnly=!1,this.params.cutoffAutomatic=
!1,!0;if("cutoff"===a)return this.params.cutoff=b.floatValue(),this.params.isPositiveOnly=!1,this.params.cutoffAutomatic=!1,!0;if("parameters"===a)return this.params.parameters=JU.AU.ensureLengthA(b,2),0<this.params.parameters.length&&0!=this.params.parameters[0]&&(this.params.cutoff=this.params.parameters[0]),!0;if("cutoffPositive"===a)return this.params.cutoff=b.floatValue(),this.params.isPositiveOnly=!0;if("cap"===a||"slab"===a)return null!=b&&this.params.addSlabInfo(b),!0;if("scale"===a)return this.params.scale=
b.floatValue(),!0;if("scale3d"===a)return this.params.scale3d=b.floatValue(),!0;if("angstroms"===a)return this.params.isAngstroms=!0;if("resolution"===a)return c=b.floatValue(),this.params.resolution=0<c?c:3.4028235E38,!0;if("downsample"===a)return c=b.intValue(),this.params.downsampleFactor=0<=c?c:0,!0;if("anisotropy"===a)return 0==(this.params.dataType&32)&&this.params.setAnisotropy(b),!0;if("eccentricity"===a)return this.params.setEccentricity(b),!0;if("addHydrogens"===a)return this.params.addHydrogens=
b.booleanValue(),!0;if("squareData"===a)return this.params.isSquared=null==b?!1:b.booleanValue(),!0;if("squareLinear"===a)return this.params.isSquaredLinear=null==b?!1:b.booleanValue(),!0;if("gridPoints"===a)return this.params.iAddGridPoints=!0;if("atomIndex"===a)return this.params.atomIndex=b.intValue(),!0;if("insideOut"===a)return this.params.insideOut=!0;if("sign"===a)return this.params.isCutoffAbsolute=!0,this.params.colorBySign=!0,this.colorPtr=0,!0;if("colorRGB"===a)return c=b.intValue(),this.params.colorRgb=
this.params.colorPos=this.params.colorPosLCAO=c,0==this.colorPtr++?this.params.colorNeg=this.params.colorNegLCAO=c:this.params.colorRgb=2147483647,!0;if("monteCarloCount"===a)return this.params.psi_monteCarloCount=b.intValue(),!0;if("rangeAll"===a)return this.params.rangeAll=!0;if("rangeSelected"===a)return this.params.rangeSelected=!0;if("red"===a)return this.params.valueMappedToRed=b.floatValue(),!0;if("blue"===a)return this.params.valueMappedToBlue=b.floatValue(),this.params.valueMappedToRed>this.params.valueMappedToBlue&&
(c=this.params.valueMappedToRed,this.params.valueMappedToRed=this.params.valueMappedToBlue,this.params.valueMappedToBlue=c,this.params.isColorReversed=!this.params.isColorReversed),this.params.rangeDefined=!0,this.params.rangeAll=!1,!0;if("reverseColor"===a)return this.params.isColorReversed=!0;if("setColorScheme"===a)return this.getSurfaceSets(),this.params.colorBySets=!0,this.mapSurface(),!0;if("center"===a)return this.params.center.setT(b),!0;if("volumeData"===a)return this.params.volumeData=b,
!0;if("origin"===a)return this.params.origin=b,!0;if("step"===a)return this.params.steps=b,!0;if("point"===a)return this.params.points=b,!0;if("withinDistance"===a)return this.params.distance=b.floatValue(),!0;if("withinPoint"===a)return this.params.point=b,!0;if("progressive"===a)return this.params.isXLowToHigh=!0;if("phase"===a)return this.params.isCutoffAbsolute=!0,this.params.colorBySign=!0,this.params.colorByPhase=!0,this.params.colorPhase=J.jvxl.readers.SurfaceReader.getColorPhaseIndex(b),0>
this.params.colorPhase&&(JU.Logger.warn(" invalid color phase: "+b),this.params.colorPhase=0),this.params.colorByPhase=0!=this.params.colorPhase,2<=this.params.state&&(this.params.dataType=this.params.surfaceType,this.params.state=3,this.params.isBicolorMap=!0,this.surfaceReader.applyColorScale()),!0;if("radius"===a)return JU.Logger.info("solvent probe radius set to "+b),this.params.atomRadiusData=b,!0;if("envelopeRadius"===a)return this.params.envelopeRadius=b.floatValue(),!0;if("cavityRadius"===
a)return this.params.cavityRadius=b.floatValue(),!0;if("cavity"===a)return this.params.isCavity=!0;if("doFullMolecular"===a)return this.params.doFullMolecular=!0;if("pocket"===a)return this.params.pocket=b,this.params.fullyLit=this.params.pocket.booleanValue(),!0;if("minset"===a)return this.params.minSet=b.intValue(),!0;if("maxset"===a)return this.params.maxSet=b.intValue(),!0;if("plane"===a)return this.params.setPlane(b),!0;if("contour"===a){this.params.isContoured=!0;if(JU.PT.isAF(b))this.params.contoursDiscrete=
b,this.params.nContours=this.params.contoursDiscrete.length;else if(F(b,JU.P3)){var c=this.params.contourIncrements=b,d=c.x,h=c.y,e=c.z;0>=e&&(e=1);for(var c=0,f=d;f<=h+e/10;f+=e,c++);this.params.contoursDiscrete=u(c,0);f=d;for(d=0;d<c;d++,f+=e)this.params.contoursDiscrete[d]=f;this.params.nContours=c}else c=b.intValue(),0==c?this.params.nContours=9:0<c?this.params.nContours=c:this.params.thisContour=-c;return!0}if("colorDiscrete"===a)return this.params.contourColixes=b,!0;if("colorDensity"===a)return this.params.colorDensity=
!0,null!=b&&(this.params.pointSize=b.floatValue()),!1;if("fullPlane"===a)return this.params.contourFromZero=!b.booleanValue(),!0;if("mapLattice"===a)return this.params.mapLattice=b,!0;if("property"===a)return this.params.dataType=1206,this.params.theProperty=b,this.mapSurface(),!0;if("sphere"===a)return this.params.setSphere(b.floatValue(),!1),this.readerData=Float.$valueOf(this.params.distance),this.surfaceReader=this.newReader("IsoShapeReader"),this.generateSurface(),!0;if("geodesic"===a)return this.params.setSphere(b.floatValue(),
!0),this.readerData=Float.$valueOf(this.params.distance),this.surfaceReader=this.newReader("IsoShapeReader"),this.generateSurface(),!0;if("ellipsoid"===a){if(F(b,JU.P4))this.params.setEllipsoidP4(b);else if(JU.PT.isAF(b))this.params.setEllipsoidAF(b);else return!0;this.readerData=Float.$valueOf(this.params.distance);this.surfaceReader=this.newReader("IsoShapeReader");this.generateSurface();return!0}if("ellipsoid3"===a)return this.params.setEllipsoidAF(b),this.readerData=Float.$valueOf(this.params.distance),
this.surfaceReader=this.newReader("IsoShapeReader"),this.generateSurface(),!0;if("lp"===a)return this.params.setLp(b),this.readerData=[3,2,0,15,0],this.surfaceReader=this.newReader("IsoShapeReader"),this.generateSurface(),!0;if("rad"===a)return this.params.setRadical(b),this.readerData=[3,2,0,15,0],this.surfaceReader=this.newReader("IsoShapeReader"),this.generateSurface(),!0;if("lobe"===a)return this.params.setLobe(b),this.readerData=[3,2,0,15,0],this.surfaceReader=this.newReader("IsoShapeReader"),
this.generateSurface(),!0;if("hydrogenOrbital"===a){if(!this.params.setAtomicOrbital(b))return this.$isValid=!1,!0;this.readerData=[this.params.psi_n,this.params.psi_l,this.params.psi_m,this.params.psi_Znuc,this.params.psi_monteCarloCount];this.surfaceReader=this.newReader("IsoShapeReader");this.processState();return!0}if("functionXY"===a)return this.params.setFunctionXY(b),this.params.isContoured&&this.volumeData.setPlaneParameters(JU.P4.new4(0,0,1,0)),0<=this.params.functionInfo.get(0).indexOf("_xyz")&&
this.getFunctionZfromXY(),this.processState(),!0;if("functionXYZ"===a)return this.params.setFunctionXYZ(b),this.processState(),!0;if("lcaoType"===a)return this.params.setLcao(b,this.colorPtr),!0;if("lcaoCartoonCenter"===a){if(2!=++this.params.state)return!0;3.4028235E38==this.params.center.x&&this.params.center.setT(b);return!1}if("molecular"===a||"solvent"===a||"sasurface"===a||"nomap"===a)return this.params.setSolvent(a,b.floatValue()),JU.Logger.info(this.params.calculationType),this.processState(),
!0;if("moData"===a)return this.params.moData=b,!0;if("mepCalcType"===a)return this.params.mep_calcType=b.intValue(),!0;if("mep"===a)return this.params.setMep(b,!1),this.processState(),!0;if("mlp"===a)return this.params.setMep(b,!0),this.processState(),!0;if("nci"===a)return c=b.booleanValue(),this.params.setNci(c),c&&this.processState(),!0;if("calculationType"===a)return this.params.calculationType=b,!0;if("charges"===a)return this.params.theProperty=b,!0;if("randomSeed"===a)return this.params.randomSeed=
b.intValue(),!0;if("molecularOrbital"===a)return c=0,d=null,F(b,Integer)?c=b.intValue():d=b,this.params.setMO(c,d),JU.Logger.info(this.params.calculationType),this.processState(),!0;if("fileType"===a)return this.fileType=b,!0;if("fileName"===a)return this.params.fileName=b,!0;if("outputChannel"===a)return this.out=b,!0;if("readFile"===a){if(null==(this.surfaceReader=this.setFileData(b)))return JU.Logger.error("Could not set the surface data"),!0;this.surfaceReader.setOutputChannel(this.out);this.generateSurface();
return!0}if("getSurfaceSets"===a)return this.getSurfaceSets(),!0;if("mapColor"===a){if(null==(this.surfaceReader=this.setFileData(b)))return JU.Logger.error("Could not set the mapping data"),!0;this.surfaceReader.setOutputChannel(this.out);this.mapSurface();return!0}"periodic"===a&&(this.params.isPeriodic=!0);return!1},"~S,~O,JU.BS");e(c$,"newReader",function(a){a=J.jvxl.readers.SurfaceGenerator.getInterface(a);null!=a&&a.init(this);return a},"~S");e(c$,"newReaderBr",function(a,b){var c=J.jvxl.readers.SurfaceGenerator.getInterface(a);
null!=c&&c.init2(this,b);return c},"~S,java.io.BufferedReader");c$.getInterface=e(c$,"getInterface",function(a){try{var b=S._4Name("J.jvxl.readers."+a);return null==b?null:b.newInstance()}catch(c){if(D(c,Exception))return JU.Logger.error("Interface.java Error creating instance for "+a+": \n"+c.toString()),null;throw c;}},"~S");e(c$,"getSurfaceSets",function(){null==this.meshDataServer?this.meshData.getSurfaceSet():(this.meshDataServer.fillMeshData(this.meshData,1,null),this.meshData.getSurfaceSet(),
this.meshDataServer.fillMeshData(this.meshData,3,null))});e(c$,"processState",function(){1==this.params.state&&null!=this.params.thePlane&&this.params.state++;2<=this.params.state?this.mapSurface():this.generateSurface()});e(c$,"setReader",function(){this.readerData=null;if(null!=this.surfaceReader)return!this.surfaceReader.vertexDataOnly;switch(this.params.dataType){case 1205:this.surfaceReader=this.newReader("IsoPlaneReader");break;case 1206:this.surfaceReader=this.newReader("AtomPropertyMapper");
break;case 1328:case 1329:this.readerData=1328==this.params.dataType?"Mep":"Mlp";this.surfaceReader=3==this.params.state?this.newReader("AtomPropertyMapper"):this.newReader("Iso"+this.readerData+"Reader");break;case 1333:this.surfaceReader=this.newReader("IsoIntersectReader");break;case 1195:case 1203:case 1196:this.surfaceReader=this.newReader("IsoSolventReader");break;case 1844:case 1837:this.surfaceReader=this.newReader("IsoMOReader");break;case 8:this.surfaceReader=this.newReader("IsoFxyReader");
break;case 9:this.surfaceReader=this.newReader("IsoFxyzReader")}JU.Logger.info("Using surface reader "+this.surfaceReader);return!0});e(c$,"generateSurface",function(){if(2==++this.params.state){this.setReader();var a=null!=this.meshDataServer;this.params.colorBySign&&(this.params.isBicolorMap=!0);if(null==this.surfaceReader)JU.Logger.error("surfaceReader is null for "+this.params.dataType);else if(this.surfaceReader.createIsosurface(!1)){null!=this.params.pocket&&a&&this.surfaceReader.selectPocket(!this.params.pocket.booleanValue());
0<this.params.minSet&&this.surfaceReader.excludeMinimumSet();0<this.params.maxSet&&this.surfaceReader.excludeMaximumSet();null!=this.params.slabInfo&&this.surfaceReader.slabIsosurface(this.params.slabInfo);a&&this.meshDataServer.notifySurfaceGenerationCompleted();0<=this.jvxlData.thisSet&&this.getSurfaceSets();this.jvxlData.jvxlDataIs2dContour&&(this.surfaceReader.colorIsosurface(),this.params.state=3);this.jvxlData.jvxlDataIsColorDensity&&(this.params.state=3);if(this.params.colorBySign||this.params.isBicolorMap)this.params.state=
3,this.surfaceReader.applyColorScale();null!=this.jvxlData.vertexColorMap&&(this.jvxlData.vertexColorMap=null,this.surfaceReader.hasColorData=!1);this.surfaceReader.jvxlUpdateInfo();this.setMarchingSquares(this.surfaceReader.marchingSquares);this.surfaceReader.discardTempData(!1);this.params.mappedDataMin=3.4028235E38;this.surfaceReader.closeReader();if(3!=this.params.state&&(this.surfaceReader.hasColorData||this.params.colorDensity))this.params.state=3,this.colorIsosurface();this.surfaceReader=null}else JU.Logger.error("Could not create isosurface"),
this.params.cutoff=NaN,this.surfaceReader.closeReader()}});e(c$,"mapSurface",function(){1==this.params.state&&null!=this.params.thePlane&&this.params.state++;if(!(3>++this.params.state)&&this.setReader()){this.params.isPeriodic&&(this.volumeData.isPeriodic=!0);if(null!=this.params.thePlane){var a=this.params.isSquared;this.params.isSquared=!1;this.params.cutoff=0;this.volumeData.setMappingPlane(this.params.thePlane);this.surfaceReader.createIsosurface(!this.params.isPeriodic);this.volumeData.setMappingPlane(null);
null!=this.meshDataServer&&this.meshDataServer.notifySurfaceGenerationCompleted();if(1205==this.params.dataType){this.surfaceReader.discardTempData(!0);return}this.params.isSquared=a;this.params.mappedDataMin=3.4028235E38;this.surfaceReader.readVolumeData(!0);null!=this.params.mapLattice&&(this.volumeData.isPeriodic=!0)}else!this.params.colorBySets&&!this.params.colorDensity&&(this.surfaceReader.readAndSetVolumeParameters(!0),this.params.mappedDataMin=3.4028235E38,this.surfaceReader.readVolumeData(!0));
this.colorIsosurface();this.surfaceReader.closeReader();this.surfaceReader=null}});e(c$,"getSlabInfo",function(){return this.params.slabInfo});e(c$,"colorIsosurface",function(){this.surfaceReader.colorIsosurface();this.surfaceReader.jvxlUpdateInfo();this.surfaceReader.updateTriangles();this.surfaceReader.discardTempData(!0);null!=this.meshDataServer&&this.meshDataServer.notifySurfaceMappingCompleted()});e(c$,"getProperty",function(a,b){return"jvxlFileData"===a?J.jvxl.data.JvxlCoder.jvxlGetFile(this.jvxlData,
null,this.params.title,"",!0,b,null,null):"jvxlFileInfo"===a?J.jvxl.data.JvxlCoder.jvxlGetInfo(this.jvxlData):null},"~S,~N");e(c$,"setFileData",function(a){var b=this.fileType;this.fileType=null;if(F(a,J.jvxl.data.VolumeData))return this.volumeData=a,this.newReader("VolumeDataReader");if(F(a,java.util.Map)){if(a.containsKey("__pymolSurfaceData__"))return this.readerData=a,this.newReaderBr("PyMOLMeshReader",null);this.volumeData=a.get("volumeData");return this.newReader("VolumeDataReader")}var c=null;
F(a,String)&&(c=a,a=JU.Rdr.getBR(a));var d=a;null==b&&(b=J.io.JmolBinary.determineSurfaceFileType(d));if(null!=b&&b.startsWith("UPPSALA")){var h=this.params.fileName,h=h.substring(0,h.indexOf("/",10)),h=h+JU.PT.getQuotedStringAt(b,b.indexOf("A HREF")+1);this.params.fileName=h;a=this.atomDataServer.getBufferedInputStream(h);if(null==a)return JU.Logger.error("Isosurface: could not open file "+h),null;try{d=JU.Rdr.getBufferedReader(a,null)}catch(e){if(!D(e,Exception))throw e;}b=J.io.JmolBinary.determineSurfaceFileType(d)}null==
b&&(b="UNKNOWN");JU.Logger.info("data file type was determined to be "+b);if(b.equals("Jvxl+"))return this.newReaderBr("JvxlReader",d);this.readerData=[this.params.fileName,c];if(0<="MRC DELPHI DSN6".indexOf(b.toUpperCase())){try{d.close()}catch(f){if(!D(f,java.io.IOException))throw f;}d=null;b+="Binary"}return this.newReaderBr(b+"Reader",d)},"~O");e(c$,"getReaderData",function(){var a=this.readerData;this.readerData=null;return a});e(c$,"initializeIsosurface",function(){this.params.initialize();
this.colorPtr=0;this.marchingSquares=this.surfaceReader=null;this.initState()});e(c$,"initState",function(){this.params.state=1;this.params.dataType=this.params.surfaceType=0});e(c$,"setLcao",function(){this.params.colorPos=this.params.colorPosLCAO;this.params.colorNeg=this.params.colorNegLCAO;return this.params.lcaoType});e(c$,"getFunctionZfromXY",function(){for(var a=this.params.functionInfo.get(1),b=t(3,0),c=t(3,0),d=Array(3),h=0;3>h;h++){var e=this.params.functionInfo.get(h+2);b[h]=Math.abs(E(e.x));
d[h]=JU.V3.new3(e.y,e.z,e.w)}for(var e=b[0],b=b[1],f=new JU.P3,l=new JU.P3,k=new JU.P3,m=new JU.P3,p=this.params.functionInfo.get(5),j=u(e,b,0),q,h=0;h<e;h++)for(var s=0;s<b;s++){f.scaleAdd2(h,d[0],a);f.scaleAdd2(s,d[1],f);var r=J.jvxl.readers.SurfaceGenerator.findNearestThreePoints(f.x,f.y,p,c);l.set((q=p[c[0]])[0],q[1],q[2]);1E-5>r?f.z=q[2]:(k.set((q=p[c[1]])[0],q[1],q[2]),m.set((q=p[c[2]])[0],q[1],q[2]),f.z=this.distanceVerticalToPlane(f.x,f.y,l,k,m));j[h][s]=f.z}this.params.functionInfo.set(5,
j)});e(c$,"distanceVerticalToPlane",function(a,b,c,d,h){c=JU.Measure.getDirectedNormalThroughPoints(c,d,h,this.ptRef,this.vNorm,this.vAB,this.vAC);return(this.vNorm.x*a+this.vNorm.y*b+c)/-this.vNorm.z},"~N,~N,JU.P3,JU.P3,JU.P3");c$.findNearestThreePoints=e(c$,"findNearestThreePoints",function(a,b,c,d){var h,e,f,l,k,m,p;k=m=p=-1;e=f=l=3.4028235E38;for(var j=c.length;0<=--j;)h=(h=c[j][0]-a)*h+(h=c[j][1]-b)*h,h<e?(l=f,f=e,e=h,p=m,m=k,k=j):h<f?(l=f,f=h,p=m,m=j):h<l&&(l=h,p=j);d[0]=k;d[1]=m;d[2]=p;return e},
"~N,~N,~A,~A");e(c$,"addRequiredFile",function(a){null!=this.meshDataServer&&this.meshDataServer.addRequiredFile(a)},"~S");e(c$,"log",function(a){null==this.atomDataServer?System.out.println(a):this.atomDataServer.log(a)},"~S");e(c$,"setOutputChannel",function(a,b){null!=this.meshDataServer&&this.meshDataServer.setOutputChannel(a,b)},"javajs.api.GenericBinaryDocument,JU.OC");e(c$,"isFullyLit",function(){return null!=this.params.thePlane||this.params.fullyLit});e(c$,"geVdwBitSet",function(){return this.bsVdw});
e(c$,"fillAtomData",function(a,b){0!=(b&2)&&null!=a.bsSelected&&(null==this.bsVdw&&(this.bsVdw=new JU.BS),this.bsVdw.or(a.bsSelected));this.atomDataServer.fillAtomData(a,b)},"J.atomdata.AtomData,~N");e(c$,"getSpanningVectors",function(){return this.surfaceReader.getSpanningVectors()})});y("J.jvxl.readers");z(null,"J.jvxl.readers.Parameters","java.lang.Float java.util.Hashtable JU.A4 $.Lst $.M3 $.P3 $.P4 $.V3 JU.Escape $.Logger".split(" "),function(){c$=x(function(){this.testFlags=this.state=0;this.isSilent=
this.logCube=this.logCompression=this.logMessages=!1;this.assocCutoff=0.3;this.surfaceType=this.dataType=0;this.calculationType="";this.atomRadiusData=null;this.addHydrogens=!1;this.solventExtendedAtomRadius=this.solventRadius=0;this.propertySmoothing=!1;this.propertySmoothingPower=4;this.cavityRadius=this.envelopeRadius=0;this.isCavity=!1;this.pocket=null;this.minSet=0;this.slabInfo=null;this.slabPlaneOffset=NaN;this.theProperty=null;this.solvent_ptsPerAngstrom=4;this.solvent_gridMax=60;this.plane_ptsPerAngstrom=
4;this.plane_gridMax=81;this.colorBySets=this.colorByPhase=this.colorBySign=!1;this.colorPhase=this.colorNegLCAO=this.colorPosLCAO=this.colorPos=this.colorNeg=this.colorRgb=0;this.iAddGridPoints=this.colorDensity=!1;this.atomIndex=0;this.isAngstroms=!1;this.scale3d=this.scale=0;this.anisotropy=null;this.isAnisotropic=!1;this.eccentricityMatrixInverse=this.eccentricityMatrix=null;this.isEccentric=!1;this.eccentricityRatio=this.eccentricityScale=0;this.functionInfo=this.lcaoType=this.anisoB=this.aniosU=
null;this.psi_n=2;this.psi_Znuc=this.psi_m=this.psi_l=1;this.psi_ptsPerAngstrom=5;this.psi_monteCarloCount=0;this.mep_gridMax=40;this.mep_ptsPerAngstrom=3;this.mep_marginAngstroms=1;this.mep_calcType=-1;this.qmOrbitalCount=this.qmOrbitalType=0;this.moData=null;this.qm_gridMax=80;this.qm_ptsPerAngstrom=10;this.qm_marginAngstroms=1;this.qm_nAtoms=0;this.qm_moNumber=2147483647;this.point=this.center=this.qm_moLinearCombination=null;this.distance=0;this.allowVolumeRender=!1;this.title=this.func=this.bsSolvent=
this.bsIgnore=this.bsSelected=this.script=null;this.readAllData=this.blockCubeData=!1;this.fileIndex=-1;this.fileName=null;this.modelIndex=-1;this.dataXYReversed=this.insideOut=this.isXLowToHigh=!1;this.sigma=this.cutoff=3.4028235E38;this.cutoffAutomatic=!0;this.rangeDefined=this.rangeSelected=this.rangeAll=this.isPositiveOnly=this.isCutoffAbsolute=!1;this.mappedDataMax=this.mappedDataMin=this.valueMappedToBlue=this.valueMappedToRed=0;this.isSquaredLinear=this.isSquared=this.isBicolorMap=this.isColorReversed=
!1;this.thePlane=null;this.isContoured=!1;this.thisContour=this.nContours=0;this.contourFromZero=!1;this.parameters=null;this.maxSet=this.downsampleFactor=this.resolution=0;this.bsExcluded=this.boundingBox=this.contourIncrements=this.contourColixes=this.contoursDiscrete=null;this.contourType=0;this.colorSchemeTranslucent=!1;this.colorEncoder=null;this.usePropertyForColorRange=!0;this.doFullMolecular=this.isPeriodic=!1;this.propertyDistanceMax=2147483647;this.randomSeed=0;this.fullyLit=!1;this.mapLattice=
this.contactPair=this.volumeData=this.points=this.steps=this.origin=this.intersection=this.vertexSource=null;this.showTiming=this.isMapped=!1;this.pointSize=0;A(this,arguments)},J.jvxl.readers,"Parameters");G(c$,function(){this.anisotropy=u(3,0)});e(c$,"initialize",function(){this.addHydrogens=!1;this.allowVolumeRender=!0;this.atomRadiusData=null;this.atomIndex=-1;this.blockCubeData=!1;this.boundingBox=null;this.bsExcluded=Array(4);this.bsSolvent=this.bsSelected=this.bsIgnore=null;this.calculationType=
"";this.center=JU.P3.new3(3.4028235E38,3.4028235E38,3.4028235E38);this.colorDensity=this.colorBySign=this.colorByPhase=this.colorBySets=!1;this.colorEncoder=null;this.colorNeg=-65536;this.colorNegLCAO=-8388480;this.colorPos=-16776961;this.colorPosLCAO=-23296;this.colorRgb=-2147483648;this.colorSchemeTranslucent=!1;this.contourColixes=this.contoursDiscrete=this.contourIncrements=this.contactPair=null;this.contourFromZero=!0;this.cutoff=3.4028235E38;this.cutoffAutomatic=!0;this.dataXYReversed=!1;this.distance=
3.4028235E38;this.doFullMolecular=!1;this.envelopeRadius=10;this.fileIndex=1;this.readAllData=!0;this.fileName="";this.fullyLit=!1;this.functionInfo=this.func=null;this.insideOut=this.iAddGridPoints=!1;this.intersection=null;this.isSilent=this.isPeriodic=this.isMapped=this.isEccentric=this.isAnisotropic=this.isContoured=this.isSquaredLinear=this.isSquared=this.isColorReversed=this.isCavity=this.isBicolorMap=this.isCutoffAbsolute=this.isPositiveOnly=this.isAngstroms=!1;this.mapLattice=null;this.logCube=
this.logCompression=!1;this.logMessages=JU.Logger.debugging;this.mappedDataMin=3.4028235E38;this.mep_calcType=-1;this.minSet=0;this.modelIndex=-1;this.nContours=0;this.pocket=null;this.pointSize=NaN;this.propertyDistanceMax=2147483647;this.propertySmoothing=!1;this.propertySmoothingPower=4;this.rangeSelected=this.rangeAll=this.rangeDefined=!1;this.resolution=3.4028235E38;this.scale=NaN;this.scale3d=0;this.sigma=NaN;this.slabInfo=null;this.solventExtendedAtomRadius=0;this.state=1;this.testFlags=0;
this.theProperty=this.thePlane=null;this.thisContour=-1;this.title=null;this.usePropertyForColorRange=!0;this.volumeData=this.vertexSource=null});e(c$,"setAnisotropy",function(a){this.anisotropy[0]=a.x;this.anisotropy[1]=a.y;this.anisotropy[2]=a.z;this.isAnisotropic=!0;3.4028235E38==this.center.x&&this.center.set(0,0,0)},"JU.P3");e(c$,"setEccentricity",function(a){var b=JU.V3.new3(a.x,a.y,a.z),c=0<this.scale?this.scale:0>a.w?1:b.length();a=Math.abs(a.w);b.normalize();var d=JU.V3.new3(0,0,1);b.add(d);
b.normalize();Float.isNaN(b.x)&&b.set(1,0,0);this.eccentricityMatrixInverse=new JU.M3;this.eccentricityMatrixInverse.invertM(this.eccentricityMatrix=(new JU.M3).setAA(JU.A4.newVA(b,3.141592653589793)));this.isEccentric=this.isAnisotropic=!0;this.eccentricityScale=c;this.eccentricityRatio=a;1<a&&(this.eccentricityScale*=a);this.anisotropy[0]=a*c;this.anisotropy[1]=a*c;this.anisotropy[2]=c;3.4028235E38==this.center.x&&this.center.set(0,0,0)},"JU.P4");e(c$,"setPlane",function(a){this.thePlane=a;0==this.thePlane.x&&
(0==this.thePlane.y&&0==this.thePlane.z)&&(this.thePlane.z=1);this.isContoured=!0},"JU.P4");e(c$,"setSphere",function(a,b){this.dataType=b?74:65;this.distance=a;this.setEccentricity(JU.P4.new4(0,0,1,1));this.cutoff=1.4E-45;this.isCutoffAbsolute=!1;this.isSilent=!this.logMessages;this.script=this.getScriptParams()+" SPHERE "+a+";"},"~N,~B");e(c$,"setEllipsoidP4",function(a){this.dataType=66;this.distance=1;this.setEccentricity(a);this.cutoff=1.4E-45;this.isCutoffAbsolute=!1;this.isSilent=!this.logMessages},
"JU.P4");e(c$,"setEllipsoidAF",function(a){this.anisoB=a;this.dataType=67;this.distance=0.3*(Float.isNaN(this.scale)?1:this.scale);this.cutoff=1.4E-45;this.isCutoffAbsolute=!1;this.isSilent=!this.logMessages;3.4028235E38==this.center.x&&this.center.set(0,0,0);3.4028235E38==this.resolution&&(this.resolution=6)},"~A");e(c$,"setLobe",function(a){this.dataType=68;this.setEccentricity(a);3.4028235E38==this.cutoff&&(this.cutoff=0.14,this.isSquared&&(this.cutoff*=this.cutoff));this.isSilent=!this.logMessages;
this.script=this.getScriptParams()+" LOBE {"+a.x+" "+a.y+" "+a.z+" "+a.w+"};"},"JU.P4");e(c$,"getScriptParams",function(){return" center "+JU.Escape.eP(this.center)+(Float.isNaN(this.scale)?"":" scale "+this.scale)});e(c$,"setLp",function(a){this.dataType=70;this.setEccentricity(a);3.4028235E38==this.cutoff&&(this.cutoff=0.14,this.isSquared&&(this.cutoff*=this.cutoff));this.isSilent=!this.logMessages;this.script=" center "+JU.Escape.eP(this.center)+(Float.isNaN(this.scale)?"":" scale "+this.scale)+
" LP {"+a.x+" "+a.y+" "+a.z+" "+a.w+"};"},"JU.P4");e(c$,"setRadical",function(a){this.dataType=71;this.setEccentricity(a);3.4028235E38==this.cutoff&&(this.cutoff=0.14,this.isSquared&&(this.cutoff*=this.cutoff));this.isSilent=!this.logMessages;this.script=" center "+JU.Escape.eP(this.center)+(Float.isNaN(this.scale)?"":" scale "+this.scale)+" RAD {"+a.x+" "+a.y+" "+a.z+" "+a.w+"};"},"JU.P4");e(c$,"setLcao",function(a,b){this.lcaoType=a;1==b&&(this.colorPosLCAO=this.colorNegLCAO);this.isSilent=!this.logMessages},
"~S,~N");e(c$,"setSolvent",function(a,b){this.isEccentric=this.isAnisotropic=!1;this.solventRadius=Math.abs(b);this.dataType=null!=this.intersection?1333:"nomap"===a?1205:"molecular"===a?1203:"sasurface"===a||0==this.solventRadius?1196:1195;if(2>this.state&&(this.cutoffAutomatic||!this.colorDensity)&&(null==this.intersection||3.4028235E38==this.cutoff))this.cutoff=0;switch(this.dataType){case 1333:this.calculationType="VDW intersection";break;case 1205:this.calculationType="unmapped plane";break;
case 1203:this.calculationType="molecular surface with radius "+this.solventRadius;break;case 1195:this.calculationType="solvent-excluded surface with radius "+this.solventRadius;break;case 1196:this.calculationType="solvent-accessible surface with radius "+this.solventRadius}switch(this.dataType){case 1205:this.solventExtendedAtomRadius=this.solventRadius;this.solventRadius=0;this.isContoured=!1;break;case 1203:this.solventExtendedAtomRadius=0;break;case 1195:this.solventExtendedAtomRadius=0;null==
this.bsIgnore?this.bsIgnore=this.bsSolvent:null!=this.bsSolvent&&this.bsIgnore.or(this.bsSolvent);break;case 1196:this.solventExtendedAtomRadius=this.solventRadius,this.solventRadius=0,null==this.bsIgnore?this.bsIgnore=this.bsSolvent:null!=this.bsSolvent&&this.bsIgnore.or(this.bsSolvent)}},"~S,~N");e(c$,"setFunctionXY",function(a){this.dataType=8;this.functionInfo=a;this.cutoff=1.4E-45;this.isEccentric=this.isAnisotropic=!1},"JU.Lst");e(c$,"setFunctionXYZ",function(a){this.dataType=9;this.functionInfo=
a;3.4028235E38==this.cutoff&&(this.cutoff=1.4E-45);this.isEccentric=this.isAnisotropic=!1},"JU.Lst");e(c$,"setAtomicOrbital",function(a){this.dataType=1294;this.setEccentricity(JU.P4.new4(0,0,1,1));this.psi_n=E(a[0]);this.psi_l=E(a[1]);this.psi_m=E(a[2]);this.psi_Znuc=a[3];this.psi_monteCarloCount=E(a[4]);this.distance=a[5];if(0!=this.distance||null!=this.thePlane)this.allowVolumeRender=!1;this.randomSeed=E(a[6]);this.psi_ptsPerAngstrom=10;if(3.4028235E38==this.cutoff||0.14==this.cutoff)this.cutoff=
0<this.psi_monteCarloCount?0:0.04,this.isSquared&&(this.cutoff*=this.cutoff);this.isCutoffAbsolute=!0;2>this.state&&(null==this.thePlane&&this.colorBySign)&&(this.isBicolorMap=!0);return 0<this.psi_Znuc&&Math.abs(this.psi_m)<=this.psi_l&&this.psi_l<this.psi_n},"~A");e(c$,"setMep",function(a,b){this.dataType=b?1329:1328;this.theProperty=a;this.isEccentric=this.isAnisotropic=this.usePropertyForColorRange=!1;3.4028235E38==this.cutoff&&(this.cutoff=0.1,this.isSquared&&(this.cutoff*=this.cutoff));this.isCutoffAbsolute=
0<this.cutoff&&!this.isPositiveOnly;this.contourFromZero=!1;2<=this.state||null!=this.thePlane?!this.rangeDefined&&!this.rangeAll&&(this.valueMappedToRed=-0.1,this.valueMappedToBlue=0.1,this.rangeDefined=!0):this.isBicolorMap=this.colorBySign=!0},"~A,~B");e(c$,"setNci",function(a){this.fullyLit=!0;this.qm_gridMax=200;a&&(this.dataType=1844);this.qm_marginAngstroms=2;this.qmOrbitalType=a?3:4;if(a&&(null==this.parameters||2>this.parameters.length))this.parameters=[this.cutoff,2];if(3.4028235E38==this.cutoff||
0==this.cutoff)this.cutoff=0.3;this.isSquared&&(this.cutoff*=this.cutoff);null==this.title&&(this.title=[]);this.moData=new java.util.Hashtable},"~B");e(c$,"setMO",function(a,b){this.qm_moLinearCombination=b;this.qm_moNumber=null==b?Math.abs(a):E(b[1]);this.qmOrbitalType=this.moData.containsKey("haveVolumeData")?5:this.moData.containsKey("gaussians")?1:this.moData.containsKey("slaters")?2:0;var c=0>=a&&null==b;0==this.qmOrbitalType?(JU.Logger.error("MO ERROR: No basis functions found in file for MO calculation. (GAUSSIAN 'gfprint' keyword may be missing?)"),
this.title=["no basis functions found in file"]):(this.qmOrbitalCount=this.moData.get("mos").size(),this.calculationType=this.moData.get("calculationType"),this.calculationType="Molecular orbital #"+this.qm_moNumber+"/"+this.qmOrbitalCount+" "+(null==this.calculationType?"":this.calculationType),!c&&null==this.title&&(this.title=Array(5),this.title[0]="%F",this.title[1]="Model %M  MO %I/%N %T",this.title[2]="?Energy = %E %U",this.title[3]="?Symmetry = %S",this.title[4]="?Occupancy = %O"));this.dataType=
1837;3.4028235E38==this.cutoff&&(this.cutoff=c?0.01:0.05);if(this.isSquared||this.isSquaredLinear)this.cutoff*=this.cutoff;this.isEccentric=this.isAnisotropic=!1;this.isCutoffAbsolute=0<this.cutoff&&!this.isPositiveOnly;2<=this.state||null!=this.thePlane||(this.colorBySign=!0,this.colorByPhase&&0==this.colorPhase&&(this.colorByPhase=!1),this.isBicolorMap=!0)},"~N,~A");e(c$,"setMapRanges",function(a,b){if(!this.colorDensity&&(this.colorByPhase||this.colorBySign||(null!=this.thePlane||this.isBicolorMap)&&
!this.isContoured))this.mappedDataMin=-1,this.mappedDataMax=1;if(3.4028235E38==this.mappedDataMin||this.mappedDataMin==this.mappedDataMax){var c=a.getMinMaxMappedValues(b);this.mappedDataMin=c[0];this.mappedDataMax=c[1]}0==this.mappedDataMin&&0==this.mappedDataMax&&(this.mappedDataMin=-1,this.mappedDataMax=1);this.rangeDefined||(this.valueMappedToRed=this.mappedDataMin,this.valueMappedToBlue=this.mappedDataMax)},"J.jvxl.readers.SurfaceReader,~B");e(c$,"resetForMapping",function(a){a||(this.state=
2);this.isMapped=!0;this.qmOrbitalType=0;this.parameters=null;this.colorDensity=!1;this.mappedDataMin=3.4028235E38;this.volumeData=this.steps=this.origin=this.points=this.func=this.intersection=null;this.center.x=3.4028235E38;this.isAnisotropic=!1},"~B");e(c$,"addSlabInfo",function(a){null==this.slabInfo&&(this.slabInfo=new JU.Lst);this.slabInfo.addLast(a)},"~A");H(c$,"STATE_UNINITIALIZED",0,"STATE_INITIALIZED",1,"STATE_DATA_READ",2,"STATE_DATA_COLORED",3,"NO_ANISOTROPY",32,"IS_SILENT",64,"IS_SOLVENTTYPE",
128,"HAS_MAXGRID",256,"IS_POINTMAPPABLE",512,"IS_SLABBABLE",1024,"SURFACE_NONE",0,"SURFACE_SPHERE",65,"SURFACE_ELLIPSOID2",66,"SURFACE_ELLIPSOID3",67,"SURFACE_LOBE",68,"SURFACE_LCAOCARTOON",69,"SURFACE_LONEPAIR",70,"SURFACE_RADICAL",71,"SURFACE_FUNCTIONXY",8,"SURFACE_FUNCTIONXYZ",9,"SURFACE_GEODESIC",74,"SURFACE_SOLVENT",1195,"SURFACE_SASURFACE",1196,"SURFACE_MOLECULARORBITAL",1837,"SURFACE_ATOMICORBITAL",1294,"SURFACE_MEP",1328,"SURFACE_MLP",1329,"SURFACE_MOLECULAR",1203,"SURFACE_NCI",1844,"SURFACE_INTERSECT",
1333,"SURFACE_NOMAP",1205,"SURFACE_PROPERTY",1206,"ANGSTROMS_PER_BOHR",0.5291772,"defaultEdgeFractionBase",35,"defaultEdgeFractionRange",90,"defaultColorFractionBase",35,"defaultColorFractionRange",90,"defaultMappedDataMin",0,"defaultMappedDataMax",1,"defaultCutoff",0.02,"defaultOrbitalCutoff",0.04,"defaultLobeCutoff",0.14,"defaultOrbitalCutoffOld",0.14,"defaultQMOrbitalCutoff",0.05,"defaultQMElectronDensityCutoff",0.01,"defaultContourCount",11,"nContourMax",100,"defaultColorNegative",4294901760,
"defaultColorPositive",4278190335,"defaultColorNegativeLCAO",4286578816,"defaultColorPositiveLCAO",4294944E3,"defaultSolventRadius",1.2,"defaultMepCutoff",0.1,"defaultMepMin",-0.1,"defaultMepMax",0.1,"MEP_MAX_GRID",40,"QM_TYPE_UNKNOWN",0,"QM_TYPE_GAUSSIAN",1,"QM_TYPE_SLATER",2,"QM_TYPE_NCI_PRO",3,"QM_TYPE_NCI_SCF",4,"QM_TYPE_VOLUME_DATA",5,"MO_MAX_GRID",80)});y("J.jvxl.readers");z(["J.jvxl.api.VertexDataServer","JU.P3"],"J.jvxl.readers.SurfaceReader","java.lang.Float JU.AU $.BS J.jvxl.calc.MarchingCubes $.MarchingSquares J.jvxl.data.JvxlCoder $.MeshData JU.BoxInfo $.C $.ColorEncoder $.Escape $.Logger".split(" "),
function(){c$=x(function(){this.edgeData=this.volumeData=this.jvxlData=this.meshData=this.params=this.meshDataServer=this.sg=null;this.isXLowToHigh=this.isProgressive=this.allowSigma=this.haveSurfaceAtoms=!1;this.assocCutoff=0.3;this.hasColorData=this.vertexDataOnly=this.isQuiet=!1;this.dataMin=3.4028235E38;this.dataMax=-3.4028235E38;this.dataMean=0;this.anisotropy=this.center=this.xyzMax=this.xyzMin=null;this.isAnisotropic=!1;this.eccentricityMatrixInverse=this.eccentricityMatrix=null;this.isEccentric=
!1;this.edgeCount=this.eccentricityRatio=this.eccentricityScale=0;this.voxelData=this.voxelCounts=this.volumetricVectors=this.volumetricOrigin=null;this.nPointsZ=this.nPointsY=this.nPointsX=this.nDataPoints=this.nBytes=0;this.isJvxl=!1;this.colorFractionRange=this.colorFractionBase=this.edgeFractionRange=this.edgeFractionBase=0;this.fractionData=this.jvxlFileHeaderBuffer=null;this.jvxlColorDataRead=this.jvxlEdgeDataRead="";this.jvxlVoxelBitSet=null;this.jvxlDataIsColorDensity=this.jvxlDataIs2dContour=
this.jvxlDataIsPrecisionColor=this.jvxlDataIsColorMapped=!1;this.jvxlNSurfaceInts=this.jvxlCutoff=0;this.cJvxlEdgeNaN="\x00";this.contourVertexCount=0;this.yzPlanes=this.marchingCubes=this.marchingSquares=null;this.yzCount=0;this.minMax=this.ptTemp=this.qpc=null;this.haveSetAnisotropy=!1;A(this,arguments)},J.jvxl.readers,"SurfaceReader",null,J.jvxl.api.VertexDataServer);G(c$,function(){this.ptTemp=new JU.P3});C(c$,function(){});e(c$,"initSR",function(a){this.sg=a;this.params=a.getParams();this.marchingSquares=
a.getMarchingSquares();this.assocCutoff=this.params.assocCutoff;this.isXLowToHigh=this.params.isXLowToHigh;this.center=this.params.center;this.anisotropy=this.params.anisotropy;this.isAnisotropic=this.params.isAnisotropic;this.eccentricityMatrix=this.params.eccentricityMatrix;this.eccentricityMatrixInverse=this.params.eccentricityMatrixInverse;this.isEccentric=this.params.isEccentric;this.eccentricityScale=this.params.eccentricityScale;this.eccentricityRatio=this.params.eccentricityRatio;this.meshData=
a.getMeshData();this.jvxlData=a.getJvxlData();this.setVolumeDataV(a.getVolumeData());this.meshDataServer=a.getMeshDataServer();this.cJvxlEdgeNaN=String.fromCharCode(125)},"J.jvxl.readers.SurfaceGenerator");e(c$,"setOutputChannel",function(){},"JU.OC");e(c$,"newVoxelDataCube",function(){this.volumeData.setVoxelDataAsArray(this.voxelData=u(this.nPointsX,this.nPointsY,this.nPointsZ,0))});e(c$,"setVolumeDataV",function(a){this.nBytes=0;this.volumetricOrigin=a.volumetricOrigin;this.volumetricVectors=a.volumetricVectors;
this.voxelCounts=a.voxelCounts;this.voxelData=a.getVoxelData();this.volumeData=a},"J.jvxl.data.VolumeData");e(c$,"jvxlUpdateInfo",function(){this.jvxlData.jvxlUpdateInfo(this.params.title,this.nBytes)});e(c$,"readAndSetVolumeParameters",function(a){return!this.readVolumeParameters(a)?!1:this.vertexDataOnly?!0:this.volumeData.setUnitVectors()},"~B");e(c$,"createIsosurface",function(a){this.resetIsosurface();this.params.showTiming&&JU.Logger.startTimer("isosurface creation");this.jvxlData.cutoff=NaN;
if(!this.readAndSetVolumeParameters(a))return!1;!a&&(!Float.isNaN(this.params.sigma)&&!this.allowSigma)&&(0<this.params.sigma&&JU.Logger.error("Reader does not support SIGMA option -- using cutoff 1.6"),this.params.cutoff=1.6);0>this.params.sigma&&(this.params.sigma=-this.params.sigma);this.nPointsX=this.voxelCounts[0];this.nPointsY=this.voxelCounts[1];this.nPointsZ=this.voxelCounts[2];this.jvxlData.isSlabbable=0!=(this.params.dataType&1024);this.jvxlData.insideOut=this.params.insideOut;this.jvxlData.dataXYReversed=
this.params.dataXYReversed;this.jvxlData.isBicolorMap=this.params.isBicolorMap;this.jvxlData.nPointsX=this.nPointsX;this.jvxlData.nPointsY=this.nPointsY;this.jvxlData.nPointsZ=this.nPointsZ;this.jvxlData.jvxlVolumeDataXml=this.volumeData.xmlData;this.jvxlData.voxelVolume=this.volumeData.voxelVolume;if(a)this.volumeData.setMappingPlane(this.params.thePlane),null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null),this.params.setMapRanges(this,!1),this.generateSurfaceData(),
this.volumeData.setMappingPlane(null);else{if(!this.readVolumeData(!1))return!1;this.generateSurfaceData()}if(null!=this.jvxlFileHeaderBuffer){a=this.jvxlFileHeaderBuffer.toString();var b=a.indexOf("\n",a.indexOf("\n",a.indexOf("\n")+1)+1)+1;this.jvxlData.jvxlFileTitle=a.substring(0,b)}null==this.params.contactPair&&this.setBBoxAll();this.params.isSilent||JU.Logger.info("boundbox corners "+JU.Escape.eP(this.xyzMin)+" "+JU.Escape.eP(this.xyzMax));this.jvxlData.boundingBox=[this.xyzMin,this.xyzMax];
this.jvxlData.dataMin=this.dataMin;this.jvxlData.dataMax=this.dataMax;this.jvxlData.cutoff=this.isJvxl?this.jvxlCutoff:this.params.cutoff;this.jvxlData.isCutoffAbsolute=this.params.isCutoffAbsolute;this.jvxlData.pointsPerAngstrom=1/this.volumeData.volumetricVectorLengths[0];this.jvxlData.jvxlColorData="";this.jvxlData.jvxlPlane=this.params.thePlane;this.jvxlData.jvxlEdgeData=this.edgeData;this.jvxlData.isBicolorMap=this.params.isBicolorMap;this.jvxlData.isContoured=this.params.isContoured;this.jvxlData.colorDensity=
this.params.colorDensity;this.jvxlData.pointSize=this.params.pointSize;null!=this.jvxlData.vContours&&(this.params.nContours=this.jvxlData.vContours.length);this.jvxlData.nContours=this.params.contourFromZero?this.params.nContours:-1-this.params.nContours;this.jvxlData.nEdges=this.edgeCount;this.jvxlData.edgeFractionBase=this.edgeFractionBase;this.jvxlData.edgeFractionRange=this.edgeFractionRange;this.jvxlData.colorFractionBase=this.colorFractionBase;this.jvxlData.colorFractionRange=this.colorFractionRange;
this.jvxlData.jvxlDataIs2dContour=this.jvxlDataIs2dContour;this.jvxlData.jvxlDataIsColorMapped=this.jvxlDataIsColorMapped;this.jvxlData.jvxlDataIsColorDensity=this.jvxlDataIsColorDensity;this.jvxlData.isXLowToHigh=this.isXLowToHigh;this.jvxlData.vertexDataOnly=this.vertexDataOnly;this.jvxlData.saveVertexCount=0;if(this.jvxlDataIsColorMapped||0<this.jvxlData.nVertexColors)null!=this.meshDataServer&&(this.meshDataServer.fillMeshData(this.meshData,1,null),this.meshDataServer.fillMeshData(this.meshData,
2,null)),this.jvxlData.jvxlColorData=this.readColorData(),this.updateSurfaceData(),null!=this.meshDataServer&&this.meshDataServer.notifySurfaceMappingCompleted();this.params.showTiming&&JU.Logger.checkTimer("isosurface creation",!1);return!0},"~B");e(c$,"resetIsosurface",function(){this.meshData=new J.jvxl.data.MeshData;this.xyzMin=this.xyzMax=null;this.jvxlData.isBicolorMap=this.params.isBicolorMap;null!=this.meshDataServer&&this.meshDataServer.fillMeshData(null,0,null);this.contourVertexCount=0;
3.4028235E38==this.params.cutoff&&(this.params.cutoff=0.02);this.jvxlData.jvxlSurfaceData="";this.jvxlData.jvxlEdgeData="";this.jvxlData.jvxlColorData="";this.edgeCount=0;this.edgeFractionBase=35;this.edgeFractionRange=90;this.colorFractionBase=35;this.colorFractionRange=90;this.params.mappedDataMin=3.4028235E38});e(c$,"discardTempData",function(a){this.discardTempDataSR(a)},"~B");e(c$,"discardTempDataSR",function(a){a&&(this.voxelData=null,this.sg.setMarchingSquares(this.marchingSquares=null),this.marchingCubes=
null)},"~B");e(c$,"initializeVolumetricData",function(){this.nPointsX=this.voxelCounts[0];this.nPointsY=this.voxelCounts[1];this.nPointsZ=this.voxelCounts[2];this.setVolumeDataV(this.volumeData)});e(c$,"gotoAndReadVoxelData",function(a){this.initializeVolumetricData();if(0<this.nPointsX&&0<this.nPointsY&&0<this.nPointsZ)try{this.gotoData(this.params.fileIndex-1,this.nPointsX*this.nPointsY*this.nPointsZ),this.readSurfaceData(a)}catch(b){if(D(b,Exception))return JU.Logger.error(b.toString()),!1;throw b;
}return!0},"~B");e(c$,"gotoData",function(){},"~N,~N");e(c$,"readColorData",function(){if(null==this.jvxlData.vertexColors)return"";var a=this.jvxlData.vertexCount,b=this.meshData.vcs,c=this.meshData.vvs;if(null==b||b.length<a)this.meshData.vcs=b=K(a,0);if(null==c||c.length<a)this.meshData.vvs=u(a,0);for(c=0;c<a;c++)b[c]=JU.C.getColix(this.jvxlData.vertexColors[c]);return"-"});j(c$,"getPlane",function(a){return this.getPlane2(a)},"~N");e(c$,"getPlane2",function(a){0==this.yzCount&&this.initPlanes();
null!=this.qpc&&this.qpc.getPlane(a,this.yzPlanes[a%2]);return this.yzPlanes[a%2]},"~N");e(c$,"initPlanes",function(){this.yzCount=this.nPointsY*this.nPointsZ;this.isQuiet||JU.Logger.info("reading data progressively -- yzCount = "+this.yzCount);this.yzPlanes=JU.AU.newFloat2(2);this.yzPlanes[0]=u(this.yzCount,0);this.yzPlanes[1]=u(this.yzCount,0)});j(c$,"getValue",function(a,b,c,d){return this.getValue2(a,b,c,d)},"~N,~N,~N,~N");e(c$,"getValue2",function(a,b,c,d){return null==this.yzPlanes?this.voxelData[a][b][c]:
this.yzPlanes[a%2][d]},"~N,~N,~N,~N");e(c$,"generateSurfaceData",function(){this.edgeData="";if(this.vertexDataOnly)try{this.readSurfaceData(!1)}catch(a){if(D(a,Exception))System.out.println(a.toString()),JU.Logger.error("Exception in SurfaceReader::readSurfaceData: "+a.toString());else throw a;}else{this.contourVertexCount=0;var b=-1;this.marchingSquares=null;if(null!=this.params.thePlane||this.params.isContoured)this.marchingSquares=new J.jvxl.calc.MarchingSquares(this,this.volumeData,this.params.thePlane,
this.params.contoursDiscrete,this.params.nContours,this.params.thisContour,this.params.contourFromZero),b=this.marchingSquares.getContourType(),this.marchingSquares.setMinMax(this.params.valueMappedToRed,this.params.valueMappedToBlue);this.params.contourType=b;this.params.isXLowToHigh=this.isXLowToHigh;this.marchingCubes=new J.jvxl.calc.MarchingCubes(this,this.volumeData,this.params,this.jvxlVoxelBitSet);b=this.marchingCubes.getEdgeData();null==this.params.thePlane&&(this.edgeData=b);this.jvxlData.setSurfaceInfoFromBitSetPts(this.marchingCubes.getBsVoxels(),
this.params.thePlane,this.params.mapLattice);this.jvxlData.jvxlExcluded=this.params.bsExcluded;this.isJvxl&&(this.edgeData=this.jvxlEdgeDataRead);this.postProcessVertices()}});e(c$,"postProcessVertices",function(){});j(c$,"getSurfacePointIndexAndFraction",function(a,b,c,d,h,e,f,l,k,m,p,j,q,s){b=this.getSurfacePointAndFraction(a,b,k,m,p,j,c,d,h,f,l,s,this.ptTemp);if(null!=this.marchingSquares&&this.params.isContoured)return this.marchingSquares.addContourVertex(this.ptTemp,a);a=0<this.assocCutoff?
s[0]<this.assocCutoff?f:s[0]>1-this.assocCutoff?l:-1:-1;0<=a&&(a=this.marchingCubes.getLinearOffset(c,d,h,a));a=this.addVertexCopy(this.ptTemp,b,a,!0);0<=a&&this.params.iAddGridPoints&&(this.marchingCubes.calcVertexPoint(c,d,h,l,this.ptTemp),this.addVertexCopy(k<m?p:this.ptTemp,Math.min(k,m),-3,!0),this.addVertexCopy(k<m?this.ptTemp:p,Math.max(k,m),-3,!0));return a},"~N,~B,~N,~N,~N,JU.P3i,~N,~N,~N,~N,JU.T3,JU.V3,~B,~A");e(c$,"getSurfacePointAndFraction",function(a,b,c,d,h,e,f,l,k,m,p,j,q){return this.getSPF(a,
b,c,d,h,e,f,l,k,m,p,j,q)},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");e(c$,"getSPF",function(a,b,c,d,h,e,f,l,k,m,j,n,q){d-=c;f=(a-c)/d;if(b&&(0>f||1<f))f=(-a-c)/d;if(0>f||1<f)f=NaN;n[0]=f;q.scaleAdd2(f,e,h);return c+f*d},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");e(c$,"addVertexCopy",function(a,b,c,d){return this.addVC(a,b,c,d)},"JU.T3,~N,~N,~B");e(c$,"addVC",function(a,b,c,d){return Float.isNaN(b)&&-3!=c?-1:null==this.meshDataServer?this.meshData.addVertexCopy(a,b,c,d):this.meshDataServer.addVertexCopy(a,
b,c,d)},"JU.T3,~N,~N,~B");e(c$,"addTriangleCheck",function(a,b,c,d,h,e,f){if(null!=this.marchingSquares&&this.params.isContoured){if(0==f)return this.marchingSquares.addTriangle(a,b,c,d,h);f=0}return null!=this.meshDataServer?this.meshDataServer.addTriangleCheck(a,b,c,d,h,e,f):e&&!J.jvxl.data.MeshData.checkCutoff(a,b,c,this.meshData.vvs)?-1:this.meshData.addTriangleCheck(a,b,c,d,h,f)},"~N,~N,~N,~N,~N,~B,~N");e(c$,"colorIsosurface",function(){this.params.isSquared&&null!=this.volumeData&&this.volumeData.filterData(!0,
NaN);null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);this.jvxlData.saveVertexCount=0;this.params.isContoured&&null!=this.marchingSquares&&(this.initializeMapping(),this.params.setMapRanges(this,!1),this.marchingSquares.setMinMax(this.params.valueMappedToRed,this.params.valueMappedToBlue),this.jvxlData.saveVertexCount=this.marchingSquares.contourVertexCount,this.contourVertexCount=this.marchingSquares.generateContourData(this.jvxlDataIs2dContour,this.params.isSquared?
1E-8:1E-4),this.jvxlData.contourValuesUsed=this.marchingSquares.getContourValues(),this.minMax=this.marchingSquares.getMinMax(),null!=this.meshDataServer&&this.meshDataServer.notifySurfaceGenerationCompleted(),this.finalizeMapping());this.applyColorScale();this.jvxlData.nContours=this.params.contourFromZero?this.params.nContours:-1-this.params.nContours;this.jvxlData.jvxlFileMessage="mapped: min = "+this.params.valueMappedToRed+"; max = "+this.params.valueMappedToBlue});e(c$,"applyColorScale",function(){this.colorFractionBase=
this.jvxlData.colorFractionBase=35;this.colorFractionRange=this.jvxlData.colorFractionRange=90;0==this.params.colorPhase&&(this.params.colorPhase=1);null==this.meshDataServer?this.meshData.vcs=K(this.meshData.vc,0):(this.meshDataServer.fillMeshData(this.meshData,1,null),null==this.params.contactPair&&this.meshDataServer.fillMeshData(this.meshData,2,null));var a=this.params.colorDensity||this.params.isBicolorMap||this.params.colorBySign||!this.params.colorByPhase;null!=this.params.contactPair&&(a=
!1);this.jvxlData.isJvxlPrecisionColor=!0;this.jvxlData.vertexCount=0<this.contourVertexCount?this.contourVertexCount:this.meshData.vc;this.jvxlData.minColorIndex=-1;this.jvxlData.maxColorIndex=0;this.jvxlData.contourValues=this.params.contoursDiscrete;this.jvxlData.isColorReversed=this.params.isColorReversed;if(!this.params.colorDensity&&(this.params.isBicolorMap&&!this.params.isContoured||this.params.colorBySign))this.jvxlData.minColorIndex=JU.C.getColixTranslucent3(JU.C.getColix(this.params.isColorReversed?
this.params.colorPos:this.params.colorNeg),0!=this.jvxlData.translucency,this.jvxlData.translucency),this.jvxlData.maxColorIndex=JU.C.getColixTranslucent3(JU.C.getColix(this.params.isColorReversed?this.params.colorNeg:this.params.colorPos),0!=this.jvxlData.translucency,this.jvxlData.translucency);this.jvxlData.isTruncated=0<=this.jvxlData.minColorIndex&&!this.params.isContoured;if(!this.jvxlDataIs2dContour&&!this.hasColorData&&!this.vertexDataOnly&&!(this.params.colorDensity||this.params.isBicolorMap&&
!this.params.isContoured)){this.haveSurfaceAtoms&&null==this.meshData.vertexSource&&(this.meshData.vertexSource=t(this.meshData.vc,0));var b=3.4028235E38,c=-3.4028235E38,d;this.initializeMapping();for(var e=this.meshData.vc;--e>=this.meshData.mergeVertexCount0;){if(this.params.colorBySets)d=this.meshData.vertexSets[e];else if(this.params.colorByPhase)d=this.getPhase(this.meshData.vs[e]);else{var g=this.haveSurfaceAtoms;d=this.volumeData.lookupInterpolatedVoxelValue(this.meshData.vs[e],g);g&&(this.meshData.vertexSource[e]=
this.getSurfaceAtomIndex())}d<b&&(b=d);d>c&&3.4028235E38!=d&&(c=d);this.meshData.vvs[e]=d}this.params.rangeSelected&&null==this.minMax&&(this.minMax=[b,c]);this.finalizeMapping()}this.params.setMapRanges(this,!0);this.jvxlData.mappedDataMin=this.params.mappedDataMin;this.jvxlData.mappedDataMax=this.params.mappedDataMax;this.jvxlData.valueMappedToRed=this.params.valueMappedToRed;this.jvxlData.valueMappedToBlue=this.params.valueMappedToBlue;null==this.params.contactPair&&null==this.jvxlData.vertexColors&&
this.colorData();J.jvxl.data.JvxlCoder.jvxlCreateColorData(this.jvxlData,a?this.meshData.vvs:null);this.haveSurfaceAtoms&&null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,4,null);null!=this.meshDataServer&&this.params.colorBySets&&this.meshDataServer.fillMeshData(this.meshData,3,null)});e(c$,"colorData",function(){var a=this.meshData.vvs,b=this.meshData.vcs;this.meshData.pcs=null;var c=this.jvxlData.valueMappedToBlue,d=this.jvxlData.valueMappedToRed,e=this.jvxlData.minColorIndex,
g=this.jvxlData.maxColorIndex;null==this.params.colorEncoder&&(this.params.colorEncoder=new JU.ColorEncoder(null));this.params.colorEncoder.setRange(this.params.valueMappedToRed,this.params.valueMappedToBlue,this.params.isColorReversed);for(var f=this.meshData.vc;0<=--f;){var l=a[f];0<=e?0>=l?b[f]=e:0<l&&(b[f]=g):(l<=d&&(l=d),l>=c&&(l=c),b[f]=this.params.colorEncoder.getColorIndex(l))}if((0<this.params.nContours||null!=this.jvxlData.contourValues)&&null==this.jvxlData.contourColixes){a=null==this.jvxlData.contourValues?
this.params.nContours:this.jvxlData.contourValues.length;b=this.jvxlData.contourColixes=K(a,0);e=this.jvxlData.contourValues;null==e&&(e=this.jvxlData.contourValuesUsed);null==this.jvxlData.contourValuesUsed&&(this.jvxlData.contourValuesUsed=null==e?u(a,0):e);c=(c-d)/(a+1);this.params.colorEncoder.setRange(this.params.valueMappedToRed,this.params.valueMappedToBlue,this.params.isColorReversed);for(f=0;f<a;f++)g=null==e?d+(f+1)*c:e[f],this.jvxlData.contourValuesUsed[f]=g,b[f]=JU.C.getColixTranslucent(this.params.colorEncoder.getArgb(g));
this.jvxlData.contourColors=JU.C.getHexCodes(b)}});c$.getColorPhaseIndex=e(c$,"getColorPhaseIndex",function(a){for(var b=-1,c=0;c<J.jvxl.readers.SurfaceReader.colorPhases.length;c++)if(a.equalsIgnoreCase(J.jvxl.readers.SurfaceReader.colorPhases[c])){b=c;break}return b},"~S");e(c$,"getPhase",function(a){switch(this.params.colorPhase){case 0:case -1:case 1:return 0<a.x?1:-1;case 2:return 0<a.y?1:-1;case 3:return 0<a.z?1:-1;case 4:return 0<a.x*a.y?1:-1;case 5:return 0<a.y*a.z?1:-1;case 6:return 0<a.x*
a.z?1:-1;case 7:return 0<a.x*a.x-a.y*a.y?1:-1;case 8:return 0<2*a.z*a.z-a.x*a.x-a.y*a.y?1:-1}return 1},"JU.T3");e(c$,"getMinMaxMappedValues",function(a){if(null!=this.minMax&&3.4028235E38!=this.minMax[0])return this.minMax;if(this.params.colorBySets)return this.minMax=[0,Math.max(this.meshData.nSets-1,0)];var b=3.4028235E38,c=-3.4028235E38;if(this.params.usePropertyForColorRange&&null!=this.params.theProperty){for(a=0;a<this.params.theProperty.length;a++)if(!this.params.rangeSelected||this.params.bsSelected.get(a)){var d=
this.params.theProperty[a];Float.isNaN(d)||(d<b&&(b=d),d>c&&(c=d))}return this.minMax=[b,c]}var d=0<this.contourVertexCount?this.contourVertexCount:this.meshData.vc,e=this.meshData.vs,g=a||this.jvxlDataIs2dContour||this.vertexDataOnly||this.params.colorDensity;for(a=this.meshData.mergeVertexCount0;a<d;a++){var f;f=g?this.meshData.vvs[a]:this.volumeData.lookupInterpolatedVoxelValue(e[a],!1);f<b&&(b=f);f>c&&3.4028235E38!=f&&(c=f)}return this.minMax=[b,c]},"~B");e(c$,"updateTriangles",function(){null==
this.meshDataServer?this.meshData.invalidatePolygons():this.meshDataServer.invalidateTriangles()});e(c$,"updateSurfaceData",function(){this.meshData.setVertexSets(!0);this.updateTriangles();null==this.params.bsExcluded[1]&&(this.params.bsExcluded[1]=new JU.BS);this.meshData.updateInvalidatedVertices(this.params.bsExcluded[1])});e(c$,"selectPocket",function(){},"~B");e(c$,"excludeMinimumSet",function(){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);this.meshData.getSurfaceSet();
for(var a,b=this.meshData.nSets;0<=--b;)null!=(a=this.meshData.surfaceSet[b])&&a.cardinality()<this.params.minSet&&this.meshData.invalidateSurfaceSet(b);this.updateSurfaceData();null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,3,null)});e(c$,"excludeMaximumSet",function(){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);this.meshData.getSurfaceSet();for(var a,b=this.meshData.nSets;0<=--b;)null!=(a=this.meshData.surfaceSet[b])&&a.cardinality()>
this.params.maxSet&&this.meshData.invalidateSurfaceSet(b);this.updateSurfaceData();null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,3,null)});e(c$,"slabIsosurface",function(a){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);this.meshData.slabPolygonsList(a,!0);null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,4,null)},"JU.Lst");e(c$,"setVertexAnisotropy",function(a){a.x*=this.anisotropy[0];a.y*=this.anisotropy[1];a.z*=
this.anisotropy[2];a.add(this.center)},"JU.T3");e(c$,"setVectorAnisotropy",function(a){this.haveSetAnisotropy=!0;a.x*=this.anisotropy[0];a.y*=this.anisotropy[1];a.z*=this.anisotropy[2]},"JU.T3");e(c$,"setVolumetricAnisotropy",function(){this.haveSetAnisotropy||(this.setVolumetricOriginAnisotropy(),this.setVectorAnisotropy(this.volumetricVectors[0]),this.setVectorAnisotropy(this.volumetricVectors[1]),this.setVectorAnisotropy(this.volumetricVectors[2]))});e(c$,"setVolumetricOriginAnisotropy",function(){this.volumetricOrigin.setT(this.center)});
e(c$,"setBBoxAll",function(){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);this.xyzMin=null;for(var a=0;a<this.meshData.vc;a++){var b=this.meshData.vs[a];Float.isNaN(b.x)||this.setBBox(b,0)}});e(c$,"setBBox",function(a,b){null==this.xyzMin&&(this.xyzMin=JU.P3.new3(3.4028235E38,3.4028235E38,3.4028235E38),this.xyzMax=JU.P3.new3(-3.4028235E38,-3.4028235E38,-3.4028235E38));JU.BoxInfo.addPoint(a,this.xyzMin,this.xyzMax,b)},"JU.T3,~N");e(c$,"getValueAtPoint",function(){return 0},
"JU.T3,~B");e(c$,"initializeMapping",function(){});e(c$,"finalizeMapping",function(){});e(c$,"getSurfaceAtomIndex",function(){return-1});e(c$,"getSpanningVectors",function(){return null==this.volumeData?null:this.volumeData.getSpanningVectors()});H(c$,"ANGSTROMS_PER_BOHR",0.5291772,"defaultMappedDataMin",0,"defaultMappedDataMax",1,"defaultCutoff",0.02,"colorPhases","_orb x y z xy yz xz x2-y2 z2".split(" "))});y("J.jvxl.calc");z(["JU.TriangleData","JU.BS","$.P3","$.SB","$.V3"],"J.jvxl.calc.MarchingCubes",
["java.lang.Float","J.jvxl.data.JvxlCoder"],function(){c$=x(function(){this.volumeData=this.surfaceReader=null;this.contourType=0;this.isContoured=!1;this.cutoff=0;this.isXLowToHigh=this.isSquared=this.isCutoffAbsolute=!1;this.yzCount=this.nZ=this.nY=this.cubeCountZ=this.cubeCountY=this.cubeCountX=0;this.colorDensity=!1;this.integrateSquared=!0;this.edgeData=this.bsExcludedPlanes=this.bsExcludedTriangles=this.bsExcludedVertices=this.bsVoxels=null;this.excludePartialCubes=!0;this.mode=0;this.vertexValues=
null;this.edgeCount=0;this.mappingPlane=this.yzPlanes=this.isoPointIndexPlanes=this.edgePointIndexes=this.edgeVectors=this.voxelVertexVectors=null;this.$isInside=this.allInside=!1;this.voxelData=this.offset=null;this.nTriangles=0;this.linearOffsets=this.fReturn=this.edgeVertexPlanes=this.edgeVertexPointers=this.pointA=this.pt0=this.bsValues=null;A(this,arguments)},J.jvxl.calc,"MarchingCubes",JU.TriangleData);G(c$,function(){this.edgeData=new JU.SB;this.vertexValues=u(8,0);this.voxelVertexVectors=
Array(8);this.edgeVectors=Array(12);for(var a=12;0<=--a;)this.edgeVectors[a]=new JU.V3;this.edgePointIndexes=t(12,0);this.bsValues=new JU.BS;this.pt0=new JU.P3;this.pointA=new JU.P3;this.fReturn=u(1,0);this.linearOffsets=t(8,0)});e(c$,"getBsVoxels",function(){return this.bsVoxels});C(c$,function(){I(this,J.jvxl.calc.MarchingCubes,[])});C(c$,function(a,b,c,d){I(this,J.jvxl.calc.MarchingCubes,[]);this.excludePartialCubes=!0;this.surfaceReader=a;this.bsVoxels=d;a=c.bsExcluded;this.bsExcludedVertices=
null==a[0]?a[0]=new JU.BS:a[0];this.bsExcludedPlanes=null==a[2]?a[2]=new JU.BS:a[2];this.bsExcludedTriangles=null==a[3]?a[3]=new JU.BS:a[3];this.mode=null!=b.getVoxelData()||null!=b.mappingPlane?1:null!=d?2:3;this.setParameters(b,c)},"J.jvxl.api.VertexDataServer,J.jvxl.data.VolumeData,J.jvxl.readers.Parameters,JU.BS");e(c$,"setParameters",function(a,b){this.volumeData=a;this.colorDensity=b.colorDensity;this.isContoured=null==b.thePlane&&b.isContoured&&!this.colorDensity;this.cutoff=b.cutoff;this.isCutoffAbsolute=
b.isCutoffAbsolute;this.contourType=b.contourType;this.isSquared=b.isSquared;this.isXLowToHigh=b.isXLowToHigh;this.cubeCountX=a.voxelCounts[0]-1;this.cubeCountY=a.voxelCounts[1]-1;this.cubeCountZ=a.voxelCounts[2]-1;a.getYzCount();null!=b.mapLattice&&(this.cubeCountX*=Math.abs(b.mapLattice.x),this.cubeCountY*=Math.abs(b.mapLattice.y),this.cubeCountZ*=Math.abs(b.mapLattice.z));this.nY=this.cubeCountY+1;this.nZ=this.cubeCountZ+1;this.yzCount=this.nY*this.nZ;null==this.bsVoxels&&(this.bsVoxels=new JU.BS);
this.edgeVertexPointers=this.isXLowToHigh?J.jvxl.calc.MarchingCubes.edgeVertexPointersLowToHigh:J.jvxl.calc.MarchingCubes.edgeVertexPointersHighToLow;this.edgeVertexPlanes=this.isXLowToHigh?J.jvxl.calc.MarchingCubes.edgeVertexPlanesLowToHigh:J.jvxl.calc.MarchingCubes.edgeVertexPlanesHighToLow;this.isoPointIndexPlanes=t(2,this.yzCount,3,0);this.yzPlanes=3==this.mode?u(2,this.yzCount,0):null;this.setLinearOffsets();this.calcVoxelVertexVectors()},"J.jvxl.data.VolumeData,J.jvxl.readers.Parameters");e(c$,
"calcVoxelVertexVectors",function(){for(var a=8;0<=--a;)this.volumeData.transform(J.jvxl.calc.MarchingCubes.cubeVertexVectors[a],this.voxelVertexVectors[a]=new JU.V3);for(a=12;0<=--a;)this.edgeVectors[a].sub2(this.voxelVertexVectors[JU.TriangleData.edgeVertexes[a+a+1]],this.voxelVertexVectors[JU.TriangleData.edgeVertexes[a+a]])});e(c$,"resetIndexPlane",function(a){for(var b=0;b<this.yzCount;b++)for(var c=0;3>c;c++)a[b][c]=-2147483648;return a},"~A");e(c$,"getEdgeData",function(){if(0>this.cubeCountX||
0>this.cubeCountY||0>this.cubeCountZ)return"";this.mappingPlane=this.volumeData.mappingPlane;this.edgeCount=0;var a,b,c,d,e,g;this.isXLowToHigh?(a=0,this.colorDensity?(b=this.cubeCountX+1,g=this.yzCount-1):(b=this.cubeCountX,g=this.yzCount-1-this.nZ-1),c=1,d=this.yzCount):(this.colorDensity?(a=this.cubeCountX,g=(this.cubeCountX+1)*this.yzCount-1):(a=this.cubeCountX-1,g=this.cubeCountX*this.yzCount-1-this.nZ-1),c=b=-1,d=-this.yzCount);e=g;this.resetIndexPlane(this.isoPointIndexPlanes[1]);this.voxelData=
null;var f=this.cubeCountY+(this.colorDensity?1:0),l=this.cubeCountZ+(this.colorDensity?1:0);switch(this.mode){case 3:this.getPlane(a,!1);break;case 1:this.voxelData=this.volumeData.getVoxelData()}this.allInside=this.colorDensity&&(0==this.cutoff||2==this.mode&&0==this.bsVoxels.cardinality());for(var k=this.colorDensity&&0==this.cutoff,m=0;a!=b;a+=c,g+=d,e=g)if(3==this.mode&&a+c<=b&&this.getPlane(a+c,!0),!this.bsExcludedPlanes.get(a)||!this.bsExcludedPlanes.get(a+c))if(this.colorDensity)for(var j=
f;0<=--j;)for(var n=l;0<=--n;e--)m=this.getValue(a,j,n,e,0),(k||this.$isInside)&&this.addVertex(a,j,n,e,m);else{j=this.isoPointIndexPlanes[0];this.isoPointIndexPlanes[0]=this.isoPointIndexPlanes[1];this.isoPointIndexPlanes[1]=this.resetIndexPlane(j);for(var q=!0,j=f;0<=--j;e--)for(n=l;0<=--n;e--){for(var s=0,r=8;0<=--r;)m=this.getValue(a,j,n,e,r),this.$isInside&&(s|=JU.TriangleData.Pwr2[r]);q&&!Float.isNaN(m)&&(q=!1);0!=s&&255!=s&&this.processOneCubical(s,a,j,n,e)&&(!this.isContoured&&!this.colorDensity)&&
this.processTriangles(s)}q&&this.bsExcludedPlanes.set(a)}return this.edgeData.toString()});e(c$,"getValue",function(a,b,c,d,e){this.offset=JU.TriangleData.cubeVertexOffsets[e];d+=this.linearOffsets[e];switch(this.mode){case 3:a=this.vertexValues[e]=this.getValueArray(a+this.offset.x,b+this.offset.y,c+this.offset.z,d,this.yzPlanes[J.jvxl.calc.MarchingCubes.yzPlanePts[e]]);this.$isInside=this.allInside||this.bsVoxels.get(d);break;case 2:this.$isInside=this.allInside||this.bsVoxels.get(d);a=this.vertexValues[e]=
this.bsExcludedVertices.get(d)?NaN:this.$isInside?1:0;break;default:case 1:null==this.mappingPlane?a=this.vertexValues[e]=this.voxelData[a+this.offset.x][b+this.offset.y][c+this.offset.z]:(this.volumeData.voxelPtToXYZ(a+this.offset.x,b+this.offset.y,c+this.offset.z,this.pt0),a=this.vertexValues[e]=this.volumeData.distanceToMappingPlane(this.pt0)),this.isSquared&&(this.vertexValues[e]*=this.vertexValues[e]),(this.$isInside=this.allInside?!0:J.jvxl.calc.MarchingCubes.isInside(this.vertexValues[e],this.cutoff,
this.isCutoffAbsolute))&&this.bsVoxels.set(d)}return a},"~N,~N,~N,~N,~N");e(c$,"getPlane",function(a,b){if(!(0>a||a>this.cubeCountX))if(this.surfaceReader.getPlane(a),b){var c=this.yzPlanes[0];this.yzPlanes[0]=this.yzPlanes[1];this.yzPlanes[1]=c}},"~N,~B");e(c$,"processTriangles",function(a){a=JU.TriangleData.triangleTable2[a];for(var b=a.length;0<=(b-=4);)this.addTriangle(a[b],a[b+1],a[b+2],a[b+3])},"~N");e(c$,"addVertex",function(a,b,c,d,e){this.volumeData.voxelPtToXYZ(a,b,c,this.pt0);0>this.surfaceReader.addVertexCopy(this.pt0,
e,-4,!0)&&this.bsExcludedVertices.set(d)},"~N,~N,~N,~N,~N");e(c$,"addTriangle",function(a,b,c,d){!this.bsExcludedTriangles.get(this.nTriangles)&&0>this.surfaceReader.addTriangleCheck(this.edgePointIndexes[a],this.edgePointIndexes[b],this.edgePointIndexes[c],d,0,this.isCutoffAbsolute,0)&&this.bsExcludedTriangles.set(this.nTriangles);this.nTriangles++},"~N,~N,~N,~N");e(c$,"getValueArray",function(a,b,c,d,e){var g=d%this.yzCount;this.bsValues.set(d);a=this.surfaceReader.getValue(a,b,c,g);this.isSquared&&
(a*=a);e[g]=a;J.jvxl.calc.MarchingCubes.isInside(a,this.cutoff,this.isCutoffAbsolute)&&this.bsVoxels.set(d);return a},"~N,~N,~N,~N,~A");c$.isInside=e(c$,"isInside",function(a,b,c){return 0<b&&(c?Math.abs(a):a)>=b||0>=b&&a<=b},"~N,~N,~B");e(c$,"processOneCubical",function(a,b,c,d,e){a=J.jvxl.calc.MarchingCubes.insideMaskTable[a];for(var g=!1,f=12;0<=--f;)if(0!=(a&JU.TriangleData.Pwr2[f])){var l=this.edgeVertexPlanes[f],k=(e+this.linearOffsets[this.edgeVertexPointers[f]])%this.yzCount,m=J.jvxl.calc.MarchingCubes.edgeTypeTable[f],
j=this.edgePointIndexes[f]=this.isoPointIndexPlanes[l][k][m];if(-2147483648!=j)-1==j&&(g=this.excludePartialCubes);else{var j=JU.TriangleData.edgeVertexes[f<<1],n=JU.TriangleData.edgeVertexes[(f<<1)+1],q=this.vertexValues[j],s=this.vertexValues[n];this.calcVertexPoint(b,c,d,j,this.pointA);this.edgeCount++;l=this.edgePointIndexes[f]=this.isoPointIndexPlanes[l][k][m]=this.surfaceReader.getSurfacePointIndexAndFraction(this.cutoff,this.isCutoffAbsolute,b,c,d,JU.TriangleData.cubeVertexOffsets[j],j,n,q,
s,this.pointA,this.edgeVectors[f],m==this.contourType,this.fReturn);this.addEdgeData(0>l?NaN:this.fReturn[0]);if(Float.isNaN(this.fReturn[0])||0>l)g=this.excludePartialCubes}}return!g},"~N,~N,~N,~N,~N");e(c$,"addEdgeData",function(a){a=J.jvxl.data.JvxlCoder.jvxlFractionAsCharacter(a);this.edgeData.appendC(a)},"~N");e(c$,"calcVertexPoint",function(a,b,c,d,e){this.volumeData.voxelPtToXYZ(a,b,c,this.pt0);e.add2(this.pt0,this.voxelVertexVectors[d])},"~N,~N,~N,~N,JU.P3");e(c$,"setLinearOffsets",function(){this.linearOffsets[0]=
0;this.linearOffsets[1]=this.yzCount;this.linearOffsets[2]=this.yzCount+1;this.linearOffsets[3]=1;this.linearOffsets[4]=this.nZ;this.linearOffsets[5]=this.yzCount+this.nZ;this.linearOffsets[6]=this.yzCount+this.nZ+1;this.linearOffsets[7]=this.nZ+1});e(c$,"getLinearOffset",function(a,b,c,d){return a*this.yzCount+b*this.nZ+c+this.linearOffsets[d]},"~N,~N,~N,~N");H(c$,"MODE_CUBE",1,"MODE_JVXL",2,"MODE_PLANES",3);H(c$,"yzPlanePts",[0,1,1,0,0,1,1,0],"edgeVertexPointersLowToHigh",[1,1,2,0,5,5,6,4,0,1,2,
3],"edgeVertexPointersHighToLow",[0,1,3,0,4,5,7,4,0,1,2,3],"edgeVertexPlanesLowToHigh",[1,1,1,0,1,1,1,0,0,1,1,0],"edgeVertexPlanesHighToLow",[1,0,1,1,1,0,1,1,1,0,0,1]);c$.cubeVertexVectors=c$.prototype.cubeVertexVectors=[JU.V3.new3(0,0,0),JU.V3.new3(1,0,0),JU.V3.new3(1,0,1),JU.V3.new3(0,0,1),JU.V3.new3(0,1,0),JU.V3.new3(1,1,0),JU.V3.new3(1,1,1),JU.V3.new3(0,1,1)];H(c$,"edgeTypeTable",[0,2,0,2,0,2,0,2,1,1,1,1],"insideMaskTable",[0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,
3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,
3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,
3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0])});y("J.jvxl.calc");z(["JU.P3","java.util.Hashtable"],"J.jvxl.calc.MarchingSquares",["java.lang.Float","JU.AU","JU.Logger"],function(){c$=x(function(){this.volumeData=this.surfaceReader=null;this.valueMax=this.valueMin=this.thisContour=this.contourType=this.nContourSegments=0;this.pointB=this.pointA=null;this.contourFromZero=!0;this.contoursDiscrete=null;this.contourVertexCount=
0;this.contourVertexes=null;O("J.jvxl.calc.MarchingSquares.ContourVertex")||J.jvxl.calc.MarchingSquares.$MarchingSquares$ContourVertex$();this.contourPlaneMaximumValue=this.contourPlaneMinimumValue=0;this.ptTemp=this.contourValuesUsed=null;this.triangleCount=0;this.htPts=this.triangles=null;O("J.jvxl.calc.MarchingSquares.Triangle")||J.jvxl.calc.MarchingSquares.$MarchingSquares$Triangle$();A(this,arguments)},J.jvxl.calc,"MarchingSquares");G(c$,function(){this.pointA=new JU.P3;this.pointB=new JU.P3;
this.contourVertexes=Array(1E3);this.ptTemp=new JU.P3;this.triangles=Array(1E3);this.htPts=new java.util.Hashtable});C(c$,function(a,b,c,d,e,g,f){this.surfaceReader=a;this.volumeData=b;this.thisContour=g;this.contoursDiscrete=d;this.contourFromZero=f;null==d?(this.nContourSegments=(0==e?9:e)+0,100<this.nContourSegments&&(this.nContourSegments=100)):(this.nContourSegments=e=d.length,this.contourFromZero=!1)},"J.jvxl.api.VertexDataServer,J.jvxl.data.VolumeData,JU.P4,~A,~N,~N,~B");e(c$,"getContourType",
function(){return this.contourType});e(c$,"setMinMax",function(a,b){this.valueMin=a;this.valueMax=b},"~N,~N");e(c$,"addContourVertex",function(a,b){this.contourVertexCount==this.contourVertexes.length&&(this.contourVertexes=JU.AU.doubleLength(this.contourVertexes));var c=this.surfaceReader.addVertexCopy(a,b,-2,!0);this.contourVertexes[this.contourVertexCount++]=N(J.jvxl.calc.MarchingSquares.ContourVertex,this,null,a);return c},"JU.P3,~N");e(c$,"setContourData",function(a,b){this.contourVertexes[a].setValue(b)},
"~N,~N");e(c$,"getContourValues",function(){return this.contourValuesUsed});e(c$,"calcContourPoint",function(a,b,c,d){return this.volumeData.calculateFractionalPoint(a,this.pointA,this.pointB,b,c,d)},"~N,~N,~N,JU.P3");e(c$,"addTriangle",function(a,b,c,d,e){this.triangleCount==this.triangles.length&&(this.triangles=JU.AU.doubleLength(this.triangles));this.triangles[this.triangleCount++]=N(J.jvxl.calc.MarchingSquares.Triangle,this,null,a,b,c,d,e);return 0},"~N,~N,~N,~N,~N");e(c$,"generateContourData",
function(a,b){JU.Logger.info("generateContours: "+this.nContourSegments+" segments");this.getVertexValues(a);this.createContours(this.valueMin,this.valueMax,b);this.addAllTriangles();return this.contourVertexCount},"~B,~N");e(c$,"getVertexValues",function(a){this.contourPlaneMinimumValue=3.4028235E38;this.contourPlaneMaximumValue=-3.4028235E38;for(var b=0;b<this.contourVertexCount;b++){var c=this.contourVertexes[b],d;a?d=c.value:(d=this.volumeData.lookupInterpolatedVoxelValue(c,!1),c.setValue(d));
d<this.contourPlaneMinimumValue&&(this.contourPlaneMinimumValue=d);d>this.contourPlaneMaximumValue&&(this.contourPlaneMaximumValue=d)}},"~B");e(c$,"createContours",function(a,b,c){b-=a;this.contourValuesUsed=u(this.nContourSegments,0);for(var d=this.triangleCount;0<=--d;)this.triangles[d].check=0;for(var e=-3.4028235E38,d=0;d<this.nContourSegments;d++){e=null!=this.contoursDiscrete?this.contoursDiscrete[d]:this.contourFromZero?a+1*d/this.nContourSegments*b:0==d?-3.4028235E38:d==this.nContourSegments-
1?3.4028235E38:a+1*(d-1)/(this.nContourSegments-1)*b;null==this.contoursDiscrete&&Math.abs(e)<c&&(e=0>e?-c:c);this.contourValuesUsed[d]=e;JU.Logger.info("#contour "+(d+1)+" "+e);this.htPts.clear();for(var g=this.triangleCount;0<=--g;)this.triangles[g].isValid&&this.checkContour(this.triangles[g],d,e)}this.valueMin=this.contourValuesUsed[0];this.valueMax=0==this.contourValuesUsed.length?this.valueMin:this.contourValuesUsed[this.contourValuesUsed.length-1];return!0},"~N,~N,~N");e(c$,"intercept",function(a,
b,c){var d=a.pts[b];a=a.pts[(b+1)%3];if(2147483647==d||2147483647==a)return-1;b=d<a?d+"_"+a:a+"_"+d;if(this.htPts.containsKey(b))return this.htPts.get(b).intValue();var e=this.contourVertexes[d].value,g=this.contourVertexes[a].value,f=-1;if(e!=g){var l=(c-e)/(g-e);if(0<=l&&1>=l&&(this.pointA.setT(this.contourVertexes[d]),this.pointB.setT(this.contourVertexes[a]),c=this.calcContourPoint(c,e,g,this.ptTemp),!Float.isNaN(c))){f=this.addContourVertex(this.ptTemp,c);if(0>f)return-1;this.contourVertexes[f].setValue(c)}}this.htPts.put(b,
Integer.$valueOf(f));return f},"J.jvxl.calc.MarchingSquares.Triangle,~N,~N");e(c$,"checkContour",function(a,b,c){var d=this.intercept(a,0,c),e=this.intercept(a,1,c);c=this.intercept(a,2,c);var g=a.pts,f=0;0<=d&&(f+=1);0<=e&&(f+=2);0<=c&&(f+=4);switch(f){case 3:this.addTriangle(g[0],d,e,2|a.check&1,b);this.addTriangle(d,g[1],e,4|a.check&3,b);this.addTriangle(g[0],e,g[2],a.check&6,b);break;case 5:this.addTriangle(g[0],d,c,2|a.check&5,b);this.addTriangle(d,g[1],c,4|a.check&1,b);this.addTriangle(c,g[1],
g[2],a.check&6,b);break;case 6:this.addTriangle(g[0],g[1],c,a.check&5,b);this.addTriangle(c,g[1],e,4|a.check&2,b);this.addTriangle(c,e,g[2],1|a.check&6,b);break;default:return}a.isValid=!1},"J.jvxl.calc.MarchingSquares.Triangle,~N,~N");e(c$,"getMinMax",function(){return[this.valueMin,this.valueMax]});e(c$,"addAllTriangles",function(){for(var a=0;a<this.triangleCount;a++)if(this.triangles[a].isValid){var b=this.triangles[a];this.surfaceReader.addTriangleCheck(b.pts[0],b.pts[1],b.pts[2],b.check,b.contourIndex,
!1,-1)}});c$.$MarchingSquares$ContourVertex$=function(){M(self.c$);c$=x(function(){P(this,arguments);this.value=0;A(this,arguments)},J.jvxl.calc.MarchingSquares,"ContourVertex",JU.P3);C(c$,function(a){I(this,J.jvxl.calc.MarchingSquares.ContourVertex,[]);this.setT(a)},"JU.P3");e(c$,"setValue",function(a){this.value=a},"~N");c$=L()};c$.$MarchingSquares$Triangle$=function(){M(self.c$);c$=x(function(){P(this,arguments);this.pts=null;this.check=0;this.isValid=!0;this.contourIndex=0;A(this,arguments)},
J.jvxl.calc.MarchingSquares,"Triangle");C(c$,function(a,b,c,d,e){this.pts=[a,b,c];this.check=d;this.contourIndex=e},"~N,~N,~N,~N,~N");c$=L()};H(c$,"CONTOUR_POINT",-1,"VERTEX_POINT",-2,"EDGE_POINT",-3,"nContourMax",100,"defaultContourCount",9)});y("J.shapesurface");z(["J.shape.Mesh","J.jvxl.data.JvxlData"],"J.shapesurface.IsosurfaceMesh","java.lang.Character $.Float java.util.Hashtable JU.AU $.BS $.CU $.Lst $.M4 $.P3 $.P4 $.PT $.SB $.V3 J.api.Interface J.jvxl.data.JvxlCoder JS.T JU.BoxInfo $.C $.ColorEncoder $.Escape $.Logger $.Measure JV.Viewer".split(" "),
function(){c$=x(function(){this.jvxlData=null;this.vertexIncrement=1;this.firstRealVertex=-1;this.dataType=0;this.hasGridPoints=!1;this.assocGridPointNormals=this.assocGridPointMap=this.info=this.calculatedVolume=this.calculatedArea=null;this.mergeAssociatedNormalCount=0;this.bsVdw=this.colorEncoder=this.contourColixes=this.contourValues=this.centers=null;this.colorPhased=!1;A(this,arguments)},J.shapesurface,"IsosurfaceMesh",J.shape.Mesh);G(c$,function(){this.jvxlData=new J.jvxl.data.JvxlData});C(c$,
function(a,b,c){I(this,J.shapesurface.IsosurfaceMesh,[]);this.mesh1(a,b,c);this.checkByteCount=2;this.jvxlData.version=JV.Viewer.getJmolVersion()},"~S,~N,~N");e(c$,"clearType",function(a,b){this.clear(a);this.jvxlData.clear();this.colorEncoder=this.centers=this.calculatedArea=this.calculatedVolume=this.bsVdw=this.assocGridPointNormals=this.assocGridPointMap=null;this.colorPhased=!1;this.firstRealVertex=-1;this.hasGridPoints=b;this.isColorSolid=!0;this.nSets=this.mergeAssociatedNormalCount=0;this.pcs=
null;this.showPoints=b;this.vertexColorMap=this.vcs=this.surfaceSet=null;this.vertexIncrement=1;this.vvs=this.vertexSets=null},"~S,~B");e(c$,"allocVertexColixes",function(){if(null==this.vcs){this.vcs=K(this.vc,0);for(var a=this.vc;0<=--a;)this.vcs[a]=this.colix}this.isColorSolid=!1});e(c$,"addVertexCopy",function(a,b,c,d,e){a=this.addVCVal(a,b,e);switch(c){case -1:0>this.firstRealVertex&&(this.firstRealVertex=a);break;case -2:this.hasGridPoints=!0;break;case -3:this.vertexIncrement=3;break;default:0>
this.firstRealVertex&&(this.firstRealVertex=a),d&&(null==this.assocGridPointMap&&(this.assocGridPointMap=new java.util.Hashtable),this.assocGridPointMap.put(Integer.$valueOf(a),Integer.$valueOf(c+this.mergeAssociatedNormalCount)))}return a},"JU.T3,~N,~N,~B,~B");j(c$,"setTranslucent",function(a,b){this.colix=JU.C.getColixTranslucent3(this.colix,a,b);if(null!=this.vcs)for(var c=this.vc;0<=--c;)this.vcs[c]=JU.C.getColixTranslucent3(this.vcs[c],a,b)},"~B,~N");e(c$,"setMerged",function(a){this.mergePolygonCount0=
(this.isMerged=a)?this.pc:0;this.mergeVertexCount0=a?this.vc:0;a&&(this.mergeAssociatedNormalCount+=this.jvxlData.nPointsX*this.jvxlData.nPointsY*this.jvxlData.nPointsZ,this.assocGridPointNormals=null)},"~B");j(c$,"sumVertexNormals",function(a,b){this.sumVertexNormals2(a,b);if(null!=this.assocGridPointMap&&0<b.length&&!this.isMerged){null==this.assocGridPointNormals&&(this.assocGridPointNormals=new java.util.Hashtable);for(var c,d=this.assocGridPointMap.entrySet().iterator();d.hasNext()&&((c=d.next())||
1);){var e=c.getValue();this.assocGridPointNormals.containsKey(e)||this.assocGridPointNormals.put(e,JU.V3.new3(0,0,0));this.assocGridPointNormals.get(e).add(b[c.getKey().intValue()])}for(d=this.assocGridPointMap.entrySet().iterator();d.hasNext()&&((c=d.next())||1);)b[c.getKey().intValue()]=this.assocGridPointNormals.get(c.getValue())}},"~A,~A");e(c$,"getCenters",function(){if(null!=this.centers)return this.centers;this.centers=Array(this.pc);for(var a=0;a<this.pc;a++){var b=this.pis[a];if(null!=b){var c=
this.centers[a]=JU.P3.newP(this.vs[b[0]]);c.add(this.vs[b[1]]);c.add(this.vs[b[2]]);c.scale(0.33333334)}}return this.centers});e(c$,"getFacePlane",function(a,b){var c=new JU.P4;JU.Measure.getPlaneThroughPoints(this.vs[this.pis[a][0]],this.vs[this.pis[a][1]],this.vs[this.pis[a][2]],b,this.vAB,this.vAC,c);return c},"~N,JU.V3");e(c$,"getContours",function(){var a=this.jvxlData.nContours;if(0==a||null==this.pis||(this.havePlanarContours=null!=this.jvxlData.jvxlPlane))return null;0>a&&(a=-1-a);var b=this.jvxlData.vContours;
if(null!=b){for(var c=0;c<a&&!(6<b[c].size());c++)J.jvxl.data.JvxlCoder.set3dContourVector(b[c],this.pis,this.vs);return this.jvxlData.vContours}b=Array(a);for(c=0;c<a;c++)b[c]=new JU.Lst;if(null==this.jvxlData.contourValuesUsed){for(var d=(this.jvxlData.valueMappedToBlue-this.jvxlData.valueMappedToRed)/(a+1),c=0;c<a;c++){var e=this.jvxlData.valueMappedToRed+(c+1)*d;this.get3dContour(b[c],e,this.jvxlData.contourColixes[c])}JU.Logger.info(a+" contour lines; separation = "+d)}else for(c=0;c<a;c++)e=
this.jvxlData.contourValuesUsed[c],this.get3dContour(b[c],e,this.jvxlData.contourColixes[c]);this.jvxlData.contourColixes=K(a,0);this.jvxlData.contourValues=u(a,0);for(c=0;c<a;c++)this.jvxlData.contourValues[c]=b[c].get(2).floatValue(),this.jvxlData.contourColixes[c]=b[c].get(3)[0];return this.jvxlData.vContours=b});e(c$,"get3dContour",function(a,b,c){var d=JU.BS.newN(this.pc),e=new JU.SB,g=JU.C.getArgb(c);J.shapesurface.IsosurfaceMesh.setContourVector(a,this.pc,d,b,c,g,e);for(c=0;c<this.pc;c++)this.setABC(c)&&
J.shapesurface.IsosurfaceMesh.addContourPoints(a,d,c,e,this.vs,this.vvs,this.iA,this.iB,this.iC,b)},"JU.Lst,~N,~N");c$.setContourVector=e(c$,"setContourVector",function(a,b,c,d,e,g,f){a.add(0,Integer.$valueOf(b));a.add(1,c);a.add(2,Float.$valueOf(d));a.add(3,[e]);a.add(4,[g]);a.add(5,f)},"JU.Lst,~N,JU.BS,~N,~N,~N,JU.SB");c$.addContourPoints=e(c$,"addContourPoints",function(a,b,c,d,e,g,f,l,k,m){var j=null,n=null,q=0,s=J.shapesurface.IsosurfaceMesh.checkPt(g,f,l,m);Float.isNaN(s)||(j=J.shapesurface.IsosurfaceMesh.getContourPoint(e,
f,l,s),q|=1);var r=1==s?NaN:J.shapesurface.IsosurfaceMesh.checkPt(g,l,k,m);Float.isNaN(r)||(n=J.shapesurface.IsosurfaceMesh.getContourPoint(e,l,k,r),0==q&&(j=n,s=r),q|=2);switch(q){case 0:return;case 1:if(0==s)return;case 2:r=1==r?NaN:J.shapesurface.IsosurfaceMesh.checkPt(g,k,f,m),Float.isNaN(r)||(n=J.shapesurface.IsosurfaceMesh.getContourPoint(e,k,f,r),q|=4)}switch(q){case 3:case 5:case 6:break;default:return}b.set(c);J.jvxl.data.JvxlCoder.appendContourTriangleIntersection(q,s,r,d);a.addLast(j);
a.addLast(n)},"JU.Lst,JU.BS,~N,JU.SB,~A,~A,~N,~N,~N,~N");c$.checkPt=e(c$,"checkPt",function(a,b,c,d){var e,g;return d==(e=a[b])?0:d==(g=a[c])?1:e<d==d<g?(d-e)/(g-e):NaN},"~A,~N,~N,~N");c$.getContourPoint=e(c$,"getContourPoint",function(a,b,c,d){var e=new JU.P3;e.sub2(a[c],a[b]);e.scaleAdd2(d,e,a[b]);return e},"~A,~N,~N,~N");e(c$,"setDiscreteColixes",function(a,b){null!=a&&(this.jvxlData.contourValues=a);if(null==a||0==a.length)a=this.jvxlData.contourValues=this.jvxlData.contourValuesUsed;null==b&&
null!=this.jvxlData.contourColixes?b=this.jvxlData.contourColixes:(this.jvxlData.contourColixes=b,this.jvxlData.contourColors=JU.C.getHexCodes(b));if(!(null==this.vs||null==this.vvs||null==a)){var c=a.length,d=a[c-1];this.colorCommand=null;var e=null!=b&&0<b.length;this.isColorSolid=e&&null!=this.jvxlData.jvxlPlane;if(null!=this.jvxlData.vContours){if(e)for(var g=0;g<this.jvxlData.vContours.length;g++)c=b[g%b.length],this.jvxlData.vContours[g].get(3)[0]=c,this.jvxlData.vContours[g].get(4)[0]=JU.C.getArgb(c)}else{this.pcs=
K(this.pc,0);for(g=0;g<this.pc;g++){var f=this.pis[g];if(null!=f){this.pcs[g]=0;for(var f=(this.vvs[f[0]]+this.vvs[f[1]]+this.vvs[f[2]])/3,l=c;0<=--l;)if(f>=a[l]&&f<d){this.pcs[g]=e?b[l%b.length]:0;break}}}}}},"~A,~A");e(c$,"getContourList",function(){var a=new java.util.Hashtable;a.put("values",null==this.jvxlData.contourValuesUsed?this.jvxlData.contourValues:this.jvxlData.contourValuesUsed);var b=new JU.Lst;if(null!=this.jvxlData.contourColixes){for(var c=0;c<this.jvxlData.contourColixes.length;c++)b.addLast(JU.CU.colorPtFromInt(JU.C.getArgb(this.jvxlData.contourColixes[c]),
null));a.put("colors",b)}return a},"JV.Viewer");e(c$,"deleteContours",function(){this.jvxlData.contourValuesUsed=null;this.jvxlData.contourValues=null;this.jvxlData.contourColixes=null;this.jvxlData.vContours=null});e(c$,"setVertexColorMap",function(){this.vertexColorMap=new java.util.Hashtable;for(var a=-999,b=null,c=this.vc;0<=--c;){var d=this.vcs[c];d!=a&&(d=JU.C.getHexCode(a=d),b=this.vertexColorMap.get(d),null==b&&this.vertexColorMap.put(d,b=new JU.BS));b.set(c)}});e(c$,"setVertexColixesForAtoms",
function(a,b,c,d){this.jvxlData.vertexDataOnly=!0;this.jvxlData.vertexColors=t(this.vc,0);this.jvxlData.nVertexColors=this.vc;for(var e=a.ms.at,g=this.mergeVertexCount0;g<this.vc;g++){var f=this.vertexSource[g];if(!(0>f)&&d.get(f)){this.jvxlData.vertexColors[g]=a.getColorArgbOrGray(this.vcs[g]=JU.C.copyColixTranslucency(this.colix,e[f].getColix()));var l=null==b?0:b[c[f]];0==l&&(l=e[f].getColix());this.vcs[g]=JU.C.copyColixTranslucency(this.colix,l)}}},"JV.Viewer,~A,~A,JU.BS");e(c$,"colorVertices",
function(a,b,c){if(null!=this.vertexSource){a=JU.C.copyColixTranslucency(this.colix,a);var d=c?new JU.BS:b;this.checkAllocColixes();if(c)for(var e=0;e<this.vc;e++){var g=this.vertexSource[e];0<=g&&b.get(g)&&(this.vcs[e]=a,null!=d&&d.set(e))}else for(e=0;e<this.vc;e++)d.get(e)&&(this.vcs[e]=a);c&&(a=JU.C.getHexCode(a),null==this.vertexColorMap&&(this.vertexColorMap=new java.util.Hashtable),J.shapesurface.IsosurfaceMesh.addColorToMap(this.vertexColorMap,a,b))}},"~N,JU.BS,~B");e(c$,"checkAllocColixes",
function(){(null==this.vcs||null==this.vertexColorMap&&this.isColorSolid)&&this.allocVertexColixes();this.isColorSolid=!1});c$.addColorToMap=e(c$,"addColorToMap",function(a,b,c){for(var d=null,e,g=a.entrySet().iterator();g.hasNext()&&((e=g.next())||1);)e.getKey()===b?(d=e.getValue(),d.or(c)):e.getValue().andNot(c);null==d&&a.put(b,c)},"java.util.Map,~S,JU.BS");e(c$,"setJvxlColorMap",function(a){this.jvxlData.diameter=this.diameter;this.jvxlData.color=JU.C.getHexCode(this.colix);this.jvxlData.meshColor=
0==this.meshColix?null:JU.C.getHexCode(this.meshColix);this.jvxlData.translucency=JU.C.getColixTranslucencyFractional(this.colix);this.jvxlData.rendering=this.getRendering().substring(1);this.jvxlData.colorScheme=null==this.colorEncoder?null:this.colorEncoder.getColorScheme();null==this.jvxlData.vertexColors&&(this.jvxlData.nVertexColors=null==this.vertexColorMap?0:this.vertexColorMap.size());if(!(null==this.vertexColorMap||null==this.vertexSource||!a)){null==this.jvxlData.vertexColorMap&&(this.jvxlData.vertexColorMap=
new java.util.Hashtable);var b;for(a=this.vertexColorMap.entrySet().iterator();a.hasNext()&&((b=a.next())||1);){var c=b.getValue();if(!c.isEmpty()){for(var d=b.getKey(),e=new JU.BS,g=0;g<this.vc;g++)c.get(this.vertexSource[g])&&e.set(g);J.shapesurface.IsosurfaceMesh.addColorToMap(this.jvxlData.vertexColorMap,d,e)}}this.jvxlData.nVertexColors=this.jvxlData.vertexColorMap.size();0==this.jvxlData.vertexColorMap.size()&&(this.jvxlData.vertexColorMap=null)}},"~B");e(c$,"setColorCommand",function(){null!=
this.colorEncoder&&(this.colorCommand=this.colorEncoder.getColorScheme(),this.colorCommand.equals("inherit")?this.colorCommand="#inherit;":null!=this.colorCommand&&(this.colorCommand="color $"+(Character.isLetter(this.thisID.charAt(0))&&0>this.thisID.indexOf(" ")?this.thisID:'"'+this.thisID+'"')+' "'+this.colorCommand+'" range '+(this.jvxlData.isColorReversed?this.jvxlData.valueMappedToBlue+" "+this.jvxlData.valueMappedToRed:this.jvxlData.valueMappedToRed+" "+this.jvxlData.valueMappedToBlue)))});
e(c$,"setColorsFromJvxlData",function(a){this.diameter=this.jvxlData.diameter;-1!=a&&(-2147483648!=a&&2147483647!=a?this.colix=JU.C.getColix(a):null!=this.jvxlData.color&&(this.colix=JU.C.getColixS(this.jvxlData.color)));0==this.colix&&(this.colix=5);this.colix=JU.C.getColixTranslucent3(this.colix,0!=this.jvxlData.translucency,this.jvxlData.translucency);null!=this.jvxlData.meshColor&&(this.meshColix=JU.C.getColixS(this.jvxlData.meshColor));this.setJvxlDataRendering();this.isColorSolid=!this.jvxlData.isBicolorMap&&
null==this.jvxlData.vertexColors&&null==this.jvxlData.vertexColorMap;if(null!=this.colorEncoder)if(null==this.jvxlData.vertexColorMap){if(null!=this.jvxlData.colorScheme){var b=this.jvxlData.colorScheme;(a=b.startsWith("translucent "))&&(b=b.substring(12));this.colorEncoder.setColorScheme(b,a);this.remapColors(null,null,NaN)}}else{if(null!=this.jvxlData.baseColor)for(a=this.vc;0<=--a;)this.vcs[a]=this.colix;for(var c=this.jvxlData.vertexColorMap.entrySet().iterator();c.hasNext()&&((b=c.next())||1);){var d=
b.getValue(),e=JU.C.copyColixTranslucency(this.colix,JU.C.getColixS(b.getKey()));for(a=d.nextSetBit(0);0<=a;a=d.nextSetBit(a+1))this.vcs[a]=e}}},"~N");e(c$,"setJvxlDataRendering",function(){if(null!=this.jvxlData.rendering)for(var a=JU.PT.getTokens(this.jvxlData.rendering),b=0;b<a.length;b++)this.setTokenProperty(JS.T.getTokFromName(a[b]),!0)});e(c$,"remapColors",function(a,b,c){null==b&&(b=this.colorEncoder);null==b&&(b=this.colorEncoder=new JU.ColorEncoder(null));this.colorEncoder=b;this.setColorCommand();
Float.isNaN(c)?c=JU.C.getColixTranslucencyLevel(this.colix):this.colix=JU.C.getColixTranslucent3(this.colix,!0,c);var d=b.lo,e=b.hi,g=null!=this.vertexSource&&15==b.currentPalette;this.pcs=this.vertexColorMap=null;this.jvxlData.baseColor=null;this.jvxlData.vertexCount=this.vc;if(!(null==this.vvs||0==this.jvxlData.vertexCount))if((null==this.vcs||this.vcs.length!=this.vc)&&this.allocVertexColixes(),g){this.jvxlData.vertexDataOnly=!0;this.jvxlData.vertexColors=t(this.vc,0);this.jvxlData.nVertexColors=
this.vc;b=a.ms.at;for(d=this.mergeVertexCount0;d<this.vc;d++)c=this.vertexSource[d],0<=c&&c<b.length&&(this.jvxlData.vertexColors[d]=a.getColorArgbOrGray(this.vcs[d]=JU.C.copyColixTranslucency(this.colix,b[c].getColix())))}else if(this.jvxlData.vertexColors=null,this.jvxlData.vertexColorMap=null,this.jvxlData.isBicolorMap)for(d=this.mergeVertexCount0;d<this.vc;d++)this.vcs[d]=JU.C.copyColixTranslucency(this.colix,0>this.vvs[d]?this.jvxlData.minColorIndex:this.jvxlData.maxColorIndex);else{this.jvxlData.isColorReversed=
b.isReversed;3.4028235E38!=e&&(this.jvxlData.valueMappedToRed=d,this.jvxlData.valueMappedToBlue=e);b.setRange(this.jvxlData.valueMappedToRed,this.jvxlData.valueMappedToBlue,this.jvxlData.isColorReversed);a=JU.C.isColixTranslucent(this.colix);b.isTranslucent&&(a||(this.colix=JU.C.getColixTranslucent3(this.colix,!0,0.5)),a=!1);for(d=this.vc;--d>=this.mergeVertexCount0;)this.vcs[d]=b.getColorIndex(this.vvs[d]);this.setTranslucent(a,c);this.colorEncoder=b;a=this.getContours();if(null!=a)for(d=a.length;0<=
--d;)c=a[d].get(2).floatValue(),e=a[d].get(3),e[0]=b.getColorIndex(c),a[d].get(4)[0]=JU.C.getArgb(e[0]);if(null!=this.contourValues){this.contourColixes=K(this.contourValues.length,0);for(d=0;d<this.contourValues.length;d++)this.contourColixes[d]=b.getColorIndex(this.contourValues[d]);this.setDiscreteColixes(null,null)}this.jvxlData.isJvxlPrecisionColor=!0;J.jvxl.data.JvxlCoder.jvxlCreateColorData(this.jvxlData,this.vvs);this.setColorCommand();this.isColorSolid=!1}},"JV.Viewer,JU.ColorEncoder,~N");
e(c$,"reinitializeLightingAndColor",function(a){this.initialize(this.lighting,null,null);if(null!=this.colorEncoder||this.jvxlData.isBicolorMap)this.vcs=null,this.remapColors(a,null,NaN)},"JV.Viewer");j(c$,"getBoundingBox",function(){return this.jvxlData.boundingBox});e(c$,"resetBoundingBox",function(){var a=new JU.BoxInfo;if(0==this.pc)for(var b=this.vc;0<=--b;)a.addBoundBoxPoint(this.vs[b]);else for(var c=new JU.BS,b=this.pc;0<=--b;)this.setABC(b)&&(c.get(this.iA)||(a.addBoundBoxPoint(this.vs[this.iA]),
c.set(this.iA)),c.get(this.iB)||(a.addBoundBoxPoint(this.vs[this.iB]),c.set(this.iB)),c.get(this.iC)||(a.addBoundBoxPoint(this.vs[this.iC]),c.set(this.iC)));this.jvxlData.boundingBox=a.getBoundBoxPoints(!1)});e(c$,"merge",function(a){var b=this.vc+(null==a?0:a.vc);null==this.pis&&(this.pis=t(0,0,0));null!=a&&null==a.pis&&(a.pis=t(0,0,0));var c=(null==this.bsSlabDisplay||0==this.pc?this.pc:this.bsSlabDisplay.cardinality())+(null==a||0==a.pc?0:null==a.bsSlabDisplay?a.pc:a.bsSlabDisplay.cardinality());
null==this.vs&&(this.vs=[]);this.vs=JU.AU.ensureLength(this.vs,b);this.vvs=JU.AU.ensureLengthA(this.vvs,b);var d=null!=this.vertexSource&&(null==a||null!=a.vertexSource);this.vertexSource=JU.AU.ensureLengthI(this.vertexSource,b);var e=JU.AU.newInt2(c),g=J.shapesurface.IsosurfaceMesh.mergePolygons(this,0,0,e);if(null!=a){J.shapesurface.IsosurfaceMesh.mergePolygons(a,g,this.vc,e);for(g=0;g<a.vc;g++,this.vc++)this.vs[this.vc]=a.vs[g],this.vvs[this.vc]=a.vvs[g],d&&(this.vertexSource[this.vc]=a.vertexSource[g])}this.pc=
this.polygonCount0=c;this.vc=this.vertexCount0=b;0<c&&this.resetSlab();this.pis=e},"J.jvxl.data.MeshData");c$.mergePolygons=e(c$,"mergePolygons",function(a,b,c,d){for(var e,g=0;g<a.pc;g++)if(!(null==(e=a.pis[g])||null!=a.bsSlabDisplay&&!a.bsSlabDisplay.get(g)))if(d[b++]=a.pis[g],0<c)for(var f=0;3>f;f++)e[f]+=c;return b},"JU.MeshSurface,~N,~N,~A");j(c$,"getUnitCell",function(){return null==this.spanningVectors?null:J.api.Interface.getSymmetry().getUnitCell(this.spanningVectors,!0,null)});j(c$,"slabBrillouin",
function(a){var b=null==a?this.spanningVectors:a;if(null!=b){a=Array(27);a[0]=JU.P3.newP(b[0]);for(var c=0,d=-1;1>=d;d++)for(var e=-1;1>=e;e++)for(var g=-1;1>=g;g++)if(0!=d||0!=e||0!=g)a[++c]=JU.P3.newP(a[0]),a[c].scaleAdd2(d,b[1],a[c]),a[c].scaleAdd2(e,b[2],a[c]),a[c].scaleAdd2(g,b[3],a[c]);System.out.println("draw line1 {0 0 0} color red"+JU.Escape.eP(this.spanningVectors[1]));System.out.println("draw line2 {0 0 0} color green"+JU.Escape.eP(this.spanningVectors[2]));System.out.println("draw line3 {0 0 0} color blue"+
JU.Escape.eP(this.spanningVectors[3]));var b=new JU.P3,c=new JU.P4,f=new JU.V3,l=new JU.V3,k=new JU.BS,m=new java.util.Hashtable;this.bsSlabGhost=new JU.BS;for(d=1;27>d;d++){f.setT(a[d]);JU.Measure.getBisectingPlane(a[0],f,b,l,c);this.getIntersection(1,c,null,null,null,null,null,!1,!1,135266319,!0);k.clearAll();m.clear();for(e=this.bsSlabGhost.nextSetBit(0);0<=e;e=this.bsSlabGhost.nextSetBit(e+1))if(this.setABC(e)){for(var j=JU.AU.arrayCopyRangeI(this.pis[e],0,-1),g=0;3>g;g++){var n=j[g];j[g]=this.addIntersectionVertex(this.vs[n],
this.vvs[n],null==this.vertexSource?0:this.vertexSource[n],null==this.vertexSets?0:this.vertexSets[n],m,0,n);n!=j[g]&&k.get(n)&&k.set(j[g])}this.addPolygonC(j,0,this.bsSlabDisplay);for(g=0;3>g;g++)k.get(j[g])||(k.set(j[g]),this.vs[j[g]].sub(f))}0<=this.bsSlabGhost.nextSetBit(0)&&(this.bsSlabGhost.clearAll(),d=0)}this.bsSlabGhost=null;this.resetBoundingBox()}},"~A");j(c$,"getMinDistance2ForVertexGrouping",function(){return null!=this.jvxlData.boundingBox&&null!=this.jvxlData.boundingBox[0]&&5>this.jvxlData.boundingBox[1].distanceSquared(this.jvxlData.boundingBox[0])?
1E-10:1E-8});j(c$,"getVisibleVertexBitSet",function(){var a=this.getVisibleVBS();if(0<=this.jvxlData.thisSet)for(var b=0;b<this.vc;b++)this.vertexSets[b]!=this.jvxlData.thisSet&&a.clear(b);return a});e(c$,"updateCoordinates",function(a,b){var c=null==b;if(!c)for(var d=0;d<this.connections.length;d++)if(0<=this.connections[d]&&b.get(this.connections[d])){c=!0;break}c&&(null==this.mat4&&(this.mat4=JU.M4.newM4(null)),this.mat4.mul2(a,this.mat4),this.recalcAltVertices=!0)},"JU.M4,JU.BS")});y("J.jvxl.readers");
z(["J.jvxl.readers.SurfaceReader"],"J.jvxl.readers.VolumeDataReader",["JU.AU","$.SB","J.jvxl.data.JvxlCoder","JU.Logger"],function(){c$=x(function(){this.dataType=0;this.allowMapData=this.precalculateVoxelData=!1;this.point=null;this.maxGrid=this.ptsPerAngstrom=0;this.atomDataServer=null;this.useOriginStepsPoints=!1;A(this,arguments)},J.jvxl.readers,"VolumeDataReader",J.jvxl.readers.SurfaceReader);C(c$,function(){I(this,J.jvxl.readers.VolumeDataReader,[])});e(c$,"initVDR",function(a){this.initSR(a);
this.useOriginStepsPoints=null!=this.params.origin&&null!=this.params.points&&null!=this.params.steps;this.dataType=this.params.dataType;this.allowMapData=this.precalculateVoxelData=!0},"J.jvxl.readers.SurfaceGenerator");e(c$,"setup",function(){this.jvxlFileHeaderBuffer=(new JU.SB).append("volume data read from file\n\n");J.jvxl.data.JvxlCoder.jvxlCreateHeaderWithoutTitleOrAtoms(this.volumeData,this.jvxlFileHeaderBuffer)},"~B");j(c$,"readVolumeParameters",function(a){this.setup(a);this.initializeVolumetricData();
return!0},"~B");j(c$,"readVolumeData",function(a){try{this.readSurfaceData(a)}catch(b){if(D(b,Exception))return System.out.println(b.toString()),!1;throw b;}return!0},"~B");e(c$,"readVoxelDataIndividually",function(a){if(!a||this.allowMapData)if(!a||null!=this.volumeData.sr)this.volumeData.setVoxelDataAsArray(this.voxelData=null);else{this.newVoxelDataCube();for(a=0;a<this.nPointsX;++a){var b=JU.AU.newFloat2(this.nPointsY);this.voxelData[a]=b;for(var c=0,d=0;d<this.nPointsY;++d)for(var e=b[d]=u(this.nPointsZ,
0),g=0;g<this.nPointsZ;++g,++c)e[g]=this.getValue(a,d,g,c)}}},"~B");e(c$,"setVolumeData",function(){});e(c$,"setVolumeDataParams",function(){if(null!=this.params.volumeData)return this.setVolumeDataV(this.params.volumeData),!0;if(!this.useOriginStepsPoints)return!1;this.volumetricOrigin.setT(this.params.origin);this.volumetricVectors[0].set(this.params.steps.x,0,0);this.volumetricVectors[1].set(0,this.params.steps.y,0);this.volumetricVectors[2].set(0,0,this.params.steps.z);this.voxelCounts[0]=E(this.params.points.x);
this.voxelCounts[1]=E(this.params.points.y);this.voxelCounts[2]=E(this.params.points.z);if(1>this.voxelCounts[0]||1>this.voxelCounts[1]||1>this.voxelCounts[2])return!1;this.showGridInfo();return!0});e(c$,"showGridInfo",function(){JU.Logger.info("grid origin  = "+this.params.origin);JU.Logger.info("grid steps   = "+this.params.steps);JU.Logger.info("grid points  = "+this.params.points);this.ptTemp.x=this.params.steps.x*this.params.points.x;this.ptTemp.y=this.params.steps.y*this.params.points.y;this.ptTemp.z=
this.params.steps.z*this.params.points.z;JU.Logger.info("grid lengths = "+this.ptTemp);this.ptTemp.add(this.params.origin);JU.Logger.info("grid max xyz = "+this.ptTemp)});e(c$,"setVoxelRange",function(a,b,c,d,e,g){b>=c&&(b=-10,c=10);var f=c-b,l=this.params.resolution;3.4028235E38!=l&&(d=l);c=v(Math.floor(f*d))+1;c>e&&(0<(this.dataType&256)?3.4028235E38==l?(this.isQuiet||JU.Logger.info("Maximum number of voxels for index="+a+" exceeded ("+c+") -- set to "+e),c=e):this.isQuiet||JU.Logger.info("Warning -- high number of grid points: "+
c):3.4028235E38==l&&(c=e));d=(c-1)/f;d<g&&(c=v(Math.floor(g*f+1)),d=(c-1)/f);e=this.volumeData.volumetricVectorLengths[a]=1/d;this.voxelCounts[a]=c;this.isQuiet||JU.Logger.info("isosurface resolution for axis "+(a+1)+" set to "+d+" points/Angstrom; "+this.voxelCounts[a]+" voxels");switch(a){case 0:this.volumetricVectors[0].set(e,0,0);this.volumetricOrigin.x=b;break;case 1:this.volumetricVectors[1].set(0,e,0);this.volumetricOrigin.y=b;break;case 2:this.volumetricVectors[2].set(0,0,e),this.volumetricOrigin.z=
b,this.isEccentric&&this.eccentricityMatrix.rotate(this.volumetricOrigin),null!=this.center&&3.4028235E38!=this.center.x&&this.volumetricOrigin.add(this.center)}this.isEccentric&&this.eccentricityMatrix.rotate(this.volumetricVectors[a]);return this.voxelCounts[a]},"~N,~N,~N,~N,~N,~N");j(c$,"readSurfaceData",function(a){this.readSurfaceDataVDR(a)},"~B");e(c$,"readSurfaceDataVDR",function(a){this.isProgressive&&!a?(this.nDataPoints=this.volumeData.setVoxelCounts(this.nPointsX,this.nPointsY,this.nPointsZ),
this.voxelData=null):this.precalculateVoxelData?this.generateCube():this.readVoxelDataIndividually(a)},"~B");e(c$,"generateCube",function(){JU.Logger.info("data type: user volumeData");JU.Logger.info("voxel grid origin:"+this.volumetricOrigin);for(var a=0;3>a;++a)JU.Logger.info("voxel grid vector:"+this.volumetricVectors[a]);JU.Logger.info("Read "+this.nPointsX+" x "+this.nPointsY+" x "+this.nPointsZ+" data points")});j(c$,"closeReader",function(){})});y("J.jvxl.readers");z(["J.jvxl.readers.VolumeDataReader",
"JU.BS","$.P3","$.P3i","J.atomdata.AtomData"],"J.jvxl.readers.AtomDataReader","java.lang.Float java.util.Date JU.AU $.SB $.V3 J.atomdata.RadiusData J.c.VDW J.jvxl.data.JvxlCoder JU.BSUtil $.Logger $.Txt".split(" "),function(){c$=x(function(){this.maxDistance=0;this.fileDotModel=this.fileName=this.contactPair=null;this.modelIndex=0;this.myIndex=this.atomIndex=this.atomNo=this.atomProp=this.atomRadius=this.atomXyz=this.atomData=null;this.firstNearbyAtom=this.nearbyAtomCount=this.myAtomCount=this.ac=
0;this.bsNearby=this.bsMyIgnored=this.bsMySelected=null;this.doUseIterator=this.havePlane=this.doAddHydrogens=!1;this.theProperty=0;this.haveOneProperty=!1;this.sr=this.minPtsPerAng=0;this.rs2=this.rs=null;this.maxRS=0;this.thisAtomSet=this.thisPlane=null;this.vl2=this.vl1=this.vl0=this.margin=this.thisX=0;this.ptV=this.pt1=this.pt0=this.ptZ0=this.ptY0=this.voxelSource=this.noFaceSpheres=this.validSpheres=this.bsSurfaceVoxels=null;A(this,arguments)},J.jvxl.readers,"AtomDataReader",J.jvxl.readers.VolumeDataReader);
G(c$,function(){this.atomData=new J.atomdata.AtomData;this.bsMySelected=new JU.BS;this.bsMyIgnored=new JU.BS;this.ptY0=new JU.P3;this.ptZ0=new JU.P3;this.pt0=new JU.P3i;this.pt1=new JU.P3i;this.ptV=new JU.P3});C(c$,function(){I(this,J.jvxl.readers.AtomDataReader,[])});e(c$,"initADR",function(a){this.initVDR(a);this.precalculateVoxelData=!0;this.atomDataServer=a.getAtomDataServer()},"J.jvxl.readers.SurfaceGenerator");j(c$,"setup",function(){this.setup2()},"~B");e(c$,"setup2",function(){this.contactPair=
this.params.contactPair;this.doAddHydrogens=null!=this.sg.getAtomDataServer()&&this.params.addHydrogens;this.modelIndex=this.params.modelIndex;null!=this.params.bsIgnore&&(this.bsMyIgnored=this.params.bsIgnore);if(null!=this.params.volumeData){this.setVolumeDataV(this.params.volumeData);this.setBBox(this.volumeData.volumetricOrigin,0);this.ptV.setT(this.volumeData.volumetricOrigin);for(var a=0;3>a;a++)this.ptV.scaleAdd2(this.volumeData.voxelCounts[a]-1,this.volumeData.volumetricVectors[a],this.ptV);
this.setBBox(this.ptV,0)}(this.havePlane=null!=this.params.thePlane)&&this.volumeData.setPlaneParameters(this.params.thePlane)});e(c$,"markPlaneVoxels",function(a,b){for(var c=0,d=this.thisX*this.yzCount,e=d+this.yzCount;d<e;d++,c++)this.volumeData.getPoint(d,this.ptV),this.thisPlane[c]=this.ptV.distance(a)-b},"JU.P3,~N");e(c$,"setVolumeForPlane",function(){this.useOriginStepsPoints?(this.xyzMin=JU.P3.newP(this.params.origin),this.xyzMax=JU.P3.newP(this.params.origin),this.xyzMax.add3((this.params.points.x-
1)*this.params.steps.x,(this.params.points.y-1)*this.params.steps.y,(this.params.points.z-1)*this.params.steps.z)):null==this.params.boundingBox?(this.getAtoms(this.params.bsSelected,!1,!0,!1,!1,!1,!1,this.params.mep_marginAngstroms),null==this.xyzMin&&(this.xyzMin=JU.P3.new3(-10,-10,-10),this.xyzMax=JU.P3.new3(10,10,10))):(this.xyzMin=JU.P3.newP(this.params.boundingBox[0]),this.xyzMax=JU.P3.newP(this.params.boundingBox[1]));this.setRanges(this.params.plane_ptsPerAngstrom,this.params.plane_gridMax,
0)});e(c$,"getAtoms",function(a,b,c,d,e,g,f,l){g&&(c=!0);c&&(null==this.params.atomRadiusData&&(this.params.atomRadiusData=new J.atomdata.RadiusData(null,1,J.atomdata.RadiusData.EnumType.FACTOR,J.c.VDW.AUTO)),this.atomData.radiusData=this.params.atomRadiusData,this.atomData.radiusData.valueExtended=this.params.solventExtendedAtomRadius,b&&(this.atomData.radiusData.vdwType=J.c.VDW.NOJMOL));this.atomData.modelIndex=this.modelIndex;this.atomData.bsSelected=a;this.atomData.bsIgnored=this.bsMyIgnored;
this.sg.fillAtomData(this.atomData,1|(e?16:0)|(d?4:0)|(c?2:0));this.doUseIterator&&(this.atomData.bsSelected=null);this.ac=this.atomData.ac;this.modelIndex=this.atomData.firstModelIndex;e=!1;for(d=0;d<this.ac;d++){if((null==a||a.get(d))&&!this.bsMyIgnored.get(d)){if(this.havePlane&&Math.abs(this.volumeData.distancePointToPlane(this.atomData.atomXyz[d]))>2*(this.atomData.atomRadius[d]=this.getWorkingRadius(d,l)))continue;this.bsMySelected.set(d);e=!this.havePlane}if(c&&(g||e))this.atomData.atomRadius[d]=
this.getWorkingRadius(d,l)}e=c&&b?this.getWorkingRadius(-1,l):0;this.myAtomCount=JU.BSUtil.cardinalityOf(this.bsMySelected);l=JU.BSUtil.copy(this.bsMySelected);f=0;this.atomProp=null;this.theProperty=3.4028235E38;this.haveOneProperty=!1;a=this.params.theProperty;if(0<this.myAtomCount){var k=null;if(b){this.atomData.bsSelected=l;this.atomDataServer.fillAtomData(this.atomData,8);k=Array(f=this.atomData.hydrogenAtomCount);for(d=0;d<this.atomData.hAtoms.length;d++)if(null!=this.atomData.hAtoms[d])for(b=
this.atomData.hAtoms[d].length;0<=--b;)k[--f]=this.atomData.hAtoms[d][b];f=k.length;JU.Logger.info(f+" attached hydrogens added")}b=f+this.myAtomCount;c&&(this.atomRadius=u(b,0));this.atomXyz=Array(b);null!=this.params.theProperty&&(this.atomProp=u(b,0));this.atomNo=t(b,0);this.atomIndex=t(b,0);this.myIndex=t(this.ac,0);for(d=0;d<f;d++)c&&(this.atomRadius[d]=e),this.atomXyz[d]=k[d],this.atomNo[d]=-1,null!=this.atomProp&&this.addAtomProp(d,NaN);this.myAtomCount=f;for(d=l.nextSetBit(0);0<=d;d=l.nextSetBit(d+
1))null!=this.atomProp&&this.addAtomProp(this.myAtomCount,null!=a&&d<a.length?a[d]:NaN),this.atomXyz[this.myAtomCount]=this.atomData.atomXyz[d],this.atomNo[this.myAtomCount]=this.atomData.atomicNumber[d],this.atomIndex[this.myAtomCount]=d,this.myIndex[d]=this.myAtomCount,c&&(this.atomRadius[this.myAtomCount]=this.atomData.atomRadius[d]),this.myAtomCount++}this.firstNearbyAtom=this.myAtomCount;JU.Logger.info(this.myAtomCount+" atoms will be used in the surface calculation");0==this.myAtomCount&&(this.setBBox(JU.P3.new3(10,
10,10),0),this.setBBox(JU.P3.new3(-10,-10,-10),0));for(d=0;d<this.myAtomCount;d++)this.setBBox(this.atomXyz[d],c?this.atomRadius[d]+0.5:0);Float.isNaN(this.params.scale)||(b=JU.V3.newVsub(this.xyzMax,this.xyzMin),b.scale(0.5),this.xyzMin.add(b),b.scale(this.params.scale),this.xyzMax.add2(this.xyzMin,b),this.xyzMin.sub(b));if(g&&0!=this.myAtomCount){g=new JU.P3;this.bsNearby=new JU.BS;for(d=0;d<this.ac;d++)!l.get(d)&&!this.bsMyIgnored.get(d)&&(b=this.atomData.atomRadius[d],null!=this.params.thePlane&&
Math.abs(this.volumeData.distancePointToPlane(this.atomData.atomXyz[d]))>2*b||(null!=this.params.theProperty&&(b+=this.maxDistance),g=this.atomData.atomXyz[d],g.x+b>this.xyzMin.x&&(g.x-b<this.xyzMax.x&&g.y+b>this.xyzMin.y&&g.y-b<this.xyzMax.y&&g.z+b>this.xyzMin.z&&g.z-b<this.xyzMax.z)&&(this.bsNearby.set(d),this.nearbyAtomCount++)));g=this.myAtomCount;if(0!=this.nearbyAtomCount){g+=this.nearbyAtomCount;this.atomRadius=JU.AU.arrayCopyF(this.atomRadius,g);this.atomXyz=JU.AU.arrayCopyObject(this.atomXyz,
g);null!=this.atomIndex&&(this.atomIndex=JU.AU.arrayCopyI(this.atomIndex,g));null!=a&&(this.atomProp=JU.AU.arrayCopyF(this.atomProp,g));for(d=this.bsNearby.nextSetBit(0);0<=d;d=this.bsNearby.nextSetBit(d+1))null!=a&&this.addAtomProp(this.myAtomCount,a[d]),this.myIndex[d]=this.myAtomCount,this.atomIndex[this.myAtomCount]=d,this.atomXyz[this.myAtomCount]=this.atomData.atomXyz[d],this.atomRadius[this.myAtomCount++]=this.atomData.atomRadius[d]}c&&this.setRadii();this.haveOneProperty=!Float.isNaN(this.theProperty)}},
"JU.BS,~B,~B,~B,~B,~B,~B,~N");e(c$,"setRadii",function(){if(null==this.rs){this.maxRS=0;this.rs=u(this.myAtomCount,0);this.rs2=u(this.myAtomCount,0);for(var a=0;a<this.myAtomCount;a++){var b=this.rs[a]=this.atomRadius[a]+this.sr;b>this.maxRS&&(this.maxRS=b);this.rs2[a]=this.rs[a]*this.rs[a]}}});e(c$,"addAtomProp",function(a,b){this.atomProp[a]=b;!Float.isNaN(this.theProperty)&&b!=this.theProperty&&(this.theProperty=3.4028235E38==this.theProperty?b:NaN)},"~N,~N");e(c$,"getWorkingRadius",function(a,
b){var c=0>a?this.atomData.hAtomRadius:this.atomData.atomRadius[a];return Float.isNaN(b)?Math.max(c,0.1):c+b},"~N,~N");e(c$,"setHeader",function(a,b){this.jvxlFileHeaderBuffer=new JU.SB;null!=this.atomData.programInfo&&this.jvxlFileHeaderBuffer.append("#created by ").append(this.atomData.programInfo).append(" on ").append(""+new java.util.Date).append("\n");this.jvxlFileHeaderBuffer.append(a).append("\n").append(b).append("\n")},"~S,~S");e(c$,"setRanges",function(a,b,c){null!=this.xyzMin&&(this.ptsPerAngstrom=
a,this.maxGrid=b,this.minPtsPerAng=c,this.setVolumeData(),J.jvxl.data.JvxlCoder.jvxlCreateHeader(this.volumeData,this.jvxlFileHeaderBuffer))},"~N,~N,~N");j(c$,"setVolumeData",function(){this.setVolumeDataADR()});e(c$,"setVolumeDataADR",function(){this.setVolumeDataParams()||(this.setVoxelRange(0,this.xyzMin.x,this.xyzMax.x,this.ptsPerAngstrom,this.maxGrid,this.minPtsPerAng),this.setVoxelRange(1,this.xyzMin.y,this.xyzMax.y,this.ptsPerAngstrom,this.maxGrid,this.minPtsPerAng),this.setVoxelRange(2,this.xyzMin.z,
this.xyzMax.z,this.ptsPerAngstrom,this.maxGrid,this.minPtsPerAng))});e(c$,"fixTitleLine",function(a){if(null==this.params.title)return!1;var b=this.params.title[a];0<b.indexOf("%F")&&(b=this.params.title[a]=JU.Txt.formatStringS(b,"F",this.atomData.fileName));0<b.indexOf("%M")&&(this.params.title[a]=JU.Txt.formatStringS(b,"M",this.atomData.modelName));return!0},"~N");e(c$,"setVertexSource",function(){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);if(null!=this.params.vertexSource){this.params.vertexSource=
JU.AU.arrayCopyI(this.params.vertexSource,this.meshData.vc);for(var a=0;a<this.meshData.vc;a++)this.params.vertexSource[a]=Math.abs(this.params.vertexSource[a])-1}});e(c$,"resetPlane",function(a){for(var b=0;b<this.yzCount;b++)this.thisPlane[b]=a},"~N");e(c$,"resetVoxelData",function(a){for(var b=0;b<this.nPointsX;++b)for(var c=0;c<this.nPointsY;++c)for(var d=0;d<this.nPointsZ;++d)this.voxelData[b][c][d]=a},"~N");e(c$,"getVoxel",function(a,b,c,d){return this.isProgressive?this.thisPlane[d%this.yzCount]:
this.voxelData[a][b][c]},"~N,~N,~N,~N");e(c$,"unsetVoxelData",function(){this.unsetVoxelData2()});e(c$,"unsetVoxelData2",function(){if(this.isProgressive)for(var a=0;a<this.yzCount;a++)3.4028235E38==this.thisPlane[a]&&(this.thisPlane[a]=NaN);else for(a=0;a<this.nPointsX;++a)for(var b=0;b<this.nPointsY;++b)for(var c=0;c<this.nPointsZ;++c)3.4028235E38==this.voxelData[a][b][c]&&(this.voxelData[a][b][c]=NaN)});e(c$,"setGridLimitsForAtom",function(a,b,c,d){b+=this.margin;this.volumeData.xyzToVoxelPt(a.x,
a.y,a.z,c);a=v(Math.floor(b/this.volumeData.volumetricVectorLengths[0]));var e=v(Math.floor(b/this.volumeData.volumetricVectorLengths[1]));b=v(Math.floor(b/this.volumeData.volumetricVectorLengths[2]));d.set(c.x+a,c.y+e,c.z+b);c.set(c.x-a,c.y-e,c.z-b);c.x=Math.max(c.x-1,0);c.y=Math.max(c.y-1,0);c.z=Math.max(c.z-1,0);d.x=Math.min(d.x+1,this.nPointsX);d.y=Math.min(d.y+1,this.nPointsY);d.z=Math.min(d.z+1,this.nPointsZ)},"JU.P3,~N,JU.P3i,JU.P3i");e(c$,"getAtomMinMax",function(a,b){for(var c=0;c<this.nPointsX;c++)b[c]=
new JU.BS;for(var d=this.myAtomCount;0<=--d;)if(null==a||a.get(d)){this.setGridLimitsForAtom(this.atomXyz[d],this.atomRadius[d],this.pt0,this.pt1);for(c=this.pt0.x;c<this.pt1.x;c++)b[c].set(d)}},"JU.BS,~A");e(c$,"markSphereVoxels",function(a,b){for(var c=3.4028235E38!=b&&null!=this.point,d=this.volumetricVectors[0],e=this.volumetricVectors[1],g=this.volumetricVectors[2],f=this.thisAtomSet.nextSetBit(0);0<=f;f=this.thisAtomSet.nextSetBit(f+1))if(this.havePlane||null==this.validSpheres||this.validSpheres.get(f)){var l=
null!=this.noFaceSpheres&&this.noFaceSpheres.get(f),k=f>=this.firstNearbyAtom,j=this.atomXyz[f],p=this.atomRadius[f];if(!(c&&j.distance(this.point)>b+p+0.5)){var n=p+a;this.setGridLimitsForAtom(j,n,this.pt0,this.pt1);this.isProgressive&&(this.pt0.x=this.thisX,this.pt1.x=this.thisX+1);this.volumeData.voxelPtToXYZ(this.pt0.x,this.pt0.y,this.pt0.z,this.ptV);for(var q=this.pt0.x;q<this.pt1.x;q++,this.ptV.add2(d,this.ptY0)){this.ptY0.setT(this.ptV);for(var s=this.pt0.y;s<this.pt1.y;s++,this.ptV.add2(e,
this.ptZ0)){this.ptZ0.setT(this.ptV);for(var r=this.pt0.z;r<this.pt1.z;r++,this.ptV.add(g)){var w=this.ptV.distance(j)-p,t=this.volumeData.getPointIndex(q,s,r);if((0==a||w<=n)&&w<this.getVoxel(q,s,r,t)){if(k||c&&this.ptV.distance(this.point)>b)w=NaN;this.setVoxel(q,s,r,t,w);Float.isNaN(w)||(null!=this.voxelSource&&(this.voxelSource[t]=f+1),0>w&&l&&this.bsSurfaceVoxels.set(t))}}}}}}},"~N,~N");e(c$,"setVoxel",function(a,b,c,d,e){this.isProgressive?this.thisPlane[d%this.yzCount]=e:this.voxelData[a][b][c]=
e},"~N,~N,~N,~N,~N")});y("J.jvxl.readers");z(["JU.P3","J.jvxl.readers.AtomDataReader","JU.P4","$.V3"],"J.jvxl.readers.IsoSolventReader","java.lang.Float java.util.Hashtable JU.BS $.Lst J.jvxl.data.MeshData JU.BSUtil $.Logger $.Measure $.MeshSurface $.TempArray".split(" "),function(){c$=x(function(){this.envelopeRadius=this.cavityRadius=0;this.dots=null;this.isPocket=this.isCavity=this.doCalculateTroughs=!1;this.bsAtomMinMax=this.p=this.vTemp2=this.ptTemp2=this.plane=this.vTemp=this.vTemp3=this.ptS2=
this.ptS1=this.vFaces=this.vEdges=this.htEdges=this.bsLocale=this.bsSurfaceDone=this.bsSurfacePoints=this.iter=null;this.isSurfacePoint=!1;this.nTest=this.iAtomSurface=0;O("J.jvxl.readers.IsoSolventReader.Edge")||J.jvxl.readers.IsoSolventReader.$IsoSolventReader$Edge$();O("J.jvxl.readers.IsoSolventReader.Face")||J.jvxl.readers.IsoSolventReader.$IsoSolventReader$Face$();this.ecosASB2=this.dAB2=this.dAB=this.rBS2=this.rAS2=this.rBS=this.rAS=0;A(this,arguments)},J.jvxl.readers,"IsoSolventReader",J.jvxl.readers.AtomDataReader);
G(c$,function(){this.ptS1=new JU.P3;this.ptS2=new JU.P3;this.vTemp3=new JU.V3;this.vTemp=new JU.V3;this.plane=new JU.P4;this.ptTemp2=new JU.P3;this.vTemp2=new JU.V3;this.p=new JU.P3});C(c$,function(){I(this,J.jvxl.readers.IsoSolventReader,[])});j(c$,"init",function(a){this.initADR(a)},"J.jvxl.readers.SurfaceGenerator");j(c$,"readVolumeParameters",function(a){this.setup(a);this.initializeVolumetricData();this.volumeData.setUnitVectors();this.vl0=this.volumeData.volumetricVectorLengths[0];this.vl1=
this.volumeData.volumetricVectorLengths[1];this.vl2=this.volumeData.volumetricVectorLengths[2];this.isProgressive&&(this.volumeData.getYzCount(),this.bsAtomMinMax=Array(this.nPointsX),this.getAtomMinMax(null,this.bsAtomMinMax),this.voxelSource=t(this.volumeData.nPoints,0));return!0},"~B");j(c$,"setup",function(a){this.setup2();if(null==this.contactPair){this.cavityRadius=this.params.cavityRadius;this.envelopeRadius=this.params.envelopeRadius;this.sr=this.params.solventRadius;this.point=this.params.point;
this.isCavity=this.params.isCavity&&null!=this.meshDataServer;this.isPocket=null!=this.params.pocket&&null!=this.meshDataServer;this.doUseIterator=this.doCalculateTroughs=!a&&null!=this.atomDataServer&&!this.isCavity&&0<this.sr&&(1195==this.dataType||1203==this.dataType);this.getAtoms(this.params.bsSelected,this.doAddHydrogens,!0,!1,!1,!0,!1,NaN);if(this.isCavity||this.isPocket)this.dots=this.meshDataServer.calculateGeodesicSurface(this.bsMySelected,this.envelopeRadius);this.setHeader("solvent/molecular surface",
this.params.calculationType);if(this.havePlane||!a)this.setRanges(this.params.solvent_ptsPerAngstrom,this.params.solvent_gridMax,0),this.volumeData.getYzCount(),this.margin=2*this.volumeData.maxGrid;null!=this.bsNearby&&this.bsMySelected.or(this.bsNearby)}else a||this.setVolumeData();this.doCalculateTroughs||(a?(this.precalculateVoxelData=!1,this.volumeData.sr=this):this.isCavity||(this.isProgressive=this.isXLowToHigh=!0));null==this.thisAtomSet&&(this.thisAtomSet=JU.BSUtil.setAll(this.myAtomCount))},
"~B");j(c$,"generateCube",function(){if(!(this.isCavity&&null!=this.params.theProperty)){this.isCavity&&1205!=this.dataType&&1206!=this.dataType?(this.params.vertexSource=null,this.newVoxelDataCube(),this.resetVoxelData(3.4028235E38),this.markSphereVoxels(this.cavityRadius,this.params.distance),this.generateSolventCavity(),this.resetVoxelData(3.4028235E38),this.markSphereVoxels(0,NaN)):(this.voxelSource=t(this.volumeData.nPoints,0),this.generateSolventCube());this.unsetVoxelData();var a=this.params.slabInfo;
if(null!=a)for(var b=0;b<a.size();b++)a.get(b)[2].booleanValue()&&F(a.get(b)[0],JU.P4)&&(this.volumeData.capData(a.get(b)[0],this.params.cutoff),a.remove(b--))}});j(c$,"getSurfacePointAndFraction",function(a,b,c,d,e,g,f,l,k,j,p,n,q){j=this.marchingCubes.getLinearOffset(f,l,k,j);p=this.marchingCubes.getLinearOffset(f,l,k,p);this.isSurfacePoint=null!=this.bsSurfaceVoxels&&(this.bsSurfaceVoxels.get(j)||this.bsSurfaceVoxels.get(p));if(J.jvxl.readers.IsoSolventReader.testLinear||null==this.voxelSource||
0==this.voxelSource[j]||this.voxelSource[j]!=this.voxelSource[p])return this.getSPF(a,b,c,d,e,g,f,l,k,j,p,n,q);a=Math.abs(c<d?this.voxelSource[j]:this.voxelSource[p]);this.iAtomSurface=this.atomIndex[a-1];n=n[0]=JU.MeshSurface.getSphericalInterpolationFraction(0>this.voxelSource[j]?this.sr:this.atomRadius[this.voxelSource[j]-1],c,d,g.length());q.scaleAdd2(n,g,e);return c+n*(d-c)},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");j(c$,"addVertexCopy",function(a,b,c,d){a=this.addVC(a,b,c,d);if(0>a)return a;
this.isSurfacePoint&&this.bsSurfacePoints.set(a);null!=this.params.vertexSource&&(this.params.vertexSource[a]=this.iAtomSurface);return a},"JU.T3,~N,~N,~B");j(c$,"selectPocket",function(a){null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null);for(var b=this.meshData.vs,c=this.meshData.vc,d=this.meshData.vvs,e=this.dots.length,g=0;g<c;g++)for(var f=0;f<e;f++)this.dots[f].distance(b[g])<this.envelopeRadius&&(d[g]=NaN);this.meshData.getSurfaceSet();b=this.meshData.nSets;c=
JU.BS.newN(b);for(g=0;g<b;g++)if(null!=(d=this.meshData.surfaceSet[g]))for(f=d.nextSetBit(0);0<=f;f=d.nextSetBit(f+1))if(Float.isNaN(this.meshData.vvs[f])){c.set(g);break}for(g=0;g<b;g++)null!=this.meshData.surfaceSet[g]&&c.get(g)==a&&this.meshData.invalidateSurfaceSet(g);this.updateSurfaceData();a||(this.meshData.surfaceSet=null);null!=this.meshDataServer&&(this.meshDataServer.fillMeshData(this.meshData,3,null),this.meshData=new J.jvxl.data.MeshData)},"~B");j(c$,"postProcessVertices",function(){this.setVertexSource();
if(this.doCalculateTroughs&&null!=this.bsSurfacePoints){var a=new JU.BS,b=this.meshData.getSurfaceSet(),c=null,d=this.isPocket?null:this.meshData.calculateVolumeOrArea(-2147483648,!1,!1),e=4.71238898038469*Math.pow(this.sr,3),g=0,f=!1;if(null!=d&&!this.isCavity)for(var l=0;l<this.meshData.nSets;l++){var k=d[l];Math.abs(k)>g&&(g=Math.abs(k),f=0>k)}g=f?-1:1;for(l=0;l<this.meshData.nSets;l++)if(f=b[l],f.intersects(this.bsSurfacePoints)&&(null==d||d[l]*g>e)&&null!=this.params.vertexSource){k=new JU.BS;
null==c&&(c=Array(b.length));for(var j=f.nextSetBit(0);0<=j;j=f.nextSetBit(j+1)){var p=this.params.vertexSource[j];if(!(0>p)){if(a.get(p)){this.meshData.invalidateSurfaceSet(l);break}k.set(p)}}a.or(k)}else this.meshData.invalidateSurfaceSet(l);this.updateSurfaceData();null!=this.meshDataServer&&(this.meshDataServer.fillMeshData(this.meshData,3,null),this.meshData=new J.jvxl.data.MeshData)}null!=this.params.thePlane&&null==this.params.slabInfo&&this.params.addSlabInfo(JU.TempArray.getSlabWithinRange(-100,
0))});e(c$,"generateSolventCavity",function(){for(var a=JU.BS.newN(this.nPointsX*this.nPointsY*this.nPointsZ),b=0,c=this.dots.length,d=0,e,g=this.envelopeRadius,f=0;f<this.nPointsX;++f)for(var l=0;l<this.nPointsY;++l){var k=0;a:for(;k<this.nPointsZ;++k,++b)if(3.4028235E38>(e=this.voxelData[f][l][k])&&e>=this.cavityRadius){this.volumeData.voxelPtToXYZ(f,l,k,this.ptV);for(var j=0;j<c;j++)if(this.dots[j].distance(this.ptV)<g)continue a;a.set(b);d++}}JU.Logger.info("cavities include "+d+" voxel points");
this.atomRadius=u(d,0);this.atomXyz=Array(d);for(c=b=f=0;f<this.nPointsX;++f)for(l=0;l<this.nPointsY;++l)for(k=0;k<this.nPointsZ;++k)a.get(b++)&&(this.volumeData.voxelPtToXYZ(f,l,k,this.atomXyz[c]=new JU.P3),this.atomRadius[c++]=this.voxelData[f][l][k]);this.myAtomCount=this.firstNearbyAtom=d;this.thisAtomSet=JU.BSUtil.setAll(this.myAtomCount);this.rs=null;this.setRadii()});e(c$,"generateSolventCube",function(){1205!=this.dataType&&(this.params.vertexSource=t(this.volumeData.nPoints,0),this.bsSurfaceDone=
new JU.BS,this.bsSurfaceVoxels=new JU.BS,this.bsSurfacePoints=new JU.BS,this.doCalculateTroughs?(this.iter=this.atomDataServer.getSelectedAtomIterator(this.bsMySelected,!0,!1,!1),this.vEdges=new JU.Lst,this.bsLocale=Array(this.myAtomCount),this.htEdges=new java.util.Hashtable,this.getEdges(),JU.Logger.info(this.vEdges.size()+" edges"),this.vFaces=new JU.Lst,this.getFaces(),JU.Logger.info(this.vFaces.size()+" faces"),this.htEdges=this.bsLocale=null,this.iter.release(),this.iter=null,this.newVoxelDataCube(),
this.resetVoxelData(3.4028235E38),this.markFaceVoxels(!0),this.markToroidVoxels(),this.validSpheres.or(this.noFaceSpheres),this.vEdges=null,this.markFaceVoxels(!1),this.vFaces=null):(this.newVoxelDataCube(),this.resetVoxelData(3.4028235E38)),this.markSphereVoxels(0,this.doCalculateTroughs?3.4028235E38:this.params.distance),this.validSpheres=this.noFaceSpheres=null)});e(c$,"getEdges",function(){for(var a=0;a<this.myAtomCount;a++)this.bsLocale[a]=new JU.BS;for(a=0;a<this.myAtomCount;a++){var b=this.atomXyz[a],
c=this.rs[a];for(this.atomDataServer.setIteratorForAtom(this.iter,this.atomIndex[a],c+this.maxRS);this.iter.hasNext();){var d=this.iter.next(),d=this.myIndex[d];if(!(a>=this.firstNearbyAtom&&d>=this.firstNearbyAtom)){var e=this.rs[d],g=b.distance(this.atomXyz[d]);g>=c+e||(e=N(J.jvxl.readers.IsoSolventReader.Edge,this,null,this,a,d,g),this.vEdges.addLast(e),this.bsLocale[a].set(d),this.bsLocale[d].set(a),this.htEdges.put(e.toString(),e))}}}});e(c$,"findEdge",function(a,b){return this.htEdges.get(a<
b?a+"_"+b:b+"_"+a)},"~N,~N");e(c$,"getFaces",function(){var a=new JU.BS;this.validSpheres=new JU.BS;this.noFaceSpheres=JU.BSUtil.setAll(this.myAtomCount);for(var b=this.vEdges.size();0<=--b;){var c=this.vEdges.get(b),d=c.ia,e=c.ib;a.clearAll();a.or(this.bsLocale[d]);a.and(this.bsLocale[e]);for(var g=a.nextSetBit(e+1);0<=g;g=a.nextSetBit(g+1))if(this.getSolventPoints(c,d,e,g)){var f,l=!1;if(null!=(f=this.validateFace(d,e,g,c,this.ptS1)))this.vFaces.addLast(f),l=!0;if(null!=(f=this.validateFace(d,e,
g,c,this.ptS2)))this.vFaces.addLast(f),l=!0;l&&(this.noFaceSpheres.clear(d),this.noFaceSpheres.clear(e),this.noFaceSpheres.clear(g))}}});e(c$,"validateFace",function(a,b,c,d,e){this.atomDataServer.setIteratorForPoint(this.iter,this.modelIndex,e,this.maxRS);for(var g=!0;this.iter.hasNext();){var f=this.iter.next(),l=this.myIndex[f];if(!(l==a||l==b||l==c)&&this.atomData.atomXyz[f].distance(e)<this.atomData.atomRadius[f]+this.sr){g=!1;break}}f=this.findEdge(b,c);l=this.findEdge(a,c);e=g?N(J.jvxl.readers.IsoSolventReader.Face,
this,null,a,b,c,e):null;d.addFace(e);f.addFace(e);l.addFace(e);if(!g)return null;this.validSpheres.set(a);this.validSpheres.set(b);this.validSpheres.set(c);return e},"~N,~N,~N,J.jvxl.readers.IsoSolventReader.Edge,JU.P3");e(c$,"markFaceVoxels",function(a){for(var b=new JU.BS,c=this.volumetricVectors[0],d=this.volumetricVectors[1],e=this.volumetricVectors[2],g=this.vFaces.size();0<=--g;){var f=this.vFaces.get(g),l=this.atomXyz[f.ia],k=this.atomXyz[f.ib],j=this.atomXyz[f.ic],p=f.pS;this.setGridLimitsForAtom(p,
this.sr,this.pt0,this.pt1);this.volumeData.voxelPtToXYZ(this.pt0.x,this.pt0.y,this.pt0.z,this.ptV);for(var n=this.pt0.x;n<this.pt1.x;n++,this.ptV.add2(c,this.ptY0)){this.ptY0.setT(this.ptV);for(var q=this.pt0.y;q<this.pt1.y;q++,this.ptV.add2(d,this.ptZ0)){this.ptZ0.setT(this.ptV);for(var s=this.pt0.z;s<this.pt1.z;s++,this.ptV.add(e)){var r=this.sr-this.ptV.distance(p),w=this.voxelData[n][q][s],t=this.volumeData.getPointIndex(n,q,s);a&&0<r&&this.bsSurfaceDone.set(t);if(JU.Measure.isInTetrahedron(this.ptV,
l,k,j,p,this.plane,this.vTemp,this.vTemp2,this.vTemp3,!1)&&(!a?!this.bsSurfaceDone.get(t)&&0>r&&r>1.8*-this.volumeData.maxGrid&&r>w==b.get(t):0<r&&(0>w||3.4028235E38==w||r>w==b.get(t))))b.set(t),this.setVoxel(n,q,s,t,r),null!=this.voxelSource&&(this.voxelSource[t]=-1-f.ia),0<r&&this.bsSurfaceVoxels.set(t)}}}}},"~B");e(c$,"markToroidVoxels",function(){for(var a=this.volumetricVectors[0],b=this.volumetricVectors[1],c=this.volumetricVectors[2],d=this.vEdges.size();0<=--d;){var e=this.vEdges.get(d);if(e.isValid()){var g=
e.ia,f=e.ib,l=this.atomXyz[g],k=this.atomXyz[f];this.rAS=this.rs[g];this.rBS=this.rs[f];this.rAS2=this.rs2[g];this.rBS2=this.rs2[f];this.dAB=e.d;this.dAB2=e.d2;this.ecosASB2=e.cosASB2;this.setGridLimitsForAtom(e,e.maxr,this.pt0,this.pt1);this.volumeData.voxelPtToXYZ(this.pt0.x,this.pt0.y,this.pt0.z,this.ptV);for(e=this.pt0.x;e<this.pt1.x;e++,this.ptV.add2(a,this.ptY0)){this.ptY0.setT(this.ptV);for(f=this.pt0.y;f<this.pt1.y;f++,this.ptV.add2(b,this.ptZ0)){this.ptZ0.setT(this.ptV);for(var j=this.pt0.z;j<
this.pt1.z;j++,this.ptV.add(c)){var p=this.checkSpecialVoxel(l,k,this.ptV);if(!Float.isNaN(p)&&(p=this.sr-p,p<this.voxelData[e][f][j])){var n=this.volumeData.getPointIndex(e,f,j);this.setVoxel(e,f,j,n,p);null!=this.voxelSource&&(this.voxelSource[n]=-1-g)}}}}}}});j(c$,"unsetVoxelData",function(){if(this.havePlane)if(this.isProgressive)for(var a=0;a<this.yzCount;a++)0.001>this.thisPlane[a]||(this.thisPlane[a]=0.001);else for(a=0;a<this.nPointsX;++a)for(var b=0;b<this.nPointsY;++b)for(var c=0;c<this.nPointsZ;++c)0.001>
this.voxelData[a][b][c]||(this.voxelData[a][b][c]=0.001);else this.unsetVoxelData2()});e(c$,"getSolventPoints",function(a,b,c,d){var e=this.rs[b],g=a.v;a=(a.d2+this.rs2[b]-this.rs2[c])/(2*a.d*e);c=Math.acos(a);this.p.scaleAdd2(a*e,g,this.atomXyz[b]);JU.Measure.getPlaneThroughPoint(this.p,g,this.plane);b=Math.sin(c)*e;a=this.atomXyz[d];c=this.rs[d];e=JU.Measure.distanceToPlane(this.plane,a);if(Math.abs(e)>=0.9*c)return!1;this.ptTemp.scaleAdd2(-e,g,a);a=this.p.distance(this.ptTemp);d=(b*b+a*a-(this.rs2[d]-
e*e))/(2*b*a);if(0.99<=Math.abs(d))return!1;e=this.vTemp2;e.sub2(this.ptTemp,this.p);e.normalize();this.ptTemp.scaleAdd2(b*d,e,this.p);e.cross(g,e);e.normalize();e.scale(Math.sqrt(1-d*d)*b);this.ptS1.add2(this.ptTemp,e);this.ptS2.sub2(this.ptTemp,e);return!0},"J.jvxl.readers.IsoSolventReader.Edge,~N,~N,~N");e(c$,"checkSpecialVoxel",function(a,b,c){var d=a.distance(c),e=a.distanceSquared(c),g=this.rAS/d;if(1<g)return this.p.set(a.x+(c.x-a.x)*g,a.y+(c.y-a.y)*g,a.z+(c.z-a.z)*g),b.distanceSquared(this.p)>=
this.rBS2?NaN:this.solventDistance(this.rAS,this.rAS2,this.rBS2,d,e,b.distanceSquared(c));d=b.distance(c);return 1<(g=this.rBS/d)?(this.p.set(b.x+(c.x-b.x)*g,b.y+(c.y-b.y)*g,b.z+(c.z-b.z)*g),a.distanceSquared(this.p)>=this.rAS2?NaN:this.solventDistance(this.rBS,this.rBS2,this.rAS2,d,d*d,e)):NaN},"JU.P3,JU.P3,JU.P3");e(c$,"solventDistance",function(a,b,c,d,e,g){g=Math.acos((e+this.dAB2-g)/(2*d*this.dAB));c=Math.acos((b+this.dAB2-c)/(2*a*this.dAB));e=b+e-2*a*d*Math.cos(c-g);c=Math.sqrt(e);return this.ecosASB2<
(b+e-d*d)/(c*a)?c:NaN},"~N,~N,~N,~N,~N,~N");e(c$,"dumpLine",function(a,b,c,d){this.sg.log('draw ID "x'+c+this.nTest++ +'" '+JU.P3.newP(a)+" "+JU.P3.newP(b)+" color "+d)},"JU.P3,JU.T3,~S,~S");e(c$,"dumpLine2",function(a,b,c,d,e,g){var f=new JU.V3;f.setT(b);f.sub(a);f.normalize();f.scale(d);f.add(a);this.sg.log('draw ID "'+c+this.nTest++ +'" '+JU.P3.newP(a)+" "+JU.P3.newP(f)+" color "+e);this.sg.log('draw ID "'+c+this.nTest++ +'"'+JU.P3.newP(f)+" "+JU.P3.newP(b)+" color "+g+'"'+c+'"')},"JU.P3,JU.P3,~S,~N,~S,~S");
e(c$,"dumpPoint",function(a,b,c){this.sg.log('draw ID "'+b+this.nTest++ +'"'+JU.P3.newP(a)+" color "+c)},"JU.P3,~S,~S");j(c$,"getValueAtPoint",function(a){if(null!=this.contactPair)return a.distance(this.contactPair.myAtoms[1])-this.contactPair.radii[1];for(var b=3.4028235E38,c=0;c<this.firstNearbyAtom;c++){(null==this.rs||null==this.atomXyz||null==this.atomXyz[c]||null==a)&&System.out.println("HOH");var d=a.distance(this.atomXyz[c])-this.rs[c];d<b&&(b=d)}return 3.4028235E38==b?NaN:b},"JU.T3,~B");
j(c$,"discardTempData",function(a){this.rs2=this.rs=null;this.discardTempDataSR(a)},"~B");j(c$,"getPlane",function(a){0==this.yzCount&&this.initPlanes();this.thisX=a;this.thisPlane=this.yzPlanes[a%2];null==this.contactPair?(this.resetPlane(3.4028235E38),this.thisAtomSet=this.bsAtomMinMax[a],this.markSphereVoxels(0,this.params.distance),this.unsetVoxelData()):this.markPlaneVoxels(this.contactPair.myAtoms[0],this.contactPair.radii[0]);return this.thisPlane},"~N");c$.$IsoSolventReader$Edge$=function(){M(self.c$);
c$=x(function(){P(this,arguments);this.cosASB2=this.maxr=this.d2=this.d=this.nInvalid=this.nFaces=this.ib=this.ia=0;this.v=null;A(this,arguments)},J.jvxl.readers.IsoSolventReader,"Edge",JU.P3);V(c$,function(a,b,c,d){this.ia=Math.min(b,c);this.ib=Math.max(b,c);this.d=d;this.d2=d*d;this.maxr=Math.sqrt(this.d2/4+Math.max(a.rs2[b],a.rs2[c]));this.ave(a.atomXyz[b],a.atomXyz[c]);this.cosASB2=(a.rs2[b]+a.rs2[c]-this.d2)/(a.rs[c]*a.rs[b]);this.v=JU.V3.newVsub(a.atomXyz[c],a.atomXyz[b]);this.v.normalize()},
"J.jvxl.readers.IsoSolventReader,~N,~N,~N");e(c$,"addFace",function(a){this.nFaces++;null==a&&this.nInvalid++},"J.jvxl.readers.IsoSolventReader.Face");e(c$,"isValid",function(){return 0==this.nFaces||this.nInvalid!=this.nFaces});j(c$,"toString",function(){return this.ia+"_"+this.ib});c$=L()};c$.$IsoSolventReader$Face$=function(){M(self.c$);c$=x(function(){P(this,arguments);this.ic=this.ib=this.ia=0;this.pS=null;A(this,arguments)},J.jvxl.readers.IsoSolventReader,"Face");C(c$,function(a,b,c,d){this.ia=
a;this.ib=b;this.ic=c;this.pS=JU.P3.newP(d)},"~N,~N,~N,JU.P3");j(c$,"toString",function(){return this.ia+"_"+this.ib+"_"+this.ic+"_"+this.pS});c$=L()};H(c$,"testLinear",!1)});y("J.jvxl.readers");z(["J.jvxl.readers.SurfaceReader"],"J.jvxl.readers.SurfaceFileReader",["JU.PT","J.api.Interface"],function(){c$=x(function(){this.next=this.line=this.out=this.binarydoc=this.br=null;A(this,arguments)},J.jvxl.readers,"SurfaceFileReader",J.jvxl.readers.SurfaceReader);G(c$,function(){this.next=t(1,0)});C(c$,
function(){I(this,J.jvxl.readers.SurfaceFileReader,[])});j(c$,"init",function(a){this.initSR(a)},"J.jvxl.readers.SurfaceGenerator");e(c$,"init2",function(a,b){this.init2SFR(a,b)},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");e(c$,"init2SFR",function(a,b){this.init(a);this.br=b},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");e(c$,"newBinaryDocument",function(){return J.api.Interface.getInterface("JU.BinaryDocument")});j(c$,"setOutputChannel",function(a){null==this.binarydoc?
this.out=a:this.sg.setOutputChannel(this.binarydoc,a)},"JU.OC");j(c$,"closeReader",function(){this.closeReaderSFR()});e(c$,"closeReaderSFR",function(){if(null!=this.br)try{this.br.close()}catch(a){if(!D(a,java.io.IOException))throw a;}null!=this.out&&this.out.closeChannel();null!=this.binarydoc&&this.binarydoc.close()});j(c$,"discardTempData",function(a){this.closeReader();this.discardTempDataSR(a)},"~B");e(c$,"getTokens",function(){return JU.PT.getTokensAt(this.line,0)});e(c$,"parseFloat",function(){return JU.PT.parseFloatNext(this.line,
this.next)});e(c$,"parseFloatStr",function(a){this.next[0]=0;return JU.PT.parseFloatNext(a,this.next)},"~S");e(c$,"parseFloatRange",function(a,b,c){this.next[0]=b;return JU.PT.parseFloatRange(a,c,this.next)},"~S,~N,~N");e(c$,"parseInt",function(){return JU.PT.parseIntNext(this.line,this.next)});e(c$,"parseIntStr",function(a){this.next[0]=0;return JU.PT.parseIntNext(a,this.next)},"~S");e(c$,"parseIntNext",function(a){return JU.PT.parseIntNext(a,this.next)},"~S");e(c$,"parseFloatArrayStr",function(a){this.next[0]=
0;return JU.PT.parseFloatArrayNext(a,this.next,null,null,null)},"~S");e(c$,"parseFloatArray",function(a,b,c){return JU.PT.parseFloatArrayNext(this.line,this.next,a,b,c)},"~A,~S,~S");e(c$,"getQuotedStringNext",function(){return JU.PT.getQuotedStringNext(this.line,this.next)});e(c$,"skipTo",function(a,b){if(null!=a)for(;0>this.readLine().indexOf(a););null!=b&&(this.next[0]=this.line.indexOf(b)+b.length+2)},"~S,~S");e(c$,"readLine",function(){this.line=this.br.readLine();if(null!=this.line&&(this.nBytes+=
this.line.length,null!=this.out)){var a=this.line.getBytes();this.out.write(a,0,a.length);this.out.writeByteAsInt(10)}return this.line})});y("J.jvxl.readers");z(["J.jvxl.readers.SurfaceFileReader"],"J.jvxl.readers.VolumeFileReader","java.lang.Float JU.AU $.PT $.SB J.api.Interface J.atomdata.AtomData JU.Logger".split(" "),function(){c$=x(function(){this.negativeAtomCount=this.endOfData=!1;this.nSurfaces=this.ac=0;this.canDownsample=this.isAngstroms=!1;this.downsampleRemainders=null;this.preProcessPlanes=
!1;this.nData=0;this.readerClosed=!1;this.nSkipZ=this.nSkipY=this.nSkipX=this.downsampleFactor=0;this.yzPlanesRaw=null;this.iPlaneRaw=0;this.boundingBox=null;this.isScaledAlready=!1;A(this,arguments)},J.jvxl.readers,"VolumeFileReader",J.jvxl.readers.SurfaceFileReader);C(c$,function(){I(this,J.jvxl.readers.VolumeFileReader,[])});j(c$,"init2",function(a,b){this.init2VFR(a,b)},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");e(c$,"init2VFR",function(a,b){this.init2SFR(a,b);this.canDownsample=
this.isProgressive=this.isXLowToHigh=!0;this.jvxlData.wasCubic=!0;this.boundingBox=this.params.boundingBox;4==this.params.qmOrbitalType&&(this.hasColorData=null==this.params.parameters||0<=this.params.parameters[1],this.preProcessPlanes=!0,this.params.insideOut=!this.params.insideOut)},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");e(c$,"recordData",function(a){if(Float.isNaN(a))return a;a<this.dataMin&&(this.dataMin=a);a>this.dataMax&&(this.dataMax=a);this.dataMean+=a;this.nData++;return a},
"~N");j(c$,"closeReader",function(){this.readerClosed||(this.readerClosed=!0,this.closeReaderSFR(),0==this.nData||-3.4028235E38==this.dataMax||(this.dataMean/=this.nData,JU.Logger.info("VolumeFileReader closing file: "+this.nData+" points read \ndata min/max/mean = "+this.dataMin+"/"+this.dataMax+"/"+this.dataMean)))});j(c$,"readVolumeParameters",function(){this.endOfData=!1;this.nSurfaces=this.readVolumetricHeader();if(0==this.nSurfaces)return!1;this.nSurfaces<this.params.fileIndex&&(JU.Logger.warn("not enough surfaces in file -- resetting params.fileIndex to "+
this.nSurfaces),this.params.fileIndex=this.nSurfaces);return!0},"~B");j(c$,"readVolumeData",function(a){return this.readVolumeDataVFR(a)},"~B");e(c$,"readVolumeDataVFR",function(a){if(!this.gotoAndReadVoxelData(a))return!1;this.vertexDataOnly||JU.Logger.info("JVXL read: "+this.nPointsX+" x "+this.nPointsY+" x "+this.nPointsZ+" data points");return!0},"~B");e(c$,"readVolumetricHeader",function(){try{this.readParameters();if(-2147483648==this.ac)return 0;this.vertexDataOnly||JU.Logger.info("voxel grid origin:"+
this.volumetricOrigin);var a=this.params.downsampleFactor;if(this.canDownsample&&1<a){this.downsampleRemainders=t(3,0);JU.Logger.info("downsample factor = "+a);for(var b=0;3>b;++b){var c=this.voxelCounts[b];this.downsampleRemainders[b]=c%a;this.voxelCounts[b]/=a;this.volumetricVectors[b].scale(a);JU.Logger.info("downsampling axis "+(b+1)+" from "+c+" to "+this.voxelCounts[b])}}if(!this.vertexDataOnly)for(b=0;3>b;++b)this.isAngstroms||this.volumetricVectors[b].scale(0.5291772),this.line=this.voxelCounts[b]+
" "+this.volumetricVectors[b].x+" "+this.volumetricVectors[b].y+" "+this.volumetricVectors[b].z,this.jvxlFileHeaderBuffer.append(this.line).appendC("\n"),JU.Logger.info("voxel grid count/vector:"+this.line);this.scaleIsosurface(this.params.scale);this.volumeData.setVolumetricXml();return this.nSurfaces}catch(d){if(D(d,Exception))return JU.Logger.error(d.toString()),0;throw d;}});e(c$,"skipComments",function(a){for(var b=new JU.SB;null!=this.readLine()&&(a&&0==this.line.length||0==this.line.indexOf("#"));)b.append(this.line).appendC("\n");
return b.toString()},"~B");e(c$,"readVoxelVector",function(a){this.readLine();var b=this.volumetricVectors[a];if(-2147483648==(this.voxelCounts[a]=this.parseIntStr(this.line)))this.next[0]=this.line.indexOf(" ");b.set(this.parseFloat(),this.parseFloat(),this.parseFloat());this.isAnisotropic&&this.setVectorAnisotropy(b)},"~N");e(c$,"initializeSurfaceData",function(){this.downsampleFactor=this.params.downsampleFactor;this.nSkipZ=this.nSkipY=this.nSkipX=0;this.canDownsample&&0<this.downsampleFactor&&
(this.nSkipX=this.downsampleFactor-1,this.nSkipY=this.downsampleRemainders[2]+(this.downsampleFactor-1)*(this.nSkipZ=this.nPointsZ*this.downsampleFactor+this.downsampleRemainders[2]),this.nSkipZ=this.downsampleRemainders[1]*this.nSkipZ+(this.downsampleFactor-1)*this.nSkipZ*(this.nPointsY*this.downsampleFactor+this.downsampleRemainders[1]));null!=this.params.thePlane?this.params.cutoff=0:this.isJvxl&&(this.params.cutoff=this.params.isBicolorMap||this.params.colorBySign?0.01:0.5);this.nDataPoints=0;
this.next[0]=0;this.line="";this.jvxlNSurfaceInts=0});j(c$,"readSurfaceData",function(a){this.readSurfaceDataVFR(a)},"~B");e(c$,"readSurfaceDataVFR",function(a){this.initializeSurfaceData();if(this.isProgressive&&!a||this.isJvxl)this.nDataPoints=this.volumeData.setVoxelCounts(this.nPointsX,this.nPointsY,this.nPointsZ),this.voxelData=null,this.isJvxl&&(this.jvxlVoxelBitSet=this.getVoxelBitSet(this.nDataPoints));else if(a&&this.volumeData.hasPlane()){this.volumeData.setVoxelMap();var b=this.volumeData.getToPlaneParameter();
for(a=0;a<this.nPointsX;++a){for(var c=0;c<this.nPointsY;++c){for(var d=0;d<this.nPointsZ;++d){var e=this.recordData(this.getNextVoxelValue());this.volumeData.isNearPlane(a,c,d,b)&&this.volumeData.setVoxelMapValue(a,c,d,e);0!=this.nSkipX&&this.skipVoxels(this.nSkipX)}0!=this.nSkipY&&this.skipVoxels(this.nSkipY)}0!=this.nSkipZ&&this.skipVoxels(this.nSkipZ)}}else{this.voxelData=JU.AU.newFloat3(this.nPointsX,-1);for(a=0;a<this.nPointsX;++a){b=JU.AU.newFloat2(this.nPointsY);this.voxelData[a]=b;for(c=
0;c<this.nPointsY;++c){e=u(this.nPointsZ,0);b[c]=e;for(d=0;d<this.nPointsZ;++d)e[d]=this.recordData(this.getNextVoxelValue()),0!=this.nSkipX&&this.skipVoxels(this.nSkipX);0!=this.nSkipY&&this.skipVoxels(this.nSkipY)}0!=this.nSkipZ&&this.skipVoxels(this.nSkipZ)}}this.volumeData.setVoxelDataAsArray(this.voxelData)},"~B");e(c$,"getPlane",function(a){0==a&&this.initPlanes();if(this.preProcessPlanes)return this.getPlaneProcessed(a);a=this.getPlane2(a);null==this.qpc&&this.getPlane(a,!0);return a},"~N");
e(c$,"getPlaneProcessed",function(a){var b;if(0==this.iPlaneRaw){this.qpc=J.api.Interface.getOption("quantum.NciCalculation");b=new J.atomdata.AtomData;b.modelIndex=-1;b.bsSelected=this.params.bsSelected;this.sg.fillAtomData(b,1);this.qpc.setupCalculation(this.volumeData,this.sg.getBsSelected(),null,null,null,b.atomXyz,-1,null,null,null,null,null,null,this.params.isSquaredLinear,null,this.params.theProperty,!0,null,this.params.parameters,this.params.testFlags);this.iPlaneRaw=1;this.qpc.setPlanes(this.yzPlanesRaw=
u(4,this.yzCount,0));if(this.hasColorData){this.getPlane(this.yzPlanesRaw[0],!1);this.getPlane(this.yzPlanesRaw[1],!1);b=this.yzPlanes[0];for(a=0;a<this.yzCount;a++)b[a]=NaN;return b}this.iPlaneRaw=-1}var c=this.qpc.getNoValue(),d=this.nPointsX-1;switch(this.iPlaneRaw){case -1:b=this.yzPlanes[a%2];d++;break;case 3:b=this.yzPlanesRaw[0];this.yzPlanesRaw[0]=this.yzPlanesRaw[1];this.yzPlanesRaw[1]=this.yzPlanesRaw[2];this.yzPlanesRaw[2]=this.yzPlanesRaw[3];this.yzPlanesRaw[3]=b;b=this.yzPlanesRaw[this.iPlaneRaw];
break;default:this.iPlaneRaw++,b=this.yzPlanesRaw[this.iPlaneRaw]}if(a<d){this.getPlane(b,!1);this.qpc.calcPlane(a,b=this.yzPlanes[a%2]);for(a=0;a<this.yzCount;a++)b[a]!=c&&this.recordData(b[a])}else for(a=0;a<this.yzCount;a++)b[a]=NaN;return b},"~N");e(c$,"getPlane",function(a,b){try{for(var c=0,d=0;c<this.nPointsY;++c){for(var e=0;e<this.nPointsZ;++e){var g=this.getNextVoxelValue();b&&this.recordData(g);a[d++]=g;0!=this.nSkipX&&this.skipVoxels(this.nSkipX)}0!=this.nSkipY&&this.skipVoxels(this.nSkipY)}0!=
this.nSkipZ&&this.skipVoxels(this.nSkipZ)}catch(f){if(!D(f,Exception))throw f;}},"~A,~B");j(c$,"getValue",function(a,b,c,d){return null!=this.boundingBox&&(this.volumeData.voxelPtToXYZ(a,b,c,this.ptTemp),this.ptTemp.x<this.boundingBox[0].x||this.ptTemp.x>this.boundingBox[1].x||this.ptTemp.y<this.boundingBox[0].y||this.ptTemp.y>this.boundingBox[1].y||this.ptTemp.z<this.boundingBox[0].z||this.ptTemp.z>this.boundingBox[1].z)?NaN:this.getValue2(a,b,c,d)},"~N,~N,~N,~N");e(c$,"skipVoxels",function(a){for(;0<=
--a;)this.getNextVoxelValue()},"~N");e(c$,"getVoxelBitSet",function(){return null},"~N");e(c$,"getNextVoxelValue",function(){var a=0;if(1<this.nSurfaces&&!this.params.blockCubeData){for(var b=1;b<this.params.fileIndex;b++)this.nextVoxel();a=this.nextVoxel();for(b=this.params.fileIndex;b<this.nSurfaces;b++)this.nextVoxel()}else a=this.nextVoxel();return a});e(c$,"nextVoxel",function(){var a=this.parseFloat();if(Float.isNaN(a)){for(;null!=this.readLine()&&Float.isNaN(a=this.parseFloatStr(this.line)););
null==this.line&&(this.endOfData||JU.Logger.warn("end of file reading cube voxel data? nBytes="+this.nBytes+" nDataPoints="+this.nDataPoints+" (line):"+this.line),this.endOfData=!0,this.line="0 0 0 0 0 0 0 0 0 0")}return a});j(c$,"gotoData",function(a,b){if(this.params.blockCubeData){0<a&&JU.Logger.info("skipping "+a+" data sets, "+b+" points each");for(var c=0;c<a;c++)this.skipData(b)}},"~N,~N");e(c$,"skipData",function(a){this.skipDataVFR(a)},"~N");e(c$,"skipDataVFR",function(a){for(var b=0;b<a;)b+=
this.countData(this.readLine())},"~N");e(c$,"countData",function(a){for(var b=0,c=0,d=a.length,e;c<d;){for(;c<d&&(" "==(e=a.charAt(c))||"\t"==e);)++c;for(c<d&&++b;c<d&&" "!=(e=a.charAt(c))&&"\t"!=e;)++c}return b},"~S");c$.checkAtomLine=e(c$,"checkAtomLine",function(a,b,c,d,e){0<=d.indexOf("ANGSTROMS")&&(b=!0);c=null==c?2147483647:JU.PT.parseInt(c);switch(c){case -2147483648:c=0;d=" "+d.substring(d.indexOf(" ")+1);break;case 2147483647:c=-2147483648;break;default:var g=""+c;d=d.substring(d.indexOf(g)+
g.length)}b?0>d.indexOf("ANGSTROM")&&(d+=" ANGSTROMS"):0>d.indexOf("BOHR")&&(d+=" BOHR");d=(-2147483648==c?"":(a?"+":"-")+Math.abs(c))+d+"\n";e.append(d);return b},"~B,~B,~S,~S,JU.SB");j(c$,"getSurfacePointAndFraction",function(a,b,c,d,e,g,f,l,k,j,p,n,q){return this.getSPFv(a,b,c,d,e,g,f,l,k,j,p,n,q)},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");e(c$,"getSPFv",function(a,b,c,d,e,g,f,l,k,j,p,n,q){a=this.getSPF(a,b,c,d,e,g,f,l,k,j,p,n,q);if(null==this.qpc||Float.isNaN(a)||!this.hasColorData)return a;
j=this.marchingCubes.getLinearOffset(f,l,k,j);p=this.marchingCubes.getLinearOffset(f,l,k,p);return this.qpc.process(j,p,n[0])},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");e(c$,"scaleIsosurface",function(a){this.isScaledAlready||(this.isScaledAlready=!0,this.isAnisotropic&&this.setVolumetricAnisotropy(),Float.isNaN(a)||(JU.Logger.info("applying scaling factor of "+a),this.volumetricOrigin.scaleAdd2((1-a)/2,this.volumetricVectors[0],this.volumetricOrigin),this.volumetricOrigin.scaleAdd2((1-a)/
2,this.volumetricVectors[1],this.volumetricOrigin),this.volumetricOrigin.scaleAdd2((1-a)/2,this.volumetricVectors[2],this.volumetricOrigin),this.volumetricVectors[0].scale(a),this.volumetricVectors[1].scale(a),this.volumetricVectors[2].scale(a)))},"~N")});y("J.jvxl.readers");z(["J.jvxl.readers.VolumeFileReader"],"J.jvxl.readers.JvxlXmlReader","java.lang.Float $.NullPointerException java.util.Hashtable JU.AU $.BS $.CU $.Lst $.P3 $.P4 $.PT $.SB J.jvxl.data.JvxlCoder $.MeshData J.jvxl.readers.XmlReader J.shapesurface.IsosurfaceMesh JU.C $.ColorEncoder $.Escape $.Logger".split(" "),
function(){c$=x(function(){this.JVXL_VERSION="2.3";this.invalidatedVertexCount=this.excludedVertexCount=this.excludedTriangleCount=this.colorDataCount=this.edgeDataCount=this.surfaceDataCount=0;this.haveContourData=!1;this.xr=null;this.isXmlFile=!0;this.thisInside=!1;this.bsVoxelBitSet=this.tempDataXml=null;this.includeValueNaN=!0;this.valueCount=0;this.valueRange=this.valueMin=NaN;this.colorPtr=this.fractionPtr=0;this.strFractionTemp="";this.haveReadColorData=!1;this.jvxlColorEncodingRead=null;A(this,
arguments)},J.jvxl.readers,"JvxlXmlReader",J.jvxl.readers.VolumeFileReader);C(c$,function(){I(this,J.jvxl.readers.JvxlXmlReader,[])});j(c$,"init2",function(a,b){this.init2JXR(a,b)},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");e(c$,"init2JXR",function(a,b){this.init2VFR(a,b);this.jvxlData.wasJvxl=this.isJvxl=!0;this.isXLowToHigh=!1;this.xr=new J.jvxl.readers.XmlReader(b)},"J.jvxl.readers.SurfaceGenerator,java.io.BufferedReader");j(c$,"readVolumeData",function(a){if(!this.readVolumeDataVFR(a))return!1;
this.strFractionTemp=this.jvxlEdgeDataRead;this.fractionPtr=0;return!0},"~B");j(c$,"gotoAndReadVoxelData",function(a){this.initializeVolumetricData();if(0>this.nPointsX||0>this.nPointsY||0>this.nPointsZ)return!0;try{this.gotoData(this.params.fileIndex-1,this.nPointsX*this.nPointsY*this.nPointsZ);if(this.vertexDataOnly)return!0;this.volumeData.setMappingPlane(this.params.thePlane);this.readSurfaceData(a);this.volumeData.setMappingPlane(null);0<this.edgeDataCount&&(this.jvxlEdgeDataRead=this.jvxlReadFractionData("edge",
this.edgeDataCount));this.params.bsExcluded=this.jvxlData.jvxlExcluded=Array(4);if(this.hasColorData=0<this.colorDataCount)this.jvxlColorDataRead=this.jvxlReadFractionData("color",this.colorDataCount);0<this.excludedVertexCount&&(this.jvxlData.jvxlExcluded[0]=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlExcludedVertexData",null,!1,!1)),this.xr.isNext("jvxlExcludedPlaneData")&&(this.jvxlData.jvxlExcluded[2]=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlExcludedPlaneData",
null,!1,!1))));0<this.excludedTriangleCount&&(this.jvxlData.jvxlExcluded[3]=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlExcludedTriangleData",null,!1,!1)));0<this.invalidatedVertexCount&&(this.jvxlData.jvxlExcluded[1]=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlInvalidatedVertexData",null,!1,!1)));this.haveContourData&&this.jvxlDecodeContourData(this.jvxlData,this.xr.getXmlData("jvxlContourData",null,!1,!1));if(this.jvxlDataIsColorMapped&&0<this.jvxlData.nVertexColors){this.jvxlData.vertexColorMap=
new java.util.Hashtable;var b=this.xr.getXmlData("jvxlVertexColorData",null,!0,!1),c=J.jvxl.readers.XmlReader.getXmlAttrib(b,"baseColor");this.jvxlData.baseColor=0<c.length?c:null;for(a=0;a<this.jvxlData.nVertexColors;a++){var d=this.xr.getXmlData("jvxlColorMap",b,!0,!1),e=J.jvxl.readers.XmlReader.getXmlAttrib(d,"color"),g=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlColorMap",d,!1,!1));this.jvxlData.vertexColorMap.put(e,g)}}}catch(f){if(D(f,Exception))return JU.Logger.error(f.toString()),
!1;throw f;}return!0},"~B");j(c$,"readParameters",function(){var a=this.xr.getXmlData("jvxlFileTitle",null,!1,!1);this.jvxlFileHeaderBuffer=JU.SB.newS(a);this.xr.toTag("jvxlVolumeData");a=this.tempDataXml=this.xr.getXmlData("jvxlVolumeData",null,!0,!1);this.volumetricOrigin.setT(this.xr.getXmlPoint(a,"origin"));this.isAngstroms=!0;this.readVector(0);this.readVector(1);this.readVector(2);this.line=this.xr.toTag("jvxlSurfaceSet");this.nSurfaces=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(this.line,
"count"));JU.Logger.info("jvxl file surfaces: "+this.nSurfaces);JU.Logger.info("using default edge fraction base and range");JU.Logger.info("using default color fraction base and range");this.cJvxlEdgeNaN=String.fromCharCode(this.edgeFractionBase+this.edgeFractionRange)});e(c$,"readVector",function(a){var b=this.xr.getXmlData("jvxlVolumeVector",this.tempDataXml,!0,!0);this.tempDataXml=this.tempDataXml.substring(this.tempDataXml.indexOf(b)+b.length);var c=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,
"count"));-2147483648==c&&(this.vertexDataOnly=!0);this.voxelCounts[a]=0>c?0:c;this.volumetricVectors[a].setT(this.xr.getXmlPoint(b,"vector"));this.isAnisotropic&&this.setVectorAnisotropy(this.volumetricVectors[a])},"~N");j(c$,"gotoData",function(a,b){0<a&&JU.Logger.info("skipping "+a+" data sets, "+b+" points each");this.vertexDataOnly=this.jvxlData.vertexDataOnly=0==b;for(var c=0;c<a;c++)this.jvxlSkipData(b,!0);this.xr.toTag("jvxlSurface");this.jvxlReadSurfaceInfo()},"~N,~N");e(c$,"jvxlSkipData",
function(){this.readLine();this.xr.skipTag("jvxlSurface")},"~N,~B");e(c$,"jvxlReadSurfaceInfo",function(){var a,b=this.xr.getXmlData("jvxlSurfaceInfo",null,!0,!0);this.isXLowToHigh=J.jvxl.readers.XmlReader.getXmlAttrib(b,"isXLowToHigh").equals("true");this.jvxlCutoff=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"cutoff"));Float.isNaN(this.jvxlCutoff)||JU.Logger.info("JVXL read: cutoff "+this.jvxlCutoff);var c=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nContourData"));
this.haveContourData=0<c;this.params.isContoured=J.jvxl.readers.XmlReader.getXmlAttrib(b,"contoured").equals("true");if(this.params.isContoured){var d=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nContours"));0>=d?d=0:(a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"contourValues"),0<a.length&&(this.jvxlData.contourValues=this.params.contoursDiscrete=this.parseFloatArrayStr(a),JU.Logger.info("JVXL read: contourValues "+JU.Escape.eAF(this.jvxlData.contourValues))),a=J.jvxl.readers.XmlReader.getXmlAttrib(b,
"contourColors"),0<a.length&&(this.jvxlData.contourColixes=this.params.contourColixes=JU.C.getColixArray(a),this.jvxlData.contourColors=JU.C.getHexCodes(this.jvxlData.contourColixes),JU.Logger.info("JVXL read: contourColixes "+JU.C.getHexCodes(this.jvxlData.contourColixes))),this.params.contourFromZero=J.jvxl.readers.XmlReader.getXmlAttrib(b,"contourFromZero").equals("true"));this.params.nContours=this.haveContourData?c:d}this.jvxlData.nVertexColors=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,
"nVertexColors"));this.params.isBicolorMap=J.jvxl.readers.XmlReader.getXmlAttrib(b,"bicolorMap").equals("true");this.params.isBicolorMap&&(a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"colorPositive"),0<a.length&&(-2147483648==this.params.colorRgb&&-16776961==this.params.colorPos)&&(this.params.colorPos=JU.CU.getArgbFromString(a)),a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"colorNegative"),0<a.length&&(-2147483648==this.params.colorRgb&&-65536==this.params.colorNeg)&&(this.params.colorNeg=JU.CU.getArgbFromString(a)));
if(this.params.isBicolorMap||this.params.colorBySign)this.jvxlCutoff=0;this.jvxlDataIsColorMapped=(-2147483648==this.params.colorRgb||2147483647==this.params.colorRgb)&&(this.params.isBicolorMap||J.jvxl.readers.XmlReader.getXmlAttrib(b,"colorMapped").equals("true"));this.jvxlData.isJvxlPrecisionColor=J.jvxl.readers.XmlReader.getXmlAttrib(b,"precisionColor").equals("true");this.jvxlData.jvxlDataIsColorDensity=this.params.colorDensity=-2147483648==this.params.colorRgb&&J.jvxl.readers.XmlReader.getXmlAttrib(b,
"colorDensity").equals("true");this.jvxlData.jvxlDataIsColorDensity&&Float.isNaN(this.params.pointSize)&&(a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"pointSize"),0<a.length&&(this.jvxlData.pointSize=this.params.pointSize=this.parseFloatStr(a)));a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"allowVolumeRender");this.jvxlData.allowVolumeRender=this.params.allowVolumeRender=0==a.length||a.equalsIgnoreCase("true");a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"plane");if(0<=a.indexOf("{")){this.params.thePlane=
null;this.params.mapLattice=null;try{this.params.thePlane=JU.Escape.uP(a),a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"maplattice"),JU.Logger.info("JVXL read: plane "+this.params.thePlane),0<=a.indexOf("{")&&(this.params.mapLattice=JU.Escape.uP(a),JU.Logger.info("JVXL read: mapLattice "+this.params.mapLattice)),0==this.params.scale3d&&(this.params.scale3d=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"scale3d"))),Float.isNaN(this.params.scale3d)&&(this.params.scale3d=0)}catch(e){if(D(e,
Exception))null==this.params.thePlane?(JU.Logger.error("JVXL Error reading plane definition -- setting to 0 0 1 0  (z=0)"),this.params.thePlane=JU.P4.new4(0,0,1,0)):JU.Logger.error("JVXL Error reading mapLattice definition -- ignored");else throw e;}this.edgeDataCount=this.surfaceDataCount=0}else this.params.thePlane=null,this.surfaceDataCount=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nSurfaceInts")),this.edgeDataCount=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nBytesUncompressedEdgeData"));
this.excludedVertexCount=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nExcludedVertexes"));this.excludedTriangleCount=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nExcludedTriangles"));this.invalidatedVertexCount=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"nInvalidatedVertexes"));a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"slabInfo");0<a.length&&(this.jvxlData.slabInfo=a);this.colorDataCount=Math.max(0,this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,
"nBytesUncompressedColorData")));this.jvxlDataIs2dContour=null!=this.params.thePlane&&this.jvxlDataIsColorMapped;this.jvxlData.color=J.jvxl.readers.XmlReader.getXmlAttrib(b,"color");if(0==this.jvxlData.color.length||0<=this.jvxlData.color.indexOf("null"))this.jvxlData.color="orange";this.jvxlData.translucency=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"translucency"));Float.isNaN(this.jvxlData.translucency)&&(this.jvxlData.translucency=0);a=J.jvxl.readers.XmlReader.getXmlAttrib(b,
"meshColor");0<a.length&&(this.jvxlData.meshColor=a);a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"rendering");0<a.length&&(this.jvxlData.rendering=a);this.jvxlData.colorScheme=J.jvxl.readers.XmlReader.getXmlAttrib(b,"colorScheme");0==this.jvxlData.colorScheme.length&&(this.jvxlData.colorScheme=null);0>this.jvxlData.thisSet&&(a=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"set")),0<a&&(this.jvxlData.thisSet=a-1));this.jvxlData.slabValue=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,
"slabValue"));this.jvxlData.isSlabbable=J.jvxl.readers.XmlReader.getXmlAttrib(b,"slabbable").equalsIgnoreCase("true");this.jvxlData.diameter=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"diameter"));-2147483648==this.jvxlData.diameter&&(this.jvxlData.diameter=0);this.jvxlDataIs2dContour&&(this.params.isContoured=!0);this.params.colorBySign&&(this.params.isBicolorMap=!0);a=J.jvxl.readers.XmlReader.getXmlAttrib(b,"insideOut").equals("true");var g=d=c=NaN,f=NaN;this.jvxlDataIsColorMapped&&
(c=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"dataMinimum")),d=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"dataMaximum")),g=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"valueMappedToRed")),f=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(b,"valueMappedToBlue")),Float.isNaN(c)&&(c=g=-1,d=f=1));this.jvxlSetColorRanges(c,d,g,f,a)});e(c$,"jvxlSetColorRanges",function(a,b,c,d,e){this.jvxlDataIsColorMapped&&(!Float.isNaN(a)&&!Float.isNaN(b)&&(0==
b&&0==a&&(a=-1,b=1),this.params.mappedDataMin=a,this.params.mappedDataMax=b,JU.Logger.info("JVXL read: data_min/max "+this.params.mappedDataMin+"/"+this.params.mappedDataMax)),this.params.rangeDefined||(!Float.isNaN(c)&&!Float.isNaN(d)?(0==c&&0==d&&(c=-1,d=1),this.params.valueMappedToRed=Math.min(c,d),this.params.valueMappedToBlue=Math.max(c,d),this.params.isColorReversed=c>d):(this.params.valueMappedToRed=0,this.params.valueMappedToBlue=1),this.params.rangeDefined=!0),JU.Logger.info("JVXL read: color red/blue: "+
this.params.valueMappedToRed+"/"+this.params.valueMappedToBlue));this.jvxlData.valueMappedToRed=this.params.valueMappedToRed;this.jvxlData.valueMappedToBlue=this.params.valueMappedToBlue;this.jvxlData.mappedDataMin=this.params.mappedDataMin;this.jvxlData.mappedDataMax=this.params.mappedDataMax;this.jvxlData.isColorReversed=this.params.isColorReversed;this.jvxlData.insideOut=e;this.params.insideOut&&(this.jvxlData.insideOut=!this.jvxlData.insideOut);this.params.insideOut=this.jvxlData.insideOut},"~N,~N,~N,~N,~B");
j(c$,"readSurfaceData",function(){this.thisInside=!this.params.isContoured;this.readSurfaceDataXML()||(this.tempDataXml=this.xr.getXmlData("jvxlEdgeData",null,!0,!1),this.bsVoxelBitSet=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlEdgeData",this.tempDataXml,!1,!1)),this.readSurfaceDataJXR())},"~B");e(c$,"readSurfaceDataXML",function(){return this.vertexDataOnly?(this.getEncodedVertexData(),!0):null!=this.params.thePlane?(this.volumeData.setDataDistanceToPlane(this.params.thePlane),
this.setVolumeDataV(this.volumeData),this.params.cutoff=0,this.jvxlData.setSurfaceInfo(this.params.thePlane,this.params.mapLattice,0,""),this.jvxlData.scale3d=this.params.scale3d,!0):!1});e(c$,"readSurfaceDataJXR",function(){this.readSurfaceDataVFR(!1);this.volumeData.setMappingPlane(null)});e(c$,"jvxlReadFractionData",function(a){var b;try{if(a.equals("edge"))b=J.jvxl.data.JvxlCoder.jvxlDecompressString(J.jvxl.readers.XmlReader.getXmlAttrib(this.tempDataXml,"data"));else{var c=this.xr.getXmlData("jvxlColorData",
null,!0,!1);this.jvxlData.isJvxlPrecisionColor=J.jvxl.readers.JvxlXmlReader.getEncoding(c).endsWith("2");b=J.jvxl.data.JvxlCoder.jvxlDecompressString(J.jvxl.readers.XmlReader.getXmlAttrib(c,"data"))}}catch(d){if(D(d,Exception))throw JU.Logger.error("Error reading "+a+" data "+d),new NullPointerException;throw d;}return b},"~S,~N");j(c$,"getVoxelBitSet",function(a){if(null!=this.bsVoxelBitSet)return this.bsVoxelBitSet;var b=new JU.BS,c=0;if(0>=this.surfaceDataCount)return b;for(var d=0;c<a;){d=this.parseInt();
if(-2147483648==d&&(this.readLine(),null==this.line||-2147483648==(d=this.parseIntStr(this.line))))this.endOfData||JU.Logger.error("end of file in JvxlReader? line="+this.line),this.endOfData=!0,d=1E4;this.thisInside=!this.thisInside;++this.jvxlNSurfaceInts;this.thisInside&&b.setBits(c,c+d);c+=d}return b},"~N");j(c$,"getSurfacePointAndFraction",function(a,b,c,d,e,g,f,l,k,j,p,n,q){if(0>=this.edgeDataCount)return this.getSPFv(a,b,c,d,e,g,f,l,k,j,p,n,q);q.scaleAdd2(n[0]=this.jvxlGetNextFraction(this.edgeFractionBase,
this.edgeFractionRange,0.5),g,e);Float.isNaN(this.valueMin)&&this.setValueMinMax();return 0==this.valueCount||this.includeValueNaN&&Float.isNaN(n[0])?n[0]:this.getNextValue()},"~N,~B,~N,~N,JU.T3,JU.V3,~N,~N,~N,~N,~N,~A,JU.T3");e(c$,"getNextValue",function(){for(var a=NaN;this.colorPtr<this.valueCount&&Float.isNaN(a);){a=this.jvxlData.isJvxlPrecisionColor?J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter2(this.jvxlColorDataRead.charCodeAt(this.colorPtr),this.jvxlColorDataRead.charCodeAt(this.colorPtr++ +
this.valueCount),this.colorFractionBase,this.colorFractionRange):J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(this.jvxlColorDataRead.charCodeAt(this.colorPtr++),this.colorFractionBase,this.colorFractionRange,0.5);break}return this.valueMin+a*this.valueRange});e(c$,"setValueMinMax",function(){this.valueCount=this.jvxlColorDataRead.length;this.jvxlData.isJvxlPrecisionColor&&(this.valueCount/=2);this.includeValueNaN=this.valueCount!=this.jvxlEdgeDataRead.length;this.valueMin=!this.jvxlData.isJvxlPrecisionColor?
this.params.valueMappedToRed:3.4028235E38==this.params.mappedDataMin?0:this.params.mappedDataMin;this.valueRange=(!this.jvxlData.isJvxlPrecisionColor?this.params.valueMappedToBlue:3.4028235E38==this.params.mappedDataMin?1:this.params.mappedDataMax)-this.valueMin;this.haveReadColorData=!0});e(c$,"jvxlGetNextFraction",function(a,b,c){this.fractionPtr>=this.strFractionTemp.length&&(this.endOfData||JU.Logger.error("end of file reading compressed fraction data"),this.endOfData=!0,this.strFractionTemp=
""+String.fromCharCode(a),this.fractionPtr=0);return J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter(this.strFractionTemp.charCodeAt(this.fractionPtr++),a,b,c)},"~N,~N,~N");j(c$,"readColorData",function(){if(!this.jvxlDataIsColorMapped)return"";var a=this.jvxlData.vertexCount=this.meshData.vc,b=this.meshData.vcs,c=this.meshData.vvs;if("none".equals(this.jvxlColorEncodingRead)){this.jvxlData.vertexColors=t(a,0);for(var d=t(1,0),c=JU.PT.parseIntNext(this.jvxlColorDataRead,d),c=Math.min(c,a),a=JU.PT.getTokens(this.jvxlColorDataRead.substring(d[0])),
e=!1,g=this.jvxlData.translucency,f=0,d=0;d<c;d++)try{var l=J.jvxl.readers.JvxlXmlReader.getColor(a[d]);0==l?l=f:f=l;b[d]=JU.C.getColixTranslucent(this.jvxlData.vertexColors[d]=l);JU.C.isColixTranslucent(b[d])?e=!0:0!=g&&(b[d]=JU.C.getColixTranslucent3(b[d],!0,g))}catch(k){if(D(k,Exception))JU.Logger.info("JvxlXmlReader: Cannot interpret color code: "+a[d]);else throw k;}e&&0==g&&(this.jvxlData.translucency=0.5);return"-"}null==this.params.colorEncoder&&(this.params.colorEncoder=new JU.ColorEncoder(null));
this.params.colorEncoder.setColorScheme(null,!1);this.params.colorEncoder.setRange(this.params.valueMappedToRed,this.params.valueMappedToBlue,this.params.isColorReversed);JU.Logger.info("JVXL reading color data mapped min/max: "+this.params.mappedDataMin+"/"+this.params.mappedDataMax+" for "+a+" vertices. using encoding keys "+this.colorFractionBase+" "+this.colorFractionRange);JU.Logger.info("mapping red--\x3eblue for "+this.params.valueMappedToRed+" to "+this.params.valueMappedToBlue+" colorPrecision:"+
this.jvxlData.isJvxlPrecisionColor);(f=Float.isNaN(this.valueMin))&&this.setValueMinMax();var j=3.4028235E38,p=-3.4028235E38;if(null==b||b.length<a)this.meshData.vcs=b=K(a,0);e=l=0;this.params.colorBySign&&(e=JU.C.getColix(this.params.isColorReversed?this.params.colorNeg:this.params.colorPos),l=JU.C.getColix(this.params.isColorReversed?this.params.colorPos:this.params.colorNeg));for(var g=this.meshData.vertexIncrement,n=3.4028235E38==this.params.mappedDataMin,d=0;d<a;d+=g){var q;q=f?c[d]=this.getNextValue():
c[d];n&&(q<j&&(j=q),q>p&&(p=q))}n&&(this.params.mappedDataMin=j,this.params.mappedDataMax=p);if(null!=this.jvxlData.colorScheme)for(d=0;d<a;d+=g)q=c[d],null!=this.marchingSquares&&this.params.isContoured?this.marchingSquares.setContourData(d,q):(f=!this.params.colorBySign?this.params.colorEncoder.getColorIndex(q):(this.params.isColorReversed?0<q:0>=q)?l:e,b[d]=JU.C.getColixTranslucent3(f,!0,this.jvxlData.translucency));return this.jvxlColorDataRead+"\n"});c$.getColor=e(c$,"getColor",function(a){var b=
0;try{switch(a.charAt(0)){case "[":b=JU.CU.getArgbFromString(a);break;case "0":b=JU.PT.parseIntRadix(a.substring(2),16);break;default:b=JU.PT.parseIntRadix(a,10)}}catch(c){if(!D(c,Exception))throw c;}return b},"~S");e(c$,"getEncodedVertexData",function(){var a=this.xr.getXmlData("jvxlSurfaceData",null,!0,!1);this.jvxlDecodeVertexData(this.xr.getXmlData("jvxlVertexData",a,!0,!1),!1);var b=this.xr.getXmlData("jvxlTriangleData",a,!0,!1),c=this.xr.getXmlData("jvxlTriangleEdgeData",a,!0,!1),d=this.xr.getXmlData("jvxlPolygonColorData",
a,!1,!1);this.jvxlDecodeTriangleData(b,c,d);a=this.xr.getXmlData("jvxlColorData",a,!0,!1);this.jvxlColorEncodingRead=J.jvxl.readers.JvxlXmlReader.getEncoding(a);this.jvxlData.isJvxlPrecisionColor=this.jvxlColorEncodingRead.endsWith("2");a=this.getData(a,"jvxlColorData");this.jvxlColorDataRead=this.jvxlColorEncodingRead.equals("none")?a:J.jvxl.data.JvxlCoder.jvxlDecompressString(a);this.jvxlDataIsColorMapped=(-2147483648==this.params.colorRgb||2147483647==this.params.colorRgb)&&0<this.jvxlColorDataRead.length;
this.haveContourData&&this.jvxlDecodeContourData(this.jvxlData,this.xr.getXmlData("jvxlContourData",null,!1,!1))});e(c$,"getData",function(a,b){var c=J.jvxl.readers.XmlReader.getXmlAttrib(a,"data");0==c.length&&(c=this.xr.getXmlData(b,a,!1,!1));return c},"~S,~S");c$.getEncoding=e(c$,"getEncoding",function(a){if(0<J.jvxl.readers.XmlReader.getXmlAttrib(a,"len").length)return"";a=J.jvxl.readers.XmlReader.getXmlAttrib(a,"encoding");return 0==a.length?"none":a},"~S");e(c$,"jvxlDecodeVertexData",function(a,
b){var c=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(a,"count"));b||JU.Logger.info("Reading "+c+" vertices");var d=3*c,e=b?Array(c):null,g,f=J.jvxl.readers.XmlReader.getXmlAttrib(a,"data"),l=J.jvxl.readers.JvxlXmlReader.getEncoding(a);if("none".equals(l)){0==f.length&&(f=this.xr.getXmlData("jvxlVertexData",a,!1,!1));d=JU.PT.parseFloatArray(f);d[0]!=3*c&&JU.Logger.info("JvxlXmlReader: vertexData count="+E(d[0])+"; expected "+3*c);f=0;for(l=1;f<c;f++){var k=JU.P3.new3(d[l++],d[l++],d[l++]);
b?e[f]=k:this.addVertexCopy(k,0,f,!1)}}else{var j=this.xr.getXmlPoint(a,"min"),p=this.xr.getXmlPoint(a,"max");p.sub(j);var n=this.jvxlData.colorFractionBase,q=this.jvxlData.colorFractionRange,s=J.jvxl.data.JvxlCoder.jvxlDecompressString(f);0==s.length&&(s=this.xr.getXmlData("jvxlVertexData",a,!1,!1));f=0;for(l=-1;f<c;f++)k=new JU.P3,g=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter2(s.charCodeAt(++l),s.charCodeAt(l+d),n,q),k.x=j.x+g*p.x,g=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter2(s.charCodeAt(++l),
s.charCodeAt(l+d),n,q),k.y=j.y+g*p.y,g=J.jvxl.data.JvxlCoder.jvxlFractionFromCharacter2(s.charCodeAt(++l),s.charCodeAt(l+d),n,q),k.z=j.z+g*p.z,b?e[f]=k:this.addVertexCopy(k,0,f,!1)}return e},"~S,~B");e(c$,"jvxlDecodeTriangleData",function(a,b,c){var d=this.parseIntStr(J.jvxl.readers.XmlReader.getXmlAttrib(a,"count"));if(!(0>d)){var e=t(1,0),g=null==c?-1:JU.PT.parseIntNext(c,e),f=0;JU.Logger.info("Reading "+d+" triangles");var l=J.jvxl.readers.JvxlXmlReader.getEncoding(a);a=this.getData(a,"jvxlTriangleData");
b=this.getData(b,"jvxlTriangleEdgeData");var k=t(3,0),j=t(1,0),p=null,n=7,q=!"none".equals(l);if(q)a=J.jvxl.data.JvxlCoder.jvxlDecompressString(a),b=J.jvxl.data.JvxlCoder.jvxlDecompressString(b).trim(),l=b.length==d;else{var s=JU.PT.parseIntNext(a,j);(l=0<b.length)?(p=t(1,0),JU.PT.parseIntNext(b,p)):0<s&&JU.Logger.info("JvxlXmlReader: jvxlTriangleEdgeData count="+s+"; expected "+d)}for(var r=s=0,w=0,u=-1;s<d;){if(q){var v=a.charAt(++u);switch(v){case "!":v=0;break;case "+":case ".":case " ":case "\n":case "\r":case "\t":case ",":continue;
case "-":case "0":case "1":case "2":case "3":case "4":case "5":case "6":case "7":case "8":case "9":j[0]=u;v=JU.PT.parseIntNext(a,j);u=j[0]-1;break;default:v=v.charCodeAt(0)-92}r+=v}else r=JU.PT.parseIntNext(a,j)-1;k[w]=r;if(3==++w){w=0;if(l&&(n=null==p?b.charCodeAt(s)-48:JU.PT.parseIntNext(b,p),0>n||7<n))n=7;0<g&&(v=JU.PT.parseIntNext(c,e),-2147483648==v?g=0:f=v,g--);this.addTriangleCheck(k[0],k[1],k[2],n,0,!1,f);s++}}}},"~S,~S,~S");e(c$,"jvxlDecodeContourData",function(a,b){var c=new JU.Lst,d=new JU.SB,
e=new JU.SB,g=-1;a.vContours=null;if(null!=b){for(;0<=(g=b.indexOf("<jvxlContour",g+1));){var f=new JU.Lst,j=this.xr.getXmlData("jvxlContour",b.substring(g),!0,!1),k=this.parseFloatStr(J.jvxl.readers.XmlReader.getXmlAttrib(j,"value"));d.append(" ").appendF(k);var m=J.jvxl.readers.JvxlXmlReader.getColor(J.jvxl.readers.XmlReader.getXmlAttrib(j,"color")),p=JU.C.getColix(m);e.append(" ").append(JU.Escape.escapeColor(m));var n=J.jvxl.data.JvxlCoder.jvxlDecompressString(J.jvxl.readers.XmlReader.getXmlAttrib(j,
"data")),q=J.jvxl.data.JvxlCoder.jvxlDecodeBitSet(this.xr.getXmlData("jvxlContour",j,!1,!1)),j=q.length();J.shapesurface.IsosurfaceMesh.setContourVector(f,j,q,k,p,m,JU.SB.newS(n));c.addLast(f)}j=c.size();if(0<j){a.vContours=JU.AU.createArrayOfArrayList(j);a.contourColixes=this.params.contourColixes=K(j,0);a.contourValues=this.params.contoursDiscrete=u(j,0);for(g=0;g<j;g++)a.vContours[g]=c.get(g),a.contourValues[g]=a.vContours[g].get(2).floatValue(),a.contourColixes[g]=a.vContours[g].get(3)[0];a.contourColors=
JU.C.getHexCodes(a.contourColixes);JU.Logger.info("JVXL read: "+j+" discrete contours");JU.Logger.info("JVXL read: contour values: "+d);JU.Logger.info("JVXL read: contour colors: "+e)}}},"J.jvxl.data.JvxlData,~S");j(c$,"postProcessVertices",function(){var a=this.params.bsExcluded[1];null!=a&&(null!=this.meshDataServer&&this.meshDataServer.fillMeshData(this.meshData,1,null),this.meshData.invalidateVertices(a),null!=this.meshDataServer&&(this.meshDataServer.fillMeshData(this.meshData,4,null),this.meshData=
new J.jvxl.data.MeshData),this.updateTriangles())})});y("J.rendersurface");z(["J.render.MeshRenderer","JU.P3","$.P3i"],"J.rendersurface.IsosurfaceRenderer",["java.lang.Boolean","$.Float","JU.V3","JU.C","$.Normix"],function(){c$=x(function(){this.isBicolorMap=this.iHideBackground=!1;this.nError=this.backgroundColix=0;this.isosurface=this.imesh=this.vertexValues=null;this.showNumbers=this.iShowNormals=this.isNavigationMode=!1;this.$showKey=null;this.hasColorRange=!1;this.meshScale=-1;this.globalSlabValue=
this.mySlabValue=0;this.ptTempi=this.ptTemp=null;A(this,arguments)},J.rendersurface,"IsosurfaceRenderer",J.render.MeshRenderer);G(c$,function(){this.ptTemp=new JU.P3;this.ptTempi=new JU.P3i});j(c$,"render",function(){return this.renderIso()});e(c$,"renderIso",function(){this.setGlobals();for(var a=this.isosurface.meshCount;0<=--a;)if(this.mesh=this.imesh=this.isosurface.meshes[a],null==this.imesh.connections||this.vwr.ms.at[this.imesh.connections[0]].checkVisible())this.hasColorRange=!1,this.renderMeshSlab()&&
(this.isExport||this.renderInfo(),this.isExport&&this.isGhostPass&&(this.exportPass=1,this.renderMeshSlab(),this.exportPass=2));return this.needTranslucent});e(c$,"setGlobals",function(){this.needTranslucent=!1;this.iShowNormals=this.vwr.getTestFlag(4);this.showNumbers=this.vwr.getTestFlag(3);this.isosurface=this.shape;this.exportPass=this.isExport?2:0;this.isNavigationMode=this.vwr.getBoolean(603979887);this.$showKey=this.vwr.getBoolean(603979870)?Boolean.TRUE:null;this.isosurface.keyXy=null;this.meshScale=
-1;this.globalSlabValue=this.g3d.getSlab();this.mySlabValue=this.isNavigationMode?E(this.tm.getNavigationOffset().z):2147483647});e(c$,"renderInfo",function(){this.hasColorRange&&(null!=this.imesh.colorEncoder&&Boolean.TRUE===this.$showKey)&&this.showKey()});e(c$,"showKey",function(){this.$showKey=Boolean.FALSE;var a=null,b=null,c=null,d=0,e=0;if(this.imesh.showContourLines)if(c=this.imesh.getContours(),null==c){b=this.imesh.jvxlData.contourColixes;if(null==b)return;d=b.length}else d=c.length,e=1;
else a=this.imesh.colorEncoder.getColorSchemeArray(this.imesh.colorEncoder.currentPalette),d=null==a?0:a.length,e=2;if(!(2>d)){var g=this.g3d.isAntialiased()?2:1,f=this.vwr.getScreenHeight()*g,j=v(v(f/2)/(d-1)),f=3*v(f/4)-j,k=10*g,m=20*g;this.isosurface.keyXy=[v(k/g),0,v((k+m)/g),v((f+j)/g),v(j/g)];for(var p=0;p<d;p++,f-=j){switch(e){case 0:if(!this.g3d.setC(b[p]))return;break;case 1:if(!this.g3d.setC(c[p].get(3)[0]))return;break;case 2:this.g3d.setColor(a[p])}this.g3d.fillRect(k,f,5,-2147483648,
m,j)}this.isosurface.keyXy[1]=v((f+j)/g)}});e(c$,"renderMeshSlab",function(){this.volumeRender=this.imesh.jvxlData.colorDensity&&this.imesh.jvxlData.allowVolumeRender;var a=this.mySlabValue;this.frontOnly=this.mesh.frontOnly||26==this.shapeID;if(!this.isNavigationMode&&(this.meshSlabValue=this.imesh.jvxlData.slabValue,-2147483648!=this.meshSlabValue&&this.imesh.jvxlData.isSlabbable)){for(var b=this.imesh.jvxlData.boundingBox,a=3.4028235E38,c=1.4E-45,d=b.length;0<=--d;)this.pt2f.setT(b[d]),this.tm.transformPt3f(this.pt2f,
this.pt2f),this.pt2f.z<a&&(a=this.pt2f.z),this.pt2f.z>c&&(c=this.pt2f.z);a=Math.round(a+(c-a)*(100-this.meshSlabValue)/100);this.frontOnly=(new Boolean(this.frontOnly&100<=this.meshSlabValue)).valueOf()}b=this.g3d.getTranslucentCoverOnly();this.g3d.setTranslucentCoverOnly(this.frontOnly||!this.vwr.getBoolean(603979967));this.thePlane=this.imesh.jvxlData.jvxlPlane;this.vertexValues=this.mesh.vvs;2147483647!=a&&this.imesh.jvxlData.isSlabbable?(this.g3d.setSlab(a),a=this.renderMesh(this.mesh),this.g3d.setSlab(this.globalSlabValue)):
a=this.renderMesh(this.mesh);this.g3d.setTranslucentCoverOnly(b);return a});j(c$,"render2",function(a){if(this.volumeRender)this.renderPoints();else{switch(this.imesh.dataType){case 70:this.renderLonePair(!1);return;case 71:this.renderLonePair(!0);return}this.isBicolorMap=this.imesh.jvxlData.isBicolorMap;this.render2b(a);this.g3d.setC(4)&&this.imesh.showContourLines&&this.renderContourLines()}},"~B");e(c$,"renderLonePair",function(a){this.pt2f.setT(this.vertices[1]);this.tm.transformPt3f(this.pt2f,
this.pt2f);var b=E(this.vwr.tm.scaleToScreen(E(this.pt2f.z),100));1>b&&(b=1);if(!a){var c=new JU.V3;a=new JU.V3;this.pt1f.setT(this.vertices[0]);this.tm.transformPt3f(this.pt1f,this.pt1f);c.sub2(this.pt2f,this.pt1f);a.set(c.x,c.y,c.z+1);a.cross(a,c);a.normalize();c=this.vwr.tm.scaleToScreen(E(this.pt1f.z),100);a.scale(c);this.pt1f.add2(this.pt2f,a);this.pt2f.sub(a);this.screens[0].set(Math.round(this.pt1f.x),Math.round(this.pt1f.y),Math.round(this.pt1f.z));this.g3d.fillSphereI(b,this.screens[0])}this.screens[1].set(Math.round(this.pt2f.x),
Math.round(this.pt2f.y),Math.round(this.pt2f.z));this.g3d.fillSphereI(b,this.screens[1])},"~B");e(c$,"renderContourLines",function(){var a=this.imesh.getContours();if(null==a)null!=this.imesh.jvxlData.contourValues&&(this.hasColorRange=!0);else{this.hasColorRange=0==this.mesh.meshColix;for(var b=a.length;0<=--b;){var c=a[b];if(!(6>c.size())){this.colix=0==this.mesh.meshColix?c.get(3)[0]:this.mesh.meshColix;if(!this.g3d.setC(this.colix))break;for(var d=c.size()-1,e=6;e<d;e++){var g=c.get(e),f=c.get(++e);
this.tm.transformPtScr(g,this.pt1i);this.tm.transformPtScr(f,this.pt2i);if(Float.isNaN(g.x)||Float.isNaN(f.x))break;this.pt1i.z-=2;this.pt2i.z-=2;this.g3d.drawLineAB(this.pt1i,this.pt2i)}}}}});j(c$,"renderPoints",function(){try{this.volumeRender&&this.g3d.volumeRender(!0);var a=(this.volumeRender||0==this.mesh.pc)&&this.selectedPolyOnly,b=this.imesh.vertexIncrement,c;0>=this.mesh.diameter?(c=this.vwr.getInt(553648144),this.frontOnly=!1):c=v(this.vwr.getScreenDim()/(this.volumeRender?50:100));var d=
Math.round(Float.isNaN(this.mesh.volumeRenderPointSize)?150:1E3*this.mesh.volumeRenderPointSize);1>c&&(c=1);var e=this.showNumbers?v(this.vwr.getScreenWidth()/2):0,g=this.showNumbers?v(this.vwr.getScreenHeight()/2):0;this.showNumbers&&this.g3d.setFontFid(this.g3d.getFontFidFS("Monospaced",24));for(var f=!this.imesh.hasGridPoints||0>this.imesh.firstRealVertex?0:this.imesh.firstRealVertex;f<this.vertexCount;f+=b)if(!(null!=this.vertexValues&&Float.isNaN(this.vertexValues[f])||this.frontOnly&&0>this.transformedVectors[this.normixes[f]].z||
0<=this.imesh.jvxlData.thisSet&&this.mesh.vertexSets[f]!=this.imesh.jvxlData.thisSet||!this.mesh.isColorSolid&&null!=this.mesh.vcs&&!this.setColix(this.mesh.vcs[f])||this.haveBsDisplay&&!this.mesh.bsDisplay.get(f)||a&&!this.bsPolygons.get(f))){this.hasColorRange=!0;if(this.showNumbers&&10<this.screens[f].z&&150>Math.abs(this.screens[f].x-e)&&150>Math.abs(this.screens[f].y-g)){var j=f+(this.mesh.isColorSolid?"":" "+this.mesh.vvs[f]);this.g3d.setC(4);this.g3d.drawStringNoSlab(j,null,this.screens[f].x,
this.screens[f].y,this.screens[f].z-30,0)}this.volumeRender?(c=E(this.vwr.tm.scaleToScreen(this.screens[f].z,d)),1>c&&(c=1),this.g3d.volumeRender4(c,this.screens[f].x,this.screens[f].y,this.screens[f].z)):this.g3d.fillSphereI(c,this.screens[f])}if(3==b){this.g3d.setC(this.isTranslucent?JU.C.getColixTranslucent3(12,!0,0.5):12);for(f=1;f<this.vertexCount;f+=3)this.g3d.fillCylinder(3,v(c/4),this.screens[f],this.screens[f+1]);this.g3d.setC(this.isTranslucent?JU.C.getColixTranslucent3(21,!0,0.5):21);for(f=
1;f<this.vertexCount;f+=3)this.g3d.fillSphereI(c,this.screens[f]);this.g3d.setC(this.isTranslucent?JU.C.getColixTranslucent3(7,!0,0.5):7);for(f=2;f<this.vertexCount;f+=3)this.g3d.fillSphereI(c,this.screens[f])}}catch(k){}this.volumeRender&&this.g3d.volumeRender(!1)});j(c$,"renderTriangles",function(a,b,c){this.g3d.addRenderer(1073742182);var d=this.mesh.pis;this.colix=this.isGhostPass?this.mesh.slabColix:!a&&0!=this.mesh.meshColix?this.mesh.meshColix:this.mesh.colix;var e=!a&&0!=this.mesh.meshColix?
null:this.mesh.vcs;this.isTranslucentInherit&&(this.colix=JU.C.copyColixTranslucency(this.mesh.slabColix,this.mesh.colix));this.g3d.setC(this.colix);c&&(this.frontOnly&&a&&(this.frontOnly=!1),this.bsPolygonsToExport.clearAll());1==this.exportType&&(this.frontOnly=!1);var g=this.isGhostPass&&!this.isBicolorMap||null==e||this.mesh.isColorSolid,f=this.isGhostPass&&!this.isBicolorMap||null==e||!a&&0!=this.mesh.meshColix,j=this.colix;null!=this.imesh.jvxlData.jvxlPlane&&(!g&&!a&&this.mesh.fillTriangles)&&
(g=!0,j=4);var k=g&&null!=this.mesh.pcs;k&&(!a&&this.mesh.fillTriangles)&&(k=!1);var m=this.imesh.jvxlData.contourColixes;this.hasColorRange=!g&&!this.isBicolorMap;var p;0>=this.mesh.diameter?(p=0>this.meshScale?this.meshScale=this.vwr.getInt(553648151):this.meshScale,this.g3d.isAntialiased()&&(p*=2)):p=v(this.vwr.getScreenDim()/100);1>p&&(p=1);for(var n=this.mesh.pc;0<=--n;){var q=d[n];if(!(null==q||this.selectedPolyOnly&&!this.bsPolygons.get(n))){var s=q[0],r=q[1],t=q[2];if(!(0<=this.imesh.jvxlData.thisSet&&
null!=this.mesh.vertexSets&&this.mesh.vertexSets[s]!=this.imesh.jvxlData.thisSet)&&(!this.haveBsDisplay||this.mesh.bsDisplay.get(s)&&this.mesh.bsDisplay.get(r)&&this.mesh.bsDisplay.get(t))){var u=this.normixes[s],y=this.normixes[r],A=this.normixes[t],x=this.checkNormals(u,y,A);if(!(a&&0==x)){var z,B,C;if(g){if(k&&n<this.mesh.pcs.length){z=this.mesh.pcs[n];if(0==z)continue;j=z}z=B=C=j}else if(z=e[s],B=e[r],C=e[t],this.isBicolorMap){if(z!=B||B!=C)continue;this.isGhostPass&&(z=B=C=JU.C.copyColixTranslucency(this.mesh.slabColix,
z))}if(a)c?this.bsPolygonsToExport.set(n):(r==t?(this.setColix(z),s==r?this.g3d.fillSphereI(p,this.screens[s]):this.g3d.fillCylinder(3,p,this.screens[s],this.screens[r])):b?this.g3d.fillTriangle(this.screens[s],z,u,this.screens[r],B,y,this.screens[t],C,A,0.1):(this.isTranslucentInherit&&null!=e&&(z=JU.C.copyColixTranslucency(this.mesh.slabColix,e[s]),B=JU.C.copyColixTranslucency(this.mesh.slabColix,e[r]),C=JU.C.copyColixTranslucency(this.mesh.slabColix,e[t])),this.g3d.fillTriangle3CN(this.screens[s],
z,u,this.screens[r],B,y,this.screens[t],C,A)),this.iShowNormals&&this.renderNormals());else if(x&=q[3],b&&(x=7),0!=x){this.pt1i.setT(this.screens[s]);this.pt2i.setT(this.screens[r]);this.pt3i.setT(this.screens[t]);this.pt1i.z-=2;this.pt2i.z-=2;this.pt3i.z-=2;if(!f)if(k)this.g3d.setC(this.mesh.fillTriangles?4:m[q[4]%m.length]);else{this.drawTriangle(this.pt1i,z,this.pt2i,B,this.pt3i,C,x,p);continue}this.drawTriangle(this.pt1i,j,this.pt2i,j,this.pt3i,j,x,p)}}}}}c&&this.exportSurface(g?j:0)},"~B,~B,~B");
e(c$,"renderNormals",function(){if(this.g3d.setC(8)){this.g3d.setFontFid(this.g3d.getFontFidFS("Monospaced",24));for(var a=JU.Normix.getVertexVectors(),b=this.vertexCount;0<=--b;)if(!(null!=this.vertexValues&&Float.isNaN(this.vertexValues[b]))&&!(100<b)){this.ptTemp.setT(this.vertices[b]);var c=this.mesh.normixes[b];0<=c&&(this.ptTemp.scaleAdd2(3,a[c],this.ptTemp),this.tm.transformPtScr(this.ptTemp,this.ptTempi),this.g3d.drawLineAB(this.screens[b],this.ptTempi))}}})})})(Clazz,Clazz.doubleToInt,Clazz.declarePackage,
Clazz.instanceOf,Clazz.load,Clazz.instantialize,Clazz.decorateAsClass,Clazz.floatToInt,Clazz.makeConstructor,Clazz.defineEnumConstant,Clazz.exceptionOf,Clazz.newIntArray,Clazz.defineStatics,Clazz.newFloatArray,Clazz.declareType,Clazz.prepareFields,Clazz.superConstructor,Clazz.newByteArray,Clazz.declareInterface,Clazz.p0p,Clazz.pu$h,Clazz.newShortArray,Clazz.innerTypeInstance,Clazz.isClassDefined,Clazz.prepareCallback,Clazz.newArray,Clazz.castNullAs,Clazz.floatToShort,Clazz.superCall,Clazz.decorateAsType,
Clazz.newBooleanArray,Clazz.newCharArray,Clazz.implementOf,Clazz.newDoubleArray,Clazz.overrideConstructor,Clazz.clone,Clazz.doubleToShort,Clazz.getInheritedLevel,Clazz.getParamsType,Clazz.isAF,Clazz.isAI,Clazz.isAS,Clazz.isASS,Clazz.isAP,Clazz.isAFloat,Clazz.isAII,Clazz.isAFF,Clazz.isAFFF,Clazz.tryToSearchAndExecute,Clazz.getStackTrace,Clazz.inheritArgs,Clazz.alert,Clazz.defineMethod,Clazz.overrideMethod,Clazz.declareAnonymous,Clazz.cloneFinals);
