WebMol=window.WebMol||{};WebMol.createViewer=function(g,z){"string"===$.type(g)&&(g=$("#"+g));if(g){z=z||{};z.order||(z.order=["glmol","jmol"]);z.defaultcolors||(z.defaultcolors=WebMol.la);for(var C=0;C<z.order.length;C++){var A=z.order[C],B=A+"Viewer";if("function"===typeof this[B])try{return new this[B](g,z.callback,z.defaultcolors)}catch(u){console.log("error with "+A+":"+u)}}alert("Unable to instantiate webmol viewer: "+z.order);return null}};
WebMol.download=function(g,z){var C="";if("pdb:"===g.substr(0,4)){C="pdb";g=g.substr(4).toUpperCase();if(!g.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri="http://www.pdb.org/pdb/files/"+g+".pdb"}else if("cid:"==g.substr(0,4)){C="sdf";g=g.substr(4);if(!g.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+g+"/SDF?record_type=3d"}$.get(uri,function(g){z.addModel(g,C);z.zoomTo();z.render()});return null};
WebMol.SurfaceType={VDW:1,MS:2,SAS:3,SES:4};WebMol.m={k:{},color:function(g){if("undefined"!==typeof this.k[g])return this.k[g];var z=new WebMol.Color(g);return this.k[g]=z}};WebMol.pa=function(g,z){var C=z.geometry;void 0!==C&&g.geometryGroups.push(C.geometryGroups[0])};WebMol.mb=function(g){return g.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};WebMol.syncSurface=!1;WebMol=WebMol||{};
WebMol.M=function(){var g={oa:function(g,m,r,d){function c(q,V,e,l,h,b){var c=new WebMol.Vector3;c.copy(f);var M=h;l&1<<h||!(l&1<<b)||(M=b);M&1&&e++;M&2&&V++;M&4&&q++;c.x+=s.x*q;c.y+=s.y*V;c.z+=s.z*e;q=(y*q+V)*w+e;if(a)return m.push(c),m.length-1;0>t[q]&&(t[q]=m.length,m.push(c));return t[q]}var e=!!d.Ua,f=d.hasOwnProperty("origin")&&d.origin.hasOwnProperty("x")?d.origin:{x:0,y:0,z:0},a=!!d.za,b=d.ra||0,y=d.sa||0,w=d.ta||0;d=d.scale||1;var s=(new WebMol.Vector3(1,1,1)).multiplyScalar(d),t=new Int32Array(b*
y*w),x;d=0;for(x=t.length;d<x;++d)t[d]=-1;x=new Int32Array(12);var G=e?A:z,e=e?B:C;for(d=0;d<b-1;++d)for(var n=0;n<y-1;++n)for(var J=0;J<w-1;++J){for(var v=0,q=0;8>q;++q)v|=!!(g[(y*(d+((q&4)>>2))+n+((q&2)>>1))*w+J+(q&1)]&2)<<q;if(0!==v&&255!==v){var F=G[v];if(0!==F)for(q=e[v],F&1&&(x[0]=c(d,n,J,v,0,1)),F&2&&(x[1]=c(d,n,J,v,1,3)),F&4&&(x[2]=c(d,n,J,v,3,2)),F&8&&(x[3]=c(d,n,J,v,2,0)),F&16&&(x[4]=c(d,n,J,v,4,5)),F&32&&(x[5]=c(d,n,J,v,5,7)),F&64&&(x[6]=c(d,n,J,v,7,6)),F&128&&(x[7]=c(d,n,J,v,6,4)),F&256&&
(x[8]=c(d,n,J,v,0,4)),F&512&&(x[9]=c(d,n,J,v,1,5)),F&1024&&(x[10]=c(d,n,J,v,3,7)),F&2048&&(x[11]=c(d,n,J,v,2,6)),v=0;v<q.length;v+=3){var F=x[q[v]],V=x[q[v+1]],M=x[q[v+2]];a&&3<=v&&(m.push(m[F]),F=m.length-1,m.push(m[V]),V=m.length-1,m.push(m[M]),M=m.length-1);r.push(F);r.push(V);r.push(M)}}}},na:function(g,m,r){var d=Array(m.length),c,e,f,a;c=0;for(e=m.length;c<e;c++)d[c]={x:0,y:0,z:0};var b=Array(20),y;for(c=0;20>c;c++)b[c]=Array(m.length);c=0;for(e=m.length;c<e;c++)b[0][c]=0;c=0;for(e=r.length/
3;c<e;c++){var w=3*c,s=3*c+1,t=3*c+2;y=!0;f=0;for(a=b[0][r[w]];f<a;f++)if(r[s]==b[f+1][r[w]]){y=!1;break}y&&(b[0][r[w]]++,b[b[0][r[w]]][r[w]]=r[s]);y=!0;f=0;for(a=b[0][r[w]];f<a;f++)if(r[t]==b[f+1][r[w]]){y=!1;break}y&&(b[0][r[w]]++,b[b[0][r[w]]][r[w]]=r[t]);y=!0;f=0;for(a=b[0][r[s]];f<a;f++)if(r[w]==b[f+1][r[s]]){y=!1;break}y&&(b[0][r[s]]++,b[b[0][r[s]]][r[s]]=r[w]);y=!0;f=0;for(a=b[0][r[s]];f<a;f++)if(r[t]==b[f+1][r[s]]){y=!1;break}y&&(b[0][r[s]]++,b[b[0][r[s]]][r[s]]=r[t]);y=!0;for(f=0;f<b[0][r[t]];f++)if(r[w]==
b[f+1][r[t]]){y=!1;break}y&&(b[0][r[t]]++,b[b[0][r[t]]][r[t]]=r[w]);y=!0;f=0;for(a=b[0][r[t]];f<a;f++)if(r[s]==b[f+1][r[t]]){y=!1;break}y&&(b[0][r[t]]++,b[b[0][r[t]]][r[t]]=r[s])}for(r=0;r<g;r++){c=0;for(e=m.length;c<e;c++)if(3>b[0][c])d[c].x=m[c].x,d[c].y=m[c].y,d[c].z=m[c].z;else if(3==b[0][c]||4==b[0][c]){d[c].x=0;d[c].y=0;f=d[c].z=0;for(a=b[0][c];f<a;f++)d[c].x+=m[b[f+1][c]].x,d[c].y+=m[b[f+1][c]].y,d[c].z+=m[b[f+1][c]].z;d[c].x+=.5*m[c].x;d[c].y+=.5*m[c].y;d[c].z+=.5*m[c].z;d[c].x/=.5+b[0][c];
d[c].y/=.5+b[0][c];d[c].z/=.5+b[0][c]}else{d[c].x=0;d[c].y=0;f=d[c].z=0;for(a=b[0][c];f<a;f++)d[c].x+=m[b[f+1][c]].x,d[c].y+=m[b[f+1][c]].y,d[c].z+=m[b[f+1][c]].z;d[c].x+=1*m[c].x;d[c].y+=1*m[c].y;d[c].z+=1*m[c].z;d[c].x/=1+b[0][c];d[c].y/=1+b[0][c];d[c].z/=1+b[0][c]}c=0;for(e=m.length;c<e;c++)m[c].x=d[c].x,m[c].y=d[c].y,m[c].z=d[c].z}},La:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,
2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,
2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},z=new Uint32Array(g.La),C=g.pb=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,
4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,
4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,
1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,
1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,
7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,
3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],A=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,
2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,
3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],B=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,
2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,
11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,
5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,
6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],
[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,
2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,
4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,
6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,
10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,
5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,
10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return g}();"undefined"===typeof console&&(console={log:function(){}});
WebMol.Da=function(){function g(a,q,e){var b=new Int32Array(a*q*e*3);this.set=function(a,l,h,V){a=3*((a*q+l)*e+h);b[a]=V.c;b[a+1]=V.d;b[a+2]=V.f};this.get=function(a,l,h){a=3*((a*q+l)*e+h);return{c:b[a],d:b[a+1],f:b[a+2]}}}function z(a){return a.elem&&"undefined"!=typeof G[a.elem]?a.elem:"X"}var C=0,A=0,B=0,u=2,m=0,r=0,d=0,c=0,e=null,f=null,a=null,b=0,y=0,w=0,s=0,t=0,x=0,G={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},n={},
J={},v,q,F=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,
1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.Va=function(b){var c={},H,d;H=0;for(d=b.length;H<d;H++)c[b[H]]=!0;b=q;H=0;for(d=b.length;H<d;H++)b[H].x=b[H].x/u-C,b[H].y=b[H].y/u-A,b[H].z=b[H].z/u-B;var F=[];H=0;for(d=v.length;H<d;H+=3){var l=v[H],h=v[H+1],E=v[H+2],m=b[h].v,s=b[E].v,p=b[l].v;m<p&&(p=m);s<p&&(p=s);c[p]&&l!==h&&h!==E&&l!==E&&(F.push(l),F.push(h),F.push(E))}a=f=e=null;
return{vertices:b,Ma:F}};this.Xa=function(q,M,H){1E6<H&&(u=1);H=1/u*5.5;b=q[0][0];s=q[1][0];y=q[0][1];t=q[1][1];w=q[0][2];x=q[1][2];M?(b-=1.4+H,y-=1.4+H,w-=1.4+H,s+=1.4+H,t+=1.4+H,x+=1.4+H):(b-=H,y-=H,w-=H,s+=H,t+=H,x+=H);b=Math.floor(b*u)/u;y=Math.floor(y*u)/u;w=Math.floor(w*u)/u;s=Math.ceil(s*u)/u;t=Math.ceil(t*u)/u;x=Math.ceil(x*u)/u;C=-b;A=-y;B=-w;d=Math.ceil(u*(s-b))+1;r=Math.ceil(u*(t-y))+1;m=Math.ceil(u*(x-w))+1;this.ka(M);c=1.4*u;e=new Uint8Array(d*r*m);f=new Float64Array(d*r*m);a=new Int32Array(d*
r*m);console.log("Box size: ",d,r,m,e.length)};this.ka=function(a){var q=[],b,e;flagradius=a;for(var c in G)if(G.hasOwnProperty(c))for(e=G[c],q[c]=a?(e+1.4)*u+.5:e*u+.5,e=q[c]*q[c],J[c]=Math.floor(q[c])+1,n[c]=new Int32Array(J[c]*J[c]),j=indx=0;j<J[c];j++)for(k=0;k<J[c];k++)b=j*j+k*k,b>e?n[c][indx]=-1:(b=Math.sqrt(e-b),n[c][indx]=Math.floor(b)),indx++};this.Sa=function(q,b){var c,d;c=0;for(d=e.length;c<d;c++)e[c]=0,f[c]=-1,a[c]=-1;for(c in b)d=q[b[c]],void 0!==d&&this.Qa(d,q);c=0;for(d=e.length;c<
d;c++)e[c]&1&&(e[c]|=2)};this.Qa=function(q,b){var c,f,F,l,h,E,s,y,p,g,D,w,v,x,t,da,G;c=Math.floor(.5+u*(q.x+C));f=Math.floor(.5+u*(q.y+A));F=Math.floor(.5+u*(q.z+B));var P=z(q),I=0,T=r*m;g=0;for(G=J[P];g<G;g++)for(D=0;D<G;D++){if(-1!=n[P][I])for(x=-1;2>x;x++)for(t=-1;2>t;t++)for(da=-1;2>da;da++)if(0!==x&&0!==t&&0!==da)for(s=x*g,p=da*D,w=0;w<=n[P][I];w++)y=w*t,l=c+s,h=f+y,v=F+p,0>l||0>h||0>v||l>=d||h>=r||v>=m||(v=l*T+h*m+v,e[v]&1?(E=b[a[v]],l=Math.floor(.5+u*(E.x+C)),h=Math.floor(.5+u*(E.y+A)),E=
Math.floor(.5+u*(E.z+B)),s*s+y*y+p*p<l*l+h*h+E*E&&(a[v]=q.serial)):(e[v]|=1,a[v]=q.serial));I++}};this.Ta=function(a,q){var b,c;b=0;for(c=e.length;b<c;b++)e[b]&=-3;for(b in q)c=a[q[b]],void 0!==c&&this.Ra(c,a)};this.Ra=function(q,b){var c,f,F,l,h,E,s=0,y,p,g,D,v,w,x,t,G,U,P;c=Math.floor(.5+u*(q.x+C));f=Math.floor(.5+u*(q.y+A));F=Math.floor(.5+u*(q.z+B));var I=z(q),T=r*m;v=0;for(P=J[I];v<P;v++)for(w=0;w<P;w++){if(-1!=n[I][s])for(t=-1;2>t;t++)for(G=-1;2>G;G++)for(U=-1;2>U;U++)if(0!==t&&0!==G&&0!==U)for(y=
t*v,g=U*w,x=0;x<=n[I][s];x++)p=x*G,l=c+y,h=f+p,D=F+g,0>l||0>h||0>D||l>=d||h>=r||D>=m||(D=l*T+h*m+D,e[D]&2?(E=b[a[D]],l=Math.floor(.5+u*(E.x+C)),h=Math.floor(.5+u*(E.y+A)),E=Math.floor(.5+u*(E.z+B)),y*y+p*p+g*g<l*l+h*h+E*E&&(a[D]=q.serial)):(e[D]|=2,a[D]=q.serial));s++}};this.Ia=function(){var a=r*m;for(i=0;i<d;i++)for(j=0;j<m;j++)for(k=0;k<r;k++){var q=i*a+k*m+j;if(e[q]&1)for(var b=0;26>b;){var c=i+F[b][0],f=j+F[b][2],l=k+F[b][1];if(-1<c&&c<d&&-1<l&&l<r&&-1<f&&f<m&&!(e[c*a+l*m+f]&1)){e[q]|=4;break}else b++}}};
this.Oa=function(){var q,a,b,F=new g(d,r,m),s=r*m,l=c*c,h=[];b=[];var E;for(q=0;q<d;q++)for(a=0;a<r;a++)for(b=0;b<m;b++)if(E=q*s+a*m+b,e[E]&=-3,e[E]&1&&e[E]&4){var y={c:q,d:a,f:b};F.set(q,a,b,y);h.push(y);f[E]=0;e[E]|=2;e[E]&=-5}do for(b=this.Pa(h,F),h=[],q=0,a=b.length;q<a;q++)E=s*b[q].c+m*b[q].d+b[q].f,e[E]&=-5,f[E]<=1.0404*l&&h.push({c:b[q].c,d:b[q].d,f:b[q].f});while(0!==h.length);q=u-.5;0>q&&(q=0);l-=.5/(.1+q);for(q=0;q<d;q++)for(a=0;a<r;a++)for(b=0;b<m;b++)E=q*s+a*m+b,e[E]&=-5,e[E]&1&&(!(e[E]&
2)||e[E]&2&&f[E]>=l)&&(e[E]|=4)};this.Pa=function(q,a){var b,c,s,l,h,E,y,g,p,n,D,v=[];if(0===q.length)return v;tnv={c:-1,d:-1,f:-1};var w=r*m;y=0;for(p=q.length;y<p;y++)for(b=q[y].c,c=q[y].d,s=q[y].f,n=a.get(b,c,s),g=0;6>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=s+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<r&&-1<tnv.d&&tnv.f<m&&-1<tnv.f&&(D=tnv.c*w+m*tnv.d+tnv.f,e[D]&1&&!(e[D]&2)?(a.set(tnv.c,tnv.d,s+F[g][2],n),l=tnv.c-n.c,h=tnv.d-n.d,E=tnv.f-n.f,l=l*l+h*h+E*E,f[D]=l,e[D]|=2,e[D]|=4,v.push({c:tnv.c,d:tnv.d,
f:tnv.f})):e[D]&1&&e[D]&2&&(l=tnv.c-n.c,h=tnv.d-n.d,E=tnv.f-n.f,l=l*l+h*h+E*E,l<f[D]&&(a.set(tnv.c,tnv.d,tnv.f,n),f[D]=l,e[D]&4||(e[D]|=4,v.push({c:tnv.c,d:tnv.d,f:tnv.f})))));y=0;for(p=q.length;y<p;y++)for(b=q[y].c,c=q[y].d,s=q[y].f,n=a.get(b,c,s),g=6;18>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=s+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<r&&-1<tnv.d&&tnv.f<m&&-1<tnv.f&&(D=tnv.c*w+m*tnv.d+tnv.f,e[D]&1&&!(e[D]&2)?(a.set(tnv.c,tnv.d,s+F[g][2],n),l=tnv.c-n.c,h=tnv.d-n.d,E=tnv.f-n.f,l=l*l+h*h+E*E,f[D]=l,e[D]|=
2,e[D]|=4,v.push({c:tnv.c,d:tnv.d,f:tnv.f})):e[D]&1&&e[D]&2&&(l=tnv.c-n.c,h=tnv.d-n.d,E=tnv.f-n.f,l=l*l+h*h+E*E,l<f[D]&&(a.set(tnv.c,tnv.d,tnv.f,n),f[D]=l,e[D]&4||(e[D]|=4,v.push({c:tnv.c,d:tnv.d,f:tnv.f})))));y=0;for(p=q.length;y<p;y++)for(b=q[y].c,c=q[y].d,s=q[y].f,n=a.get(b,c,s),g=18;26>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=s+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<r&&-1<tnv.d&&tnv.f<m&&-1<tnv.f&&(D=tnv.c*w+m*tnv.d+tnv.f,e[D]&1&&!(e[D]&2)?(a.set(tnv.c,tnv.d,s+F[g][2],n),l=tnv.c-n.c,h=tnv.d-n.d,
E=tnv.f-n.f,l=l*l+h*h+E*E,f[D]=l,e[D]|=2,e[D]|=4,v.push({c:tnv.c,d:tnv.d,f:tnv.f})):e[D]&1&&e[D]&2&&(l=tnv.c-n.c,h=tnv.d-n.d,E=tnv.f-n.f,l=l*l+h*h+E*E,l<f[D]&&(a.set(tnv.c,tnv.d,tnv.f,n),f[D]=l,e[D]&4||(e[D]|=4,v.push({c:tnv.c,d:tnv.d,f:tnv.f})))));return v};this.Za=function(q){for(var a=0,b=e.length;a<b;a++)1==q?e[a]&=-5:4==q?(e[a]&=-3,e[a]&4&&(e[a]|=2),e[a]&=-5):2==q?e[a]&4&&e[a]&2?e[a]&=-5:e[a]&4&&!(e[a]&2)&&(e[a]|=2):3==q&&(e[a]&=-5)};this.Ya=function(b){this.Za(b);q=[];v=[];WebMol.M.oa(e,q,v,
{ob:1,ra:d,sa:r,ta:m});b=r*m;for(var c=0,f=q.length;c<f;c++)q[c].v=a[q[c].x*b+m*q[c].y+q[c].z];WebMol.M.na(1,q,v)}};WebMol.bb='self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(0>type)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1==type?!1:!0,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),(4===type||2===type)&&(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}};var Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0};Vector3.prototype={constructor:Vector3,copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this}};var ISDONE=2,ProteinSurface=function (){var faces,verts,origextent,INOUT=1,ISDONE=2,ISBOUND=4,ptranx=0,ptrany=0,ptranz=0,probeRadius=1.4,defaultScaleFactor=2,scaleFactor=defaultScaleFactor,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&"undefined"!=typeof vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;il>i;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;il>i;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;il>i;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(which>b&&(which=b),which>c&&(which=c),atomsToShow[which]){{vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]]}fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=defaultScaleFactor/2);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=probeRadius+margin,pminy-=probeRadius+margin,pminz-=probeRadius+margin,pmaxx+=probeRadius+margin,pmaxy+=probeRadius+margin,pmaxz+=probeRadius+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=probeRadius*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight),console.log("Box size: ",pLength,pWidth,pHeight,vpBits.length)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+probeRadius)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)txz=j*j+k*k,txz>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&INOUT&&(vpBits[i]|=ISDONE)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&INOUT){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=INOUT,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&=~ISDONE;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&ISDONE){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=ISDONE,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;pLength>i;i++)for(j=0;pHeight>j;j++)for(k=0;pWidth>k;k++){var index=i*pWH+k*pHeight+j;if(vpBits[index]&INOUT)for(var ii=0;26>ii;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&pLength>ti&&tk>-1&&pWidth>tk&&tj>-1&&pHeight>tj&&!(vpBits[ti*pWH+tk*pHeight+tj]&INOUT)){vpBits[index]|=ISBOUND;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=~ISDONE,vpBits[index]&INOUT&&vpBits[index]&ISBOUND){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=ISDONE,vpBits[index]&=~ISBOUND}do for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;n>i;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=~ISBOUND,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz});while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;0>cutsf&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)index=i*pWH+j*pHeight+k,vpBits[index]&=~ISBOUND,vpBits[index]&INOUT&&(!(vpBits[index]&ISDONE)||vpBits[index]&ISDONE&&vpDistance[index]>=cutoff)&&(vpBits[index]|=ISBOUND)},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;6>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;18>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;26>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;lim>i;i++)1==stype?vpBits[i]&=~ISBOUND:4==stype?(vpBits[i]&=~ISDONE,vpBits[i]&ISBOUND&&(vpBits[i]|=ISDONE),vpBits[i]&=~ISBOUND):2==stype?vpBits[i]&ISBOUND&&vpBits[i]&ISDONE?vpBits[i]&=~ISBOUND:vpBits[i]&ISBOUND&&!(vpBits[i]&ISDONE)&&(vpBits[i]|=ISDONE):3==stype&&(vpBits[i]&=~ISBOUND)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;vlen>i;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];laplacianSmooth(1,verts,faces)}},march=function (data,verts,faces,spec){var i,il,fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=new Vector3(1,1,1).multiplyScalar(scale),vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;il>i;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt=new Vector3;pt.copy(origin);var val1=!!(code&1<<p1),val2=!!(code&1<<p2),p=p1;!val1&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,pt.x+=unitCube.x*i,pt.y+=unitCube.y*j,pt.z+=unitCube.z*k;var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;nX-1>i;++i)for(var j=0;nY-1>j;++j)for(var k=0;nZ-1>k;++k){for(var code=0,p=0;8>p;++p){var index=(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p),val=!!(data[index]&ISDONE);code|=val<<p}if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},laplacianSmooth=function (numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;20>i;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;il>i;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}var wt=1,wt2=.5;for(k=0;numiter>k;k++){for(i=0,il=verts.length;il>i;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt2*verts[i].x,tps[i].y+=wt2*verts[i].y,tps[i].z+=wt2*verts[i].z,tps[i].x/=wt2+vertdeg[0][i],tps[i].y/=wt2+vertdeg[0][i],tps[i].z/=wt2+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt*verts[i].x,tps[i].y+=wt*verts[i].y,tps[i].z+=wt*verts[i].z,tps[i].x/=wt+vertdeg[0][i],tps[i].y/=wt+vertdeg[0][i],tps[i].z/=wt+vertdeg[0][i]}for(i=0,il=verts.length;il>i;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]';
WebMol.Ga=window.URL.createObjectURL(new Blob([WebMol.bb]));
$(document).ready(function(){void 0!==$("#webmoljs_viewer")[0]&&(WebMol.Ha=!0);if(WebMol.Ha){var g=WebMol.qb=$("#webmoljs_viewer"),z=null;g.data("pdb")?z="http://www.pdb.org/pdb/files/"+g.data("pdb")+".pdb":g.data("href")&&(z=g.data("href"));var C=Number(g.data("backgroundcolor"))||0,A=g.data("style")||{line:{}};WebMol.U=WebMol.createViewer("webmoljs_viewer",{defaultcolors:WebMol.rasmolElementColors,callback:function(g){g.setBackgroundColor(C)}});if(z){var B=g.data("datatype")||"pdb";$.get(z,function(g){WebMol.U.addModel(g,
B);WebMol.U.setStyle({},A);WebMol.U.zoomTo();WebMol.U.render()},"text")}}});WebMol.Ja=16716947;
WebMol.JmolElementColors={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,
I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219};
WebMol.rasmolElementColors={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,
Ba:16753920,BA:16753920,Au:14329120,AU:14329120};WebMol.la=WebMol.JmolElementColors;var WebMol=WebMol||{};WebMol.Ea=function(){this.Z=function(g,z){var C,A;z?(C=z[0],A=z[1]):A=C=void 0;if(void 0===g)return 16777215;g<C&&(g=C);g>A&&(g=A);var B=(A+C)/2;g<=B?(C=Math.floor(255*Math.sqrt((g-C)/(B-C))),C=16711680+256*C+C):(C=Math.floor(255*Math.sqrt(1-(g-B)/(A-B))),C=65536*C+256*C+255);return C};this.ia=function(){return null}};
WebMol.cb=function(g,z){this.Z=function(C,A){var B,u;A?(B=A[0],u=A[1]):(B=g,u=z);if("undefined"==typeof C)return 16777215;C<B&&(C=B);C>u&&(C=u);var m=(B+u)/2,r=(B+m)/2,d=(m+u)/2;C<r?(B=Math.floor(255*Math.sqrt((C-B)/(r-B))),B=256*B+16711680):C<m?(B=Math.floor(255*Math.sqrt(1-(C-r)/(m-r))),B=65536*B+65280):C<d?(B=Math.floor(255*Math.sqrt((C-m)/(d-m))),B=65280+1*B):(B=Math.floor(255*Math.sqrt(1-(C-d)/(u-d))),B=256*B+255);return B};this.ia=function(){return"undefined"!=typeof g&&"undefined"!=typeof z?
[g,z]:null}};WebMol.eb=function(g,z){this.Z=function(C,A){var B,u;A?(B=A[0],u=A[1]):(B=g,u=z);if("undefined"==typeof C)return 16777215;C<B&&(C=B);C>u&&(C=u);var m=(C-B)/(u-B)*5/6+.5;B=Math.sin(Math.PI*m);u=Math.sin(Math.PI*(m+1/3));m=Math.sin(Math.PI*(m+2/3));return 65536*Math.floor(255*B*B)+256*Math.floor(255*m*m)+1*Math.floor(255*u*u)};this.ia=function(){return"undefined"!=typeof g&&"undefined"!=typeof z?[g,z]:null}};WebMol=WebMol||{};
WebMol.Ka=function(){function g(g,A,B,u,m){if(!(2>A.length)){m=m||5;A=z(A,m);B=z(B,m);var r=new WebMol.Geometry(!0),d=[],c,e,f,a,b,y=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],w,s,t,x,G,n,J,v,q;n=0;for(J=A.length;n<J;n++){t=WebMol.m.color(u[Math.round((n-1)/m)]);d.push(e=A[n]);d.push(e);d.push(f=B[n]);d.push(f);n<J-1&&(w=A[n+1].clone().sub(A[n]),c=B[n].clone().sub(A[n]).cross(w).normalize().multiplyScalar(.4));d.push(a=A[n].clone().add(c));d.push(a);d.push(b=B[n].clone().add(c));d.push(b);
void 0!==e.atom&&(x=e.atom);q=r.updateGeoGroup(8);w=q.vertices;s=3*w;q.__vertexArray[s]=e.x;q.__vertexArray[s+1]=e.y;q.__vertexArray[s+2]=e.z;q.__vertexArray[s+3]=e.x;q.__vertexArray[s+4]=e.y;q.__vertexArray[s+5]=e.z;q.__vertexArray[s+6]=f.x;q.__vertexArray[s+7]=f.y;q.__vertexArray[s+8]=f.z;q.__vertexArray[s+9]=f.x;q.__vertexArray[s+10]=f.y;q.__vertexArray[s+11]=f.z;q.__vertexArray[s+12]=a.x;q.__vertexArray[s+13]=a.y;q.__vertexArray[s+14]=a.z;q.__vertexArray[s+15]=a.x;q.__vertexArray[s+16]=a.y;q.__vertexArray[s+
17]=a.z;q.__vertexArray[s+18]=b.x;q.__vertexArray[s+19]=b.y;q.__vertexArray[s+20]=b.z;q.__vertexArray[s+21]=b.x;q.__vertexArray[s+22]=b.y;q.__vertexArray[s+23]=b.z;for(e=0;8>e;++e)q.__colorArray[s+3*e]=t.r,q.__colorArray[s+1+3*e]=t.g,q.__colorArray[s+2+3*e]=t.b;if(0<n)for(s=void 0!==G&&void 0!==x&&G.serial!==x.serial,e=0;4>e;e++)if(f=[w+y[e][0],w+y[e][1],w+y[e][2],w+y[e][3]],b=q.faceidx,q.__faceArray[b]=f[0],q.__faceArray[b+1]=f[1],q.__faceArray[b+2]=f[3],q.__faceArray[b+3]=f[1],q.__faceArray[b+4]=
f[2],q.__faceArray[b+5]=f[3],q.faceidx+=6,x.clickable||G.clickable){v=d[f[3]].clone();b=d[f[0]].clone();var F=d[f[2]].clone(),V=d[f[1]].clone();v.atom=d[f[3]].atom||null;F.atom=d[f[2]].atom||null;b.atom=d[f[0]].atom||null;V.atom=d[f[1]].atom||null;if(s){var M=v.clone().add(b).multiplyScalar(.5),H=F.clone().add(V).multiplyScalar(.5),L=v.clone().add(V).multiplyScalar(.5);0===e%2?(G.clickable&&(f=new WebMol.Triangle(M,L,v),a=new WebMol.Triangle(H,F,L),v=new WebMol.Triangle(L,F,v),G.e.i.push(f),G.e.i.push(a),
G.e.i.push(v)),x.clickable&&(f=new WebMol.Triangle(b,V,L),a=new WebMol.Triangle(V,H,L),v=new WebMol.Triangle(b,L,M),x.e.i.push(f),x.e.i.push(a),x.e.i.push(v))):(x.clickable&&(f=new WebMol.Triangle(M,L,v),a=new WebMol.Triangle(H,F,L),v=new WebMol.Triangle(L,F,v),x.e.i.push(f),x.e.i.push(a),x.e.i.push(v)),G.clickable&&(f=new WebMol.Triangle(b,V,L),a=new WebMol.Triangle(V,H,L),v=new WebMol.Triangle(b,L,M),G.e.i.push(f),G.e.i.push(a),G.e.i.push(v)))}else x.clickable&&(f=new WebMol.Triangle(b,V,v),a=new WebMol.Triangle(V,
F,v),x.e.i.push(f),x.e.i.push(a))}q.vertices+=8;G=x}A=d.length-8;q=r.updateGeoGroup(8);w=q.vertices;s=3*w;b=q.faceidx;for(n=0;4>n;n++)d.push(d[2*n]),d.push(d[A+2*n]),B=d[2*n],u=d[A+2*n],q.__vertexArray[s+6*n]=B.x,q.__vertexArray[s+1+6*n]=B.y,q.__vertexArray[s+2+6*n]=B.z,q.__vertexArray[s+3+6*n]=u.x,q.__vertexArray[s+4+6*n]=u.y,q.__vertexArray[s+5+6*n]=u.z,q.__colorArray[s+6*n]=t.r,q.__colorArray[s+1+6*n]=t.g,q.__colorArray[s+2+6*n]=t.b,q.__colorArray[s+3+6*n]=t.r,q.__colorArray[s+4+6*n]=t.g,q.__colorArray[s+
5+6*n]=t.b;f=[w,w+2,w+6,w+4];a=[w+1,w+5,w+7,w+3];q.__faceArray[b]=f[0];q.__faceArray[b+1]=f[1];q.__faceArray[b+2]=f[3];q.__faceArray[b+3]=f[1];q.__faceArray[b+4]=f[2];q.__faceArray[b+5]=f[3];q.__faceArray[b+6]=a[0];q.__faceArray[b+7]=a[1];q.__faceArray[b+8]=a[3];q.__faceArray[b+9]=a[1];q.__faceArray[b+10]=a[2];q.__faceArray[b+11]=a[3];q.faceidx+=12;q.vertices+=8;r.initTypedArrays();r.setUpNormals();d=new WebMol.MeshLambertMaterial;d.vertexColors=WebMol.FaceColors;d.side=WebMol.DoubleSide;r=new WebMol.Mesh(r,
d);g.add(r)}}function z(g,z){var B=[],u=g,u=[];u.push(g[0]);var m,r,d,c,e,f;m=1;for(r=g.length-1;m<r;m++)c=g[m],e=g[m+1],c.$a?u.push(new WebMol.Vector3((c.x+e.x)/2,(c.y+e.y)/2,(c.z+e.z)/2)):u.push(c);u.push(g[g.length-1]);m=-1;for(r=u.length;m<=r-3;m++){d=u[-1===m?0:m];c=u[m+1];e=u[m+2];f=u[m===r-3?r-1:m+3];d=(new WebMol.Vector3).subVectors(e,d).multiplyScalar(.5);f=(new WebMol.Vector3).subVectors(f,c).multiplyScalar(.5);for(var a=0;a<z;a++){var b=1/z*a,b=new WebMol.Vector3(c.x+b*d.x+b*b*(-3*c.x+
3*e.x-2*d.x-f.x)+b*b*b*(2*c.x-2*e.x+d.x+f.x),c.y+b*d.y+b*b*(-3*c.y+3*e.y-2*d.y-f.y)+b*b*b*(2*c.y-2*e.y+d.y+f.y),c.z+b*d.z+b*b*(-3*c.z+3*e.z-2*d.z-f.z)+b*b*b*(2*c.z-2*e.z+d.z+f.z)),y=Math.floor((B.length+2)/z);void 0!==g[y]&&void 0!==g[y].atom&&(b.atom=g[y].atom);B.push(b)}}B.push(u[u.length-1]);return B}return function(C,z){var B,u,m;B=2;u=5;m=!1;var r=[],d,c,e;for(e=0;e<B;e++)r[e]=[];e=[];var f,a,b,y,w=null,s=null;for(d in z)if(c=z[d],void 0!==c&&("O"==c.atom||"CA"==c.atom)&&!c.hetflag)if("CA"==
c.atom){if(f!=c.chain||b+1!=c.resi||a!=c.va){g(C,r[0],r[B-1],e,u);r=[];for(e=0;e<B;e++)r[e]=[];e=[];w=null}y=new WebMol.Vector3(c.x,c.y,c.z);currentAtom=c;f=c.chain;a=c.va;b=c.resi;var s=c.ss,t=c.color;"undefined"!=typeof c.style.cartoon.color&&(t=c.style.cartoon.color);e.push(t);!0!==c.clickable||void 0!==c.e&&void 0!==c.e.i||(c.e={sphere:null,j:[],line:[],i:[]})}else for(c=new WebMol.Vector3(c.x,c.y,c.z),c.sub(y),c.normalize(),c.multiplyScalar("c"==s?.3:1.3),null!==w&&0>c.dot(w)&&c.negate(),w=c,
c=0;c<B;c++)t=-1+2/(B-1)*c,t=new WebMol.Vector3(y.x+w.x*t,y.y+w.y*t,y.z+w.z*t),t.atom=currentAtom,m||"s"!=s||(t.$a=!0),r[c].push(t);g(C,r[0],r[B-1],e,u)}}();WebMol=WebMol||{};
WebMol.GLModel=function(){function g(d){var c=[],e,f;e=0;for(f=d.length;e<f;e++){d[e].index=e;var a=d[e];a.hetflag||"N"!==a.atom&&"O"!==a.atom||(c.push(a),a.fa=null,a.J=Number.POSITIVE_INFINITY)}c.sort(function(a,b){return a.z-b.z});e=0;for(f=c.length;e<f;e++)for(a=c[e],d=e+1;d<f;d++){var b=c[d];if(3.5<b.z-a.z)break;var g=z(a,b);g<a.J&&(a.fa=b,a.J=g);g<b.J&&(b.fa=a,b.J=g)}}function z(d,c){if(d.chain==c.chain&&4>Math.abs(d.resi-c.resi))return Number.POSITIVE_INFINITY;if("O"===d.atom&&"N"===c.atom||
"N"===d.atom&&"O"===c.atom){var e=d.x-c.x;if(3.5<e)return Number.POSITIVE_INFINITY;var f=d.y-c.y;if(3.5<f)return Number.POSITIVE_INFINITY;var a=d.z-c.z;if(3.5<a)return Number.POSITIVE_INFINITY;e=Math.sqrt(e*e+f*f+a*a);if(3.5>e)return e}return Number.POSITIVE_INFINITY}function C(d){var c=[],e=[],f,a;f=0;for(a=d.length;f<a;f++){var b=d[f];b.index=f;b.hetflag?e.push(b):c.push(b)}A(e);c.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var e=d=-1,g;f=0;for(a=c.length;f<a;f++){b=
c[f];b.resi!==d&&(d=b.resi,g||e++,g=!1);b.va=e;for(var m=f+1;m<c.length;m++){var s=c[m];if(s.chain!=b.chain)break;if(1<s.resi-b.resi)break;B(b,s)&&(-1===b.bonds.indexOf(s.index)&&(b.bonds.push(s.index),b.bondOrder.push(1),s.bonds.push(b.index),s.bondOrder.push(1)),b.resi!==s.resi&&(g=!0))}}}function A(d){var c=d.slice(0),e,f;e=0;for(f=d.length;e<f;e++)d[e].index||(d[e].index=e);c.sort(function(a,b){return a.z-b.z});e=0;for(f=c.length;e<f;e++){var a=c[e];for(d=e+1;d<f;d++){var b=c[d];if(1.9<b.z-a.z)break;
B(a,b)&&-1==a.bonds.indexOf(b.index)&&(a.bonds.push(b.index),a.bondOrder.push(1),b.bonds.push(a.index),b.bondOrder.push(1))}}}function B(d,c){var e=d.x-c.x,e=e*e;if(3.6<e)return!1;var f=d.y-c.y,f=f*f;if(3.6<f)return!1;var a=d.z-c.z,a=a*a;if(3.6<a)return!1;e=e+f+a;return isNaN(e)||.5>e||1.3<e&&("H"==d.elem||"H"==c.elem||"D"==d.elem||"D"==c.elem)?!1:3.6>e&&("S"==d.elem||"S"==c.elem)?!0:2.78<e?!1:!0}function u(d,c){return d&&c?JSON.stringify(d)==JSON.stringify(c):d==c}var m={line:{}},r={H:1.2,Li:1.82,
Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63};return function(d,c){function e(a,b,c,e,f,d,g){if(b&&c){v++;var l=d||g,h=c.clone();h.sub(b);var h=B(h),E=G.G(e);e=E.w;var s=E.Wa,y=l?s*e+2:2*e;a=a.updateGeoGroup(y);var p=E.vertices,m=E.s,E=E.t,n=E[s/2],r=E[s/2+1],w=a.vertices,x,t,u,C,z,I;for(u=0;u<e;++u)t=2*u,C=h[0]*p[t].x+h[3]*p[t].y+h[6]*p[t].z,z=h[1]*p[t].x+h[4]*p[t].y+h[7]*p[t].z,I=h[5]*p[t].y+h[8]*p[t].z,x=3*(w+t),t=a.faceidx,a.__vertexArray[x]=
C+b.x,a.__vertexArray[x+1]=z+b.y,a.__vertexArray[x+2]=I+b.z,a.__vertexArray[x+3]=C+c.x,a.__vertexArray[x+4]=z+c.y,a.__vertexArray[x+5]=I+c.z,a.__normalArray[x]=C,a.__normalArray[x+3]=C,a.__normalArray[x+1]=z,a.__normalArray[x+4]=z,a.__normalArray[x+2]=I,a.__normalArray[x+5]=I,a.__colorArray[x]=f.r,a.__colorArray[x+3]=f.r,a.__colorArray[x+1]=f.g,a.__colorArray[x+4]=f.g,a.__colorArray[x+2]=f.b,a.__colorArray[x+5]=f.b,a.__faceArray[t]=r[u]+w,a.__faceArray[t+1]=r[u+1]+w,a.__faceArray[t+2]=n[u]+w,a.__faceArray[t+
3]=n[u]+w,a.__faceArray[t+4]=r[u+1]+w,a.__faceArray[t+5]=n[u+1]+w,a.faceidx+=6;if(l){d=d?s+1:s/2+1;var T,N,S,Z,A,O,K,Y,W,aa,ka,la,ca;for(z=g?0:s/2;z<d;z++)if(z!==s/2){var fa=z<=s/2?c:b;for(C=0;C<e;C++)t=a.faceidx,g=E[z][C+1],u=3*(g+w),l=E[z][C],I=3*(l+w),n=E[z+1][C],x=3*(n+w),r=E[z+1][C+1],ca=3*(r+w),T=h[0]*p[g].x+h[3]*p[g].y+h[6]*p[g].z,N=h[0]*p[l].x+h[3]*p[l].y+h[6]*p[l].z,S=h[0]*p[n].x+h[3]*p[n].y+h[6]*p[n].z,Z=h[0]*p[r].x+h[3]*p[r].y+h[6]*p[r].z,A=h[1]*p[g].x+h[4]*p[g].y+h[7]*p[g].z,O=h[1]*p[l].x+
h[4]*p[l].y+h[7]*p[l].z,K=h[1]*p[n].x+h[4]*p[n].y+h[7]*p[n].z,Y=h[1]*p[r].x+h[4]*p[r].y+h[7]*p[r].z,W=h[5]*p[g].y+h[8]*p[g].z,aa=h[5]*p[l].y+h[8]*p[l].z,ka=h[5]*p[n].y+h[8]*p[n].z,la=h[5]*p[r].y+h[8]*p[r].z,a.__vertexArray[u]=T+fa.x,a.__vertexArray[I]=N+fa.x,a.__vertexArray[x]=S+fa.x,a.__vertexArray[ca]=Z+fa.x,a.__vertexArray[u+1]=A+fa.y,a.__vertexArray[I+1]=O+fa.y,a.__vertexArray[x+1]=K+fa.y,a.__vertexArray[ca+1]=Y+fa.y,a.__vertexArray[u+2]=W+fa.z,a.__vertexArray[I+2]=aa+fa.z,a.__vertexArray[x+2]=
ka+fa.z,a.__vertexArray[ca+2]=la+fa.z,a.__colorArray[u]=f.r,a.__colorArray[I]=f.r,a.__colorArray[x]=f.r,a.__colorArray[ca]=f.r,a.__colorArray[u+1]=f.g,a.__colorArray[I+1]=f.g,a.__colorArray[x+1]=f.g,a.__colorArray[ca+1]=f.g,a.__colorArray[u+2]=f.b,a.__colorArray[I+2]=f.b,a.__colorArray[x+2]=f.b,a.__colorArray[ca+2]=f.b,T=h[0]*m[g].x+h[3]*m[g].y+h[6]*m[g].z,N=h[0]*m[l].x+h[3]*m[l].y+h[6]*m[l].z,S=h[0]*m[n].x+h[3]*m[n].y+h[6]*m[n].z,Z=h[0]*m[r].x+h[3]*m[r].y+h[6]*m[r].z,A=h[1]*m[g].x+h[4]*m[g].y+h[7]*
m[g].z,O=h[1]*m[l].x+h[4]*m[l].y+h[7]*m[l].z,K=h[1]*m[n].x+h[4]*m[n].y+h[7]*m[n].z,Y=h[1]*m[r].x+h[4]*m[r].y+h[7]*m[r].z,W=h[5]*m[g].y+h[8]*m[g].z,aa=h[5]*m[l].y+h[8]*m[l].z,ka=h[5]*m[n].y+h[8]*m[n].z,la=h[5]*m[r].y+h[8]*m[r].z,0===z?(a.__normalArray[u]=T,a.__normalArray[x]=S,a.__normalArray[ca]=Z,a.__normalArray[u+1]=A,a.__normalArray[x+1]=K,a.__normalArray[ca+1]=Y,a.__normalArray[u+2]=W,a.__normalArray[x+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[t]=g+w,a.__faceArray[t+1]=n+w,a.__faceArray[t+
2]=r+w,a.faceidx+=3):z===d-1?(a.__normalArray[u]=T,a.__normalArray[I]=N,a.__normalArray[x]=S,a.__normalArray[u+1]=A,a.__normalArray[I+1]=O,a.__normalArray[x+1]=K,a.__normalArray[u+2]=W,a.__normalArray[I+2]=aa,a.__normalArray[x+2]=ka,a.__faceArray[t]=g+w,a.__faceArray[t+1]=l+w,a.__faceArray[t+2]=n+w,a.faceidx+=3):(a.__normalArray[u]=T,a.__normalArray[I]=N,a.__normalArray[ca]=Z,a.__normalArray[u+1]=A,a.__normalArray[I+1]=O,a.__normalArray[ca+1]=Y,a.__normalArray[u+2]=W,a.__normalArray[I+2]=aa,a.__normalArray[ca+
2]=la,a.__normalArray[I]=N,a.__normalArray[x]=S,a.__normalArray[ca]=Z,a.__normalArray[I+1]=O,a.__normalArray[x+1]=K,a.__normalArray[ca+1]=Y,a.__normalArray[I+2]=aa,a.__normalArray[x+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[t]=g+w,a.__faceArray[t+1]=l+w,a.__faceArray[t+2]=r+w,a.__faceArray[t+3]=l+w,a.__faceArray[t+4]=n+w,a.__faceArray[t+5]=r+w,a.faceidx+=6)}}a.vertices+=y}}function f(q,b){if(q.style.sphere){var c=q.style.sphere;if(!c.hidden){var e=q.color;"undefined"!=typeof c.color&&(e=c.color);
var f=WebMol.m.color(e),d,c=a(q,c);!0===q.clickable&&void 0!==q.e&&(e=new WebMol.Vector3(q.x,q.y,q.z),q.e.sphere.push(new WebMol.Sphere(e,c)));d=n.G(c);for(var e=d.vertices,g=d.s,l=b.updateGeoGroup(e.length),h=l.vertices,m=0,s=e.length;m<s;++m){var y=3*(h+m),p=e[m];l.__vertexArray[y]=p.x+q.x;l.__vertexArray[y+1]=p.y+q.y;l.__vertexArray[y+2]=p.z+q.z;l.__colorArray[y]=f.r;l.__colorArray[y+1]=f.g;l.__colorArray[y+2]=f.b}l.vertices+=e.length;m=d.t;s=m.length-1;for(d=0;d<s;d++)for(y=m[d].length-1,f=0;f<
y;f++){var p=l.faceidx,x=m[d][f+1]+h,r=3*x,w=m[d][f]+h,t=3*w,v=m[d+1][f]+h,u=3*v,C=m[d+1][f+1]+h,G=3*C,z=g[x-h],I=g[w-h],T=g[v-h],N=g[C-h];Math.abs(e[x-h].y)===c?(l.__normalArray[r]=z.x,l.__normalArray[u]=T.x,l.__normalArray[G]=N.x,l.__normalArray[r+1]=z.y,l.__normalArray[u+1]=T.y,l.__normalArray[G+1]=N.y,l.__normalArray[r+2]=z.z,l.__normalArray[u+2]=T.z,l.__normalArray[G+2]=N.z,l.__faceArray[p]=x,l.__faceArray[p+1]=v,l.__faceArray[p+2]=C,l.faceidx+=3):Math.abs(e[v-h].y)===c?(l.__normalArray[r]=z.x,
l.__normalArray[t]=I.x,l.__normalArray[u]=T.x,l.__normalArray[r+1]=z.y,l.__normalArray[t+1]=I.y,l.__normalArray[u+1]=T.y,l.__normalArray[r+2]=z.z,l.__normalArray[t+2]=I.z,l.__normalArray[u+2]=T.z,l.__faceArray[p]=x,l.__faceArray[p+1]=w,l.__faceArray[p+2]=v,l.faceidx+=3):(l.__normalArray[r]=z.x,l.__normalArray[t]=I.x,l.__normalArray[G]=N.x,l.__normalArray[r+1]=z.y,l.__normalArray[t+1]=I.y,l.__normalArray[G+1]=N.y,l.__normalArray[r+2]=z.z,l.__normalArray[t+2]=I.z,l.__normalArray[G+2]=N.z,l.__normalArray[t]=
I.x,l.__normalArray[u]=T.x,l.__normalArray[G]=N.x,l.__normalArray[t+1]=I.y,l.__normalArray[u+1]=T.y,l.__normalArray[G+1]=N.y,l.__normalArray[t+2]=I.z,l.__normalArray[u+2]=T.z,l.__normalArray[G+2]=N.z,l.__faceArray[p]=x,l.__faceArray[p+1]=w,l.__faceArray[p+2]=C,l.__faceArray[p+3]=w,l.__faceArray[p+4]=v,l.__faceArray[p+5]=C,l.faceidx+=6)}}}}function a(a,b){var c=1.5;"undefined"!=typeof b.l?c=b.l:r[a.elem]&&(c=r[a.elem]);"undefined"!=typeof b.scale&&(c*=b.scale);return c}var b=[],y=null,w=null,s=null,
t=null,x=WebMol.Ja;ElementColors=c?c:WebMol.la;var G={Q:function(){var a=[];a[0]=new WebMol.Vector3(-1,0,0);a[4]=new WebMol.Vector3(0,0,1);a[8]=new WebMol.Vector3(1,0,0);a[12]=new WebMol.Vector3(0,0,-1);a[2]=a[0].clone().add(a[4]).normalize();a[6]=a[4].clone().add(a[8]).normalize();a[10]=a[8].clone().add(a[12]).normalize();a[14]=a[12].clone().add(a[0]).normalize();a[1]=a[0].clone().add(a[2]).normalize();a[3]=a[2].clone().add(a[4]).normalize();a[5]=a[4].clone().add(a[6]).normalize();a[7]=a[6].clone().add(a[8]).normalize();
a[9]=a[8].clone().add(a[10]).normalize();a[11]=a[10].clone().add(a[12]).normalize();a[13]=a[12].clone().add(a[14]).normalize();a[15]=a[14].clone().add(a[0]).normalize();return a}(),k:{},G:function(a){if(void 0!==this.k[a])return this.k[a];new WebMol.Vector3(0,1,0);for(var b=this.Q.length,c=[],e=[],f,d=0;d<b;d++)c.push(this.Q[d].clone().multiplyScalar(a)),c.push(this.Q[d].clone().multiplyScalar(a)),f=this.Q[d].clone().normalize(),e.push(f),e.push(f);var d=[],g=2*Math.PI,l=Math.PI,h,m,s=!1,n=!1;for(m=
0;10>=m;m++){var s=0===m||10===m?!0:!1,n=5===m?!0:!1,p=[],y=[];for(h=0;h<=b;h++)if(n){var r=h<b?2*h:0;y.push(r+1);p.push(r)}else{f=h/b;var x=m/10;s&&0!==h?s&&p.push(c.length-1):h<b?(r=new WebMol.Vector3,r.x=-a*Math.cos(0+f*g)*Math.sin(0+x*l),r.y=a*Math.cos(0+x*l),r.z=a*Math.sin(0+f*g)*Math.sin(0+x*l),1E-5>Math.abs(r.x)&&(r.x=0),1E-5>Math.abs(r.y)&&(r.y=0),1E-5>Math.abs(r.z)&&(r.z=0),f=new WebMol.Vector3(r.x,r.y,r.z),f.normalize(),c.push(r),e.push(f),p.push(c.length-1)):p.push(c.length-b)}n&&d.push(y);
d.push(p)}b={vertices:c,s:e,t:d,w:b,Wa:10};return this.k[a]=b}},n={k:{},G:function(a){if("undefined"!=typeof this.k[a])return this.k[a];var b={vertices:[],t:[],s:[]},c=12,e=10;1>a&&(c=8,e=6);var f=2*Math.PI,d=Math.PI,g,l;for(l=0;l<=e;l++){var h=[];for(g=0;g<=c;g++){var m=g/c,s=l/e,n={};n.x=-a*Math.cos(0+m*f)*Math.sin(0+s*d);n.y=a*Math.cos(0+s*d);n.z=a*Math.sin(0+m*f)*Math.sin(0+s*d);m=new WebMol.Vector3(n.x,n.y,n.z);m.normalize();b.vertices.push(n);b.s.push(m);h.push(b.vertices.length-1)}b.t.push(h)}return this.k[a]=
b}},B=function(){var a=new WebMol.Vector3;return function(b){a.copy(b);var c=a.x,e=a.y,f=a.z,d=Math.sqrt(c*c+e*e);1E-4>d?(b=0,d=1):(b=-c/d,d=e/d);e=-b*c+d*e;c=Math.sqrt(e*e+f*f);1E-4>c?(f=0,e=1):(f/=c,e/=c);rot=new Float32Array(9);rot[0]=d;rot[1]=b;rot[2]=0;rot[3]=-b*e;rot[4]=d*e;rot[5]=f;rot[6]=b*f;rot[7]=-d*f;rot[8]=e;return rot}}(),v=0;this.getID=function(){return d};this.addMolData=function(a,c){a||console.error("Erorr with addMolData: No input data specified");switch(c){case "xyz":var e=b,f=
a.split("\n");if(!(3>f.length)){var s=parseInt(f[0].substr(0,3));if(!(isNaN(s)||0>=s||f.length<s+2)){for(var n=2,y=e.length,s=y+s;y<s;y++){var l=f[n++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),h={};h.serial=y;h.atom=h.elem=l[0];h.x=parseFloat(l[1]);h.y=parseFloat(l[2]);h.z=parseFloat(l[3]);h.hetflag=!0;h.bonds=[];h.bondOrder=[];h.singleBonds=!0;h.properties={};e[y]=h}A(e)}}break;case "pdb":var e=b,f=e.length,r,n=[],s=[],l=[],h=a.split("\n"),t,w,p;for(t=0;t<h.length;t++){p=h[t].replace(/^\s*/,
"");r=p.substr(0,6);var u;if("ATOM  "==r||"HETATM"==r){var v,G,z,B,J,da,U,P,I;r=p.substr(16,1);if(" "==r||"A"==r)P=parseInt(p.substr(6,5)),r=p.substr(12,4).replace(/ /g,""),w=p.substr(17,3),u=p.substr(21,1),v=parseInt(p.substr(22,4)),G=p.substr(26,1),z=parseFloat(p.substr(30,8)),B=parseFloat(p.substr(38,8)),J=parseFloat(p.substr(46,8)),I=parseFloat(p.substr(60,8)),U=p.substr(76,2).replace(/ /g,""),""===U&&(U=p.substr(12,2).replace(/ /g,"")),"H"!=U&&"HH"!=U&&"HD"!=U&&(da="H"==p[0]?!0:!1,l[P]=e.length,
e.push({resn:w,x:z,y:B,z:J,elem:U,hetflag:da,chain:u,resi:v,icode:G,rescode:v+(" "!=G?"^"+G:""),serial:P,atom:r,bonds:[],ss:"c",singleBonds:!0,bondOrder:[],properties:{},b:I,pdbline:p}))}else if("SHEET "==r)r=p.substr(21,1),w=parseInt(p.substr(22,4)),u=p.substr(32,1),p=parseInt(p.substr(33,4)),n.push([r,w,u,p]);else if("CONECT"==r)for(r=e[l[parseInt(p.substr(6,5))]],w=0;4>w;w++)u=parseInt(p.substr([11,16,21,26][w],5)),v=e[l[u]],void 0!==r&&void 0!==v&&(r.bonds.push(l[u]),r.bondOrder.push(1));else"HELIX "==
r&&(r=p.substr(19,1),w=parseInt(p.substr(21,4)),u=p.substr(31,1),p=parseInt(p.substr(33,4)),s.push([r,w,u,p]))}l=(new Date).getTime();C(e);console.log("bond connecting "+((new Date).getTime()-l));l=(new Date).getTime();g(e);h={};p=0;for(r=e.length;p<r;p++)w=e[p],"undefined"===typeof h[w.chain]&&(h[w.chain]=[]),isFinite(w.J)&&(h[w.chain][w.resi]=4===Math.abs(w.fa.resi-w.resi)?"h":"s");for(y in h){for(p=1;p<h[y].length-1;p++)r=h[y][p-1],w=h[y][p+1],t=h[y][p],r==w&&t!=r&&(h[y][p]=r);for(p=0;p<h[y].length;p++)t=
h[y][p],"h"!=t&&"s"!=t||h[y][p-1]==t||h[y][p+1]==t||delete h[y][p]}p=0;for(r=e.length;p<r;p++)w=e[p],t=h[w.chain][w.resi],"undefined"!=typeof t&&(w.ss=t,h[w.chain][w.resi-1]!=t&&(w.wa=!0),h[w.chain][w.resi+1]!=t&&(w.xa=!0));console.log("secondary structure "+((new Date).getTime()-l));for(t=f;t<e.length;t++)if(r=e[t],void 0!==r){for(w=0;w<n.length;w++)r.chain!=n[w][0]||r.resi<n[w][1]||r.resi>n[w][3]||(r.ss="s",r.resi==n[w][1]&&(r.wa=!0),r.resi==n[w][3]&&(r.xa=!0));for(w=0;w<s.length;w++)r.chain!=s[w][0]||
r.resi<s[w][1]||r.resi>s[w][3]||(r.ss="h",r.resi==s[w][1]?r.wa=!0:r.resi==s[w][3]&&(r.xa=!0))}break;case "sdf":e=b;f=a.split("\n");if(!(4>f.length||(l=parseInt(f[3].substr(0,3)),isNaN(l)||0>=l||(n=parseInt(f[3].substr(3,3)),s=4,f.length<4+l+n)))){y=e.length;t=y+l;for(l=y;l<t;l++)h=f[s],s++,p={},p.serial=l,p.x=parseFloat(h.substr(0,10)),p.y=parseFloat(h.substr(10,10)),p.z=parseFloat(h.substr(20,10)),p.hetflag=!0,p.singleBonds=!0,p.atom=p.elem=h.substr(31,3).replace(/ /g,""),p.bonds=[],p.bondOrder=
[],p.properties={},e[l]=p;for(l=0;l<n;l++)h=f[s],s++,t=parseInt(h.substr(0,3))-1+y,p=parseInt(h.substr(3,3))-1+y,h=parseInt(h.substr(6,3)),1<h&&(e[t].singleBonds=!1,e[p].singleBonds=!1),e[t].bonds.push(p),e[t].bondOrder.push(h),e[p].bonds.push(t),e[p].bondOrder.push(h)}break;case "mol2":e=b;n=a.search(/@<TRIPOS>MOLECULE/);f=a.search(/@<TRIPOS>ATOM/);if(-1!=n&&-1!=f){f=[];n=a.substr(n,a.length).split("\n");h=n[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");t=parseInt(h[0]);s=0;1<h.length&&(s=
parseInt(h[1]));y=4;for(l=3;l<n.length;l++)if("@<TRIPOS>ATOM"==n[l]){y=l+1;break}l=e.length;for(t=l+t;l<t;l++)h=n[y++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p={},r=l,w=parseInt(h[0]),p.serial=w,p.x=parseFloat(h[2]),p.y=parseFloat(h[3]),p.z=parseFloat(h[4]),p.atom=p.elem=h[5].split(".")[0],p.singleBonds=!0,"H"!=p.elem&&(p.bonds=[],p.bondOrder=[],p.properties={},f[w]=r,e.push(p));for(l=!1;y<n.length;)if("@<TRIPOS>BOND"==n[y++]){l=!0;break}if(l&&s)for(l=0;l<s;l++)h=n[y++],h=h.replace(/^\s+/,
"").replace(/\s+/g," ").split(" "),t=parseInt(h[1]),fromAtom=e[f[t]],p=parseInt(h[2]),toAtom=e[f[p]],h=parseInt(h[3]),isNaN(h)&&(h=1),1<h&&(fromAtom.singleBonds=!1,toAtom.singleBonds=!1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(f[p]),fromAtom.bondOrder.push(h),toAtom.bonds.push(f[t]),toAtom.bondOrder.push(h))}break;case "cube":if(e=b,f=a.replace(/^\s+/,"").split(/[\n\r]+/),!(6>f.length)){n=f[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");s=Math.abs(parseFloat(n[0]));n=f[3].replace(/^\s+/,
"").replace(/\s+/g," ").split(" ");n=0<parseFloat(n[0])?.529177:1;f=f.splice(6,s);s=e.length;y=s+f.length;for(l=s;l<y;++l)h={},h.serial=l,t=f[l-s].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),6==t[0]?h.elem="C":1==t[0]?h.elem="H":8==t[0]?h.elem="O":17==t[0]&&(h.elem="CL"),h.x=parseFloat(t[2])*n,h.y=parseFloat(t[3])*n,h.z=parseFloat(t[4])*n,h.hetflag=!0,h.singleBonds=!0,h.bonds=[],h.bondOrder=[],h.properties={},e.push(h);A(e)}}e=b;for(f=0;f<e.length;f++)if(n=e[f])n.style=n.style||m,n.color=n.color||
ElementColors[n.elem]||x,n.qa=d,n.clickable&&(n.e={sphere:[],j:[],line:[],i:[]})};this.atomIsSelected=function(a,b){if("undefined"===typeof b)return!0;var c=!!b.kb,e=!0,f;for(f in b)if(b.hasOwnProperty(f)&&"props"!=f&&"invert"!=f&&"model"!=f){if("undefined"===typeof a[f]){e=!1;break}var d=!1;if($.isArray(b[f])){for(var n=b[f],l=0;l<n.length;l++)if(a[f]==n[l]){d=!0;break}if(!d){e=!1;break}}else if(a[f]!=b[f]){e=!1;break}}return c?!e:e};this.selectedAtoms=function(a){for(var c=[],e=0;e<b.length;e++){var f=
b[e];f&&this.atomIsSelected(f,a)&&c.push(f)}return c};this.addAtoms=function(a){y=null;var c=b.length,e=[],f;for(f=0;f<a.length;f++)e[a[f].index]=c+f;for(f=0;f<a.length;f++){var c=a[f],d=e[c.index],n=$.extend(!1,{},c);n.index=d;n.bonds=[];n.bondOrder=[];for(d=0;d<c.bonds.length;d++){var g=e[c.bonds[d]];"undefined"!=typeof g&&(n.bonds.push(g),n.bondOrder.push(c.bondOrder[d]))}b.push(n)}};this.removeAtoms=function(a){y=null;var c=[],e;for(e=0;e<a.length;e++)c[a[e].index]=!0;a=[];for(e=0;e<b.length;e++){var f=
b[e];c[f.index]||a.push(f)}b=[];this.addAtoms(a)};this.setStyle=function(a,b,c){if(c||null===y||!u(b,s)){s=c?null:b;a=this.selectedAtoms(a);0<a.length&&(y=null);b=$.extend(!0,{},b);for(var e=0;e<a.length;e++){a[e].clickable&&(a[e].e={sphere:[],j:[],line:[],i:[]});a[e].R=!1;c||(a[e].style={});for(var f in b)b.hasOwnProperty(f)&&(a[e].style[f]=b[f])}}};this.setColorByElement=function(a,b){if(null===y||!u(b,t)){t=b;var c=this.selectedAtoms(a);0<c.length&&(y=null);for(var e=0;e<c.length;e++){var f=c[e];
"undefined"!==typeof b[f.elem]&&(f.color=b[f.elem])}}};this.setColorByProperty=function(a,b,c){a=this.selectedAtoms(a);t=null;0<a.length&&(y=null);var e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,d,n;for(d=0;d<a.length;d++)n=a[d],n.properties&&void 0!==typeof n.properties[b]&&(n=parseFloat(n.properties[b]),n<e&&(e=n),n>f&&(f=n));for(d=0;d<a.length;d++)n=a[d],n.properties&&void 0!==typeof n.properties[b]&&(n.color=c.Z(parseFloat(n.properties[b]),[e,f]))};this.globj=function(c){var n=new Date;
if(null===y){var g=b;console.log("creating for "+d);var s=new WebMol.Object3D,r=[],m={},t={},l=new WebMol.Geometry(!0),h=new WebMol.Geometry(!0),x,u;x=0;for(u=g.length;x<u;x++){var v=g[x];if(v&&v.style){v.clickable&&void 0===v.e&&(v.e={sphere:[],j:[],line:[],i:[]});f(v,l);var p=v,G=t;if(p.style.cross){var D=p.style.cross;if(!D.hidden){var z=D.linewidth||1;G[z]||(G[z]=new WebMol.Geometry);G=G[z].updateGeoGroup(6);D=a(p,D);D=[[D,0,0],[-D,0,0],[0,D,0],[0,-D,0],[0,0,D],[0,0,-D]];(z=p.clickable)&&void 0===
p.e&&(p.e={sphere:[],j:[],line:[]});for(var C=WebMol.m.color(p.color),B=0;6>B;B++){var A=3*G.vertices;G.vertices++;G.__vertexArray[A]=p.x+D[B][0];G.__vertexArray[A+1]=p.y+D[B][1];G.__vertexArray[A+2]=p.z+D[B][2];G.__colorArray[A]=C.r;G.__colorArray[A+1]=C.g;G.__colorArray[A+2]=C.b;z&&(A=new WebMol.Vector3(D[B][0],D[B][1],D[B][2]),A.multiplyScalar(.1),A.set(A.x+p.x,A.y+p.y,A.z+p.z),p.e.line.push(A))}}}p=v;G=g;D=m;if(p.style.line&&(z=p.style.line,!z.hidden))for(z=z.linewidth||1,D[z]||(D[z]=new WebMol.Geometry),
D=D[z].updateGeoGroup(2*p.bonds.length),z=0;z<p.bonds.length;z++)if(B=G[p.bonds[z]],B.style.line){C=new WebMol.Vector3(p.x,p.y,p.z);B=new WebMol.Vector3(B.x,B.y,B.z);B=C.clone().add(B).multiplyScalar(.5);p.clickable&&(void 0===p.e&&(p.e={sphere:[],j:[],line:[],i:[]}),p.e.line.push(C),p.e.line.push(B));var A=WebMol.m.color(p.color),J=3*D.vertices;D.vertices+=2;D.__vertexArray[J]=C.x;D.__vertexArray[J+1]=C.y;D.__vertexArray[J+2]=C.z;D.__colorArray[J]=A.r;D.__colorArray[J+1]=A.g;D.__colorArray[J+2]=
A.b;D.__vertexArray[J+3]=B.x;D.__vertexArray[J+4]=B.y;D.__vertexArray[J+5]=B.z;D.__colorArray[J+3]=A.r;D.__colorArray[J+4]=A.g;D.__colorArray[J+5]=A.b}p=v;C=g;G=h;if(p.style.stick&&(B=p.style.stick,!B.hidden)){D=B.l||.25;J=A=!1;z=p.color;"undefined"!=typeof B.color&&(z=B.color);var U=WebMol.m.color(z),P=void 0,I=void 0;!p.R&&4>p.bonds.length&&(A=!0);for(var T=0;T<p.bonds.length;T++){var N=C[p.bonds[T]];if(p.serial<N.serial&&N.style.stick){var S=new WebMol.Vector3(p.x,p.y,p.z),Z=new WebMol.Vector3(N.x,
N.y,N.z),P=N.color;"undefined"!=typeof B.color&&(P=B.color);var ea=WebMol.m.color(P);if(1===p.bondOrder[T]){if(!N.R&&4>N.bonds.length&&(J=!0),z!=P?(P=(new WebMol.Vector3).addVectors(S,Z).multiplyScalar(.5),e(G,S,P,D,U,A,!1),e(G,P,Z,D,ea,!1,J)):e(G,S,Z,D,U,A,J),p.clickable||N.clickable)P=(new WebMol.Vector3).addVectors(S,Z).multiplyScalar(.5),p.clickable&&(ea=new WebMol.Cylinder(S.clone(),P.clone(),D),S=new WebMol.Sphere(S.clone(),D),p.e.j.push(ea),p.e.sphere.push(S)),N.clickable&&(S=new WebMol.Cylinder(Z.clone(),
P.clone(),D),Z=new WebMol.Sphere(Z.clone(),D),N.e.j.push(S),N.e.sphere.push(Z))}else if(1<p.bondOrder[T]){var J=A=!1,I=Z.clone(),O=null;I.sub(S);var K,Y,W,aa;1===p.bonds.length?1===N.bonds.length?(O=I.clone(),1E-4<Math.abs(O.x)?O.y+=1:O.x+=1):(K=(T+1)%N.bonds.length,K=N.bonds[K],K=C[K],K=new WebMol.Vector3(K.x,K.y,K.z),K=K.clone(),K.sub(S),O=K.clone(),O.cross(I)):(K=(T+1)%p.bonds.length,K=p.bonds[K],K=C[K],K=new WebMol.Vector3(K.x,K.y,K.z),K=K.clone(),K.sub(S),O=K.clone(),O.cross(I));if(2==p.bondOrder[T]){if(K=
D/2.5,O.cross(I),O.normalize(),O.multiplyScalar(1.5*K),Y=S.clone(),Y.add(O),W=S.clone(),W.sub(O),O=Y.clone(),O.add(I),aa=W.clone(),aa.add(I),z!=P?(P=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),e(G,Y,P,K,U,A,!1),e(G,P,O,K,ea,!1,J),e(G,W,I,K,U,A,!1),e(G,I,aa,K,ea,!1,J)):(e(G,Y,O,K,U,A,J),e(G,W,aa,K,U,A,J)),p.clickable||N.clickable)P=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),
p.clickable&&(ea=new WebMol.Cylinder(Y.clone(),P.clone(),K),W=new WebMol.Cylinder(W.clone(),I.clone(),K),p.e.j.push(ea),p.e.j.push(W)),N.clickable&&(cylinder2a=new WebMol.Cylinder(O.clone(),P.clone(),K),cylinder2b=new WebMol.Cylinder(aa.clone(),I.clone(),K),N.e.j.push(cylinder2a),N.e.j.push(cylinder2b))}else 3==p.bondOrder[T]&&(K=D/4,O.cross(I),O.normalize(),O.multiplyScalar(3*K),Y=S.clone(),Y.add(O),W=S.clone(),W.sub(O),O=Y.clone(),O.add(I),aa=W.clone(),aa.add(I),z!=P?(P=(new WebMol.Vector3).addVectors(Y,
O).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(S,Z).multiplyScalar(.5),e(G,Y,P,K,U,A,!1),e(G,P,O,K,ea,!1,J),e(G,S,mp3,K,U,A,!1),e(G,mp3,Z,K,ea,!1,J),e(G,W,I,K,U,A,!1),e(G,I,aa,K,ea,!1,J)):(e(G,Y,O,K,U,A,J),e(G,S,Z,K,U,A,J),e(G,W,aa,K,U,A,J)),p.clickable||N.clickable)&&(P=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(S,Z).multiplyScalar(.5),
p.clickable&&(ea=new WebMol.Cylinder(Y.clone(),P.clone(),K),W=new WebMol.Cylinder(W.clone(),I.clone(),K),S=new WebMol.Cylinder(S.clone(),mp3.clone(),K),p.e.j.push(ea),p.e.j.push(W),p.e.j.push(S)),N.clickable&&(cylinder2a=new WebMol.Cylinder(O.clone(),P.clone(),K),cylinder2b=new WebMol.Cylinder(aa.clone(),I.clone(),K),cylinder2c=new WebMol.Cylinder(Z.clone(),mp3.clone(),K),N.e.j.push(cylinder2a),N.e.j.push(cylinder2b),N.e.j.push(cylinder2c)))}if(J||3<N.bonds.length)N.R=!0;if(A||3<p.bonds.length)p.R=
!0}}if(!p.singleBonds&&1===p.bonds.length||!p.bonds.length)C=p.style,p.style={sphere:{l:D,color:z}},f(p,G),p.style=C}"undefined"===typeof v.style.cartoon||v.style.cartoon.hidden||r.push(v)}}if(0<r.length)for(WebMol.Ka(s,r,!1),x=0;x<s.children.length;x++);0<l.vertices&&(g=new WebMol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),l.initTypedArrays(),g=new WebMol.Mesh(l,g),console.log("sphere geometry "+l.vertices.length),s.add(g));0<h.vertices&&(l=new WebMol.MeshLambertMaterial({vertexColors:!0,
ambient:0,reflectivity:0}),h.initTypedArrays(),l.wireframe&&h.setUpWireframe(),h=new WebMol.Mesh(h,l),s.add(h));for(x in m)m.hasOwnProperty(x)&&(h=x,h=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),m[x].initTypedArrays(),h=new WebMol.Line(m[x],h,WebMol.LinePieces),s.add(h));for(x in t)t.hasOwnProperty(x)&&(h=x,m=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),t[x].initTypedArrays(),m=new WebMol.Line(t[x],m,WebMol.LinePieces),s.add(m));y=s;console.log("object creation time: "+
(new Date-n));w&&(c.remove(w),w=null);w=y.clone();c.add(w)}};this.removegl=function(a){w&&(void 0!==w.geometry&&w.geometry.dispose(),void 0!==w.material&&w.material.dispose(),a.remove(w),w=null);y=null}}}();
WebMol.A=function(){function g(g,m){m=m||{};WebMol.Fa++;this.id=g;this.p=new WebMol.Sphere;this.e={sphere:[],j:[],line:[],i:[]};z(this,m);var r=[],d=null,c=null,e=new WebMol.Geometry(!0);this.ab=function(c){for(var a in c)m[a]=c[a];z(this,m)};this.addCustom=function(c){c.ja=c.ja||[];c.ca=c.ca||[];c.ha=c.ha||[];c.ga=c.ga||[];var a=e.addGeoGroup();A(this,a,c);a.truncateArrayBuffers(!0);for(c=0;c<a.__colorArray.length/3;++c)a.__colorArray[3*c]=this.color.r,a.__colorArray[3*c+1]=this.color.g,a.__colorArray[3*
c+2]=this.color.b;r.push({id:a.id,ea:a,T:a.getCentroid()});C(this.p,r,a.__vertexArray)};this.addSphere=function(c){c.center=c.center||{x:0,y:0,z:0};c.l=c.l?WebMol.Math.clamp(c.l,0,Infinity):1.5;var a=e.addGeoGroup(),b=c.center,d=c.l,g=new WebMol.Vector3(b.x,b.y,b.z);this.e.sphere.push(new WebMol.Sphere(g,d));var s;s=B.G(d);for(var g=s.vertices,m=s.s,x=a.vertices,u=0,n=g.length;u<n;++u){var z=3*(x+u),v=g[u];a.__vertexArray[z]=v.x+b.x;a.__vertexArray[z+1]=v.y+b.y;a.__vertexArray[z+2]=v.z+b.z}a.vertices+=
g.length;u=s.t;n=u.length-1;for(s=0;s<n;s++)for(z=u[s].length-1,b=0;b<z;b++){var v=a.faceidx,q=a.lineidx,F=u[s][b+1]+x,A=3*F,M=u[s][b]+x,H=3*M,L=u[s+1][b]+x,R=3*L,l=u[s+1][b+1]+x,h=3*l,E=m[F-x],X=m[M-x],Q=m[L-x],p=m[l-x];Math.abs(g[F-x].y)===d?(a.__normalArray[A]=E.x,a.__normalArray[R]=Q.x,a.__normalArray[h]=p.x,a.__normalArray[A+1]=E.y,a.__normalArray[R+1]=Q.y,a.__normalArray[h+1]=p.y,a.__normalArray[A+2]=E.z,a.__normalArray[R+2]=Q.z,a.__normalArray[h+2]=p.z,a.__faceArray[v]=F,a.__faceArray[v+1]=
L,a.__faceArray[v+2]=l,a.__lineArray[q]=F,a.__lineArray[q+1]=L,a.__lineArray[q+2]=F,a.__lineArray[q+3]=l,a.__lineArray[q+4]=L,a.__lineArray[q+5]=l,a.faceidx+=3,a.lineidx+=6):Math.abs(g[L-x].y)===d?(a.__normalArray[A]=E.x,a.__normalArray[H]=X.x,a.__normalArray[R]=Q.x,a.__normalArray[A+1]=E.y,a.__normalArray[H+1]=X.y,a.__normalArray[R+1]=Q.y,a.__normalArray[A+2]=E.z,a.__normalArray[H+2]=X.z,a.__normalArray[R+2]=Q.z,a.__faceArray[v]=F,a.__faceArray[v+1]=M,a.__faceArray[v+2]=L,a.__lineArray[q]=F,a.__lineArray[q+
1]=M,a.__lineArray[q+2]=F,a.__lineArray[q+3]=L,a.__lineArray[q+4]=M,a.__lineArray[q+5]=L,a.faceidx+=3,a.lineidx+=6):(a.__normalArray[A]=E.x,a.__normalArray[H]=X.x,a.__normalArray[h]=p.x,a.__normalArray[A+1]=E.y,a.__normalArray[H+1]=X.y,a.__normalArray[h+1]=p.y,a.__normalArray[A+2]=E.z,a.__normalArray[H+2]=X.z,a.__normalArray[h+2]=p.z,a.__normalArray[H]=X.x,a.__normalArray[R]=Q.x,a.__normalArray[h]=p.x,a.__normalArray[H+1]=X.y,a.__normalArray[R+1]=Q.y,a.__normalArray[h+1]=p.y,a.__normalArray[H+2]=
X.z,a.__normalArray[R+2]=Q.z,a.__normalArray[h+2]=p.z,a.__faceArray[v]=F,a.__faceArray[v+1]=M,a.__faceArray[v+2]=l,a.__faceArray[v+3]=M,a.__faceArray[v+4]=L,a.__faceArray[v+5]=l,a.__lineArray[q]=F,a.__lineArray[q+1]=M,a.__lineArray[q+2]=F,a.__lineArray[q+3]=l,a.__lineArray[q+4]=M,a.__lineArray[q+5]=L,a.__lineArray[q+6]=L,a.__lineArray[q+7]=l,a.faceidx+=6,a.lineidx+=8)}a.truncateArrayBuffers(!0);r.push({id:a.id,ea:a,T:new WebMol.Vector3(c.center.x,c.center.y,c.center.z)});C(this.p,r,a.__vertexArray)};
this.addArrow=function(c){c.start=c.start||{};c.end=c.end||{};c.start=new WebMol.Vector3(c.start.x||0,c.start.y||0,c.start.z||0);c.end=new WebMol.Vector3(c.end.x||3,c.end.y||0,c.end.z||0);c.l=c.l||.25;c.ua=c.ua||1.618034;c.Y=0<c.Y&&1>c.Y?c.Y:.618034;var a=e.addGeoGroup(),b=c.start,d=c.end,g=c.l,m=c.ua,t=c.Y;if(b&&d){var x=d.clone();x.sub(b).multiplyScalar(t);var u=b.clone().add(x),t=x.clone().negate();this.e.j.push(new WebMol.Cylinder(b.clone(),u.clone(),g));this.e.sphere.push(new WebMol.Sphere(b.clone(),
g));var n=[];n[0]=x.clone();1E-4<Math.abs(n[0].x)?n[0].y+=1:n[0].x+=1;n[0].cross(x);n[0].normalize();n[0]=n[0];n[4]=n[0].clone();n[4].crossVectors(n[0],x);n[4].normalize();n[8]=n[0].clone().negate();n[12]=n[4].clone().negate();n[2]=n[0].clone().add(n[4]).normalize();n[6]=n[4].clone().add(n[8]).normalize();n[10]=n[8].clone().add(n[12]).normalize();n[14]=n[12].clone().add(n[0]).normalize();n[1]=n[0].clone().add(n[2]).normalize();n[3]=n[2].clone().add(n[4]).normalize();n[5]=n[4].clone().add(n[6]).normalize();
n[7]=n[6].clone().add(n[8]).normalize();n[9]=n[8].clone().add(n[10]).normalize();n[11]=n[10].clone().add(n[12]).normalize();n[13]=n[12].clone().add(n[14]).normalize();n[15]=n[14].clone().add(n[0]).normalize();var z=a.vertices,v,q,B;q=0;for(B=n.length;q<B;++q){v=3*(z+3*q);var A=n[q].clone().multiplyScalar(g).add(b),M=n[q].clone().multiplyScalar(g).add(u),H=n[q].clone().multiplyScalar(g*m).add(u);a.__vertexArray[v]=A.x;a.__vertexArray[v+1]=A.y;a.__vertexArray[v+2]=A.z;a.__vertexArray[v+3]=M.x;a.__vertexArray[v+
4]=M.y;a.__vertexArray[v+5]=M.z;a.__vertexArray[v+6]=H.x;a.__vertexArray[v+7]=H.y;a.__vertexArray[v+8]=H.z;0<q&&(v=new WebMol.Vector3(a.__vertexArray[v-3],a.__vertexArray[v-2],a.__vertexArray[v-1]),A=d.clone(),M=u.clone(),H=new WebMol.Vector3(H.x,H.y,H.z),this.e.i.push(new WebMol.Triangle(H,A,v)),this.e.i.push(new WebMol.Triangle(v.clone(),M,H.clone())))}a.vertices+=48;v=3*a.vertices;a.__vertexArray[v]=b.x;a.__vertexArray[v+1]=b.y;a.__vertexArray[v+2]=b.z;a.__vertexArray[v+3]=u.x;a.__vertexArray[v+
4]=u.y;a.__vertexArray[v+5]=u.z;a.__vertexArray[v+6]=d.x;a.__vertexArray[v+7]=d.y;a.__vertexArray[v+8]=d.z;a.vertices+=3;var L,R,l,h,E,X,Q,p,ba,D=a.vertices-3,ia=a.vertices-2,ga=a.vertices-1,ha=3*D,ja=3*ia,da=3*ga;q=0;for(B=n.length-1;q<B;++q)L=z+3*q,b=a.faceidx,d=a.lineidx,g=L,A=3*g,m=L+1,M=3*m,u=L+2,R=3*u,H=L+4,l=3*H,v=L+5,h=3*v,L+=3,E=3*L,X=Q=n[q],p=ba=n[q+1],a.__normalArray[A]=X.x,a.__normalArray[M]=Q.x,a.__normalArray[E]=ba.x,a.__normalArray[A+1]=X.y,a.__normalArray[M+1]=Q.y,a.__normalArray[E+
1]=ba.y,a.__normalArray[A+2]=X.z,a.__normalArray[M+2]=Q.z,a.__normalArray[E+2]=ba.z,a.__normalArray[M]=Q.x,a.__normalArray[l]=p.x,a.__normalArray[E]=ba.x,a.__normalArray[M+1]=Q.y,a.__normalArray[l+1]=p.y,a.__normalArray[E+1]=ba.y,a.__normalArray[M+2]=Q.z,a.__normalArray[l+2]=p.z,a.__normalArray[E+2]=ba.z,a.__normalArray[R]=Q.x,a.__normalArray[h]=p.x,a.__normalArray[R+1]=Q.y,a.__normalArray[h+1]=p.y,a.__normalArray[R+2]=Q.z,a.__normalArray[h+2]=p.z,a.__faceArray[b]=g,a.__faceArray[b+1]=m,a.__faceArray[b+
2]=L,a.__faceArray[b+3]=m,a.__faceArray[b+4]=H,a.__faceArray[b+5]=L,a.__faceArray[b+6]=g,a.__faceArray[b+7]=L,a.__faceArray[b+8]=D,a.__faceArray[b+9]=u,a.__faceArray[b+10]=ia,a.__faceArray[b+11]=v,a.__faceArray[b+12]=u,a.__faceArray[b+13]=ga,a.__faceArray[b+14]=v,a.__lineArray[d]=g,a.__lineArray[d+1]=m,a.__lineArray[d+2]=g,a.__lineArray[d+3]=L,a.__lineArray[d+4]=H,a.__lineArray[d+5]=L,a.__lineArray[d+6]=g,a.__lineArray[d+7]=L,a.__lineArray[d+8]=u,a.__lineArray[d+9]=m,a.__lineArray[d+10]=u,a.__lineArray[d+
11]=v,a.__lineArray[d+12]=H,a.__lineArray[d+13]=v,a.__lineArray[d+14]=u,a.__lineArray[d+15]=ga,a.__lineArray[d+16]=u,a.__lineArray[d+17]=v,a.__lineArray[d+18]=ga,a.__lineArray[d+19]=v,a.faceidx+=15,a.lineidx+=20;z=[z+45,z+46,z+1,z,z+47,z+2];b=a.faceidx;d=a.lineidx;g=z[0];A=3*g;m=z[1];M=3*m;u=z[4];R=3*u;H=z[2];l=3*H;v=z[5];h=3*v;L=z[3];E=3*L;X=Q=n[15];p=ba=n[0];a.__normalArray[A]=X.x;a.__normalArray[M]=Q.x;a.__normalArray[E]=ba.x;a.__normalArray[A+1]=X.y;a.__normalArray[M+1]=Q.y;a.__normalArray[E+
1]=ba.y;a.__normalArray[A+2]=X.z;a.__normalArray[M+2]=Q.z;a.__normalArray[E+2]=ba.z;a.__normalArray[M]=Q.x;a.__normalArray[l]=p.x;a.__normalArray[E]=ba.x;a.__normalArray[M+1]=Q.y;a.__normalArray[l+1]=p.y;a.__normalArray[E+1]=ba.y;a.__normalArray[M+2]=Q.z;a.__normalArray[l+2]=p.z;a.__normalArray[E+2]=ba.z;a.__normalArray[R]=Q.x;a.__normalArray[h]=p.x;a.__normalArray[R+1]=Q.y;a.__normalArray[h+1]=p.y;a.__normalArray[R+2]=Q.z;a.__normalArray[h+2]=p.z;x.normalize();t.normalize();a.__normalArray[ha]=t.x;
a.__normalArray[ja]=a.__normalArray[da]=x.x;a.__normalArray[ha+1]=t.y;a.__normalArray[ja+1]=a.__normalArray[da+1]=x.y;a.__normalArray[ha+2]=t.z;a.__normalArray[ja+2]=a.__normalArray[da+2]=x.z;a.__faceArray[b]=g;a.__faceArray[b+1]=m;a.__faceArray[b+2]=L;a.__faceArray[b+3]=m;a.__faceArray[b+4]=H;a.__faceArray[b+5]=L;a.__faceArray[b+6]=g;a.__faceArray[b+7]=L;a.__faceArray[b+8]=D;a.__faceArray[b+9]=u;a.__faceArray[b+10]=ia;a.__faceArray[b+11]=v;a.__faceArray[b+12]=u;a.__faceArray[b+13]=ga;a.__faceArray[b+
14]=v;a.__lineArray[d]=g;a.__lineArray[d+1]=m;a.__lineArray[d+2]=g;a.__lineArray[d+3]=L;a.__lineArray[d+4]=H;a.__lineArray[d+5]=L;a.__lineArray[d+6]=g;a.__lineArray[d+7]=L;a.__lineArray[d+8]=u;a.__lineArray[d+9]=m;a.__lineArray[d+10]=u;a.__lineArray[d+11]=v;a.__lineArray[d+12]=H;a.__lineArray[d+13]=v;a.__lineArray[d+14]=u;a.__lineArray[d+15]=ga;a.__lineArray[d+16]=u;a.__lineArray[d+17]=v;a.__lineArray[d+18]=ga;a.__lineArray[d+19]=v;a.faceidx+=15;a.lineidx+=20}a.truncateArrayBuffers(!0);x=new WebMol.Vector3;
r.push({id:a.id,ea:a,T:x.addVectors(c.start,c.end).multiplyScalar(.5)});C(this.p,r,a.__vertexArray)};this.addVolumetricData=function(c,a,b){var d=void 0!==b.ma&&"number"===typeof b.ma?b.ma:0,g=b.za?!0:!1,m=e.addGeoGroup();switch(a){case "cube":var t=c.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>t.length)){var u=t[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),z=Math.abs(parseFloat(u[0]));c=new WebMol.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]));var u=t[3].replace(/^\s+/,"").replace(/\s+/g,
" ").split(" "),n=0<parseFloat(u[0])?.529177:1;c.multiplyScalar(n);a=Math.abs(u[0]);var B=(new WebMol.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))).multiplyScalar(n),u=t[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),v=Math.abs(u[0]);(new WebMol.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))).multiplyScalar(n);var u=t[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),q=Math.abs(u[0]);(new WebMol.Vector3(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3]))).multiplyScalar(n);
t=new Float32Array(t.splice(z+7).join(" ").replace(/^\s+/,"").split(/[\s\r]+/));u=new Int16Array(a*v*q);z=0;for(n=u.length;z<n;++z)u[z]=-1;u=new Uint8Array(a*v*q);z=0;for(n=t.length;z<n;++z)0<(0<=d?t[z]-d:d-t[z])&&(u[z]|=2);d=[];t=[];WebMol.M.oa(u,d,t,{Ua:!0,za:g,scale:B.length(),origin:c,ra:a,sa:v,ta:q});g||WebMol.M.na(10,d,t);A(this,m,{ja:d,ca:t,ha:[],ga:[]})}}r.push({id:m.id,ea:m,T:m.getCentroid()});this.ab(b);C(this.p,r,m.__vertexArray)};this.globj=function(f){e.initTypedArrays();var a=this.color,
a=a||WebMol.m.color(a);e.colorsNeedUpdate=!0;for(var b in e.geometryGroups)for(var g=e.geometryGroups[b],m=g.__colorArray,r=0,g=g.vertices;r<g;++r)m[3*r]=a.r,m[3*r+1]=a.g,m[3*r+2]=a.b;d=new WebMol.Object3D;b=new WebMol.MeshLambertMaterial({wireframe:this.wireframe,vertexColors:!0,ambient:0,reflectivity:0,side:this.side,transparent:1>this.alpha?!0:!1,opacity:this.alpha});b=new WebMol.Mesh(e,b);d.add(b);c&&(f.remove(c),c=null);c=d.clone();f.add(c)}}function z(g,m){g.color=m.color||new WebMol.Color;
g.wireframe=m.wireframe?!0:!1;g.alpha=m.alpha?WebMol.Math.clamp(m.alpha,0,1):1;g.side=void 0!==m.side?m.side:WebMol.DoubleSide;g.clickable=m.clickable?!0:!1;g.callback="function"===typeof m.callback?m.callback:null}function C(g,m,r){g.center.set(0,0,0);var d,c;if(0<m.length){d=0;for(c=m.length;d<c;++d)g.center.add(m[d].T);g.center.divideScalar(m.length)}m=g.l*g.l;d=0;for(c=r.length/3;d<c;d++){var e=g.center.distanceToSquared({x:r[3*d],y:r[3*d+1],z:r[3*d+2]});m=Math.max(m,e)}g.l=Math.sqrt(m)}function A(g,
m,r){var d=r.ja,c=r.ha,e=r.ca;r=r.ga;0!==d.length&&0!==e.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");m.vertices=d.length;m.faceidx=e.length;var f,a,b,y,w;y=0;for(w=m.vertices;y<w;++y)f=3*y,a=d[y],m.__vertexArray[f]=a.x,m.__vertexArray[f+1]=a.y,m.__vertexArray[f+2]=a.z;y=0;for(w=m.faceidx/3;y<w;++y){f=3*y;a=e[f];b=e[f+1];f=e[f+2];var s=new WebMol.Vector3,t=new WebMol.Vector3,x=new WebMol.Vector3;g.e.i.push(new WebMol.Triangle(s.copy(d[a]),
t.copy(d[b]),x.copy(d[f])))}m.__faceArray=new Uint16Array(e);m.truncateArrayBuffers(!0);if(c.length<m.vertices)m.setNormals();else for(m.__normalArray=new Float32Array(3*m.vertices),y=0,w=m.vertices;y<w;++y)f=3*y,g=c[y],m.__normalArray[f]=g.x,m.__normalArray[f+1]=g.y,m.__normalArray[f+2]=g.z;r.length?m.__lineArray=new Uint16Array(r):m.setLineIndices();m.lineidx=m.__lineArray.length}var B={k:{},G:function(g){if("undefined"!==typeof this.k[g])return this.k[g];var m={vertices:[],t:[],s:[]},r=16,d=10;
1>g&&(r=8,d=6);var c=2*Math.PI,e=Math.PI,f,a;for(a=0;a<=d;a++){var b=[];for(f=0;f<=r;f++){var y=f/r,w=a/d,s={};s.x=-g*Math.cos(0+y*c)*Math.sin(0+w*e);s.y=g*Math.cos(0+w*e);s.z=g*Math.sin(0+y*c)*Math.sin(0+w*e);y=new WebMol.Vector3(s.x,s.y,s.z);y.normalize();m.vertices.push(s);m.s.push(y);b.push(m.vertices.length-1)}m.t.push(b)}return this.k[g]=m}};Object.defineProperty(g.prototype,"position",{get:function(){return this.p.center}});Object.defineProperty(g.prototype,"x",{get:function(){return this.p.center.x}});
Object.defineProperty(g.prototype,"y",{get:function(){return this.p.center.y}});Object.defineProperty(g.prototype,"z",{get:function(){return this.p.center.z}});return g}();WebMol.Fa=0;WebMol.Aa=0;function ma(g,z){this.id=WebMol.Aa++;this.h=z||{};this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.n=new WebMol.Sprite;this.text=g}ma.prototype={dispose:function(){void 0!==this.n.material.map&&this.n.material.map.dispose();void 0!==this.n.material&&this.n.material.dispose()}};
function na(g){g.font=g.h.font=g.h.font?g.h.font:"Arial";g.fontSize=g.h.fontSize=g.h.fontSize?g.h.fontSize:20;g.q=g.h.q=g.h.q?g.h.q:{r:255,g:255,b:255,u:1};g.o=g.h.o=g.h.o?g.h.o:4;g.borderColor=g.h.borderColor=g.h.borderColor?g.h.borderColor:{r:0,g:0,b:0,u:1};g.backgroundColor=g.h.backgroundColor=g.h.backgroundColor?g.h.backgroundColor:{r:0,g:0,b:0,u:1};g.position=g.h.position=g.h.position?g.h.position:{x:-10,y:1,z:1};g.V=g.h.V=void 0!==g.h.V?g.h.V:!0;g.context.clearRect(0,0,g.canvas.width,g.canvas.height);
var z=WebMol.SpriteAlignment.topLeft;g.context.font=g.fontSize+"pt "+g.font;var C=g.context.measureText(g.text).width;g.context.fillStyle="rgba("+g.backgroundColor.r+","+g.backgroundColor.g+","+g.backgroundColor.b+","+g.backgroundColor.u+")";g.context.strokeStyle="rgba("+g.borderColor.r+","+g.borderColor.g+","+g.borderColor.b+","+g.borderColor.u+")";g.context.lineWidth=g.o;roundRect(g.context,g.o/2,g.o/2,C+g.o,1.4*g.fontSize+g.o,6);g.context.fillStyle="rgba("+g.q.r+","+g.q.g+","+g.q.b+","+g.q.u+")";
g.context.fillText(g.text,g.o,g.fontSize+g.o,C);C=new WebMol.Texture(g.canvas);C.needsUpdate=!0;g.n.material=new WebMol.SpriteMaterial({map:C,useScreenCoordinates:!1,alignment:z,depthTest:!g.V});g.n.scale.set(2*g.fontSize,g.fontSize,1);g.n.position.set(g.position.x,g.position.y,g.position.z)}
WebMol.GLViewer=function(){function g(g){var C,A,B,u,m,r,d,c,e,f;C=A=B=9999;u=m=r=-9999;d=c=e=f=0;if(0===g.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var a=0;a<g.length;a++){var b=g[a];void 0!==b&&(f++,d+=b.x,c+=b.y,e+=b.z,C=C<b.x?C:b.x,A=A<b.y?A:b.y,B=B<b.z?B:b.z,u=u>b.x?u:b.x,m=m>b.y?m:b.y,r=r>b.z?r:b.z)}return[[C,A,B],[u,m,r],[d/f,c/f,e/f]]}return function(z,C,A){function B(a,c,b,e,d,g){var f=new Date,h=new WebMol.Da;h.Xa(c,1===a?!1:!0,g);g=new Date;console.log("initialize "+(g-f)+"ms");h.Sa(d,
b);c=new Date;console.log("fillvoxels "+(c-g)+"  "+(c-f)+"ms");h.Ia();a==WebMol.SurfaceType.SES&&(h.Oa(),h.ka(!1),h.Ta(d,b));b=new Date;console.log("buildboundaryetc "+(b-c)+"  "+(b-f)+"ms");h.Ya(a);a=new Date;console.log("marching cube "+(a-b)+"  "+(a-f)+"ms");return h.Va(e)}function u(a,c,b){var e=new WebMol.Geometry(!0),d=e.updateGeoGroup(0),g=c.vertices,f,h,n;h=0;for(n=g.length;h<n;h++)f=3*d.vertices,d.__vertexArray[f]=g[h].x,d.__vertexArray[f+1]=g[h].y,d.__vertexArray[f+2]=g[h].z,d.vertices++;
c=c.Ma;d.faceidx=c.length;e.initTypedArrays();f=[];h=0;for(n=a.length;h<n;h++){var m=a[h];m&&("undefined"!=typeof m.surfaceColor?f[h]=WebMol.m.color(m.surfaceColor):m.color&&(f[h]=WebMol.m.color(m.color)))}a=d.__vertexArray;var l,p,q;h=0;for(n=c.length;h<n;h+=3){l=h;var m=c[h],r=c[h+1],s=c[h+2];p=g[m].v;q=g[r].v;var t=g[s].v,m=3*m,r=3*r,s=3*s;d.__faceArray[l]=c[h].u;d.__faceArray[l+1]=c[h].b;d.__faceArray[l+2]=c[h].gb;d.__colorArray[m]=f[p].r;d.__colorArray[m+1]=f[p].g;d.__colorArray[m+2]=f[p].b;
d.__colorArray[r]=f[q].r;d.__colorArray[r+1]=f[q].g;d.__colorArray[r+2]=f[q].b;d.__colorArray[s]=f[t].r;d.__colorArray[s+1]=f[t].g;d.__colorArray[s+2]=f[t].b;l=new WebMol.Vector3(a[m],a[m+1],a[m+2]);p=new WebMol.Vector3(a[r],a[r+1],a[r+2]);q=new WebMol.Vector3(a[s],a[s+1],a[s+2]);q.subVectors(q,p);l.subVectors(l,p);q.cross(l);l=q;l.normalize();d.__normalArray[m]+=l.x;d.__normalArray[r]+=l.x;d.__normalArray[s]+=l.x;d.__normalArray[m+1]+=l.y;d.__normalArray[r+1]+=l.y;d.__normalArray[s+1]+=l.y;d.__normalArray[m+
2]+=l.z;d.__normalArray[r+2]+=l.z;d.__normalArray[s+2]+=l.z}d.__faceArray=new Uint16Array(c);b=new WebMol.Mesh(e,b);b.hb=!0;return b}function m(a,c,b){function e(a){if(64E3>r(a))return[a];var c=a[1][0]-a[0][0],b=a[1][1]-a[0][1],d=a[1][2]-a[0][2],b=c>b&&c>d?0:b>c&&b>d?1:2,d=g(a),c=g(a);a=(a[1][b]-a[0][b])/2+a[0][b];d[1][b]=a;c[0][b]=a;a=e(d);c=e(c);return a.concat(c)}function g(a){var c=[];c[0]=[a[0][0],a[0][1],a[0][2]];c[1]=[a[1][0],a[1][1],a[1][2]];return c}var f=[];a=e(a);for(var h=0,m=a.length;h<
m;h++){var l=g(a[h]);l[0][0]-=6;l[0][1]-=6;l[0][2]-=6;l[1][0]+=6;l[1][1]+=6;l[1][2]+=6;var l=d(c,l),n=d(b,a[h]);f.push({ba:a[h],aa:l,ya:n})}return f}function r(a){return(a[1][0]-a[0][0])*(a[1][1]-a[0][1])*(a[1][2]-a[0][2])}function d(a,c){for(var b=[],d=0;d<a.length;d++){var e=a[d];"undefined"!=typeof e&&(e.x<c[0][0]||e.x>c[1][0]||e.y<c[0][1]||e.y>c[1][1]||e.z<c[0][2]||e.z>c[1][2]||b.push(d))}return b}function c(){if(R){var a=F.position.z-l.position.z;1>a&&(a=1);F.near=a+X;1>F.near&&(F.near=1);F.far=
a+Q;F.near+1>F.far&&(F.far=F.near+1);F instanceof WebMol.Camera?F.fov=20:(F.right=a*Math.tan(Math.PI/180*20),F.left=-F.right,F.top=F.right/v,F.bottom=-F.top);F.updateProjectionMatrix();R.fog.near=F.near+.4*(F.far-F.near);R.fog.far=F.far;q.render(R,F)}}function e(a){var c=[];"undefined"===typeof a&&(a={});var b=[],d;if("undefined"===typeof a.qa)for(d=0;d<s.length;d++)s[d]&&b.push(s[d]);else b=a.qa,$.isArray(b)||(b=[b]);for(d=0;d<b.length;d++)c=c.concat(b[d].selectedAtoms(a));return c}function f(a,
c,b,d){for(var e=0;e<s.length;e++)if(s[e])s[e][a](c,b,d)}function a(a){var c=new WebMol.MeshLambertMaterial;c.vertexColors=WebMol.VertexColors;for(var b in a)"color"===b?(c[b]=WebMol.m.color(a.color),delete c.vertexColors):"map"!==b&&a.hasOwnProperty(b)&&(c[b]=a[b]);void 0!==a.opacity&&(c.transparent=1===a.opacity?!1:!0);return c}function b(a,c){for(var b=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=0,g=a.length;e<g;e++){var f=a[e];f.properties&&"undefined"!=typeof f.properties[c]&&(f=f.properties[c],
f<b&&(b=f),f>d&&(d=f))}isFinite(b)||isFinite(d)?isFinite(b)?isFinite(d)||(d=b):b=d:b=d=0;return[b,d]}var y=this,w=z.id,s=[],t=[],x=[],G=z.width(),n=z.height(),J=$('<div class="glviewerSpinnerWrap" style = "position: absolute; width: 100%; height: 100%; display: table; z-index: 1;"><div class="glviewerSpinner" style="display: table-cell; text-align: center; vertical-align: middle; z-index:1"><img src="webmol/spinner.gif"></div></div>');$(z).append(J);J.hide();var v=G/n,q=new WebMol.Renderer({antialias:!0});
q.domElement.style.width="100%";q.domElement.style.height="100%";q.domElement.style.position="absolute";q.domElement.style.top="0px";q.domElement.style.zIndex="0";z.append(q.domElement);q.setSize(G,n);var F=new WebMol.Camera(20,v,1,800);F.position=new WebMol.Vector3(0,0,150);var V=new WebMol.Vector3;F.lookAt(V);var M=new WebMol.Raycaster(new WebMol.Vector3(0,0,0),new WebMol.Vector3(0,0,0)),H=new WebMol.Projector,L=new WebMol.Vector3(0,0,0),R=null,l=null,h=null,E=0,X=-50,Q=50,p=new WebMol.Quaternion(0,
0,0,1),ba=new WebMol.Quaternion(0,0,0,1),D=!1,ia=0,ga=0,ha=0,ja=0,da=0,U=0;(function(){R=new WebMol.Scene;R.fog=new WebMol.Fog(E,100,200);h=new WebMol.Object3D;l=new WebMol.Object3D;l.useQuaternion=!0;l.quaternion=new WebMol.Quaternion(0,0,0,1);l.add(h);R.add(l);var a=new WebMol.Light(16777215);a.position=(new WebMol.Vector3(.2,.2,1)).normalize();a.intensity=1;R.add(a)})();q.setClearColorHex(E,1);R.fog.color=WebMol.m.color(E);V=$(q.domElement);V.bind("mousedown touchstart",function(a){a.preventDefault();
if(R){var b=a.pageX,d=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(b=a.originalEvent.targetTouches[0].pageX,d=a.originalEvent.targetTouches[0].pageY);if(void 0!==b){D=!0;mouseButton=a.which;ia=b;ga=d;p=l.quaternion;ja=l.position.z;ha=h.position.clone();da=X;U=Q;a=b/$(window).width()*2-1;L.set(a,2*-(d/n)+1,-1);H.unprojectVector(L,F);L.sub(F.position).normalize();M.set(F.position,L);d=[];a=[];a=0;for(b=s.length;a<b;a++)var e=s[a].selectedAtoms({clickable:!0}),d=d.concat(e);
a=0;for(b=x.length;a<b;a++)e=x[a],e.clickable&&d.push(e);a=M.intersectObjects(h,d);a.length&&(d=a[0].clickable,void 0!==d.callback&&"function"===typeof d.callback&&d.callback(d,y));c()}}});V.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(R){var b=.85*(150-l.position.z);a.originalEvent.detail?l.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(l.position.z-=b*a.originalEvent.wheelDelta/400);c()}});V.bind("contextmenu",function(a){a.preventDefault()});$("body").bind("mouseup touchend",
function(){D=!1});V.bind("mousemove touchmove",function(a){a.preventDefault();if(R&&D){var b=0,d=$("input[name="+w+"_mouseMode]:checked");0<d.length&&(b=parseInt(d.val()));var d=a.pageX,e=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(d=a.originalEvent.targetTouches[0].pageX,e=a.originalEvent.targetTouches[0].pageY);if(void 0!==d){var d=(d-ia)/G,e=(e-ga)/n,g=Math.sqrt(d*d+e*e);3==b||3==mouseButton&&a.ctrlKey?(X=da+100*d,Q=U+100*e):2==b||3==mouseButton||a.shiftKey?(a=.85*
(150-l.position.z),80>a&&(a=80),l.position.z=ja-e*a):1==b||2==mouseButton||a.ctrlKey?(a=.85*(150-l.position.z),20>a&&(a=20),a=new WebMol.Vector3(d*a,-e*a,0),b=l.quaternion,b=(new WebMol.Quaternion(b.x,b.y,b.z,b.w)).inverse().normalize(),a=a.applyQuaternion(b),h.position.x=ha.x+a.x,h.position.y=ha.y+a.y,h.position.z=ha.z+a.z):0!==b&&1!=mouseButton||0===g||(a=Math.sin(g*Math.PI)/g,ba.x=Math.cos(g*Math.PI),ba.y=0,ba.z=a*d,ba.w=-a*e,l.quaternion=new WebMol.Quaternion(1,0,0,0),l.quaternion.multiply(ba),
l.quaternion.multiply(p));c()}}});this.setBackgroundColor=function(a,b){E=a;q.setClearColorHex(a,b|1);R.fog.color=WebMol.m.color(a);c()};this.setWidth=function(a){G=a||G;q.setSize(G,n)};this.setHeight=function(a){n=a||n;q.setSize(G,n)};this.resize=function(){G=z.width();n=z.height();v=G/n;q.setSize(G,n);F.aspect=v;F.updateProjectionMatrix();c()};$(window).resize(this.resize);this.getModel=function(a){a=a||s.length-1;return s[a]};this.getView=function(){if(!h)return[0,0,0,0,0,0,0,1];var a=h.position,
c=l.quaternion;return[a.x,a.y,a.z,l.position.z,c.x,c.y,c.z,c.w]};this.setView=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&h&&l&&(h.position.x=a[0],h.position.y=a[1],h.position.z=a[2],l.position.z=a[3],l.quaternion.x=a[4],l.quaternion.y=a[5],l.quaternion.z=a[6],l.quaternion.w=a[7],c())};this.render=function(){var a=new Date,c=this.getView(),b;for(b=0;b<s.length;b++)s[b]&&s[b].globj(h);for(b=0;b<x.length;b++)x[b]&&x[b].globj(h);for(b in t)if(t.hasOwnProperty(b)){var d=t[b].D;t[b].da||
(d.verticesNeedUpdate=!0,d.elementsNeedUpdate=!0,d.normalsNeedUpdate=!0,d.colorsNeedUpdate=!0,d.buffersNeedUpdate=!0,d.p=null,t[b].done&&(t[b].da=!0),t[b].W&&h.remove(t[b].W),d=new WebMol.Mesh(d,t[b].L),t[b].W=d,h.add(d))}this.setView(c);c=new Date;J.hide();console.log("render time: "+(c-a))};this.pdbData=function(a){a=e(a);for(var c="",b=0,d=a.length;b<d;++b)c+=a[b].pdbline+"\n";return c};this.zoomTo=function(a){a=e(a).concat(x);var b=e({}).concat(x);a=g(a);var b=g(b),d=new WebMol.Vector3(a[2][0],
a[2][1],a[2][2]);h.position=d.multiplyScalar(-1);var d=b[1][0]-b[0][0],f=b[1][1]-b[0][1],b=b[1][2]-b[0][2],b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);X=-b/1.9;Q=b/3;d=a[1][0]-a[0][0];f=a[1][1]-a[0][1];b=a[1][2]-a[0][2];b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);l.position.z=-(.35*b/Math.tan(Math.PI/180*F.fov/2)-150);c()};this.addLabel=function(a,b){var c=new ma(a,b);na(c);h.add(c.n);return c};this.removeLabel=function(a){a.dispose();h.remove(a.n)};this.setLabelStyle=function(a,b){a.dispose();a.h=b;na(a);h.add(a.n);
return a};this.setLabelText=function(a,b){a.dispose();a.text=b;na(a);h.add(a.n);return a};this.addShape=function(a){a=a||{};a=new WebMol.A(x.length,a);x.push(a);return a};this.addSphere=function(a){var b=new WebMol.A(x.length);a=a||{};b.addSphere(a);x.push(b);return b};this.addArrow=function(a){var b=new WebMol.A(x.length);a=a||{};b.addArrow(a);x.push(b);return b};this.addCustom=function(a){var b=new WebMol.A(x.length);a=a||{};b.addCustom(a);x.push(b);return b};this.addVolumetricData=function(a,b,
c){var d=new WebMol.A(x.length);c=c||{};d.addVolumetricData(a,b,c);x.push(d);return d};this.addModel=function(a,b){var c=new WebMol.GLModel(s.length,A);c.addMolData(a,b);s.push(c);return c};this.removeModel=function(a){if(a)for(a.removegl(h),delete s[a.getID()];0<s.length&&"undefined"===typeof s[s.length-1];)s.pop()};this.removeAllModels=function(){for(var a=0;a<s.length;a++)s[a].removegl(h);s=[]};this.createModelFrom=function(a,b){for(var c=new WebMol.GLModel(s.length,A),d=0;d<s.length;d++)if(s[d]){var e=
s[d].selectedAtoms(a);c.addAtoms(e);b&&s[d].removeAtoms(e)}s.push(c);return c};this.setStyle=function(a,b){f("setStyle",a,b,!1)};this.addStyle=function(a,b){f("setStyle",a,b,!0)};this.setColorByProperty=function(a,b,c){f("setColorByProperty",a,b,c)};this.setColorByElement=function(a,b){f("setColorByElement",a,b)};this.addSurface=function(c,d,f,h,l){f=e(f);var n=e(h),p=e(l),q,s=new Date,w=a(d),v=g(f);if(d.map&&d.map.prop){l=d.map.prop;var x=d.map.scheme||new WebMol.Ea,z=x.ia();z||(z=b(f,l));d=0;for(h=
f.length;d<h;d++)q=f[d],q.surfaceColor=x.Z(q.properties[l],z)}l=r(v);var A=m(v,n,f);if(p&&p.length&&0<p.length){var D=g(p);A.sort(function(a,b){function c(a,b){var d=a.ba,e=d[1][1]-d[0][1],f=d[1][2]-d[0][2],d=d[1][0]-d[0][0]-b[2][0],e=e-b[2][1],f=f-b[2][2];return d*d+e*e+f*f}return c(a,D)-c(b,D)})}console.log("Extents "+A.length+"  "+(+new Date-s)+"ms");var C={D:new WebMol.Geometry(!0),L:w,done:!1,da:!1};f=t.length;t[f]=C;p=[];d=0;for(h=n.length;d<h;d++)q=n[d],p[d]={x:q.x,y:q.y,z:q.z,serial:d,elem:q.elem};
if(WebMol.syncSurface)for(d=0,h=A.length;d<h;d++)q=B(c,A[d].ba,A[d].aa,A[d].ya,p,l),q=u(n,q,w),WebMol.pa(C.D,q),y.render();else{q=[];0>c&&(c=0);d=0;for(h=4;d<h;d++)v=new Worker(WebMol.Ga),q.push(v),v.postMessage({type:-1,aa:p,volume:l});var E=0;h=function(a){a=u(n,a.data,w);WebMol.pa(C.D,a);y.render();console.log("async mesh generation "+(+new Date-s)+"ms");E++;E==A.length&&(C.done=!0)};l=function(a){console.log(a.message+" ("+a.filename+":"+a.lb+")")};for(d=0;d<A.length;d++)p=q[d%q.length],p.onmessage=
h,p.onerror=l,p.postMessage({type:c,ib:A[d].ba,jb:A[d].aa,fb:A[d].ya})}console.log("full mesh generation "+(+new Date-s)+"ms");return f};this.setSurfaceMaterialStyle=function(b,c){t[b]&&(t[b].L=a(c),t[b].L.side=WebMol.FrontSide,t[b].da=!1)};this.removeSurface=function(a){t[a]&&t[a].W&&(void 0!==t[a].D&&t[a].D.dispose(),void 0!==t[a].L&&t[a].L.dispose(),h.remove(t[a].W));delete t[a];c()};this.clear=function(){t=[];this.removeAllModels();c()};getModelGroup=function(){return h};try{"function"===typeof C&&
C(this)}catch(P){console.log("error with glviewer callback: "+P)}}}();WebMol.glmolViewer=WebMol.GLViewer;WebMol=WebMol||{};
WebMol.nb=[{resn:"ALA",atom:"N",props:{a:-.15}},{resn:"ALA",atom:"CA",props:{a:.1}},{resn:"ALA",atom:"CB",props:{a:0}},{resn:"ALA",atom:"C",props:{a:.6}},{resn:"ALA",atom:"O",props:{a:-.55}},{resn:"ARG",atom:"N",props:{a:-.15}},{resn:"ARG",atom:"CA",props:{a:.1}},{resn:"ARG",atom:"CB",props:{a:0}},{resn:"ARG",atom:"CG",props:{a:0}},{resn:"ARG",atom:"CD",props:{a:.1}},{resn:"ARG",atom:"NE",props:{a:-.1}},{resn:"ARG",atom:"CZ",props:{a:.5}},{resn:"ARG",atom:"NH1",props:{a:.25}},{resn:"ARG",atom:"NH2",
props:{a:.25}},{resn:"ARG",atom:"C",props:{a:.6}},{resn:"ARG",atom:"O",props:{a:-.55}},{resn:"ASN",atom:"N",props:{a:-.15}},{resn:"ASN",atom:"CA",props:{a:.1}},{resn:"ASN",atom:"CB",props:{a:0}},{resn:"ASN",atom:"CG",props:{a:.55}},{resn:"ASN",atom:"OD1",props:{a:-.55}},{resn:"ASN",atom:"ND2",props:{a:0}},{resn:"ASN",atom:"C",props:{a:.6}},{resn:"ASN",atom:"O",props:{a:-.55}},{resn:"ASP",atom:"N",props:{a:-.15}},{resn:"ASP",atom:"CA",props:{a:.1}},{resn:"ASP",atom:"CB",props:{a:0}},{resn:"ASP",atom:"CG",
props:{a:.14}},{resn:"ASP",atom:"OD1",props:{a:-.57}},{resn:"ASP",atom:"OD2",props:{a:-.57}},{resn:"ASP",atom:"C",props:{a:.6}},{resn:"ASP",atom:"O",props:{a:-.55}},{resn:"CYS",atom:"N",props:{a:-.15}},{resn:"CYS",atom:"CA",props:{a:.1}},{resn:"CYS",atom:"CB",props:{a:.19}},{resn:"CYS",atom:"SG",props:{a:-.19}},{resn:"CYS",atom:"C",props:{a:.6}},{resn:"CYS",atom:"O",props:{a:-.55}},{resn:"GLN",atom:"N",props:{a:-.15}},{resn:"GLN",atom:"CA",props:{a:.1}},{resn:"GLN",atom:"CB",props:{a:0}},{resn:"GLN",
atom:"CG",props:{a:0}},{resn:"GLN",atom:"CD",props:{a:.55}},{resn:"GLN",atom:"OE1",props:{a:-.55}},{resn:"GLN",atom:"NE2",props:{a:0}},{resn:"GLN",atom:"C",props:{a:.6}},{resn:"GLN",atom:"O",props:{a:-.55}},{resn:"GLU",atom:"N",props:{a:-.15}},{resn:"GLU",atom:"CA",props:{a:.1}},{resn:"GLU",atom:"CB",props:{a:0}},{resn:"GLU",atom:"CG",props:{a:0}},{resn:"GLU",atom:"CD",props:{a:.14}},{resn:"GLU",atom:"OE1",props:{a:-.57}},{resn:"GLU",atom:"OE2",props:{a:-.57}},{resn:"GLU",atom:"C",props:{a:.6}},{resn:"GLU",
atom:"O",props:{a:-.55}},{resn:"GLY",atom:"N",props:{a:-.15}},{resn:"GLY",atom:"CA",props:{a:.1}},{resn:"GLY",atom:"C",props:{a:.6}},{resn:"GLY",atom:"O",props:{a:-.55}},{resn:"HIS",atom:"N",props:{a:-.15}},{resn:"HIS",atom:"CA",props:{a:.1}},{resn:"HIS",atom:"CB",props:{a:0}},{resn:"HIS",atom:"CG",props:{a:.1}},{resn:"HIS",atom:"ND1",props:{a:-.1}},{resn:"HIS",atom:"CD2",props:{a:.1}},{resn:"HIS",atom:"NE2",props:{a:-.4}},{resn:"HIS",atom:"CE1",props:{a:.3}},{resn:"HIS",atom:"C",props:{a:.6}},{resn:"HIS",
atom:"O",props:{a:-.55}},{resn:"ILE",atom:"N",props:{a:-.15}},{resn:"ILE",atom:"CA",props:{a:.1}},{resn:"ILE",atom:"CB",props:{a:0}},{resn:"ILE",atom:"CG2",props:{a:0}},{resn:"ILE",atom:"CG1",props:{a:0}},{resn:"ILE",atom:"CD",props:{a:0}},{resn:"ILE",atom:"C",props:{a:.6}},{resn:"ILE",atom:"O",props:{a:-.55}},{resn:"LEU",atom:"N",props:{a:-.15}},{resn:"LEU",atom:"CA",props:{a:.1}},{resn:"LEU",atom:"CB",props:{a:0}},{resn:"LEU",atom:"CG",props:{a:0}},{resn:"LEU",atom:"CD1",props:{a:0}},{resn:"LEU",
atom:"CD2",props:{a:0}},{resn:"LEU",atom:"C",props:{a:.6}},{resn:"LEU",atom:"O",props:{a:-.55}},{resn:"LYS",atom:"N",props:{a:-.15}},{resn:"LYS",atom:"CA",props:{a:.1}},{resn:"LYS",atom:"CB",props:{a:0}},{resn:"LYS",atom:"CG",props:{a:0}},{resn:"LYS",atom:"CD",props:{a:0}},{resn:"LYS",atom:"CE",props:{a:.25}},{resn:"LYS",atom:"NZ",props:{a:.75}},{resn:"LYS",atom:"C",props:{a:.6}},{resn:"LYS",atom:"O",props:{a:-.55}},{resn:"MET",atom:"N",props:{a:-.15}},{resn:"MET",atom:"CA",props:{a:.1}},{resn:"MET",
atom:"CB",props:{a:0}},{resn:"MET",atom:"CG",props:{a:.06}},{resn:"MET",atom:"SD",props:{a:-.12}},{resn:"MET",atom:"CE",props:{a:.06}},{resn:"MET",atom:"C",props:{a:.6}},{resn:"MET",atom:"O",props:{a:-.55}},{resn:"PHE",atom:"N",props:{a:-.15}},{resn:"PHE",atom:"CA",props:{a:.1}},{resn:"PHE",atom:"CB",props:{a:0}},{resn:"PHE",atom:"CG",props:{a:0}},{resn:"PHE",atom:"CD1",props:{a:0}},{resn:"PHE",atom:"CD2",props:{a:0}},{resn:"PHE",atom:"CE1",props:{a:0}},{resn:"PHE",atom:"CE2",props:{a:0}},{resn:"PHE",
atom:"CZ",props:{a:0}},{resn:"PHE",atom:"C",props:{a:.6}},{resn:"PHE",atom:"O",props:{a:-.55}},{resn:"PRO",atom:"N",props:{a:-.25}},{resn:"PRO",atom:"CD",props:{a:.1}},{resn:"PRO",atom:"CA",props:{a:.1}},{resn:"PRO",atom:"CB",props:{a:0}},{resn:"PRO",atom:"CG",props:{a:0}},{resn:"PRO",atom:"C",props:{a:.6}},{resn:"PRO",atom:"O",props:{a:-.55}},{resn:"SER",atom:"N",props:{a:-.15}},{resn:"SER",atom:"CA",props:{a:.1}},{resn:"SER",atom:"CB",props:{a:.25}},{resn:"SER",atom:"OG",props:{a:-.25}},{resn:"SER",
atom:"C",props:{a:.6}},{resn:"SER",atom:"O",props:{a:-.55}},{resn:"THR",atom:"N",props:{a:-.15}},{resn:"THR",atom:"CA",props:{a:.1}},{resn:"THR",atom:"CB",props:{a:.25}},{resn:"THR",atom:"OG1",props:{a:-.25}},{resn:"THR",atom:"CG2",props:{a:0}},{resn:"THR",atom:"C",props:{a:.6}},{resn:"THR",atom:"O",props:{a:-.55}},{resn:"TRP",atom:"N",props:{a:-.15}},{resn:"TRP",atom:"CA",props:{a:.1}},{resn:"TRP",atom:"CB",props:{a:0}},{resn:"TRP",atom:"CG",props:{a:-.03}},{resn:"TRP",atom:"CD2",props:{a:.1}},{resn:"TRP",
atom:"CE2",props:{a:-.04}},{resn:"TRP",atom:"CE3",props:{a:-.03}},{resn:"TRP",atom:"CD1",props:{a:.06}},{resn:"TRP",atom:"NE1",props:{a:-.06}},{resn:"TRP",atom:"CZ2",props:{a:0}},{resn:"TRP",atom:"CZ3",props:{a:0}},{resn:"TRP",atom:"CH2",props:{a:0}},{resn:"TRP",atom:"C",props:{a:.6}},{resn:"TRP",atom:"O",props:{a:-.55}},{resn:"TYR",atom:"N",props:{a:-.15}},{resn:"TYR",atom:"CA",props:{a:.1}},{resn:"TYR",atom:"CB",props:{a:0}},{resn:"TYR",atom:"CG",props:{a:0}},{resn:"TYR",atom:"CD1",props:{a:0}},
{resn:"TYR",atom:"CE1",props:{a:0}},{resn:"TYR",atom:"CD2",props:{a:0}},{resn:"TYR",atom:"CE2",props:{a:0}},{resn:"TYR",atom:"CZ",props:{a:.25}},{resn:"TYR",atom:"OH",props:{a:-.25}},{resn:"TYR",atom:"C",props:{a:.6}},{resn:"TYR",atom:"O",props:{a:-.55}},{resn:"VAL",atom:"N",props:{a:-.15}},{resn:"VAL",atom:"CA",props:{a:.1}},{resn:"VAL",atom:"CB",props:{a:0}},{resn:"VAL",atom:"CG1",props:{a:0}},{resn:"VAL",atom:"CG2",props:{a:0}},{resn:"VAL",atom:"C",props:{a:.6}},{resn:"VAL",atom:"O",props:{a:-.55}}];
