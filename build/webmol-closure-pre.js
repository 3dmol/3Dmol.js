WebMol=window.WebMol||{};WebMol.createViewer=function(d,C){"string"===$.type(d)&&(d=$("#"+d));if(d){C=C||{};C.order||(C.order=["glmol","jmol"]);C.defaultcolors||(C.defaultcolors=WebMol.ia);for(var z=0;z<C.order.length;z++){var x=C.order[z],f=x+"Viewer";if("function"===typeof this[f])try{return new this[f](d,C.callback,C.defaultcolors)}catch(v){console.log("error with "+x+":"+v)}}alert("Unable to instantiate webmol viewer: "+C.order);return null}};
WebMol.download=function(d,C){var z="";if("pdb:"===d.substr(0,4)){z="pdb";d=d.substr(4).toUpperCase();if(!d.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri="http://www.pdb.org/pdb/files/"+d+".pdb"}else if("cid:"==d.substr(0,4)){z="sdf";d=d.substr(4);if(!d.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+d+"/SDF?record_type=3d"}$.get(uri,function(d){C.addModel(d,z);C.zoomTo();C.render()});return null};
WebMol.qb={ub:1,Za:2,lb:3,mb:4};WebMol.p={i:{},color:function(d){if("undefined"!==typeof this.i[d])return this.i[d];var C=new WebMol.Color(d);return this.i[d]=C}};WebMol.Cb=function(d,C){var z=C.ja;void 0!==z&&d.aa.push(z.aa[0])};WebMol.Db=function(d){return d.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};WebMol.Gb=!1;WebMol.Wa=0;WebMol.Sa=1;WebMol.ga=2;WebMol.cb=0;WebMol.gb=1;WebMol.Ra=2;WebMol.pb=3;WebMol.ab=4;WebMol.Ua=5;WebMol.fb=0;WebMol.Va=1;WebMol.ob=2;WebMol.eb=0;
WebMol.ta=1;WebMol.vb=2;WebMol.bb=0;WebMol.$a=1;WebMol.Qa=2;WebMol.sb=function(){};WebMol.Ta=1001;WebMol.Xa=1006;WebMol.Ya=1008;WebMol.tb=1009;WebMol.ib=1021;WebMol=WebMol||{};
WebMol.ha=function(){var d={Ia:function(d,s,m,c){function b(t,b,e,c,n,h){var J=new WebMol.Vector3;J.copy(g);var N=n;c&1<<n||!(c&1<<h)||(N=h);N&1&&e++;N&2&&b++;N&4&&t++;J.x+=r.x*t;J.y+=r.y*b;J.z+=r.z*e;t=(w*t+b)*D+e;if(a)return s.push(J),s.length-1;0>B[t]&&(B[t]=s.length,s.push(J));return B[t]}var h=!!c.Fa,g=c.hasOwnProperty("origin")&&c.origin.hasOwnProperty("x")?c.origin:{x:0,y:0,z:0},a=!!c.sa,e=c.Ja||0,w=c.Ka||0,D=c.La||0;c=c.scale||1;var r=(new WebMol.Vector3(1,1,1)).multiplyScalar(c),B=new Int32Array(e*
w*D),A;c=0;for(A=B.length;c<A;++c)B[c]=-1;A=new Int32Array(12);var y=h?x:C,h=h?f:z;for(c=0;c<e-1;++c)for(var p=0;p<w-1;++p)for(var L=0;L<D-1;++L){for(var q=0,t=0;8>t;++t)q|=!!(d[(w*(c+((t&4)>>2))+p+((t&2)>>1))*D+L+(t&1)]&2)<<t;if(0!==q&&255!==q){var M=y[q];if(0!==M)for(t=h[q],M&1&&(A[0]=b(c,p,L,q,0,1)),M&2&&(A[1]=b(c,p,L,q,1,3)),M&4&&(A[2]=b(c,p,L,q,3,2)),M&8&&(A[3]=b(c,p,L,q,2,0)),M&16&&(A[4]=b(c,p,L,q,4,5)),M&32&&(A[5]=b(c,p,L,q,5,7)),M&64&&(A[6]=b(c,p,L,q,7,6)),M&128&&(A[7]=b(c,p,L,q,6,4)),M&256&&
(A[8]=b(c,p,L,q,0,4)),M&512&&(A[9]=b(c,p,L,q,1,5)),M&1024&&(A[10]=b(c,p,L,q,3,7)),M&2048&&(A[11]=b(c,p,L,q,2,6)),q=0;q<t.length;q+=3){var M=A[t[q]],N=A[t[q+1]],J=A[t[q+2]];a&&3<=q&&(s.push(s[M]),M=s.length-1,s.push(s[N]),N=s.length-1,s.push(s[J]),J=s.length-1);m.push(M);m.push(N);m.push(J)}}}},Ha:function(d,s,m){var c=Array(s.length),b,h,g,a;b=0;for(h=s.length;b<h;b++)c[b]={x:0,y:0,z:0};var e=Array(20),w;for(b=0;20>b;b++)e[b]=Array(s.length);b=0;for(h=s.length;b<h;b++)e[0][b]=0;b=0;for(h=m.length/
3;b<h;b++){var D=3*b,r=3*b+1,f=3*b+2;w=!0;g=0;for(a=e[0][m[D]];g<a;g++)if(m[r]==e[g+1][m[D]]){w=!1;break}w&&(e[0][m[D]]++,e[e[0][m[D]]][m[D]]=m[r]);w=!0;g=0;for(a=e[0][m[D]];g<a;g++)if(m[f]==e[g+1][m[D]]){w=!1;break}w&&(e[0][m[D]]++,e[e[0][m[D]]][m[D]]=m[f]);w=!0;g=0;for(a=e[0][m[r]];g<a;g++)if(m[D]==e[g+1][m[r]]){w=!1;break}w&&(e[0][m[r]]++,e[e[0][m[r]]][m[r]]=m[D]);w=!0;g=0;for(a=e[0][m[r]];g<a;g++)if(m[f]==e[g+1][m[r]]){w=!1;break}w&&(e[0][m[r]]++,e[e[0][m[r]]][m[r]]=m[f]);w=!0;for(g=0;g<e[0][m[f]];g++)if(m[D]==
e[g+1][m[f]]){w=!1;break}w&&(e[0][m[f]]++,e[e[0][m[f]]][m[f]]=m[D]);w=!0;g=0;for(a=e[0][m[f]];g<a;g++)if(m[r]==e[g+1][m[f]]){w=!1;break}w&&(e[0][m[f]]++,e[e[0][m[f]]][m[f]]=m[r])}for(m=0;m<d;m++){b=0;for(h=s.length;b<h;b++)if(3>e[0][b])c[b].x=s[b].x,c[b].y=s[b].y,c[b].z=s[b].z;else if(3==e[0][b]||4==e[0][b]){c[b].x=0;c[b].y=0;g=c[b].z=0;for(a=e[0][b];g<a;g++)c[b].x+=s[e[g+1][b]].x,c[b].y+=s[e[g+1][b]].y,c[b].z+=s[e[g+1][b]].z;c[b].x+=.5*s[b].x;c[b].y+=.5*s[b].y;c[b].z+=.5*s[b].z;c[b].x/=.5+e[0][b];
c[b].y/=.5+e[0][b];c[b].z/=.5+e[0][b]}else{c[b].x=0;c[b].y=0;g=c[b].z=0;for(a=e[0][b];g<a;g++)c[b].x+=s[e[g+1][b]].x,c[b].y+=s[e[g+1][b]].y,c[b].z+=s[e[g+1][b]].z;c[b].x+=1*s[b].x;c[b].y+=1*s[b].y;c[b].z+=1*s[b].z;c[b].x/=1+e[0][b];c[b].y/=1+e[0][b];c[b].z/=1+e[0][b]}b=0;for(h=s.length;b<h;b++)s[b].x=c[b].x,s[b].y=c[b].y,s[b].z=c[b].z}},Aa:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,
2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,
2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},C=new Uint32Array(d.Aa),z=d.Hb=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,
4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,
4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,
1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,
1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,
7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,
3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],x=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,
2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,
3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],f=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,
2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,
11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,
5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,
6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],
[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,
2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,
4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,
6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,
10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,
5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,
10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return d}();"undefined"===typeof console&&(console={log:function(){}});
WebMol.hb=function(){new Int32Array([1,0,0]);new Int32Array([-1,0,0]);new Int32Array([0,1,0]);new Int32Array([0,-1,0]);new Int32Array([0,0,1]);new Int32Array([0,0,-1]);new Int32Array([1,1,0]);new Int32Array([1,-1,0]);new Int32Array([-1,1,0]);new Int32Array([-1,-1,0]);new Int32Array([1,0,1]);new Int32Array([1,0,-1]);new Int32Array([-1,0,1]);new Int32Array([-1,0,-1]);new Int32Array([0,1,1]);new Int32Array([0,1,-1]);new Int32Array([0,-1,1]);new Int32Array([0,-1,-1]);new Int32Array([1,1,1]);new Int32Array([1,
1,-1]);new Int32Array([1,-1,1]);new Int32Array([-1,1,1]);new Int32Array([1,-1,-1]);new Int32Array([-1,-1,1]);new Int32Array([-1,1,-1]);new Int32Array([-1,-1,-1])};WebMol.Pa='self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(0>type)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1==type?!1:!0,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),(4===type||2===type)&&(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}};var Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0};Vector3.prototype={constructor:Vector3,copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this}};var ISDONE=2,ProteinSurface=function (){var faces,verts,origextent,INOUT=1,ISDONE=2,ISBOUND=4,ptranx=0,ptrany=0,ptranz=0,probeRadius=1.4,defaultScaleFactor=2,scaleFactor=defaultScaleFactor,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&"undefined"!=typeof vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;il>i;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;il>i;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;il>i;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(which>b&&(which=b),which>c&&(which=c),atomsToShow[which]){{vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]]}fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=defaultScaleFactor/2);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=probeRadius+margin,pminy-=probeRadius+margin,pminz-=probeRadius+margin,pmaxx+=probeRadius+margin,pmaxy+=probeRadius+margin,pmaxz+=probeRadius+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=probeRadius*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight),console.log("Box size: ",pLength,pWidth,pHeight,vpBits.length)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+probeRadius)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)txz=j*j+k*k,txz>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&INOUT&&(vpBits[i]|=ISDONE)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&INOUT){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=INOUT,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&=~ISDONE;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&ISDONE){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=ISDONE,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;pLength>i;i++)for(j=0;pHeight>j;j++)for(k=0;pWidth>k;k++){var index=i*pWH+k*pHeight+j;if(vpBits[index]&INOUT)for(var ii=0;26>ii;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&pLength>ti&&tk>-1&&pWidth>tk&&tj>-1&&pHeight>tj&&!(vpBits[ti*pWH+tk*pHeight+tj]&INOUT)){vpBits[index]|=ISBOUND;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=~ISDONE,vpBits[index]&INOUT&&vpBits[index]&ISBOUND){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=ISDONE,vpBits[index]&=~ISBOUND}do for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;n>i;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=~ISBOUND,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz});while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;0>cutsf&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)index=i*pWH+j*pHeight+k,vpBits[index]&=~ISBOUND,vpBits[index]&INOUT&&(!(vpBits[index]&ISDONE)||vpBits[index]&ISDONE&&vpDistance[index]>=cutoff)&&(vpBits[index]|=ISBOUND)},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;6>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;18>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;26>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;lim>i;i++)1==stype?vpBits[i]&=~ISBOUND:4==stype?(vpBits[i]&=~ISDONE,vpBits[i]&ISBOUND&&(vpBits[i]|=ISDONE),vpBits[i]&=~ISBOUND):2==stype?vpBits[i]&ISBOUND&&vpBits[i]&ISDONE?vpBits[i]&=~ISBOUND:vpBits[i]&ISBOUND&&!(vpBits[i]&ISDONE)&&(vpBits[i]|=ISDONE):3==stype&&(vpBits[i]&=~ISBOUND)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;vlen>i;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];laplacianSmooth(1,verts,faces)}},march=function (data,verts,faces,spec){var i,il,fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=new Vector3(1,1,1).multiplyScalar(scale),vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;il>i;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt=new Vector3;pt.copy(origin);var val1=!!(code&1<<p1),val2=!!(code&1<<p2),p=p1;!val1&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,pt.x+=unitCube.x*i,pt.y+=unitCube.y*j,pt.z+=unitCube.z*k;var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;nX-1>i;++i)for(var j=0;nY-1>j;++j)for(var k=0;nZ-1>k;++k){for(var code=0,p=0;8>p;++p){var index=(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p),val=!!(data[index]&ISDONE);code|=val<<p}if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},laplacianSmooth=function (numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;20>i;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;il>i;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}var wt=1,wt2=.5;for(k=0;numiter>k;k++){for(i=0,il=verts.length;il>i;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt2*verts[i].x,tps[i].y+=wt2*verts[i].y,tps[i].z+=wt2*verts[i].z,tps[i].x/=wt2+vertdeg[0][i],tps[i].y/=wt2+vertdeg[0][i],tps[i].z/=wt2+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt*verts[i].x,tps[i].y+=wt*verts[i].y,tps[i].z+=wt*verts[i].z,tps[i].x/=wt+vertdeg[0][i],tps[i].y/=wt+vertdeg[0][i],tps[i].z/=wt+vertdeg[0][i]}for(i=0,il=verts.length;il>i;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]';
WebMol.rb=window.URL.createObjectURL(new Blob([WebMol.Pa]));
$(document).ready(function(){void 0!==$("#webmoljs_viewer")[0]&&(WebMol.wa=!0);if(WebMol.wa){var d=WebMol.Jb=$("#webmoljs_viewer"),C=null;d.data("pdb")?C="http://www.pdb.org/pdb/files/"+d.data("pdb")+".pdb":d.data("href")&&(C=d.data("href"));var z=Number(d.data("backgroundcolor"))||0,x=d.data("style")||{j:{}};WebMol.U=WebMol.createViewer("webmoljs_viewer",{defaultcolors:WebMol.rasmolElementColors,callback:function(d){d.setBackgroundColor(z)}});if(C){var f=d.data("datatype")||"pdb";$.get(C,function(d){WebMol.U.addModel(d,
f);WebMol.U.setStyle({},x);WebMol.U.zoomTo();WebMol.U.render()},"text")}}});WebMol.ya=16716947;
WebMol.JmolElementColors={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,
I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219};
WebMol.rasmolElementColors={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,
Ba:16753920,BA:16753920,Au:14329120,AU:14329120};WebMol.ia=WebMol.JmolElementColors;var WebMol=WebMol||{};WebMol.kb=function(d,C){this.ea=function(z,x){var f,v;x?(f=x[0],v=x[1]):(f=d,v=C);if(void 0===z)return 16777215;z<f&&(z=f);z>v&&(z=v);var s=(v+f)/2;z<=s?(f=Math.floor(255*Math.sqrt((z-f)/(s-f))),f=16711680+256*f+f):(f=Math.floor(255*Math.sqrt(1-(z-s)/(v-s))),f=65536*f+256*f+255);return f}};
WebMol.jb=function(d,C){this.ea=function(z,x){var f,v;x?(f=x[0],v=x[1]):(f=d,v=C);if("undefined"==typeof z)return 16777215;z<f&&(z=f);z>v&&(z=v);var s=(f+v)/2,m=(f+s)/2,c=(s+v)/2;z<m?(f=Math.floor(255*Math.sqrt((z-f)/(m-f))),f=256*f+16711680):z<s?(f=Math.floor(255*Math.sqrt(1-(z-m)/(s-m))),f=65536*f+65280):z<c?(f=Math.floor(255*Math.sqrt((z-s)/(c-s))),f=65280+1*f):(f=Math.floor(255*Math.sqrt(1-(z-c)/(v-c))),f=256*f+255);return f}};
WebMol.nb=function(d,C){this.ea=function(z,x){var f,v;x?(f=x[0],v=x[1]):(f=d,v=C);if("undefined"==typeof z)return 16777215;z<f&&(z=f);z>v&&(z=v);var s=(z-f)/(v-f)*5/6+.5;f=Math.sin(Math.PI*s);v=Math.sin(Math.PI*(s+1/3));s=Math.sin(Math.PI*(s+2/3));return 65536*Math.floor(255*f*f)+256*Math.floor(255*s*s)+1*Math.floor(255*v*v)}};WebMol=WebMol||{};
WebMol.za=function(){function d(d,x,f,v,s){if(!(2>x.length)){s=s||5;x=C(x,s);f=C(f,s);var m=new WebMol.Geometry(!0),c=[],b,h,g,a,e,w=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],D,r,B,A,y,p,L,q,t;p=0;for(L=x.length;p<L;p++){B=WebMol.p.color(v[Math.round((p-1)/s)]);c.push(h=x[p]);c.push(h);c.push(g=f[p]);c.push(g);p<L-1&&(D=x[p+1].clone().sub(x[p]),b=f[p].clone().sub(x[p]).cross(D).normalize().multiplyScalar(.4));c.push(a=x[p].clone().add(b));c.push(a);c.push(e=f[p].clone().add(b));c.push(e);
void 0!==h.atom&&(A=h.atom);t=m.updateGeoGroup(8);D=t.vertices;r=3*D;t.__vertexArray[r]=h.x;t.__vertexArray[r+1]=h.y;t.__vertexArray[r+2]=h.z;t.__vertexArray[r+3]=h.x;t.__vertexArray[r+4]=h.y;t.__vertexArray[r+5]=h.z;t.__vertexArray[r+6]=g.x;t.__vertexArray[r+7]=g.y;t.__vertexArray[r+8]=g.z;t.__vertexArray[r+9]=g.x;t.__vertexArray[r+10]=g.y;t.__vertexArray[r+11]=g.z;t.__vertexArray[r+12]=a.x;t.__vertexArray[r+13]=a.y;t.__vertexArray[r+14]=a.z;t.__vertexArray[r+15]=a.x;t.__vertexArray[r+16]=a.y;t.__vertexArray[r+
17]=a.z;t.__vertexArray[r+18]=e.x;t.__vertexArray[r+19]=e.y;t.__vertexArray[r+20]=e.z;t.__vertexArray[r+21]=e.x;t.__vertexArray[r+22]=e.y;t.__vertexArray[r+23]=e.z;for(h=0;8>h;++h)t.__colorArray[r+3*h]=B.r,t.__colorArray[r+1+3*h]=B.g,t.__colorArray[r+2+3*h]=B.b;if(0<p)for(r=void 0!==y&&void 0!==A&&y.serial!==A.serial,h=0;4>h;h++)if(g=[D+w[h][0],D+w[h][1],D+w[h][2],D+w[h][3]],e=t.d,t.__faceArray[e]=g[0],t.__faceArray[e+1]=g[1],t.__faceArray[e+2]=g[3],t.__faceArray[e+3]=g[1],t.__faceArray[e+4]=g[2],
t.__faceArray[e+5]=g[3],t.d+=6,A.clickable||y.clickable){q=c[g[3]].clone();e=c[g[0]].clone();var M=c[g[2]].clone(),N=c[g[1]].clone();q.atom=c[g[3]].atom||null;M.atom=c[g[2]].atom||null;e.atom=c[g[0]].atom||null;N.atom=c[g[1]].atom||null;if(r){var J=q.clone().add(e).multiplyScalar(.5),P=M.clone().add(N).multiplyScalar(.5),K=q.clone().add(N).multiplyScalar(.5);0===h%2?(y.clickable&&(g=new WebMol.Triangle(J,K,q),a=new WebMol.Triangle(P,M,K),q=new WebMol.Triangle(K,M,q),y.c.f.push(g),y.c.f.push(a),y.c.f.push(q)),
A.clickable&&(g=new WebMol.Triangle(e,N,K),a=new WebMol.Triangle(N,P,K),q=new WebMol.Triangle(e,K,J),A.c.f.push(g),A.c.f.push(a),A.c.f.push(q))):(A.clickable&&(g=new WebMol.Triangle(J,K,q),a=new WebMol.Triangle(P,M,K),q=new WebMol.Triangle(K,M,q),A.c.f.push(g),A.c.f.push(a),A.c.f.push(q)),y.clickable&&(g=new WebMol.Triangle(e,N,K),a=new WebMol.Triangle(N,P,K),q=new WebMol.Triangle(e,K,J),y.c.f.push(g),y.c.f.push(a),y.c.f.push(q)))}else A.clickable&&(g=new WebMol.Triangle(e,N,q),a=new WebMol.Triangle(N,
M,q),A.c.f.push(g),A.c.f.push(a))}t.vertices+=8;y=A}x=c.length-8;t=m.updateGeoGroup(8);D=t.vertices;r=3*D;e=t.d;for(p=0;4>p;p++)c.push(c[2*p]),c.push(c[x+2*p]),f=c[2*p],v=c[x+2*p],t.__vertexArray[r+6*p]=f.x,t.__vertexArray[r+1+6*p]=f.y,t.__vertexArray[r+2+6*p]=f.z,t.__vertexArray[r+3+6*p]=v.x,t.__vertexArray[r+4+6*p]=v.y,t.__vertexArray[r+5+6*p]=v.z,t.__colorArray[r+6*p]=B.r,t.__colorArray[r+1+6*p]=B.g,t.__colorArray[r+2+6*p]=B.b,t.__colorArray[r+3+6*p]=B.r,t.__colorArray[r+4+6*p]=B.g,t.__colorArray[r+
5+6*p]=B.b;g=[D,D+2,D+6,D+4];a=[D+1,D+5,D+7,D+3];t.__faceArray[e]=g[0];t.__faceArray[e+1]=g[1];t.__faceArray[e+2]=g[3];t.__faceArray[e+3]=g[1];t.__faceArray[e+4]=g[2];t.__faceArray[e+5]=g[3];t.__faceArray[e+6]=a[0];t.__faceArray[e+7]=a[1];t.__faceArray[e+8]=a[3];t.__faceArray[e+9]=a[1];t.__faceArray[e+10]=a[2];t.__faceArray[e+11]=a[3];t.d+=12;t.vertices+=8;m.initTypedArrays();m.setUpNormals();c=new WebMol.MeshLambertMaterial;c.vertexColors=WebMol.ta;c.side=WebMol.ga;m=new WebMol.Mesh(m,c);d.add(m)}}
function C(d,x){var f=[],v=d,v=[];v.push(d[0]);var s,m,c,b,h,g;s=1;for(m=d.length-1;s<m;s++)b=d[s],h=d[s+1],b.Ma?v.push(new WebMol.Vector3((b.x+h.x)/2,(b.y+h.y)/2,(b.z+h.z)/2)):v.push(b);v.push(d[d.length-1]);s=-1;for(m=v.length;s<=m-3;s++){c=v[-1===s?0:s];b=v[s+1];h=v[s+2];g=v[s===m-3?m-1:s+3];c=(new WebMol.Vector3).subVectors(h,c).multiplyScalar(.5);g=(new WebMol.Vector3).subVectors(g,b).multiplyScalar(.5);for(var a=0;a<x;a++){var e=1/x*a,e=new WebMol.Vector3(b.x+e*c.x+e*e*(-3*b.x+3*h.x-2*c.x-g.x)+
e*e*e*(2*b.x-2*h.x+c.x+g.x),b.y+e*c.y+e*e*(-3*b.y+3*h.y-2*c.y-g.y)+e*e*e*(2*b.y-2*h.y+c.y+g.y),b.z+e*c.z+e*e*(-3*b.z+3*h.z-2*c.z-g.z)+e*e*e*(2*b.z-2*h.z+c.z+g.z)),w=Math.floor((f.length+2)/x);void 0!==d[w]&&void 0!==d[w].atom&&(e.atom=d[w].atom);f.push(e)}}f.push(v[v.length-1]);return f}return function(z,x){var f,v,s;f=2;v=5;s=!1;var m=[],c,b,h;for(h=0;h<f;h++)m[h]=[];h=[];var g,a,e,w,D=null,r=null;for(c in x)if(b=x[c],void 0!==b&&("O"==b.atom||"CA"==b.atom)&&!b.hetflag)if("CA"==b.atom){if(g!=b.chain||
e+1!=b.resi||a!=b.oa){d(z,m[0],m[f-1],h,v);m=[];for(h=0;h<f;h++)m[h]=[];h=[];D=null}w=new WebMol.Vector3(b.x,b.y,b.z);currentAtom=b;g=b.chain;a=b.oa;e=b.resi;var r=b.ss,B=b.color;"undefined"!=typeof b.style.X.color&&(B=b.style.X.color);h.push(B);!0!==b.clickable||void 0!==b.c&&void 0!==b.c.f||(b.c={k:null,h:[],j:[],f:[]})}else for(b=new WebMol.Vector3(b.x,b.y,b.z),b.sub(w),b.normalize(),b.multiplyScalar("c"==r?.3:1.3),null!==D&&0>b.dot(D)&&b.negate(),D=b,b=0;b<f;b++)B=-1+2/(f-1)*b,B=new WebMol.Vector3(w.x+
D.x*B,w.y+D.y*B,w.z+D.z*B),B.atom=currentAtom,s||"s"!=r||(B.Ma=!0),m[b].push(B);d(z,m[0],m[f-1],h,v)}}();WebMol=WebMol||{};
WebMol.GLModel=function(){function d(c){var b=[],h,g;h=0;for(g=c.length;h<g;h++){c[h].index=h;var a=c[h];a.hetflag||"N"!==a.atom&&"O"!==a.atom||(b.push(a),a.ba=null,a.M=Number.POSITIVE_INFINITY)}b.sort(function(a,b){return a.z-b.z});h=0;for(g=b.length;h<g;h++)for(a=b[h],c=h+1;c<g;c++){var e=b[c];if(3.5<e.z-a.z)break;var d=C(a,e);d<a.M&&(a.ba=e,a.M=d);d<e.M&&(e.ba=a,e.M=d)}}function C(c,b){if(c.chain==b.chain&&4>Math.abs(c.resi-b.resi))return Number.POSITIVE_INFINITY;if("O"===c.atom&&"N"===b.atom||
"N"===c.atom&&"O"===b.atom){var h=c.x-b.x;if(3.5<h)return Number.POSITIVE_INFINITY;var g=c.y-b.y;if(3.5<g)return Number.POSITIVE_INFINITY;var a=c.z-b.z;if(3.5<a)return Number.POSITIVE_INFINITY;h=Math.sqrt(h*h+g*g+a*a);if(3.5>h)return h}return Number.POSITIVE_INFINITY}function z(c){var b=[],h=[],g,a;g=0;for(a=c.length;g<a;g++){var e=c[g];e.index=g;e.hetflag?h.push(e):b.push(e)}x(h);b.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var h=c=-1,d;g=0;for(a=b.length;g<a;g++){e=
b[g];e.resi!==c&&(c=e.resi,d||h++,d=!1);e.oa=h;for(var s=g+1;s<b.length;s++){var r=b[s];if(r.chain!=e.chain)break;if(1<r.resi-e.resi)break;f(e,r)&&(-1===e.bonds.indexOf(r.index)&&(e.bonds.push(r.index),e.bondOrder.push(1),r.bonds.push(e.index),r.bondOrder.push(1)),e.resi!==r.resi&&(d=!0))}}}function x(c){var b=c.slice(0),h,g;h=0;for(g=c.length;h<g;h++)c[h].index||(c[h].index=h);b.sort(function(a,b){return a.z-b.z});h=0;for(g=b.length;h<g;h++){var a=b[h];for(c=h+1;c<g;c++){var e=b[c];if(1.9<e.z-a.z)break;
f(a,e)&&-1==a.bonds.indexOf(e.index)&&(a.bonds.push(e.index),a.bondOrder.push(1),e.bonds.push(a.index),e.bondOrder.push(1))}}}function f(c,b){var h=c.x-b.x,h=h*h;if(3.6<h)return!1;var g=c.y-b.y,g=g*g;if(3.6<g)return!1;var a=c.z-b.z,a=a*a;if(3.6<a)return!1;h=h+g+a;return isNaN(h)||.5>h||1.3<h&&("H"==c.elem||"H"==b.elem||"D"==c.elem||"D"==b.elem)?!1:3.6>h&&("S"==c.elem||"S"==b.elem)?!0:2.78<h?!1:!0}function v(c,b){return c&&b?JSON.stringify(c)==JSON.stringify(b):c==b}var s={j:{}},m={H:1.2,Li:1.82,Na:2.27,
K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63};return function(c,b){function h(a,b,e,g,c,h,d){if(b&&e){q++;var u=h||d,n=e.clone();n.sub(b);var n=C(n),s=y.L(g);g=s.w;var r=s.Ga,w=u?r*g+2:2*g;a=a.updateGeoGroup(w);var l=s.vertices,f=s.u,s=s.v,p=s[r/2],G=s[r/2+1],I=a.vertices,F,E,m,v,A,D;for(m=0;m<g;++m)E=2*m,v=n[0]*l[E].x+n[3]*l[E].y+n[6]*l[E].z,A=n[1]*l[E].x+n[4]*l[E].y+n[7]*l[E].z,D=n[5]*l[E].y+n[8]*l[E].z,F=3*(I+E),E=a.d,a.__vertexArray[F]=v+b.x,a.__vertexArray[F+
1]=A+b.y,a.__vertexArray[F+2]=D+b.z,a.__vertexArray[F+3]=v+e.x,a.__vertexArray[F+4]=A+e.y,a.__vertexArray[F+5]=D+e.z,a.__normalArray[F]=v,a.__normalArray[F+3]=v,a.__normalArray[F+1]=A,a.__normalArray[F+4]=A,a.__normalArray[F+2]=D,a.__normalArray[F+5]=D,a.__colorArray[F]=c.r,a.__colorArray[F+3]=c.r,a.__colorArray[F+1]=c.g,a.__colorArray[F+4]=c.g,a.__colorArray[F+2]=c.b,a.__colorArray[F+5]=c.b,a.__faceArray[E]=G[m]+I,a.__faceArray[E+1]=G[m+1]+I,a.__faceArray[E+2]=p[m]+I,a.__faceArray[E+3]=p[m]+I,a.__faceArray[E+
4]=G[m+1]+I,a.__faceArray[E+5]=p[m+1]+I,a.d+=6;if(u){h=h?r+1:r/2+1;var B,z,x,Z,ba,O,H,Y,S,aa,ga,ha,da;for(A=d?0:r/2;A<h;A++)if(A!==r/2){var ea=A<=r/2?e:b;for(v=0;v<g;v++)E=a.d,d=s[A][v+1],m=3*(d+I),u=s[A][v],D=3*(u+I),p=s[A+1][v],F=3*(p+I),G=s[A+1][v+1],da=3*(G+I),B=n[0]*l[d].x+n[3]*l[d].y+n[6]*l[d].z,z=n[0]*l[u].x+n[3]*l[u].y+n[6]*l[u].z,x=n[0]*l[p].x+n[3]*l[p].y+n[6]*l[p].z,Z=n[0]*l[G].x+n[3]*l[G].y+n[6]*l[G].z,ba=n[1]*l[d].x+n[4]*l[d].y+n[7]*l[d].z,O=n[1]*l[u].x+n[4]*l[u].y+n[7]*l[u].z,H=n[1]*
l[p].x+n[4]*l[p].y+n[7]*l[p].z,Y=n[1]*l[G].x+n[4]*l[G].y+n[7]*l[G].z,S=n[5]*l[d].y+n[8]*l[d].z,aa=n[5]*l[u].y+n[8]*l[u].z,ga=n[5]*l[p].y+n[8]*l[p].z,ha=n[5]*l[G].y+n[8]*l[G].z,a.__vertexArray[m]=B+ea.x,a.__vertexArray[D]=z+ea.x,a.__vertexArray[F]=x+ea.x,a.__vertexArray[da]=Z+ea.x,a.__vertexArray[m+1]=ba+ea.y,a.__vertexArray[D+1]=O+ea.y,a.__vertexArray[F+1]=H+ea.y,a.__vertexArray[da+1]=Y+ea.y,a.__vertexArray[m+2]=S+ea.z,a.__vertexArray[D+2]=aa+ea.z,a.__vertexArray[F+2]=ga+ea.z,a.__vertexArray[da+2]=
ha+ea.z,a.__colorArray[m]=c.r,a.__colorArray[D]=c.r,a.__colorArray[F]=c.r,a.__colorArray[da]=c.r,a.__colorArray[m+1]=c.g,a.__colorArray[D+1]=c.g,a.__colorArray[F+1]=c.g,a.__colorArray[da+1]=c.g,a.__colorArray[m+2]=c.b,a.__colorArray[D+2]=c.b,a.__colorArray[F+2]=c.b,a.__colorArray[da+2]=c.b,B=n[0]*f[d].x+n[3]*f[d].y+n[6]*f[d].z,z=n[0]*f[u].x+n[3]*f[u].y+n[6]*f[u].z,x=n[0]*f[p].x+n[3]*f[p].y+n[6]*f[p].z,Z=n[0]*f[G].x+n[3]*f[G].y+n[6]*f[G].z,ba=n[1]*f[d].x+n[4]*f[d].y+n[7]*f[d].z,O=n[1]*f[u].x+n[4]*
f[u].y+n[7]*f[u].z,H=n[1]*f[p].x+n[4]*f[p].y+n[7]*f[p].z,Y=n[1]*f[G].x+n[4]*f[G].y+n[7]*f[G].z,S=n[5]*f[d].y+n[8]*f[d].z,aa=n[5]*f[u].y+n[8]*f[u].z,ga=n[5]*f[p].y+n[8]*f[p].z,ha=n[5]*f[G].y+n[8]*f[G].z,0===A?(a.__normalArray[m]=B,a.__normalArray[F]=x,a.__normalArray[da]=Z,a.__normalArray[m+1]=ba,a.__normalArray[F+1]=H,a.__normalArray[da+1]=Y,a.__normalArray[m+2]=S,a.__normalArray[F+2]=ga,a.__normalArray[da+2]=ha,a.__faceArray[E]=d+I,a.__faceArray[E+1]=p+I,a.__faceArray[E+2]=G+I,a.d+=3):A===h-1?(a.__normalArray[m]=
B,a.__normalArray[D]=z,a.__normalArray[F]=x,a.__normalArray[m+1]=ba,a.__normalArray[D+1]=O,a.__normalArray[F+1]=H,a.__normalArray[m+2]=S,a.__normalArray[D+2]=aa,a.__normalArray[F+2]=ga,a.__faceArray[E]=d+I,a.__faceArray[E+1]=u+I,a.__faceArray[E+2]=p+I,a.d+=3):(a.__normalArray[m]=B,a.__normalArray[D]=z,a.__normalArray[da]=Z,a.__normalArray[m+1]=ba,a.__normalArray[D+1]=O,a.__normalArray[da+1]=Y,a.__normalArray[m+2]=S,a.__normalArray[D+2]=aa,a.__normalArray[da+2]=ha,a.__normalArray[D]=z,a.__normalArray[F]=
x,a.__normalArray[da]=Z,a.__normalArray[D+1]=O,a.__normalArray[F+1]=H,a.__normalArray[da+1]=Y,a.__normalArray[D+2]=aa,a.__normalArray[F+2]=ga,a.__normalArray[da+2]=ha,a.__faceArray[E]=d+I,a.__faceArray[E+1]=u+I,a.__faceArray[E+2]=G+I,a.__faceArray[E+3]=u+I,a.__faceArray[E+4]=p+I,a.__faceArray[E+5]=G+I,a.d+=6)}}a.vertices+=w}}function g(t,b){if(t.style.k){var e=t.style.k;if(!e.hidden){var g=t.color;"undefined"!=typeof e.color&&(g=e.color);var c=WebMol.p.color(g),d,e=a(t,e);!0===t.clickable&&void 0!==
t.c&&(g=new WebMol.Vector3(t.x,t.y,t.z),t.c.k.push(new WebMol.Sphere(g,e)));d=p.L(e);for(var g=d.vertices,h=d.u,u=b.updateGeoGroup(g.length),n=u.vertices,f=0,s=g.length;f<s;++f){var r=3*(n+f),l=g[f];u.__vertexArray[r]=l.x+t.x;u.__vertexArray[r+1]=l.y+t.y;u.__vertexArray[r+2]=l.z+t.z;u.__colorArray[r]=c.r;u.__colorArray[r+1]=c.g;u.__colorArray[r+2]=c.b}u.vertices+=g.length;f=d.v;s=f.length-1;for(d=0;d<s;d++)for(r=f[d].length-1,c=0;c<r;c++){var l=u.d,m=f[d][c+1]+n,w=3*m,G=f[d][c]+n,I=3*G,F=f[d+1][c]+
n,E=3*F,q=f[d+1][c+1]+n,v=3*q,D=h[m-n],A=h[G-n],B=h[F-n],z=h[q-n];Math.abs(g[m-n].y)===e?(u.__normalArray[w]=D.x,u.__normalArray[E]=B.x,u.__normalArray[v]=z.x,u.__normalArray[w+1]=D.y,u.__normalArray[E+1]=B.y,u.__normalArray[v+1]=z.y,u.__normalArray[w+2]=D.z,u.__normalArray[E+2]=B.z,u.__normalArray[v+2]=z.z,u.__faceArray[l]=m,u.__faceArray[l+1]=F,u.__faceArray[l+2]=q,u.d+=3):Math.abs(g[F-n].y)===e?(u.__normalArray[w]=D.x,u.__normalArray[I]=A.x,u.__normalArray[E]=B.x,u.__normalArray[w+1]=D.y,u.__normalArray[I+
1]=A.y,u.__normalArray[E+1]=B.y,u.__normalArray[w+2]=D.z,u.__normalArray[I+2]=A.z,u.__normalArray[E+2]=B.z,u.__faceArray[l]=m,u.__faceArray[l+1]=G,u.__faceArray[l+2]=F,u.d+=3):(u.__normalArray[w]=D.x,u.__normalArray[I]=A.x,u.__normalArray[v]=z.x,u.__normalArray[w+1]=D.y,u.__normalArray[I+1]=A.y,u.__normalArray[v+1]=z.y,u.__normalArray[w+2]=D.z,u.__normalArray[I+2]=A.z,u.__normalArray[v+2]=z.z,u.__normalArray[I]=A.x,u.__normalArray[E]=B.x,u.__normalArray[v]=z.x,u.__normalArray[I+1]=A.y,u.__normalArray[E+
1]=B.y,u.__normalArray[v+1]=z.y,u.__normalArray[I+2]=A.z,u.__normalArray[E+2]=B.z,u.__normalArray[v+2]=z.z,u.__faceArray[l]=m,u.__faceArray[l+1]=G,u.__faceArray[l+2]=q,u.__faceArray[l+3]=G,u.__faceArray[l+4]=F,u.__faceArray[l+5]=q,u.d+=6)}}}}function a(a,b){var e=1.5;"undefined"!=typeof b.m?e=b.m:m[a.elem]&&(e=m[a.elem]);"undefined"!=typeof b.scale&&(e*=b.scale);return e}var e=[],w=null,f=null,r=null,B=null,A=WebMol.ya;ElementColors=b?b:WebMol.ia;var y={Q:function(){var a=[];a[0]=new WebMol.Vector3(-1,
0,0);a[4]=new WebMol.Vector3(0,0,1);a[8]=new WebMol.Vector3(1,0,0);a[12]=new WebMol.Vector3(0,0,-1);a[2]=a[0].clone().add(a[4]).normalize();a[6]=a[4].clone().add(a[8]).normalize();a[10]=a[8].clone().add(a[12]).normalize();a[14]=a[12].clone().add(a[0]).normalize();a[1]=a[0].clone().add(a[2]).normalize();a[3]=a[2].clone().add(a[4]).normalize();a[5]=a[4].clone().add(a[6]).normalize();a[7]=a[6].clone().add(a[8]).normalize();a[9]=a[8].clone().add(a[10]).normalize();a[11]=a[10].clone().add(a[12]).normalize();
a[13]=a[12].clone().add(a[14]).normalize();a[15]=a[14].clone().add(a[0]).normalize();return a}(),i:{},L:function(a){if(void 0!==this.i[a])return this.i[a];new WebMol.Vector3(0,1,0);for(var b=this.Q.length,e=[],g=[],c,d=0;d<b;d++)e.push(this.Q[d].clone().multiplyScalar(a)),e.push(this.Q[d].clone().multiplyScalar(a)),c=this.Q[d].clone().normalize(),g.push(c),g.push(c);var d=[],h=2*Math.PI,f=Math.PI,n,s,r=!1,m=!1;for(s=0;10>=s;s++){var r=0===s||10===s?!0:!1,m=5===s?!0:!1,l=[],p=[];for(n=0;n<=b;n++)if(m){var w=
n<b?2*n:0;p.push(w+1);l.push(w)}else{c=n/b;var G=s/10;r&&0!==n?r&&l.push(e.length-1):n<b?(w=new WebMol.Vector3,w.x=-a*Math.cos(0+c*h)*Math.sin(0+G*f),w.y=a*Math.cos(0+G*f),w.z=a*Math.sin(0+c*h)*Math.sin(0+G*f),1E-5>Math.abs(w.x)&&(w.x=0),1E-5>Math.abs(w.y)&&(w.y=0),1E-5>Math.abs(w.z)&&(w.z=0),c=new WebMol.Vector3(w.x,w.y,w.z),c.normalize(),e.push(w),g.push(c),l.push(e.length-1)):l.push(e.length-b)}m&&d.push(p);d.push(l)}b={vertices:e,u:g,v:d,w:b,Ga:10};return this.i[a]=b}},p={i:{},L:function(a){if("undefined"!=
typeof this.i[a])return this.i[a];var b={vertices:[],v:[],u:[]},e=12,g=10;1>a&&(e=8,g=6);var c=2*Math.PI,d=Math.PI,h,f;for(f=0;f<=g;f++){var n=[];for(h=0;h<=e;h++){var s=h/e,w=f/g,r={};r.x=-a*Math.cos(0+s*c)*Math.sin(0+w*d);r.y=a*Math.cos(0+w*d);r.z=a*Math.sin(0+s*c)*Math.sin(0+w*d);s=new WebMol.Vector3(r.x,r.y,r.z);s.normalize();b.vertices.push(r);b.u.push(s);n.push(b.vertices.length-1)}b.v.push(n)}return this.i[a]=b}},C=function(){var a=new WebMol.Vector3;return function(b){a.copy(b);var e=a.x,
g=a.y,c=a.z,d=Math.sqrt(e*e+g*g);1E-4>d?(b=0,d=1):(b=-e/d,d=g/d);g=-b*e+d*g;e=Math.sqrt(g*g+c*c);1E-4>e?(c=0,g=1):(c/=e,g/=e);rot=new Float32Array(9);rot[0]=d;rot[1]=b;rot[2]=0;rot[3]=-b*g;rot[4]=d*g;rot[5]=c;rot[6]=b*c;rot[7]=-d*c;rot[8]=g;return rot}}(),q=0;this.getID=function(){return c};this.addMolData=function(a,b){a||console.error("Erorr with addMolData: No input data specified");switch(b){case "xyz":var g=e,h=a.split("\n");if(!(3>h.length)){var f=parseInt(h[0].substr(0,3));if(!(isNaN(f)||0>=
f||h.length<f+2)){for(var w=2,r=g.length,f=r+f;r<f;r++){var u=h[w++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),n={};n.serial=r;n.atom=n.elem=u[0];n.x=parseFloat(u[1]);n.y=parseFloat(u[2]);n.z=parseFloat(u[3]);n.hetflag=!0;n.bonds=[];n.bondOrder=[];n.singleBonds=!0;n.properties={};g[r]=n}x(g)}}break;case "pdb":var g=e,h=g.length,m,w=[],f=[],u=[],n=a.split("\n"),p,q,l;for(p=0;p<n.length;p++){l=n[p].replace(/^\s*/,"");m=l.substr(0,6);var v;if("ATOM  "==m||"HETATM"==m){var D,G,I,F,E,B,y,C,L;m=
l.substr(16,1);if(" "==m||"A"==m)C=parseInt(l.substr(6,5)),m=l.substr(12,4).replace(/ /g,""),q=l.substr(17,3),v=l.substr(21,1),D=parseInt(l.substr(22,4)),G=l.substr(26,1),I=parseFloat(l.substr(30,8)),F=parseFloat(l.substr(38,8)),E=parseFloat(l.substr(46,8)),L=parseFloat(l.substr(60,8)),y=l.substr(76,2).replace(/ /g,""),""===y&&(y=l.substr(12,2).replace(/ /g,"")),"H"!=y&&"HH"!=y&&"HD"!=y&&(B="H"==l[0]?!0:!1,u[C]=g.length,g.push({resn:q,x:I,y:F,z:E,elem:y,hetflag:B,chain:v,resi:D,icode:G,rescode:D+
(" "!=G?"^"+G:""),serial:C,atom:m,bonds:[],ss:"c",singleBonds:!0,bondOrder:[],properties:{},b:L,pdbline:l}))}else if("SHEET "==m)m=l.substr(21,1),q=parseInt(l.substr(22,4)),v=l.substr(32,1),l=parseInt(l.substr(33,4)),w.push([m,q,v,l]);else if("CONECT"==m)for(m=g[u[parseInt(l.substr(6,5))]],q=0;4>q;q++)v=parseInt(l.substr([11,16,21,26][q],5)),D=g[u[v]],void 0!==m&&void 0!==D&&(m.bonds.push(u[v]),m.bondOrder.push(1));else"HELIX "==m&&(m=l.substr(19,1),q=parseInt(l.substr(21,4)),v=l.substr(31,1),l=parseInt(l.substr(33,
4)),f.push([m,q,v,l]))}u=(new Date).getTime();z(g);console.log("bond connecting "+((new Date).getTime()-u));u=(new Date).getTime();d(g);n={};l=0;for(m=g.length;l<m;l++)q=g[l],"undefined"===typeof n[q.chain]&&(n[q.chain]=[]),isFinite(q.M)&&(n[q.chain][q.resi]=4===Math.abs(q.ba.resi-q.resi)?"h":"s");for(r in n){for(l=1;l<n[r].length-1;l++)m=n[r][l-1],q=n[r][l+1],p=n[r][l],m==q&&p!=m&&(n[r][l]=m);for(l=0;l<n[r].length;l++)p=n[r][l],"h"!=p&&"s"!=p||n[r][l-1]==p||n[r][l+1]==p||delete n[r][l]}l=0;for(m=
g.length;l<m;l++)q=g[l],p=n[q.chain][q.resi],"undefined"!=typeof p&&(q.ss=p,n[q.chain][q.resi-1]!=p&&(q.pa=!0),n[q.chain][q.resi+1]!=p&&(q.qa=!0));console.log("secondary structure "+((new Date).getTime()-u));for(p=h;p<g.length;p++)if(m=g[p],void 0!==m){for(q=0;q<w.length;q++)m.chain!=w[q][0]||m.resi<w[q][1]||m.resi>w[q][3]||(m.ss="s",m.resi==w[q][1]&&(m.pa=!0),m.resi==w[q][3]&&(m.qa=!0));for(q=0;q<f.length;q++)m.chain!=f[q][0]||m.resi<f[q][1]||m.resi>f[q][3]||(m.ss="h",m.resi==f[q][1]?m.pa=!0:m.resi==
f[q][3]&&(m.qa=!0))}break;case "sdf":g=e;h=a.split("\n");if(!(4>h.length||(u=parseInt(h[3].substr(0,3)),isNaN(u)||0>=u||(w=parseInt(h[3].substr(3,3)),f=4,h.length<4+u+w)))){r=g.length;p=r+u;for(u=r;u<p;u++)n=h[f],f++,l={},l.serial=u,l.x=parseFloat(n.substr(0,10)),l.y=parseFloat(n.substr(10,10)),l.z=parseFloat(n.substr(20,10)),l.hetflag=!0,l.singleBonds=!0,l.atom=l.elem=n.substr(31,3).replace(/ /g,""),l.bonds=[],l.bondOrder=[],l.properties={},g[u]=l;for(u=0;u<w;u++)n=h[f],f++,p=parseInt(n.substr(0,
3))-1+r,l=parseInt(n.substr(3,3))-1+r,n=parseInt(n.substr(6,3)),1<n&&(g[p].singleBonds=!1,g[l].singleBonds=!1),g[p].bonds.push(l),g[p].bondOrder.push(n),g[l].bonds.push(p),g[l].bondOrder.push(n)}break;case "mol2":g=e;w=a.search(/@<TRIPOS>MOLECULE/);h=a.search(/@<TRIPOS>ATOM/);if(-1!=w&&-1!=h){h=[];w=a.substr(w,a.length).split("\n");n=w[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");p=parseInt(n[0]);f=0;1<n.length&&(f=parseInt(n[1]));r=4;for(u=3;u<w.length;u++)if("@<TRIPOS>ATOM"==w[u]){r=u+1;
break}u=g.length;for(p=u+p;u<p;u++)n=w[r++],n=n.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l={},m=u,q=parseInt(n[0]),l.serial=q,l.x=parseFloat(n[2]),l.y=parseFloat(n[3]),l.z=parseFloat(n[4]),l.atom=l.elem=n[5].split(".")[0],l.singleBonds=!0,"H"!=l.elem&&(l.bonds=[],l.bondOrder=[],l.properties={},h[q]=m,g.push(l));for(u=!1;r<w.length;)if("@<TRIPOS>BOND"==w[r++]){u=!0;break}if(u&&f)for(u=0;u<f;u++)n=w[r++],n=n.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p=parseInt(n[1]),fromAtom=g[h[p]],
l=parseInt(n[2]),toAtom=g[h[l]],n=parseInt(n[3]),isNaN(n)&&(n=1),1<n&&(fromAtom.singleBonds=!1,toAtom.singleBonds=!1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(h[l]),fromAtom.bondOrder.push(n),toAtom.bonds.push(h[p]),toAtom.bondOrder.push(n))}break;case "cube":if(g=e,h=a.replace(/^\s+/,"").split(/[\n\r]+/),!(6>h.length)){w=h[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");f=Math.abs(parseFloat(w[0]));w=h[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");w=0<parseFloat(w[0])?
.529177:1;h=h.splice(6,f);f=g.length;r=f+h.length;for(u=f;u<r;++u)n={},n.serial=u,p=h[u-f].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),6==p[0]?n.elem="C":1==p[0]?n.elem="H":8==p[0]?n.elem="O":17==p[0]&&(n.elem="CL"),n.x=parseFloat(p[2])*w,n.y=parseFloat(p[3])*w,n.z=parseFloat(p[4])*w,n.hetflag=!0,n.singleBonds=!0,n.bonds=[],n.bondOrder=[],n.properties={},g.push(n);x(g)}}g=e;for(h=0;h<g.length;h++)if(w=g[h])w.style=w.style||s,w.color=w.color||ElementColors[w.elem]||A,w.ma=c,w.clickable&&(w.c=
{k:[],h:[],j:[],f:[]})};this.atomIsSelected=function(a,b){if("undefined"===typeof b)return!0;var g=!!b.Ab,e=!0,c;for(c in b)if(b.hasOwnProperty(c)&&"props"!=c&&"invert"!=c&&"model"!=c){if("undefined"===typeof a[c]){e=!1;break}var d=!1;if($.isArray(b[c])){for(var h=b[c],f=0;f<h.length;f++)if(a[c]==h[f]){d=!0;break}if(!d){e=!1;break}}else if(a[c]!=b[c]){e=!1;break}}return g?!e:e};this.selectedAtoms=function(a){for(var b=[],g=0;g<e.length;g++){var c=e[g];c&&this.atomIsSelected(c,a)&&b.push(c)}return b};
this.addAtoms=function(a){w=null;var b=e.length,g=[],c;for(c=0;c<a.length;c++)g[a[c].index]=b+c;for(c=0;c<a.length;c++){var b=a[c],d=g[b.index],h=$.extend(!1,{},b);h.index=d;h.bonds=[];h.bondOrder=[];for(d=0;d<b.bonds.length;d++){var f=g[b.bonds[d]];"undefined"!=typeof f&&(h.bonds.push(f),h.bondOrder.push(b.bondOrder[d]))}e.push(h)}};this.removeAtoms=function(a){w=null;var b=[],g;for(g=0;g<a.length;g++)b[a[g].index]=!0;a=[];for(g=0;g<e.length;g++){var c=e[g];b[c.index]||a.push(c)}e=[];this.addAtoms(a)};
this.setStyle=function(a,b,g){if(g||null===w||!v(b,r)){r=g?null:b;a=this.selectedAtoms(a);0<a.length&&(w=null);b=$.extend(!0,{},b);for(var e=0;e<a.length;e++){a[e].clickable&&(a[e].c={k:[],h:[],j:[],f:[]});a[e].R=!1;g||(a[e].style={});for(var c in b)b.hasOwnProperty(c)&&(a[e].style[c]=b[c])}}};this.setColorByElement=function(a,b){if(null===w||!v(b,B)){B=b;var g=this.selectedAtoms(a);0<g.length&&(w=null);for(var e=0;e<g.length;e++){var c=g[e];"undefined"!==typeof b[c.elem]&&(c.color=b[c.elem])}}};
this.setColorByProperty=function(a,b,g){a=this.selectedAtoms(a);B=null;0<a.length&&(w=null);var e=Number.POSITIVE_INFINITY,c=Number.NEGATIVE_INFINITY,d,h;for(d=0;d<a.length;d++)h=a[d],h.properties&&void 0!==typeof h.properties[b]&&(h=parseFloat(h.properties[b]),h<e&&(e=h),h>c&&(c=h));for(d=0;d<a.length;d++)h=a[d],h.properties&&void 0!==typeof h.properties[b]&&(h.color=g.ea(parseFloat(h.properties[b]),[e,c]))};this.globj=function(b){var d=new Date;if(null===w){var m=e;console.log("creating for "+c);
var r=new WebMol.Object3D,p=[],s={},q={},u=new WebMol.Geometry(!0),n=new WebMol.Geometry(!0),v,A;v=0;for(A=m.length;v<A;v++){var B=m[v];if(B&&B.style){B.clickable&&void 0===B.c&&(B.c={k:[],h:[],j:[],f:[]});g(B,u);var l=B,z=q;if(l.style.cross){var y=l.style.cross;if(!y.hidden){var G=y.linewidth||1;z[G]||(z[G]=new WebMol.Geometry);z=z[G].updateGeoGroup(6);y=a(l,y);y=[[y,0,0],[-y,0,0],[0,y,0],[0,-y,0],[0,0,y],[0,0,-y]];(G=l.clickable)&&void 0===l.c&&(l.c={k:[],h:[],j:[]});for(var I=WebMol.p.color(l.color),
F=0;6>F;F++){var E=3*z.vertices;z.vertices++;z.__vertexArray[E]=l.x+y[F][0];z.__vertexArray[E+1]=l.y+y[F][1];z.__vertexArray[E+2]=l.z+y[F][2];z.__colorArray[E]=I.r;z.__colorArray[E+1]=I.g;z.__colorArray[E+2]=I.b;G&&(E=new WebMol.Vector3(y[F][0],y[F][1],y[F][2]),E.multiplyScalar(.1),E.set(E.x+l.x,E.y+l.y,E.z+l.z),l.c.j.push(E))}}}l=B;z=m;y=s;if(l.style.j&&(G=l.style.j,!G.hidden))for(G=G.linewidth||1,y[G]||(y[G]=new WebMol.Geometry),y=y[G].updateGeoGroup(2*l.bonds.length),G=0;G<l.bonds.length;G++)if(F=
z[l.bonds[G]],F.style.j){I=new WebMol.Vector3(l.x,l.y,l.z);F=new WebMol.Vector3(F.x,F.y,F.z);F=I.clone().add(F).multiplyScalar(.5);l.clickable&&(void 0===l.c&&(l.c={k:[],h:[],j:[],f:[]}),l.c.j.push(I),l.c.j.push(F));var E=WebMol.p.color(l.color),x=3*y.vertices;y.vertices+=2;y.__vertexArray[x]=I.x;y.__vertexArray[x+1]=I.y;y.__vertexArray[x+2]=I.z;y.__colorArray[x]=E.r;y.__colorArray[x+1]=E.g;y.__colorArray[x+2]=E.b;y.__vertexArray[x+3]=F.x;y.__vertexArray[x+4]=F.y;y.__vertexArray[x+5]=F.z;y.__colorArray[x+
3]=E.r;y.__colorArray[x+4]=E.g;y.__colorArray[x+5]=E.b}l=B;I=m;z=n;if(l.style.ra&&(F=l.style.ra,!F.hidden)){y=F.m||.25;x=E=!1;G=l.color;"undefined"!=typeof F.color&&(G=F.color);var C=WebMol.p.color(G),L=void 0,X=void 0;!l.R&&4>l.bonds.length&&(E=!0);for(var fa=0;fa<l.bonds.length;fa++){var T=I[l.bonds[fa]];if(l.serial<T.serial&&T.style.ra){var V=new WebMol.Vector3(l.x,l.y,l.z),Z=new WebMol.Vector3(T.x,T.y,T.z),L=T.color;"undefined"!=typeof F.color&&(L=F.color);var ba=WebMol.p.color(L);if(1===l.bondOrder[fa]){if(!T.R&&
4>T.bonds.length&&(x=!0),G!=L?(L=(new WebMol.Vector3).addVectors(V,Z).multiplyScalar(.5),h(z,V,L,y,C,E,!1),h(z,L,Z,y,ba,!1,x)):h(z,V,Z,y,C,E,x),l.clickable||T.clickable)L=(new WebMol.Vector3).addVectors(V,Z).multiplyScalar(.5),l.clickable&&(ba=new WebMol.Cylinder(V.clone(),L.clone(),y),V=new WebMol.Sphere(V.clone(),y),l.c.h.push(ba),l.c.k.push(V)),T.clickable&&(V=new WebMol.Cylinder(Z.clone(),L.clone(),y),Z=new WebMol.Sphere(Z.clone(),y),T.c.h.push(V),T.c.k.push(Z))}else if(1<l.bondOrder[fa]){var x=
E=!1,X=Z.clone(),O=null;X.sub(V);var H,Y,S,aa;1===l.bonds.length?1===T.bonds.length?(O=X.clone(),1E-4<Math.abs(O.x)?O.y+=1:O.x+=1):(H=(fa+1)%T.bonds.length,H=T.bonds[H],H=I[H],H=new WebMol.Vector3(H.x,H.y,H.z),H=H.clone(),H.sub(V),O=H.clone(),O.cross(X)):(H=(fa+1)%l.bonds.length,H=l.bonds[H],H=I[H],H=new WebMol.Vector3(H.x,H.y,H.z),H=H.clone(),H.sub(V),O=H.clone(),O.cross(X));if(2==l.bondOrder[fa]){if(H=y/2.5,O.cross(X),O.normalize(),O.multiplyScalar(1.5*H),Y=V.clone(),Y.add(O),S=V.clone(),S.sub(O),
O=Y.clone(),O.add(X),aa=S.clone(),aa.add(X),G!=L?(L=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),X=(new WebMol.Vector3).addVectors(S,aa).multiplyScalar(.5),h(z,Y,L,H,C,E,!1),h(z,L,O,H,ba,!1,x),h(z,S,X,H,C,E,!1),h(z,X,aa,H,ba,!1,x)):(h(z,Y,O,H,C,E,x),h(z,S,aa,H,C,E,x)),l.clickable||T.clickable)L=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),X=(new WebMol.Vector3).addVectors(S,aa).multiplyScalar(.5),l.clickable&&(ba=new WebMol.Cylinder(Y.clone(),L.clone(),H),S=new WebMol.Cylinder(S.clone(),
X.clone(),H),l.c.h.push(ba),l.c.h.push(S)),T.clickable&&(cylinder2a=new WebMol.Cylinder(O.clone(),L.clone(),H),cylinder2b=new WebMol.Cylinder(aa.clone(),X.clone(),H),T.c.h.push(cylinder2a),T.c.h.push(cylinder2b))}else 3==l.bondOrder[fa]&&(H=y/4,O.cross(X),O.normalize(),O.multiplyScalar(3*H),Y=V.clone(),Y.add(O),S=V.clone(),S.sub(O),O=Y.clone(),O.add(X),aa=S.clone(),aa.add(X),G!=L?(L=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),X=(new WebMol.Vector3).addVectors(S,aa).multiplyScalar(.5),
mp3=(new WebMol.Vector3).addVectors(V,Z).multiplyScalar(.5),h(z,Y,L,H,C,E,!1),h(z,L,O,H,ba,!1,x),h(z,V,mp3,H,C,E,!1),h(z,mp3,Z,H,ba,!1,x),h(z,S,X,H,C,E,!1),h(z,X,aa,H,ba,!1,x)):(h(z,Y,O,H,C,E,x),h(z,V,Z,H,C,E,x),h(z,S,aa,H,C,E,x)),l.clickable||T.clickable)&&(L=(new WebMol.Vector3).addVectors(Y,O).multiplyScalar(.5),X=(new WebMol.Vector3).addVectors(S,aa).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(V,Z).multiplyScalar(.5),l.clickable&&(ba=new WebMol.Cylinder(Y.clone(),L.clone(),H),S=new WebMol.Cylinder(S.clone(),
X.clone(),H),V=new WebMol.Cylinder(V.clone(),mp3.clone(),H),l.c.h.push(ba),l.c.h.push(S),l.c.h.push(V)),T.clickable&&(cylinder2a=new WebMol.Cylinder(O.clone(),L.clone(),H),cylinder2b=new WebMol.Cylinder(aa.clone(),X.clone(),H),cylinder2c=new WebMol.Cylinder(Z.clone(),mp3.clone(),H),T.c.h.push(cylinder2a),T.c.h.push(cylinder2b),T.c.h.push(cylinder2c)))}if(x||3<T.bonds.length)T.R=!0;if(E||3<l.bonds.length)l.R=!0}}if(!l.singleBonds&&1===l.bonds.length||!l.bonds.length)I=l.style,l.style={k:{m:y,color:G}},
g(l,z),l.style=I}"undefined"===typeof B.style.X||B.style.X.hidden||p.push(B)}}if(0<p.length)for(WebMol.za(r,p,!1),v=0;v<r.children.length;v++);0<u.vertices&&(m=new WebMol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),u.initTypedArrays(),m=new WebMol.Mesh(u,m),console.log("sphere geometry "+u.vertices.length),r.add(m));0<n.vertices&&(u=new WebMol.MeshLambertMaterial({vertexColors:!0,ambient:0,reflectivity:0}),n.initTypedArrays(),u.wireframe&&n.setUpWireframe(),n=new WebMol.Mesh(n,
u),r.add(n));for(v in s)s.hasOwnProperty(v)&&(n=v,n=new WebMol.LineBasicMaterial({linewidth:n,vertexColors:!0}),s[v].initTypedArrays(),n=new WebMol.Line(s[v],n,WebMol.LinePieces),r.add(n));for(v in q)q.hasOwnProperty(v)&&(n=v,s=new WebMol.LineBasicMaterial({linewidth:n,vertexColors:!0}),q[v].initTypedArrays(),s=new WebMol.Line(q[v],s,WebMol.LinePieces),r.add(s));w=r;console.log("object creation time: "+(new Date-d));f&&(b.remove(f),f=null);f=w.clone();b.add(f)}};this.removegl=function(a){f&&(void 0!==
f.ja&&f.ja.dispose(),void 0!==f.A&&f.A.dispose(),a.remove(f),f=null);w=null}}}();
WebMol.D=function(){function d(d,s){s=s||{};WebMol.va++;this.id=d;this.q=new WebMol.Sphere;this.c={k:[],h:[],j:[],f:[]};C(this,s);var m=[],c=null,b=null,h=new WebMol.Geometry(!0);this.Oa=function(b){for(var a in b)s[a]=b[a];C(this,s)};this.addCustom=function(b){b.fa=b.fa||[];b.Y=b.Y||[];b.da=b.da||[];b.ca=b.ca||[];var a=h.addGeoGroup();x(this,a,b);a.truncateArrayBuffers(!0);for(b=0;b<a.__colorArray.length/3;++b)a.__colorArray[3*b]=this.color.r,a.__colorArray[3*b+1]=this.color.g,a.__colorArray[3*b+
2]=this.color.b;m.push({id:a.id,Z:a,T:a.getCentroid()});z(this.q,m,a.__vertexArray)};this.addSphere=function(b){b.center=b.center||{x:0,y:0,z:0};b.m=b.m?WebMol.Math.clamp(b.m,0,Infinity):1.5;var a=h.addGeoGroup(),e=b.center,c=b.m,d=new WebMol.Vector3(e.x,e.y,e.z);this.c.k.push(new WebMol.Sphere(d,c));var r;r=f.L(c);for(var d=r.vertices,s=r.u,v=a.vertices,y=0,p=d.length;y<p;++y){var x=3*(v+y),q=d[y];a.__vertexArray[x]=q.x+e.x;a.__vertexArray[x+1]=q.y+e.y;a.__vertexArray[x+2]=q.z+e.z}a.vertices+=d.length;
y=r.v;p=y.length-1;for(r=0;r<p;r++)for(x=y[r].length-1,e=0;e<x;e++){var q=a.d,t=a.l,C=y[r][e+1]+v,N=3*C,J=y[r][e]+v,P=3*J,K=y[r+1][e]+v,U=3*K,u=y[r+1][e+1]+v,n=3*u,R=s[C-v],W=s[J-v],Q=s[K-v],l=s[u-v];Math.abs(d[C-v].y)===c?(a.__normalArray[N]=R.x,a.__normalArray[U]=Q.x,a.__normalArray[n]=l.x,a.__normalArray[N+1]=R.y,a.__normalArray[U+1]=Q.y,a.__normalArray[n+1]=l.y,a.__normalArray[N+2]=R.z,a.__normalArray[U+2]=Q.z,a.__normalArray[n+2]=l.z,a.__faceArray[q]=C,a.__faceArray[q+1]=K,a.__faceArray[q+2]=
u,a.__lineArray[t]=C,a.__lineArray[t+1]=K,a.__lineArray[t+2]=C,a.__lineArray[t+3]=u,a.__lineArray[t+4]=K,a.__lineArray[t+5]=u,a.d+=3,a.l+=6):Math.abs(d[K-v].y)===c?(a.__normalArray[N]=R.x,a.__normalArray[P]=W.x,a.__normalArray[U]=Q.x,a.__normalArray[N+1]=R.y,a.__normalArray[P+1]=W.y,a.__normalArray[U+1]=Q.y,a.__normalArray[N+2]=R.z,a.__normalArray[P+2]=W.z,a.__normalArray[U+2]=Q.z,a.__faceArray[q]=C,a.__faceArray[q+1]=J,a.__faceArray[q+2]=K,a.__lineArray[t]=C,a.__lineArray[t+1]=J,a.__lineArray[t+
2]=C,a.__lineArray[t+3]=K,a.__lineArray[t+4]=J,a.__lineArray[t+5]=K,a.d+=3,a.l+=6):(a.__normalArray[N]=R.x,a.__normalArray[P]=W.x,a.__normalArray[n]=l.x,a.__normalArray[N+1]=R.y,a.__normalArray[P+1]=W.y,a.__normalArray[n+1]=l.y,a.__normalArray[N+2]=R.z,a.__normalArray[P+2]=W.z,a.__normalArray[n+2]=l.z,a.__normalArray[P]=W.x,a.__normalArray[U]=Q.x,a.__normalArray[n]=l.x,a.__normalArray[P+1]=W.y,a.__normalArray[U+1]=Q.y,a.__normalArray[n+1]=l.y,a.__normalArray[P+2]=W.z,a.__normalArray[U+2]=Q.z,a.__normalArray[n+
2]=l.z,a.__faceArray[q]=C,a.__faceArray[q+1]=J,a.__faceArray[q+2]=u,a.__faceArray[q+3]=J,a.__faceArray[q+4]=K,a.__faceArray[q+5]=u,a.__lineArray[t]=C,a.__lineArray[t+1]=J,a.__lineArray[t+2]=C,a.__lineArray[t+3]=u,a.__lineArray[t+4]=J,a.__lineArray[t+5]=K,a.__lineArray[t+6]=K,a.__lineArray[t+7]=u,a.d+=6,a.l+=8)}a.truncateArrayBuffers(!0);m.push({id:a.id,Z:a,T:new WebMol.Vector3(b.center.x,b.center.y,b.center.z)});z(this.q,m,a.__vertexArray)};this.addArrow=function(b){b.start=b.start||{};b.end=b.end||
{};b.start=new WebMol.Vector3(b.start.x||0,b.start.y||0,b.start.z||0);b.end=new WebMol.Vector3(b.end.x||3,b.end.y||0,b.end.z||0);b.m=b.m||.25;b.na=b.na||1.618034;b.W=0<b.W&&1>b.W?b.W:.618034;var a=h.addGeoGroup(),e=b.start,c=b.end,d=b.m,f=b.na,s=b.W;if(e&&c){var v=c.clone();v.sub(e).multiplyScalar(s);var y=e.clone().add(v),s=v.clone().negate();this.c.h.push(new WebMol.Cylinder(e.clone(),y.clone(),d));this.c.k.push(new WebMol.Sphere(e.clone(),d));var p=[];p[0]=v.clone();1E-4<Math.abs(p[0].x)?p[0].y+=
1:p[0].x+=1;p[0].cross(v);p[0].normalize();p[0]=p[0];p[4]=p[0].clone();p[4].crossVectors(p[0],v);p[4].normalize();p[8]=p[0].clone().negate();p[12]=p[4].clone().negate();p[2]=p[0].clone().add(p[4]).normalize();p[6]=p[4].clone().add(p[8]).normalize();p[10]=p[8].clone().add(p[12]).normalize();p[14]=p[12].clone().add(p[0]).normalize();p[1]=p[0].clone().add(p[2]).normalize();p[3]=p[2].clone().add(p[4]).normalize();p[5]=p[4].clone().add(p[6]).normalize();p[7]=p[6].clone().add(p[8]).normalize();p[9]=p[8].clone().add(p[10]).normalize();
p[11]=p[10].clone().add(p[12]).normalize();p[13]=p[12].clone().add(p[14]).normalize();p[15]=p[14].clone().add(p[0]).normalize();var x=a.vertices,q,t,C;t=0;for(C=p.length;t<C;++t){q=3*(x+3*t);var N=p[t].clone().multiplyScalar(d).add(e),J=p[t].clone().multiplyScalar(d).add(y),P=p[t].clone().multiplyScalar(d*f).add(y);a.__vertexArray[q]=N.x;a.__vertexArray[q+1]=N.y;a.__vertexArray[q+2]=N.z;a.__vertexArray[q+3]=J.x;a.__vertexArray[q+4]=J.y;a.__vertexArray[q+5]=J.z;a.__vertexArray[q+6]=P.x;a.__vertexArray[q+
7]=P.y;a.__vertexArray[q+8]=P.z;0<t&&(q=new WebMol.Vector3(a.__vertexArray[q-3],a.__vertexArray[q-2],a.__vertexArray[q-1]),N=c.clone(),J=y.clone(),P=new WebMol.Vector3(P.x,P.y,P.z),this.c.f.push(new WebMol.Triangle(P,N,q)),this.c.f.push(new WebMol.Triangle(q.clone(),J,P.clone())))}a.vertices+=48;q=3*a.vertices;a.__vertexArray[q]=e.x;a.__vertexArray[q+1]=e.y;a.__vertexArray[q+2]=e.z;a.__vertexArray[q+3]=y.x;a.__vertexArray[q+4]=y.y;a.__vertexArray[q+5]=y.z;a.__vertexArray[q+6]=c.x;a.__vertexArray[q+
7]=c.y;a.__vertexArray[q+8]=c.z;a.vertices+=3;var K,U,u,n,R,W,Q,l,ca,ia=a.vertices-3,G=a.vertices-2,I=a.vertices-1,F=3*ia,E=3*G,ja=3*I;t=0;for(C=p.length-1;t<C;++t)K=x+3*t,e=a.d,c=a.l,d=K,N=3*d,f=K+1,J=3*f,y=K+2,U=3*y,P=K+4,u=3*P,q=K+5,n=3*q,K+=3,R=3*K,W=Q=p[t],l=ca=p[t+1],a.__normalArray[N]=W.x,a.__normalArray[J]=Q.x,a.__normalArray[R]=ca.x,a.__normalArray[N+1]=W.y,a.__normalArray[J+1]=Q.y,a.__normalArray[R+1]=ca.y,a.__normalArray[N+2]=W.z,a.__normalArray[J+2]=Q.z,a.__normalArray[R+2]=ca.z,a.__normalArray[J]=
Q.x,a.__normalArray[u]=l.x,a.__normalArray[R]=ca.x,a.__normalArray[J+1]=Q.y,a.__normalArray[u+1]=l.y,a.__normalArray[R+1]=ca.y,a.__normalArray[J+2]=Q.z,a.__normalArray[u+2]=l.z,a.__normalArray[R+2]=ca.z,a.__normalArray[U]=Q.x,a.__normalArray[n]=l.x,a.__normalArray[U+1]=Q.y,a.__normalArray[n+1]=l.y,a.__normalArray[U+2]=Q.z,a.__normalArray[n+2]=l.z,a.__faceArray[e]=d,a.__faceArray[e+1]=f,a.__faceArray[e+2]=K,a.__faceArray[e+3]=f,a.__faceArray[e+4]=P,a.__faceArray[e+5]=K,a.__faceArray[e+6]=d,a.__faceArray[e+
7]=K,a.__faceArray[e+8]=ia,a.__faceArray[e+9]=y,a.__faceArray[e+10]=G,a.__faceArray[e+11]=q,a.__faceArray[e+12]=y,a.__faceArray[e+13]=I,a.__faceArray[e+14]=q,a.__lineArray[c]=d,a.__lineArray[c+1]=f,a.__lineArray[c+2]=d,a.__lineArray[c+3]=K,a.__lineArray[c+4]=P,a.__lineArray[c+5]=K,a.__lineArray[c+6]=d,a.__lineArray[c+7]=K,a.__lineArray[c+8]=y,a.__lineArray[c+9]=f,a.__lineArray[c+10]=y,a.__lineArray[c+11]=q,a.__lineArray[c+12]=P,a.__lineArray[c+13]=q,a.__lineArray[c+14]=y,a.__lineArray[c+15]=I,a.__lineArray[c+
16]=y,a.__lineArray[c+17]=q,a.__lineArray[c+18]=I,a.__lineArray[c+19]=q,a.d+=15,a.l+=20;x=[x+45,x+46,x+1,x,x+47,x+2];e=a.d;c=a.l;d=x[0];N=3*d;f=x[1];J=3*f;y=x[4];U=3*y;P=x[2];u=3*P;q=x[5];n=3*q;K=x[3];R=3*K;W=Q=p[15];l=ca=p[0];a.__normalArray[N]=W.x;a.__normalArray[J]=Q.x;a.__normalArray[R]=ca.x;a.__normalArray[N+1]=W.y;a.__normalArray[J+1]=Q.y;a.__normalArray[R+1]=ca.y;a.__normalArray[N+2]=W.z;a.__normalArray[J+2]=Q.z;a.__normalArray[R+2]=ca.z;a.__normalArray[J]=Q.x;a.__normalArray[u]=l.x;a.__normalArray[R]=
ca.x;a.__normalArray[J+1]=Q.y;a.__normalArray[u+1]=l.y;a.__normalArray[R+1]=ca.y;a.__normalArray[J+2]=Q.z;a.__normalArray[u+2]=l.z;a.__normalArray[R+2]=ca.z;a.__normalArray[U]=Q.x;a.__normalArray[n]=l.x;a.__normalArray[U+1]=Q.y;a.__normalArray[n+1]=l.y;a.__normalArray[U+2]=Q.z;a.__normalArray[n+2]=l.z;v.normalize();s.normalize();a.__normalArray[F]=s.x;a.__normalArray[E]=a.__normalArray[ja]=v.x;a.__normalArray[F+1]=s.y;a.__normalArray[E+1]=a.__normalArray[ja+1]=v.y;a.__normalArray[F+2]=s.z;a.__normalArray[E+
2]=a.__normalArray[ja+2]=v.z;a.__faceArray[e]=d;a.__faceArray[e+1]=f;a.__faceArray[e+2]=K;a.__faceArray[e+3]=f;a.__faceArray[e+4]=P;a.__faceArray[e+5]=K;a.__faceArray[e+6]=d;a.__faceArray[e+7]=K;a.__faceArray[e+8]=ia;a.__faceArray[e+9]=y;a.__faceArray[e+10]=G;a.__faceArray[e+11]=q;a.__faceArray[e+12]=y;a.__faceArray[e+13]=I;a.__faceArray[e+14]=q;a.__lineArray[c]=d;a.__lineArray[c+1]=f;a.__lineArray[c+2]=d;a.__lineArray[c+3]=K;a.__lineArray[c+4]=P;a.__lineArray[c+5]=K;a.__lineArray[c+6]=d;a.__lineArray[c+
7]=K;a.__lineArray[c+8]=y;a.__lineArray[c+9]=f;a.__lineArray[c+10]=y;a.__lineArray[c+11]=q;a.__lineArray[c+12]=P;a.__lineArray[c+13]=q;a.__lineArray[c+14]=y;a.__lineArray[c+15]=I;a.__lineArray[c+16]=y;a.__lineArray[c+17]=q;a.__lineArray[c+18]=I;a.__lineArray[c+19]=q;a.d+=15;a.l+=20}a.truncateArrayBuffers(!0);v=new WebMol.Vector3;m.push({id:a.id,Z:a,T:v.addVectors(b.start,b.end).multiplyScalar(.5)});z(this.q,m,a.__vertexArray)};this.addVolumetricData=function(b,a,c){var d=void 0!==c.ka&&"number"===
typeof c.ka?c.ka:0,f=c.sa?!0:!1,s=h.addGeoGroup();switch(a){case "cube":var v=b.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>v.length)){var A=v[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),y=Math.abs(parseFloat(A[0]));b=new WebMol.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]));var A=v[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p=0<parseFloat(A[0])?.529177:1;b.multiplyScalar(p);a=Math.abs(A[0]);var C=(new WebMol.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]))).multiplyScalar(p),
A=v[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),q=Math.abs(A[0]);(new WebMol.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]))).multiplyScalar(p);var A=v[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),t=Math.abs(A[0]);(new WebMol.Vector3(parseFloat(A[1]),parseFloat(A[2]),parseFloat(A[3]))).multiplyScalar(p);v=new Float32Array(v.splice(y+7).join(" ").replace(/^\s+/,"").split(/[\s\r]+/));A=new Int16Array(a*q*t);y=0;for(p=A.length;y<p;++y)A[y]=-1;A=new Uint8Array(a*q*t);y=0;
for(p=v.length;y<p;++y)0<(0<=d?v[y]-d:d-v[y])&&(A[y]|=2);d=[];v=[];WebMol.ha.Ia(A,d,v,{Fa:!0,sa:f,scale:C.length(),origin:b,Ja:a,Ka:q,La:t});f||WebMol.ha.Ha(10,d,v);x(this,s,{fa:d,Y:v,da:[],ca:[]})}}m.push({id:s.id,Z:s,T:s.getCentroid()});this.Oa(c);z(this.q,m,s.__vertexArray)};this.globj=function(d){h.initTypedArrays();var a=this.color,a=a||WebMol.p.color(a);h.xa=!0;for(var e in h.aa)for(var f=h.aa[e],m=f.__colorArray,s=0,f=f.vertices;s<f;++s)m[3*s]=a.r,m[3*s+1]=a.g,m[3*s+2]=a.b;c=new WebMol.Object3D;
e=new WebMol.MeshLambertMaterial({wireframe:this.wireframe,vertexColors:!0,ambient:0,reflectivity:0,side:this.side,transparent:1>this.alpha?!0:!1,opacity:this.alpha});e=new WebMol.Mesh(h,e);c.add(e);b&&(d.remove(b),b=null);b=c.clone();d.add(b)}}function C(d,f){d.color=f.color||new WebMol.Color;d.wireframe=f.wireframe?!0:!1;d.alpha=f.alpha?WebMol.Math.clamp(f.alpha,0,1):1;d.side=void 0!==f.side?f.side:WebMol.ga;d.clickable=f.clickable?!0:!1;d.callback="function"===typeof f.callback?f.callback:null}
function z(d,f,m){d.center.set(0,0,0);var c,b;if(0<f.length){c=0;for(b=f.length;c<b;++c)d.center.add(f[c].T);d.center.divideScalar(f.length)}f=d.m*d.m;c=0;for(b=m.length/3;c<b;c++){var h=d.center.distanceToSquared({x:m[3*c],y:m[3*c+1],z:m[3*c+2]});f=Math.max(f,h)}d.m=Math.sqrt(f)}function x(d,f,m){var c=m.fa,b=m.da,h=m.Y;m=m.ca;0!==c.length&&0!==h.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");f.vertices=c.length;f.d=h.length;var g,a,e,w,x;w=
0;for(x=f.vertices;w<x;++w)g=3*w,a=c[w],f.__vertexArray[g]=a.x,f.__vertexArray[g+1]=a.y,f.__vertexArray[g+2]=a.z;w=0;for(x=f.d/3;w<x;++w){g=3*w;a=h[g];e=h[g+1];g=h[g+2];var r=new WebMol.Vector3,z=new WebMol.Vector3,A=new WebMol.Vector3;d.c.f.push(new WebMol.Triangle(r.copy(c[a]),z.copy(c[e]),A.copy(c[g])))}f.__faceArray=new Uint16Array(h);f.truncateArrayBuffers(!0);if(b.length<f.vertices)f.setNormals();else for(f.__normalArray=new Float32Array(3*f.vertices),w=0,x=f.vertices;w<x;++w)g=3*w,d=b[w],f.__normalArray[g]=
d.x,f.__normalArray[g+1]=d.y,f.__normalArray[g+2]=d.z;m.length?f.__lineArray=new Uint16Array(m):f.setLineIndices();f.l=f.__lineArray.length}var f={i:{},L:function(d){if("undefined"!==typeof this.i[d])return this.i[d];var f={vertices:[],v:[],u:[]},m=16,c=10;1>d&&(m=8,c=6);var b=2*Math.PI,h=Math.PI,g,a;for(a=0;a<=c;a++){var e=[];for(g=0;g<=m;g++){var w=g/m,x=a/c,r={};r.x=-d*Math.cos(0+w*b)*Math.sin(0+x*h);r.y=d*Math.cos(0+x*h);r.z=d*Math.sin(0+w*b)*Math.sin(0+x*h);w=new WebMol.Vector3(r.x,r.y,r.z);
w.normalize();f.vertices.push(r);f.u.push(w);e.push(f.vertices.length-1)}f.v.push(e)}return this.i[d]=f}};Object.defineProperty(d.prototype,"position",{get:function(){return this.q.center}});Object.defineProperty(d.prototype,"x",{get:function(){return this.q.center.x}});Object.defineProperty(d.prototype,"y",{get:function(){return this.q.center.y}});Object.defineProperty(d.prototype,"z",{get:function(){return this.q.center.z}});return d}();WebMol.va=0;WebMol=WebMol||{};WebMol.ua=0;
function ka(d,C){this.id=WebMol.ua++;this.e=C||{};this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.n=new WebMol.Sprite;this.text=d}ka.prototype={dispose:function(){void 0!==this.n.A.map&&this.n.A.map.dispose();void 0!==this.n.A&&this.n.A.dispose()}};
function la(d){d.font=d.e.font=d.e.font?d.e.font:"Arial";d.fontSize=d.e.fontSize=d.e.fontSize?d.e.fontSize:20;d.s=d.e.s=d.e.s?d.e.s:{r:255,g:255,b:255,G:1};d.o=d.e.o=d.e.o?d.e.o:4;d.borderColor=d.e.borderColor=d.e.borderColor?d.e.borderColor:{r:0,g:0,b:0,G:1};d.backgroundColor=d.e.backgroundColor=d.e.backgroundColor?d.e.backgroundColor:{r:0,g:0,b:0,G:1};d.position=d.e.position=d.e.position?d.e.position:{x:-10,y:1,z:1};d.V=d.e.V=void 0!==d.e.V?d.e.V:!0;d.context.clearRect(0,0,d.canvas.width,d.canvas.height);
var C=WebMol.SpriteAlignment.topLeft;d.context.font=d.fontSize+"pt "+d.font;var z=d.context.measureText(d.text).width;d.context.fillStyle="rgba("+d.backgroundColor.r+","+d.backgroundColor.g+","+d.backgroundColor.b+","+d.backgroundColor.G+")";d.context.strokeStyle="rgba("+d.borderColor.r+","+d.borderColor.g+","+d.borderColor.b+","+d.borderColor.G+")";d.context.lineWidth=d.o;var x=d.context,f=d.o/2,v=d.o/2,s=z+d.o,m=1.4*d.fontSize+d.o;x.beginPath();x.moveTo(f+6,v);x.lineTo(f+s-6,v);x.quadraticCurveTo(f+
s,v,f+s,v+6);x.lineTo(f+s,v+m-6);x.quadraticCurveTo(f+s,v+m,f+s-6,v+m);x.lineTo(f+6,v+m);x.quadraticCurveTo(f,v+m,f,v+m-6);x.lineTo(f,v+6);x.quadraticCurveTo(f,v,f+6,v);x.closePath();x.fill();d.context.fillStyle="rgba("+d.s.r+","+d.s.g+","+d.s.b+","+d.s.G+")";d.context.fillText(d.text,d.o,d.fontSize+d.o,z);z=new WebMol.Texture(d.canvas);z.needsUpdate=!0;d.n.A=new WebMol.SpriteMaterial({map:z,useScreenCoordinates:!1,alignment:C,depthTest:!d.V});d.n.scale.set(2*d.fontSize,d.fontSize,1);d.n.position.set(d.position.x,
d.position.y,d.position.z)}
WebMol.GLViewer=function(){function d(d){var z,x,f,v,s,m,c,b,h,g;z=x=f=9999;v=s=m=-9999;c=b=h=g=0;if(0===d.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var a=0;a<d.length;a++){var e=d[a];void 0!==e&&(g++,c+=e.x,b+=e.y,h+=e.z,z=z<e.x?z:e.x,x=x<e.y?x:e.y,f=f<e.z?f:e.z,v=v>e.x?v:e.x,s=s>e.y?s:e.y,m=m>e.z?m:e.z)}return[[z,x,f],[v,s,m],[c/g,b/g,h/g]]}return function(C,z,x){function f(){if(q){var a=B.position.z-t.position.z;1>a&&(a=1);B.t=a+J;1>B.t&&(B.t=1);B.J=a+P;B.t+1>B.J&&(B.J=B.t+1);B instanceof WebMol.Camera?
B.Ea=20:(B.right=a*Math.tan(Math.PI/180*20),B.left=-B.right,B.top=B.right/D,B.bottom=-B.top);B.updateProjectionMatrix();q.fog.t=B.t+.4*(B.J-B.t);q.fog.J=B.J;r.render(q,B)}}function v(a){var c=[];"undefined"===typeof a&&(a={});var e=[],d;if("undefined"===typeof a.ma)for(d=0;d<b.length;d++)b[d]&&e.push(b[d]);else e=a.ma,$.isArray(e)||(e=[e]);for(d=0;d<e.length;d++)c=c.concat(e[d].selectedAtoms(a));return c}function s(a,c,d,e){for(var f=0;f<b.length;f++)if(b[f])b[f][a](c,d,e)}var m=this,c=C.id,b=[],
h=[],g=[],a=C.width(),e=C.height(),w=$('<div class="glviewerSpinnerWrap" style = "position: absolute; width: 100%; height: 100%; display: table; z-index: 1;"><div class="glviewerSpinner" style="display: table-cell; text-align: center; vertical-align: middle; z-index:1"><img src="webmol/spinner.gif"></div></div>');$(C).append(w);w.hide();var D=a/e,r=new WebMol.Renderer({antialias:!0});r.domElement.style.width="100%";r.domElement.style.height="100%";r.domElement.style.position="absolute";r.domElement.style.top=
"0px";r.domElement.style.zIndex="0";C.append(r.domElement);r.setSize(a,e);var B=new WebMol.Camera(20,D,1,800);B.position=new WebMol.Vector3(0,0,150);var A=new WebMol.Vector3;B.lookAt(A);var y=new WebMol.Raycaster(new WebMol.Vector3(0,0,0),new WebMol.Vector3(0,0,0)),p=new WebMol.Projector,L=new WebMol.Vector3(0,0,0),q=null,t=null,M=null,N=0,J=-50,P=50,K=new WebMol.Quaternion(0,0,0,1),U=new WebMol.Quaternion(0,0,0,1),u=!1,n=0,R=0,W=0,Q=0,l=0,ca=0;(function(){q=new WebMol.Scene;q.fog=new WebMol.Fog(N,
100,200);M=new WebMol.Object3D;t=new WebMol.Object3D;t.useQuaternion=!0;t.quaternion=new WebMol.Quaternion(0,0,0,1);t.add(M);q.add(t);var a=new WebMol.Light(16777215);a.position=(new WebMol.Vector3(.2,.2,1)).normalize();a.intensity=1;q.add(a)})();r.setClearColorHex(N,1);q.fog.color=WebMol.p.color(N);A=$(r.domElement);A.bind("mousedown touchstart",function(a){a.preventDefault();if(q){var c=a.pageX,d=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(c=a.originalEvent.targetTouches[0].pageX,
d=a.originalEvent.targetTouches[0].pageY);if(void 0!==c){u=!0;mouseButton=a.which;n=c;R=d;K=t.quaternion;Q=t.position.z;W=M.position.clone();l=J;ca=P;a=c/$(window).width()*2-1;L.set(a,2*-(d/e)+1,-1);p.unprojectVector(L,B);L.sub(B.position).normalize();y.set(B.position,L);d=[];a=[];a=0;for(c=b.length;a<c;a++)var h=b[a].selectedAtoms({clickable:!0}),d=d.concat(h);a=0;for(c=g.length;a<c;a++)h=g[a],h.clickable&&d.push(h);a=y.intersectObjects(M,d);a.length&&(d=a[0].clickable,void 0!==d.callback&&"function"===
typeof d.callback&&d.callback(d,m));f()}}});A.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(q){var b=.85*(150-t.position.z);a.originalEvent.detail?t.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(t.position.z-=b*a.originalEvent.wheelDelta/400);f()}});A.bind("contextmenu",function(a){a.preventDefault()});$("body").bind("mouseup touchend",function(){u=!1});A.bind("mousemove touchmove",function(b){b.preventDefault();if(q&&u){var d=0,g=$("input[name="+c+"_mouseMode]:checked");
0<g.length&&(d=parseInt(g.val()));var g=b.pageX,h=b.pageY;b.originalEvent.targetTouches&&b.originalEvent.targetTouches[0]&&(g=b.originalEvent.targetTouches[0].pageX,h=b.originalEvent.targetTouches[0].pageY);if(void 0!==g){var g=(g-n)/a,h=(h-R)/e,m=Math.sqrt(g*g+h*h);3==d||3==mouseButton&&b.ctrlKey?(J=l+100*g,P=ca+100*h):2==d||3==mouseButton||b.shiftKey?(b=.85*(150-t.position.z),80>b&&(b=80),t.position.z=Q-h*b):1==d||2==mouseButton||b.ctrlKey?(b=.85*(150-t.position.z),20>b&&(b=20),b=new WebMol.Vector3(g*
b,-h*b,0),d=t.quaternion,d=(new WebMol.Quaternion(d.x,d.y,d.z,d.w)).inverse().normalize(),b=b.applyQuaternion(d),M.position.x=W.x+b.x,M.position.y=W.y+b.y,M.position.z=W.z+b.z):0!==d&&1!=mouseButton||0===m||(b=Math.sin(m*Math.PI)/m,U.x=Math.cos(m*Math.PI),U.y=0,U.z=b*g,U.w=-b*h,t.quaternion=new WebMol.Quaternion(1,0,0,0),t.quaternion.multiply(U),t.quaternion.multiply(K));f()}}});this.setBackgroundColor=function(a,b){N=a;r.setClearColorHex(a,b|1);q.fog.color=WebMol.p.color(a);f()};this.setWidth=function(b){a=
b||a;r.setSize(a,e)};this.setHeight=function(b){e=b||e;r.setSize(a,e)};this.resize=function(){a=C.width();e=C.height();D=a/e;r.setSize(a,e);B.wb=D;B.updateProjectionMatrix();f()};$(window).resize(this.resize);this.getModel=function(a){a=a||b.length-1;return b[a]};this.getView=function(){if(!M)return[0,0,0,0,0,0,0,1];var a=M.position,b=t.quaternion;return[a.x,a.y,a.z,t.position.z,b.x,b.y,b.z,b.w]};this.setView=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&M&&t&&(M.position.x=a[0],M.position.y=
a[1],M.position.z=a[2],t.position.z=a[3],t.quaternion.x=a[4],t.quaternion.y=a[5],t.quaternion.z=a[6],t.quaternion.w=a[7],f())};this.render=function(){var a=new Date,c=this.getView(),d;for(d=0;d<b.length;d++)b[d]&&b[d].globj(M);for(d=0;d<g.length;d++)g[d]&&g[d].globj(M);for(d in h)if(h.hasOwnProperty(d)){var e=h[d].zb;h[d].Da||(e.Ib=!0,e.yb=!0,e.Eb=!0,e.xa=!0,e.xb=!0,e.q=null,h[d].done&&(h[d].Da=!0),h[d].la&&M.remove(h[d].la),e=new WebMol.Mesh(e,h[d].Bb),h[d].la=e,M.add(e))}this.setView(c);c=new Date;
w.hide();console.log("render time: "+(c-a))};this.pdbData=function(a){a=v(a);for(var b="",d=0,c=a.length;d<c;++d)b+=a[d].pdbline+"\n";return b};this.zoomTo=function(a){a=v(a).concat(g);var b=v({}).concat(g);a=d(a);var b=d(b),c=new WebMol.Vector3(a[2][0],a[2][1],a[2][2]);M.position=c.multiplyScalar(-1);var c=b[1][0]-b[0][0],e=b[1][1]-b[0][1],b=b[1][2]-b[0][2],b=Math.sqrt(c*c+e*e+b*b);25>b&&(b=25);J=-b/1.9;P=b/3;c=a[1][0]-a[0][0];e=a[1][1]-a[0][1];b=a[1][2]-a[0][2];b=Math.sqrt(c*c+e*e+b*b);25>b&&(b=
25);t.position.z=-(.35*b/Math.tan(Math.PI/180*B.Ea/2)-150);f()};this.addLabel=function(a,b){var c=new ka(a,b);la(c);M.add(c.n);return c};this.removeLabel=function(a){a.dispose();M.remove(a.n)};this.setLabelStyle=function(a,b){a.dispose();a.e=b;la(a);M.add(a.n);return a};this.setLabelText=function(a,b){a.dispose();a.text=b;la(a);M.add(a.n);return a};this.addShape=function(a){a=a||{};a=new WebMol.D(g.length,a);g.push(a);return a};this.addSphere=function(a){var b=new WebMol.D(g.length);a=a||{};b.addSphere(a);
g.push(b);return b};this.addArrow=function(a){var b=new WebMol.D(g.length);a=a||{};b.addArrow(a);g.push(b);return b};this.addCustom=function(a){var b=new WebMol.D(g.length);a=a||{};b.addCustom(a);g.push(b);return b};this.addVolumetricData=function(a,b,c){var d=new WebMol.D(g.length);c=c||{};d.addVolumetricData(a,b,c);g.push(d);return d};this.addModel=function(a,c){var d=new WebMol.GLModel(b.length,x);d.addMolData(a,c);b.push(d);return d};this.removeModel=function(a){if(a)for(a.removegl(M),delete b[a.getID()];0<
b.length&&"undefined"===typeof b[b.length-1];)b.pop()};this.removeAllModels=function(){for(var a=0;a<b.length;a++)b[a].removegl(M);b=[]};this.createModelFrom=function(a,c){for(var d=new WebMol.GLModel(b.length,x),e=0;e<b.length;e++)if(b[e]){var f=b[e].selectedAtoms(a);d.addAtoms(f);c&&b[e].removeAtoms(f)}b.push(d);return d};this.setStyle=function(a,b){s("setStyle",a,b,!1)};this.addStyle=function(a,b){s("setStyle",a,b,!0)};this.setColorByProperty=function(a,b,c){s("setColorByProperty",a,b,c)};this.setColorByElement=
function(a,b){s("setColorByElement",a,b)};this.clear=function(){h=[];this.removeAllModels();f()};getModelGroup=function(){return M};try{"function"===typeof z&&z(this)}catch(ia){console.log("error with glviewer callback: "+ia)}}}();WebMol.glmolViewer=WebMol.GLViewer;WebMol=WebMol||{};
WebMol.Fb=[{resn:"ALA",atom:"N",props:{a:-.15}},{resn:"ALA",atom:"CA",props:{a:.1}},{resn:"ALA",atom:"CB",props:{a:0}},{resn:"ALA",atom:"C",props:{a:.6}},{resn:"ALA",atom:"O",props:{a:-.55}},{resn:"ARG",atom:"N",props:{a:-.15}},{resn:"ARG",atom:"CA",props:{a:.1}},{resn:"ARG",atom:"CB",props:{a:0}},{resn:"ARG",atom:"CG",props:{a:0}},{resn:"ARG",atom:"CD",props:{a:.1}},{resn:"ARG",atom:"NE",props:{a:-.1}},{resn:"ARG",atom:"CZ",props:{a:.5}},{resn:"ARG",atom:"NH1",props:{a:.25}},{resn:"ARG",atom:"NH2",
props:{a:.25}},{resn:"ARG",atom:"C",props:{a:.6}},{resn:"ARG",atom:"O",props:{a:-.55}},{resn:"ASN",atom:"N",props:{a:-.15}},{resn:"ASN",atom:"CA",props:{a:.1}},{resn:"ASN",atom:"CB",props:{a:0}},{resn:"ASN",atom:"CG",props:{a:.55}},{resn:"ASN",atom:"OD1",props:{a:-.55}},{resn:"ASN",atom:"ND2",props:{a:0}},{resn:"ASN",atom:"C",props:{a:.6}},{resn:"ASN",atom:"O",props:{a:-.55}},{resn:"ASP",atom:"N",props:{a:-.15}},{resn:"ASP",atom:"CA",props:{a:.1}},{resn:"ASP",atom:"CB",props:{a:0}},{resn:"ASP",atom:"CG",
props:{a:.14}},{resn:"ASP",atom:"OD1",props:{a:-.57}},{resn:"ASP",atom:"OD2",props:{a:-.57}},{resn:"ASP",atom:"C",props:{a:.6}},{resn:"ASP",atom:"O",props:{a:-.55}},{resn:"CYS",atom:"N",props:{a:-.15}},{resn:"CYS",atom:"CA",props:{a:.1}},{resn:"CYS",atom:"CB",props:{a:.19}},{resn:"CYS",atom:"SG",props:{a:-.19}},{resn:"CYS",atom:"C",props:{a:.6}},{resn:"CYS",atom:"O",props:{a:-.55}},{resn:"GLN",atom:"N",props:{a:-.15}},{resn:"GLN",atom:"CA",props:{a:.1}},{resn:"GLN",atom:"CB",props:{a:0}},{resn:"GLN",
atom:"CG",props:{a:0}},{resn:"GLN",atom:"CD",props:{a:.55}},{resn:"GLN",atom:"OE1",props:{a:-.55}},{resn:"GLN",atom:"NE2",props:{a:0}},{resn:"GLN",atom:"C",props:{a:.6}},{resn:"GLN",atom:"O",props:{a:-.55}},{resn:"GLU",atom:"N",props:{a:-.15}},{resn:"GLU",atom:"CA",props:{a:.1}},{resn:"GLU",atom:"CB",props:{a:0}},{resn:"GLU",atom:"CG",props:{a:0}},{resn:"GLU",atom:"CD",props:{a:.14}},{resn:"GLU",atom:"OE1",props:{a:-.57}},{resn:"GLU",atom:"OE2",props:{a:-.57}},{resn:"GLU",atom:"C",props:{a:.6}},{resn:"GLU",
atom:"O",props:{a:-.55}},{resn:"GLY",atom:"N",props:{a:-.15}},{resn:"GLY",atom:"CA",props:{a:.1}},{resn:"GLY",atom:"C",props:{a:.6}},{resn:"GLY",atom:"O",props:{a:-.55}},{resn:"HIS",atom:"N",props:{a:-.15}},{resn:"HIS",atom:"CA",props:{a:.1}},{resn:"HIS",atom:"CB",props:{a:0}},{resn:"HIS",atom:"CG",props:{a:.1}},{resn:"HIS",atom:"ND1",props:{a:-.1}},{resn:"HIS",atom:"CD2",props:{a:.1}},{resn:"HIS",atom:"NE2",props:{a:-.4}},{resn:"HIS",atom:"CE1",props:{a:.3}},{resn:"HIS",atom:"C",props:{a:.6}},{resn:"HIS",
atom:"O",props:{a:-.55}},{resn:"ILE",atom:"N",props:{a:-.15}},{resn:"ILE",atom:"CA",props:{a:.1}},{resn:"ILE",atom:"CB",props:{a:0}},{resn:"ILE",atom:"CG2",props:{a:0}},{resn:"ILE",atom:"CG1",props:{a:0}},{resn:"ILE",atom:"CD",props:{a:0}},{resn:"ILE",atom:"C",props:{a:.6}},{resn:"ILE",atom:"O",props:{a:-.55}},{resn:"LEU",atom:"N",props:{a:-.15}},{resn:"LEU",atom:"CA",props:{a:.1}},{resn:"LEU",atom:"CB",props:{a:0}},{resn:"LEU",atom:"CG",props:{a:0}},{resn:"LEU",atom:"CD1",props:{a:0}},{resn:"LEU",
atom:"CD2",props:{a:0}},{resn:"LEU",atom:"C",props:{a:.6}},{resn:"LEU",atom:"O",props:{a:-.55}},{resn:"LYS",atom:"N",props:{a:-.15}},{resn:"LYS",atom:"CA",props:{a:.1}},{resn:"LYS",atom:"CB",props:{a:0}},{resn:"LYS",atom:"CG",props:{a:0}},{resn:"LYS",atom:"CD",props:{a:0}},{resn:"LYS",atom:"CE",props:{a:.25}},{resn:"LYS",atom:"NZ",props:{a:.75}},{resn:"LYS",atom:"C",props:{a:.6}},{resn:"LYS",atom:"O",props:{a:-.55}},{resn:"MET",atom:"N",props:{a:-.15}},{resn:"MET",atom:"CA",props:{a:.1}},{resn:"MET",
atom:"CB",props:{a:0}},{resn:"MET",atom:"CG",props:{a:.06}},{resn:"MET",atom:"SD",props:{a:-.12}},{resn:"MET",atom:"CE",props:{a:.06}},{resn:"MET",atom:"C",props:{a:.6}},{resn:"MET",atom:"O",props:{a:-.55}},{resn:"PHE",atom:"N",props:{a:-.15}},{resn:"PHE",atom:"CA",props:{a:.1}},{resn:"PHE",atom:"CB",props:{a:0}},{resn:"PHE",atom:"CG",props:{a:0}},{resn:"PHE",atom:"CD1",props:{a:0}},{resn:"PHE",atom:"CD2",props:{a:0}},{resn:"PHE",atom:"CE1",props:{a:0}},{resn:"PHE",atom:"CE2",props:{a:0}},{resn:"PHE",
atom:"CZ",props:{a:0}},{resn:"PHE",atom:"C",props:{a:.6}},{resn:"PHE",atom:"O",props:{a:-.55}},{resn:"PRO",atom:"N",props:{a:-.25}},{resn:"PRO",atom:"CD",props:{a:.1}},{resn:"PRO",atom:"CA",props:{a:.1}},{resn:"PRO",atom:"CB",props:{a:0}},{resn:"PRO",atom:"CG",props:{a:0}},{resn:"PRO",atom:"C",props:{a:.6}},{resn:"PRO",atom:"O",props:{a:-.55}},{resn:"SER",atom:"N",props:{a:-.15}},{resn:"SER",atom:"CA",props:{a:.1}},{resn:"SER",atom:"CB",props:{a:.25}},{resn:"SER",atom:"OG",props:{a:-.25}},{resn:"SER",
atom:"C",props:{a:.6}},{resn:"SER",atom:"O",props:{a:-.55}},{resn:"THR",atom:"N",props:{a:-.15}},{resn:"THR",atom:"CA",props:{a:.1}},{resn:"THR",atom:"CB",props:{a:.25}},{resn:"THR",atom:"OG1",props:{a:-.25}},{resn:"THR",atom:"CG2",props:{a:0}},{resn:"THR",atom:"C",props:{a:.6}},{resn:"THR",atom:"O",props:{a:-.55}},{resn:"TRP",atom:"N",props:{a:-.15}},{resn:"TRP",atom:"CA",props:{a:.1}},{resn:"TRP",atom:"CB",props:{a:0}},{resn:"TRP",atom:"CG",props:{a:-.03}},{resn:"TRP",atom:"CD2",props:{a:.1}},{resn:"TRP",
atom:"CE2",props:{a:-.04}},{resn:"TRP",atom:"CE3",props:{a:-.03}},{resn:"TRP",atom:"CD1",props:{a:.06}},{resn:"TRP",atom:"NE1",props:{a:-.06}},{resn:"TRP",atom:"CZ2",props:{a:0}},{resn:"TRP",atom:"CZ3",props:{a:0}},{resn:"TRP",atom:"CH2",props:{a:0}},{resn:"TRP",atom:"C",props:{a:.6}},{resn:"TRP",atom:"O",props:{a:-.55}},{resn:"TYR",atom:"N",props:{a:-.15}},{resn:"TYR",atom:"CA",props:{a:.1}},{resn:"TYR",atom:"CB",props:{a:0}},{resn:"TYR",atom:"CG",props:{a:0}},{resn:"TYR",atom:"CD1",props:{a:0}},
{resn:"TYR",atom:"CE1",props:{a:0}},{resn:"TYR",atom:"CD2",props:{a:0}},{resn:"TYR",atom:"CE2",props:{a:0}},{resn:"TYR",atom:"CZ",props:{a:.25}},{resn:"TYR",atom:"OH",props:{a:-.25}},{resn:"TYR",atom:"C",props:{a:.6}},{resn:"TYR",atom:"O",props:{a:-.55}},{resn:"VAL",atom:"N",props:{a:-.15}},{resn:"VAL",atom:"CA",props:{a:.1}},{resn:"VAL",atom:"CB",props:{a:0}},{resn:"VAL",atom:"CG1",props:{a:0}},{resn:"VAL",atom:"CG2",props:{a:0}},{resn:"VAL",atom:"C",props:{a:.6}},{resn:"VAL",atom:"O",props:{a:-.55}}];
