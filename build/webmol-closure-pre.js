WebMol=window.WebMol||{};WebMol.createViewer=function(g,B){"string"===$.type(g)&&(g=$("#"+g));if(g){B=B||{};B.order||(B.order=["glmol","jmol"]);B.defaultcolors||(B.defaultcolors=WebMol.ja);for(var D=0;D<B.order.length;D++){var C=B.order[D],v=C+"Viewer";if("function"===typeof this[v])try{return new this[v](g,B.callback,B.defaultcolors)}catch(t){console.log("error with "+C+":"+t)}}alert("Unable to instantiate webmol viewer: "+B.order);return null}};
WebMol.download=function(g,B){var D="";if("pdb:"===g.substr(0,4)){D="pdb";g=g.substr(4).toUpperCase();if(!g.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri="http://www.pdb.org/pdb/files/"+g+".pdb"}else if("cid:"==g.substr(0,4)){D="sdf";g=g.substr(4);if(!g.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+g+"/SDF?record_type=3d"}$.get(uri,function(g){B.addModel(g,D);B.zoomTo();B.render()});return null};
WebMol.SurfaceType={VDW:1,MS:2,SAS:3,SES:4};WebMol.m={k:{},color:function(g){if("undefined"!==typeof this.k[g])return this.k[g];var B=new WebMol.Color(g);return this.k[g]=B}};WebMol.na=function(g,B){var D=B.geometry;void 0!==D&&g.geometryGroups.push(D.geometryGroups[0])};WebMol.bb=function(g){return g.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};WebMol.syncSurface=!1;WebMol=WebMol||{};
WebMol.L=function(){var g={ma:function(g,r,s,d){function c(q,P,e,m,h,b){var c=new WebMol.Vector3;c.copy(f);var N=h;m&1<<h||!(m&1<<b)||(N=b);N&1&&e++;N&2&&P++;N&4&&q++;c.x+=n.x*q;c.y+=n.y*P;c.z+=n.z*e;q=(u*q+P)*x+e;if(a)return r.push(c),r.length-1;0>y[q]&&(y[q]=r.length,r.push(c));return y[q]}var e=!!d.Qa,f=d.hasOwnProperty("origin")&&d.origin.hasOwnProperty("x")?d.origin:{x:0,y:0,z:0},a=!!d.xa,b=d.pa||0,u=d.qa||0,x=d.ra||0;d=d.scale||1;var n=(new WebMol.Vector3(1,1,1)).multiplyScalar(d),y=new Int32Array(b*
u*x),z;d=0;for(z=y.length;d<z;++d)y[d]=-1;z=new Int32Array(12);var G=e?C:B,e=e?v:D;for(d=0;d<b-1;++d)for(var p=0;p<u-1;++p)for(var J=0;J<x-1;++J){for(var w=0,q=0;8>q;++q)w|=!!(g[(u*(d+((q&4)>>2))+p+((q&2)>>1))*x+J+(q&1)]&2)<<q;if(0!==w&&255!==w){var F=G[w];if(0!==F)for(q=e[w],F&1&&(z[0]=c(d,p,J,w,0,1)),F&2&&(z[1]=c(d,p,J,w,1,3)),F&4&&(z[2]=c(d,p,J,w,3,2)),F&8&&(z[3]=c(d,p,J,w,2,0)),F&16&&(z[4]=c(d,p,J,w,4,5)),F&32&&(z[5]=c(d,p,J,w,5,7)),F&64&&(z[6]=c(d,p,J,w,7,6)),F&128&&(z[7]=c(d,p,J,w,6,4)),F&256&&
(z[8]=c(d,p,J,w,0,4)),F&512&&(z[9]=c(d,p,J,w,1,5)),F&1024&&(z[10]=c(d,p,J,w,3,7)),F&2048&&(z[11]=c(d,p,J,w,2,6)),w=0;w<q.length;w+=3){var F=z[q[w]],P=z[q[w+1]],N=z[q[w+2]];a&&3<=w&&(r.push(r[F]),F=r.length-1,r.push(r[P]),P=r.length-1,r.push(r[N]),N=r.length-1);s.push(F);s.push(P);s.push(N)}}}},la:function(g,r,s){var d=Array(r.length),c,e,f,a;c=0;for(e=r.length;c<e;c++)d[c]={x:0,y:0,z:0};var b=Array(20),u;for(c=0;20>c;c++)b[c]=Array(r.length);c=0;for(e=r.length;c<e;c++)b[0][c]=0;c=0;for(e=s.length/
3;c<e;c++){var x=3*c,n=3*c+1,y=3*c+2;u=!0;f=0;for(a=b[0][s[x]];f<a;f++)if(s[n]==b[f+1][s[x]]){u=!1;break}u&&(b[0][s[x]]++,b[b[0][s[x]]][s[x]]=s[n]);u=!0;f=0;for(a=b[0][s[x]];f<a;f++)if(s[y]==b[f+1][s[x]]){u=!1;break}u&&(b[0][s[x]]++,b[b[0][s[x]]][s[x]]=s[y]);u=!0;f=0;for(a=b[0][s[n]];f<a;f++)if(s[x]==b[f+1][s[n]]){u=!1;break}u&&(b[0][s[n]]++,b[b[0][s[n]]][s[n]]=s[x]);u=!0;f=0;for(a=b[0][s[n]];f<a;f++)if(s[y]==b[f+1][s[n]]){u=!1;break}u&&(b[0][s[n]]++,b[b[0][s[n]]][s[n]]=s[y]);u=!0;for(f=0;f<b[0][s[y]];f++)if(s[x]==
b[f+1][s[y]]){u=!1;break}u&&(b[0][s[y]]++,b[b[0][s[y]]][s[y]]=s[x]);u=!0;f=0;for(a=b[0][s[y]];f<a;f++)if(s[n]==b[f+1][s[y]]){u=!1;break}u&&(b[0][s[y]]++,b[b[0][s[y]]][s[y]]=s[n])}for(s=0;s<g;s++){c=0;for(e=r.length;c<e;c++)if(3>b[0][c])d[c].x=r[c].x,d[c].y=r[c].y,d[c].z=r[c].z;else if(3==b[0][c]||4==b[0][c]){d[c].x=0;d[c].y=0;f=d[c].z=0;for(a=b[0][c];f<a;f++)d[c].x+=r[b[f+1][c]].x,d[c].y+=r[b[f+1][c]].y,d[c].z+=r[b[f+1][c]].z;d[c].x+=.5*r[c].x;d[c].y+=.5*r[c].y;d[c].z+=.5*r[c].z;d[c].x/=.5+b[0][c];
d[c].y/=.5+b[0][c];d[c].z/=.5+b[0][c]}else{d[c].x=0;d[c].y=0;f=d[c].z=0;for(a=b[0][c];f<a;f++)d[c].x+=r[b[f+1][c]].x,d[c].y+=r[b[f+1][c]].y,d[c].z+=r[b[f+1][c]].z;d[c].x+=1*r[c].x;d[c].y+=1*r[c].y;d[c].z+=1*r[c].z;d[c].x/=1+b[0][c];d[c].y/=1+b[0][c];d[c].z/=1+b[0][c]}c=0;for(e=r.length;c<e;c++)r[c].x=d[c].x,r[c].y=d[c].y,r[c].z=d[c].z}},Ia:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,
2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,
2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},B=new Uint32Array(g.Ia),D=g.fb=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,
4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,
4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,
1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,
1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,
7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,
3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],C=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,
2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,
3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],v=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,
2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,
11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,
5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,
6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],
[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,
2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,
4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,
6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,
10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,
5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,
10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return g}();"undefined"===typeof console&&(console={log:function(){}});
WebMol.Aa=function(){function g(a,q,e){var b=new Int32Array(a*q*e*3);this.set=function(a,m,h,P){a=3*((a*q+m)*e+h);b[a]=P.c;b[a+1]=P.d;b[a+2]=P.f};this.get=function(a,m,h){a=3*((a*q+m)*e+h);return{c:b[a],d:b[a+1],f:b[a+2]}}}function B(a){return a.elem&&"undefined"!=typeof G[a.elem]?a.elem:"X"}var D=0,C=0,v=0,t=2,r=0,s=0,d=0,c=0,e=null,f=null,a=null,b=0,u=0,x=0,n=0,y=0,z=0,G={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},p={},
J={},w,q,F=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,
1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.Ra=function(b){var c={},H,d;H=0;for(d=b.length;H<d;H++)c[b[H]]=!0;b=q;H=0;for(d=b.length;H<d;H++)b[H].x=b[H].x/t-D,b[H].y=b[H].y/t-C,b[H].z=b[H].z/t-v;var r=[];H=0;for(d=w.length;H<d;H+=3){var m=w[H],h=w[H+1],E=w[H+2],F=b[h].atomid,n=b[E].atomid,l=b[m].atomid;F<l&&(l=F);n<l&&(l=n);c[l]&&m!==h&&h!==E&&m!==E&&(r.push(m),r.push(h),r.push(E))}a=
f=e=null;return{vertices:b,faces:r}};this.Ta=function(q,N,H){1E6<H&&(t=1);H=1/t*5.5;b=q[0][0];n=q[1][0];u=q[0][1];y=q[1][1];x=q[0][2];z=q[1][2];N?(b-=1.4+H,u-=1.4+H,x-=1.4+H,n+=1.4+H,y+=1.4+H,z+=1.4+H):(b-=H,u-=H,x-=H,n+=H,y+=H,z+=H);b=Math.floor(b*t)/t;u=Math.floor(u*t)/t;x=Math.floor(x*t)/t;n=Math.ceil(n*t)/t;y=Math.ceil(y*t)/t;z=Math.ceil(z*t)/t;D=-b;C=-u;v=-x;d=Math.ceil(t*(n-b))+1;s=Math.ceil(t*(y-u))+1;r=Math.ceil(t*(z-x))+1;this.ia(N);c=1.4*t;e=new Uint8Array(d*s*r);f=new Float64Array(d*s*
r);a=new Int32Array(d*s*r);console.log("Box size: ",d,s,r,e.length)};this.ia=function(a){var q=[],b,e;flagradius=a;for(var c in G)if(G.hasOwnProperty(c))for(e=G[c],q[c]=a?(e+1.4)*t+.5:e*t+.5,e=q[c]*q[c],J[c]=Math.floor(q[c])+1,p[c]=new Int32Array(J[c]*J[c]),j=indx=0;j<J[c];j++)for(k=0;k<J[c];k++)b=j*j+k*k,b>e?p[c][indx]=-1:(b=Math.sqrt(e-b),p[c][indx]=Math.floor(b)),indx++};this.Oa=function(q,b){var c,d;c=0;for(d=e.length;c<d;c++)e[c]=0,f[c]=-1,a[c]=-1;for(c in b)d=q[b[c]],void 0!==d&&this.La(d,q);
c=0;for(d=e.length;c<d;c++)e[c]&1&&(e[c]|=2)};this.La=function(q,b){var c,f,F,m,h,E,n,u,l,g,A,x,w,z,y,da,G;c=Math.floor(.5+t*(q.x+D));f=Math.floor(.5+t*(q.y+C));F=Math.floor(.5+t*(q.z+v));var L=B(q),I=0,U=s*r;g=0;for(G=J[L];g<G;g++)for(A=0;A<G;A++){if(-1!=p[L][I])for(z=-1;2>z;z++)for(y=-1;2>y;y++)for(da=-1;2>da;da++)if(0!==z&&0!==y&&0!==da)for(n=z*g,l=da*A,x=0;x<=p[L][I];x++)u=x*y,m=c+n,h=f+u,w=F+l,0>m||0>h||0>w||m>=d||h>=s||w>=r||(w=m*U+h*r+w,e[w]&1?(E=b[a[w]],m=Math.floor(.5+t*(E.x+D)),h=Math.floor(.5+
t*(E.y+C)),E=Math.floor(.5+t*(E.z+v)),n*n+u*u+l*l<m*m+h*h+E*E&&(a[w]=q.serial)):(e[w]|=1,a[w]=q.serial));I++}};this.Pa=function(a,q){var b,c;b=0;for(c=e.length;b<c;b++)e[b]&=-3;for(b in q)c=a[q[b]],void 0!==c&&this.Ma(c,a)};this.Ma=function(q,b){var c,f,F,m,h,E,n=0,u,l,g,A,w,x,z,y,G,V,L;c=Math.floor(.5+t*(q.x+D));f=Math.floor(.5+t*(q.y+C));F=Math.floor(.5+t*(q.z+v));var I=B(q),U=s*r;w=0;for(L=J[I];w<L;w++)for(x=0;x<L;x++){if(-1!=p[I][n])for(y=-1;2>y;y++)for(G=-1;2>G;G++)for(V=-1;2>V;V++)if(0!==y&&
0!==G&&0!==V)for(u=y*w,g=V*x,z=0;z<=p[I][n];z++)l=z*G,m=c+u,h=f+l,A=F+g,0>m||0>h||0>A||m>=d||h>=s||A>=r||(A=m*U+h*r+A,e[A]&2?(E=b[a[A]],m=Math.floor(.5+t*(E.x+D)),h=Math.floor(.5+t*(E.y+C)),E=Math.floor(.5+t*(E.z+v)),u*u+l*l+g*g<m*m+h*h+E*E&&(a[A]=q.serial)):(e[A]|=2,a[A]=q.serial));n++}};this.Fa=function(){var a=s*r;for(i=0;i<d;i++)for(j=0;j<r;j++)for(k=0;k<s;k++){var q=i*a+k*r+j;if(e[q]&1)for(var b=0;26>b;){var c=i+F[b][0],f=j+F[b][2],m=k+F[b][1];if(-1<c&&c<d&&-1<m&&m<s&&-1<f&&f<r&&!(e[c*a+m*r+
f]&1)){e[q]|=4;break}else b++}}};this.Ja=function(){var q,a,b,F=new g(d,s,r),n=s*r,m=c*c,h=[];b=[];var E;for(q=0;q<d;q++)for(a=0;a<s;a++)for(b=0;b<r;b++)if(E=q*n+a*r+b,e[E]&=-3,e[E]&1&&e[E]&4){var u={c:q,d:a,f:b};F.set(q,a,b,u);h.push(u);f[E]=0;e[E]|=2;e[E]&=-5}do for(b=this.Ka(h,F),h=[],q=0,a=b.length;q<a;q++)E=n*b[q].c+r*b[q].d+b[q].f,e[E]&=-5,f[E]<=1.0404*m&&h.push({c:b[q].c,d:b[q].d,f:b[q].f});while(0!==h.length);q=t-.5;0>q&&(q=0);m-=.5/(.1+q);for(q=0;q<d;q++)for(a=0;a<s;a++)for(b=0;b<r;b++)E=
q*n+a*r+b,e[E]&=-5,e[E]&1&&(!(e[E]&2)||e[E]&2&&f[E]>=m)&&(e[E]|=4)};this.Ka=function(q,a){var b,c,n,m,h,E,u,g,l,p,A,w=[];if(0===q.length)return w;tnv={c:-1,d:-1,f:-1};var x=s*r;u=0;for(l=q.length;u<l;u++)for(b=q[u].c,c=q[u].d,n=q[u].f,p=a.get(b,c,n),g=0;6>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=n+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<s&&-1<tnv.d&&tnv.f<r&&-1<tnv.f&&(A=tnv.c*x+r*tnv.d+tnv.f,e[A]&1&&!(e[A]&2)?(a.set(tnv.c,tnv.d,n+F[g][2],p),m=tnv.c-p.c,h=tnv.d-p.d,E=tnv.f-p.f,m=m*m+h*h+E*E,f[A]=m,e[A]|=
2,e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})):e[A]&1&&e[A]&2&&(m=tnv.c-p.c,h=tnv.d-p.d,E=tnv.f-p.f,m=m*m+h*h+E*E,m<f[A]&&(a.set(tnv.c,tnv.d,tnv.f,p),f[A]=m,e[A]&4||(e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})))));u=0;for(l=q.length;u<l;u++)for(b=q[u].c,c=q[u].d,n=q[u].f,p=a.get(b,c,n),g=6;18>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=n+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<s&&-1<tnv.d&&tnv.f<r&&-1<tnv.f&&(A=tnv.c*x+r*tnv.d+tnv.f,e[A]&1&&!(e[A]&2)?(a.set(tnv.c,tnv.d,n+F[g][2],p),m=tnv.c-p.c,h=tnv.d-p.d,E=
tnv.f-p.f,m=m*m+h*h+E*E,f[A]=m,e[A]|=2,e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})):e[A]&1&&e[A]&2&&(m=tnv.c-p.c,h=tnv.d-p.d,E=tnv.f-p.f,m=m*m+h*h+E*E,m<f[A]&&(a.set(tnv.c,tnv.d,tnv.f,p),f[A]=m,e[A]&4||(e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})))));u=0;for(l=q.length;u<l;u++)for(b=q[u].c,c=q[u].d,n=q[u].f,p=a.get(b,c,n),g=18;26>g;g++)tnv.c=b+F[g][0],tnv.d=c+F[g][1],tnv.f=n+F[g][2],tnv.c<d&&-1<tnv.c&&tnv.d<s&&-1<tnv.d&&tnv.f<r&&-1<tnv.f&&(A=tnv.c*x+r*tnv.d+tnv.f,e[A]&1&&!(e[A]&2)?(a.set(tnv.c,tnv.d,
n+F[g][2],p),m=tnv.c-p.c,h=tnv.d-p.d,E=tnv.f-p.f,m=m*m+h*h+E*E,f[A]=m,e[A]|=2,e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})):e[A]&1&&e[A]&2&&(m=tnv.c-p.c,h=tnv.d-p.d,E=tnv.f-p.f,m=m*m+h*h+E*E,m<f[A]&&(a.set(tnv.c,tnv.d,tnv.f,p),f[A]=m,e[A]&4||(e[A]|=4,w.push({c:tnv.c,d:tnv.d,f:tnv.f})))));return w};this.Va=function(q){for(var a=0,b=e.length;a<b;a++)1==q?e[a]&=-5:4==q?(e[a]&=-3,e[a]&4&&(e[a]|=2),e[a]&=-5):2==q?e[a]&4&&e[a]&2?e[a]&=-5:e[a]&4&&!(e[a]&2)&&(e[a]|=2):3==q&&(e[a]&=-5)};this.Ua=function(b){this.Va(b);
q=[];w=[];WebMol.L.ma(e,q,w,{eb:1,pa:d,qa:s,ra:r});b=s*r;for(var c=0,f=q.length;c<f;c++)q[c].atomid=a[q[c].x*b+r*q[c].y+q[c].z];WebMol.L.la(1,q,w)}};WebMol.ya='self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(0>type)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1==type?!1:!0,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),(4===type||2===type)&&(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}};var Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0};Vector3.prototype={constructor:Vector3,copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this}};var ISDONE=2,ProteinSurface=function (){var faces,verts,origextent,INOUT=1,ISDONE=2,ISBOUND=4,ptranx=0,ptrany=0,ptranz=0,probeRadius=1.4,defaultScaleFactor=2,scaleFactor=defaultScaleFactor,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&"undefined"!=typeof vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;il>i;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;il>i;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;il>i;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(which>b&&(which=b),which>c&&(which=c),atomsToShow[which]){{vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]]}fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=defaultScaleFactor/2);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=probeRadius+margin,pminy-=probeRadius+margin,pminz-=probeRadius+margin,pmaxx+=probeRadius+margin,pmaxy+=probeRadius+margin,pmaxz+=probeRadius+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=probeRadius*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight),console.log("Box size: ",pLength,pWidth,pHeight,vpBits.length)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+probeRadius)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)txz=j*j+k*k,txz>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&INOUT&&(vpBits[i]|=ISDONE)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&INOUT){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=INOUT,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&=~ISDONE;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&ISDONE){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=ISDONE,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;pLength>i;i++)for(j=0;pHeight>j;j++)for(k=0;pWidth>k;k++){var index=i*pWH+k*pHeight+j;if(vpBits[index]&INOUT)for(var ii=0;26>ii;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&pLength>ti&&tk>-1&&pWidth>tk&&tj>-1&&pHeight>tj&&!(vpBits[ti*pWH+tk*pHeight+tj]&INOUT)){vpBits[index]|=ISBOUND;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=~ISDONE,vpBits[index]&INOUT&&vpBits[index]&ISBOUND){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=ISDONE,vpBits[index]&=~ISBOUND}do for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;n>i;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=~ISBOUND,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz});while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;0>cutsf&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)index=i*pWH+j*pHeight+k,vpBits[index]&=~ISBOUND,vpBits[index]&INOUT&&(!(vpBits[index]&ISDONE)||vpBits[index]&ISDONE&&vpDistance[index]>=cutoff)&&(vpBits[index]|=ISBOUND)},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;6>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;18>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;26>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;lim>i;i++)1==stype?vpBits[i]&=~ISBOUND:4==stype?(vpBits[i]&=~ISDONE,vpBits[i]&ISBOUND&&(vpBits[i]|=ISDONE),vpBits[i]&=~ISBOUND):2==stype?vpBits[i]&ISBOUND&&vpBits[i]&ISDONE?vpBits[i]&=~ISBOUND:vpBits[i]&ISBOUND&&!(vpBits[i]&ISDONE)&&(vpBits[i]|=ISDONE):3==stype&&(vpBits[i]&=~ISBOUND)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;vlen>i;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];laplacianSmooth(1,verts,faces)}},march=function (data,verts,faces,spec){var i,il,fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=new Vector3(1,1,1).multiplyScalar(scale),vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;il>i;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt=new Vector3;pt.copy(origin);var val1=!!(code&1<<p1),val2=!!(code&1<<p2),p=p1;!val1&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,pt.x+=unitCube.x*i,pt.y+=unitCube.y*j,pt.z+=unitCube.z*k;var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;nX-1>i;++i)for(var j=0;nY-1>j;++j)for(var k=0;nZ-1>k;++k){for(var code=0,p=0;8>p;++p){var index=(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p),val=!!(data[index]&ISDONE);code|=val<<p}if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},laplacianSmooth=function (numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;20>i;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;il>i;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}var wt=1,wt2=.5;for(k=0;numiter>k;k++){for(i=0,il=verts.length;il>i;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt2*verts[i].x,tps[i].y+=wt2*verts[i].y,tps[i].z+=wt2*verts[i].z,tps[i].x/=wt2+vertdeg[0][i],tps[i].y/=wt2+vertdeg[0][i],tps[i].z/=wt2+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt*verts[i].x,tps[i].y+=wt*verts[i].y,tps[i].z+=wt*verts[i].z,tps[i].x/=wt+vertdeg[0][i],tps[i].y/=wt+vertdeg[0][i],tps[i].z/=wt+vertdeg[0][i]}for(i=0,il=verts.length;il>i;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]';
WebMol.ga=window.URL.createObjectURL(new Blob([WebMol.ya]));WebMol.workerString=WebMol.ya;WebMol.SurfaceWorker=WebMol.ga;
$(document).ready(function(){void 0!==$("#webmoljs_viewer")[0]&&(WebMol.Ea=!0);if(WebMol.Ea){var g=WebMol.gb=$("#webmoljs_viewer"),B=null;g.data("pdb")?B="http://www.pdb.org/pdb/files/"+g.data("pdb")+".pdb":g.data("href")&&(B=g.data("href"));var D=Number(g.data("backgroundcolor"))||0,C=g.data("style")||{line:{}};WebMol.T=WebMol.createViewer("webmoljs_viewer",{defaultcolors:WebMol.rasmolElementColors,callback:function(g){g.setBackgroundColor(D)}});if(B){var v=g.data("datatype")||"pdb";$.get(B,function(g){WebMol.T.addModel(g,
v);WebMol.T.setStyle({},C);WebMol.T.zoomTo();WebMol.T.render()},"text")}}});WebMol.Ga=16716947;
WebMol.JmolElementColors={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,
I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219};
WebMol.rasmolElementColors={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,
Ba:16753920,BA:16753920,Au:14329120,AU:14329120};WebMol.ja=WebMol.JmolElementColors;var WebMol=WebMol||{};
WebMol.RWB=function(g,B){this.valueToHex=function(D,C){var v,t;C?(v=C[0],t=C[1]):(v=g,t=B);if(void 0===D)return 16777215;D<v&&(D=v);D>t&&(D=t);var r=(t+v)/2;D<=r?(v=Math.floor(255*Math.sqrt((D-v)/(r-v))),v=16711680+256*v+v):(v=Math.floor(255*Math.sqrt(1-(D-r)/(t-r))),v=65536*v+256*v+255);return v};this.jmolID=function(){return"rwb"};this.range=function(){return"undefined"!=typeof g&&"undefined"!=typeof B?[g,B]:null}};
WebMol.ROYGB=function(g,B){this.valueToHex=function(D,C){var v,t;C?(v=C[0],t=C[1]):(v=g,t=B);if("undefined"==typeof D)return 16777215;D<v&&(D=v);D>t&&(D=t);var r=(v+t)/2,s=(v+r)/2,d=(r+t)/2;D<s?(v=Math.floor(255*Math.sqrt((D-v)/(s-v))),v=256*v+16711680):D<r?(v=Math.floor(255*Math.sqrt(1-(D-s)/(r-s))),v=65536*v+65280):D<d?(v=Math.floor(255*Math.sqrt((D-r)/(d-r))),v=65280+1*v):(v=Math.floor(255*Math.sqrt(1-(D-d)/(t-d))),v=256*v+255);return v};this.jmolID=function(){return"roygb"};this.range=function(){return"undefined"!=
typeof g&&"undefined"!=typeof B?[g,B]:null}};
WebMol.Sinebow=function(g,B){this.valueToHex=function(D,C){var v,t;C?(v=C[0],t=C[1]):(v=g,t=B);if("undefined"==typeof D)return 16777215;D<v&&(D=v);D>t&&(D=t);var r=(D-v)/(t-v)*5/6+.5;v=Math.sin(Math.PI*r);t=Math.sin(Math.PI*(r+1/3));r=Math.sin(Math.PI*(r+2/3));return 65536*Math.floor(255*v*v)+256*Math.floor(255*r*r)+1*Math.floor(255*t*t)};this.jmolID=function(){return"sinebow"};this.range=function(){return"undefined"!=typeof g&&"undefined"!=typeof B?[g,B]:null}};WebMol=WebMol||{};
WebMol.Ha=function(){function g(g,C,v,t,r){if(!(2>C.length)){r=r||5;C=B(C,r);v=B(v,r);var s=new WebMol.Geometry(!0),d=[],c,e,f,a,b,u=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],x,n,y,z,G,p,J,w,q;p=0;for(J=C.length;p<J;p++){y=WebMol.m.color(t[Math.round((p-1)/r)]);d.push(e=C[p]);d.push(e);d.push(f=v[p]);d.push(f);p<J-1&&(x=C[p+1].clone().sub(C[p]),c=v[p].clone().sub(C[p]).cross(x).normalize().multiplyScalar(.4));d.push(a=C[p].clone().add(c));d.push(a);d.push(b=v[p].clone().add(c));d.push(b);
void 0!==e.atom&&(z=e.atom);q=s.updateGeoGroup(8);x=q.vertices;n=3*x;q.__vertexArray[n]=e.x;q.__vertexArray[n+1]=e.y;q.__vertexArray[n+2]=e.z;q.__vertexArray[n+3]=e.x;q.__vertexArray[n+4]=e.y;q.__vertexArray[n+5]=e.z;q.__vertexArray[n+6]=f.x;q.__vertexArray[n+7]=f.y;q.__vertexArray[n+8]=f.z;q.__vertexArray[n+9]=f.x;q.__vertexArray[n+10]=f.y;q.__vertexArray[n+11]=f.z;q.__vertexArray[n+12]=a.x;q.__vertexArray[n+13]=a.y;q.__vertexArray[n+14]=a.z;q.__vertexArray[n+15]=a.x;q.__vertexArray[n+16]=a.y;q.__vertexArray[n+
17]=a.z;q.__vertexArray[n+18]=b.x;q.__vertexArray[n+19]=b.y;q.__vertexArray[n+20]=b.z;q.__vertexArray[n+21]=b.x;q.__vertexArray[n+22]=b.y;q.__vertexArray[n+23]=b.z;for(e=0;8>e;++e)q.__colorArray[n+3*e]=y.r,q.__colorArray[n+1+3*e]=y.g,q.__colorArray[n+2+3*e]=y.b;if(0<p)for(n=void 0!==G&&void 0!==z&&G.serial!==z.serial,e=0;4>e;e++)if(f=[x+u[e][0],x+u[e][1],x+u[e][2],x+u[e][3]],b=q.faceidx,q.__faceArray[b]=f[0],q.__faceArray[b+1]=f[1],q.__faceArray[b+2]=f[3],q.__faceArray[b+3]=f[1],q.__faceArray[b+4]=
f[2],q.__faceArray[b+5]=f[3],q.faceidx+=6,z.clickable||G.clickable){w=d[f[3]].clone();b=d[f[0]].clone();var F=d[f[2]].clone(),P=d[f[1]].clone();w.atom=d[f[3]].atom||null;F.atom=d[f[2]].atom||null;b.atom=d[f[0]].atom||null;P.atom=d[f[1]].atom||null;if(n){var N=w.clone().add(b).multiplyScalar(.5),H=F.clone().add(P).multiplyScalar(.5),M=w.clone().add(P).multiplyScalar(.5);0===e%2?(G.clickable&&(f=new WebMol.Triangle(N,M,w),a=new WebMol.Triangle(H,F,M),w=new WebMol.Triangle(M,F,w),G.e.i.push(f),G.e.i.push(a),
G.e.i.push(w)),z.clickable&&(f=new WebMol.Triangle(b,P,M),a=new WebMol.Triangle(P,H,M),w=new WebMol.Triangle(b,M,N),z.e.i.push(f),z.e.i.push(a),z.e.i.push(w))):(z.clickable&&(f=new WebMol.Triangle(N,M,w),a=new WebMol.Triangle(H,F,M),w=new WebMol.Triangle(M,F,w),z.e.i.push(f),z.e.i.push(a),z.e.i.push(w)),G.clickable&&(f=new WebMol.Triangle(b,P,M),a=new WebMol.Triangle(P,H,M),w=new WebMol.Triangle(b,M,N),G.e.i.push(f),G.e.i.push(a),G.e.i.push(w)))}else z.clickable&&(f=new WebMol.Triangle(b,P,w),a=new WebMol.Triangle(P,
F,w),z.e.i.push(f),z.e.i.push(a))}q.vertices+=8;G=z}C=d.length-8;q=s.updateGeoGroup(8);x=q.vertices;n=3*x;b=q.faceidx;for(p=0;4>p;p++)d.push(d[2*p]),d.push(d[C+2*p]),v=d[2*p],t=d[C+2*p],q.__vertexArray[n+6*p]=v.x,q.__vertexArray[n+1+6*p]=v.y,q.__vertexArray[n+2+6*p]=v.z,q.__vertexArray[n+3+6*p]=t.x,q.__vertexArray[n+4+6*p]=t.y,q.__vertexArray[n+5+6*p]=t.z,q.__colorArray[n+6*p]=y.r,q.__colorArray[n+1+6*p]=y.g,q.__colorArray[n+2+6*p]=y.b,q.__colorArray[n+3+6*p]=y.r,q.__colorArray[n+4+6*p]=y.g,q.__colorArray[n+
5+6*p]=y.b;f=[x,x+2,x+6,x+4];a=[x+1,x+5,x+7,x+3];q.__faceArray[b]=f[0];q.__faceArray[b+1]=f[1];q.__faceArray[b+2]=f[3];q.__faceArray[b+3]=f[1];q.__faceArray[b+4]=f[2];q.__faceArray[b+5]=f[3];q.__faceArray[b+6]=a[0];q.__faceArray[b+7]=a[1];q.__faceArray[b+8]=a[3];q.__faceArray[b+9]=a[1];q.__faceArray[b+10]=a[2];q.__faceArray[b+11]=a[3];q.faceidx+=12;q.vertices+=8;s.initTypedArrays();s.setUpNormals();d=new WebMol.MeshLambertMaterial;d.vertexColors=WebMol.FaceColors;d.side=WebMol.DoubleSide;s=new WebMol.Mesh(s,
d);g.add(s)}}function B(g,B){var v=[],t=g,t=[];t.push(g[0]);var r,s,d,c,e,f;r=1;for(s=g.length-1;r<s;r++)c=g[r],e=g[r+1],c.Wa?t.push(new WebMol.Vector3((c.x+e.x)/2,(c.y+e.y)/2,(c.z+e.z)/2)):t.push(c);t.push(g[g.length-1]);r=-1;for(s=t.length;r<=s-3;r++){d=t[-1===r?0:r];c=t[r+1];e=t[r+2];f=t[r===s-3?s-1:r+3];d=(new WebMol.Vector3).subVectors(e,d).multiplyScalar(.5);f=(new WebMol.Vector3).subVectors(f,c).multiplyScalar(.5);for(var a=0;a<B;a++){var b=1/B*a,b=new WebMol.Vector3(c.x+b*d.x+b*b*(-3*c.x+
3*e.x-2*d.x-f.x)+b*b*b*(2*c.x-2*e.x+d.x+f.x),c.y+b*d.y+b*b*(-3*c.y+3*e.y-2*d.y-f.y)+b*b*b*(2*c.y-2*e.y+d.y+f.y),c.z+b*d.z+b*b*(-3*c.z+3*e.z-2*d.z-f.z)+b*b*b*(2*c.z-2*e.z+d.z+f.z)),u=Math.floor((v.length+2)/B);void 0!==g[u]&&void 0!==g[u].atom&&(b.atom=g[u].atom);v.push(b)}}v.push(t[t.length-1]);return v}return function(D,B){var v,t,r;v=2;t=5;r=!1;var s=[],d,c,e;for(e=0;e<v;e++)s[e]=[];e=[];var f,a,b,u,x=null,n=null;for(d in B)if(c=B[d],void 0!==c&&("O"==c.atom||"CA"==c.atom)&&!c.hetflag)if("CA"==
c.atom){if(f!=c.chain||b+1!=c.resi||a!=c.ta){g(D,s[0],s[v-1],e,t);s=[];for(e=0;e<v;e++)s[e]=[];e=[];x=null}u=new WebMol.Vector3(c.x,c.y,c.z);currentAtom=c;f=c.chain;a=c.ta;b=c.resi;var n=c.ss,y=c.color;"undefined"!=typeof c.style.cartoon.color&&(y=c.style.cartoon.color);e.push(y);!0!==c.clickable||void 0!==c.e&&void 0!==c.e.i||(c.e={sphere:null,j:[],line:[],i:[]})}else for(c=new WebMol.Vector3(c.x,c.y,c.z),c.sub(u),c.normalize(),c.multiplyScalar("c"==n?.3:1.3),null!==x&&0>c.dot(x)&&c.negate(),x=c,
c=0;c<v;c++)y=-1+2/(v-1)*c,y=new WebMol.Vector3(u.x+x.x*y,u.y+x.y*y,u.z+x.z*y),y.atom=currentAtom,r||"s"!=n||(y.Wa=!0),s[c].push(y);g(D,s[0],s[v-1],e,t)}}();WebMol=WebMol||{};
WebMol.GLModel=function(){function g(d){var c=[],e,f;e=0;for(f=d.length;e<f;e++){d[e].index=e;var a=d[e];a.hetflag||"N"!==a.atom&&"O"!==a.atom||(c.push(a),a.ca=null,a.G=Number.POSITIVE_INFINITY)}c.sort(function(a,b){return a.z-b.z});e=0;for(f=c.length;e<f;e++)for(a=c[e],d=e+1;d<f;d++){var b=c[d];if(3.5<b.z-a.z)break;var g=B(a,b);g<a.G&&(a.ca=b,a.G=g);g<b.G&&(b.ca=a,b.G=g)}}function B(d,c){if(d.chain==c.chain&&4>Math.abs(d.resi-c.resi))return Number.POSITIVE_INFINITY;if("O"===d.atom&&"N"===c.atom||
"N"===d.atom&&"O"===c.atom){var e=d.x-c.x;if(3.5<e)return Number.POSITIVE_INFINITY;var f=d.y-c.y;if(3.5<f)return Number.POSITIVE_INFINITY;var a=d.z-c.z;if(3.5<a)return Number.POSITIVE_INFINITY;e=Math.sqrt(e*e+f*f+a*a);if(3.5>e)return e}return Number.POSITIVE_INFINITY}function D(d){var c=[],e=[],f,a;f=0;for(a=d.length;f<a;f++){var b=d[f];b.index=f;b.hetflag?e.push(b):c.push(b)}C(e);c.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var e=d=-1,g;f=0;for(a=c.length;f<a;f++){b=
c[f];b.resi!==d&&(d=b.resi,g||e++,g=!1);b.ta=e;for(var r=f+1;r<c.length;r++){var n=c[r];if(n.chain!=b.chain)break;if(1<n.resi-b.resi)break;v(b,n)&&(-1===b.bonds.indexOf(n.index)&&(b.bonds.push(n.index),b.bondOrder.push(1),n.bonds.push(b.index),n.bondOrder.push(1)),b.resi!==n.resi&&(g=!0))}}}function C(d){var c=d.slice(0),e,f;e=0;for(f=d.length;e<f;e++)d[e].index||(d[e].index=e);c.sort(function(a,b){return a.z-b.z});e=0;for(f=c.length;e<f;e++){var a=c[e];for(d=e+1;d<f;d++){var b=c[d];if(1.9<b.z-a.z)break;
v(a,b)&&-1==a.bonds.indexOf(b.index)&&(a.bonds.push(b.index),a.bondOrder.push(1),b.bonds.push(a.index),b.bondOrder.push(1))}}}function v(d,c){var e=d.x-c.x,e=e*e;if(3.6<e)return!1;var f=d.y-c.y,f=f*f;if(3.6<f)return!1;var a=d.z-c.z,a=a*a;if(3.6<a)return!1;e=e+f+a;return isNaN(e)||.5>e||1.3<e&&("H"==d.elem||"H"==c.elem||"D"==d.elem||"D"==c.elem)?!1:3.6>e&&("S"==d.elem||"S"==c.elem)?!0:2.78<e?!1:!0}function t(d,c){return d&&c?JSON.stringify(d)==JSON.stringify(c):d==c}var r={line:{}},s={H:1.2,Li:1.82,
Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63};return function(d,c){function e(a,b,c,e,f,d,g){if(b&&c){w++;var m=d||g,h=c.clone();h.sub(b);var h=B(h),E=v.D(e);e=E.w;var n=E.Sa,r=m?n*e+2:2*e;a=a.updateGeoGroup(r);var l=E.vertices,u=E.s,E=E.t,p=E[n/2],s=E[n/2+1],x=a.vertices,z,t,y,D,L,I;for(y=0;y<e;++y)t=2*y,D=h[0]*l[t].x+h[3]*l[t].y+h[6]*l[t].z,L=h[1]*l[t].x+h[4]*l[t].y+h[7]*l[t].z,I=h[5]*l[t].y+h[8]*l[t].z,z=3*(x+t),t=a.faceidx,a.__vertexArray[z]=
D+b.x,a.__vertexArray[z+1]=L+b.y,a.__vertexArray[z+2]=I+b.z,a.__vertexArray[z+3]=D+c.x,a.__vertexArray[z+4]=L+c.y,a.__vertexArray[z+5]=I+c.z,a.__normalArray[z]=D,a.__normalArray[z+3]=D,a.__normalArray[z+1]=L,a.__normalArray[z+4]=L,a.__normalArray[z+2]=I,a.__normalArray[z+5]=I,a.__colorArray[z]=f.r,a.__colorArray[z+3]=f.r,a.__colorArray[z+1]=f.g,a.__colorArray[z+4]=f.g,a.__colorArray[z+2]=f.b,a.__colorArray[z+5]=f.b,a.__faceArray[t]=s[y]+x,a.__faceArray[t+1]=s[y+1]+x,a.__faceArray[t+2]=p[y]+x,a.__faceArray[t+
3]=p[y]+x,a.__faceArray[t+4]=s[y+1]+x,a.__faceArray[t+5]=p[y+1]+x,a.faceidx+=6;if(m){d=d?n+1:n/2+1;var U,O,T,Z,C,Q,K,Y,W,aa,ka,la,ca;for(L=g?0:n/2;L<d;L++)if(L!==n/2){var fa=L<=n/2?c:b;for(D=0;D<e;D++)t=a.faceidx,g=E[L][D+1],y=3*(g+x),m=E[L][D],I=3*(m+x),p=E[L+1][D],z=3*(p+x),s=E[L+1][D+1],ca=3*(s+x),U=h[0]*l[g].x+h[3]*l[g].y+h[6]*l[g].z,O=h[0]*l[m].x+h[3]*l[m].y+h[6]*l[m].z,T=h[0]*l[p].x+h[3]*l[p].y+h[6]*l[p].z,Z=h[0]*l[s].x+h[3]*l[s].y+h[6]*l[s].z,C=h[1]*l[g].x+h[4]*l[g].y+h[7]*l[g].z,Q=h[1]*l[m].x+
h[4]*l[m].y+h[7]*l[m].z,K=h[1]*l[p].x+h[4]*l[p].y+h[7]*l[p].z,Y=h[1]*l[s].x+h[4]*l[s].y+h[7]*l[s].z,W=h[5]*l[g].y+h[8]*l[g].z,aa=h[5]*l[m].y+h[8]*l[m].z,ka=h[5]*l[p].y+h[8]*l[p].z,la=h[5]*l[s].y+h[8]*l[s].z,a.__vertexArray[y]=U+fa.x,a.__vertexArray[I]=O+fa.x,a.__vertexArray[z]=T+fa.x,a.__vertexArray[ca]=Z+fa.x,a.__vertexArray[y+1]=C+fa.y,a.__vertexArray[I+1]=Q+fa.y,a.__vertexArray[z+1]=K+fa.y,a.__vertexArray[ca+1]=Y+fa.y,a.__vertexArray[y+2]=W+fa.z,a.__vertexArray[I+2]=aa+fa.z,a.__vertexArray[z+2]=
ka+fa.z,a.__vertexArray[ca+2]=la+fa.z,a.__colorArray[y]=f.r,a.__colorArray[I]=f.r,a.__colorArray[z]=f.r,a.__colorArray[ca]=f.r,a.__colorArray[y+1]=f.g,a.__colorArray[I+1]=f.g,a.__colorArray[z+1]=f.g,a.__colorArray[ca+1]=f.g,a.__colorArray[y+2]=f.b,a.__colorArray[I+2]=f.b,a.__colorArray[z+2]=f.b,a.__colorArray[ca+2]=f.b,U=h[0]*u[g].x+h[3]*u[g].y+h[6]*u[g].z,O=h[0]*u[m].x+h[3]*u[m].y+h[6]*u[m].z,T=h[0]*u[p].x+h[3]*u[p].y+h[6]*u[p].z,Z=h[0]*u[s].x+h[3]*u[s].y+h[6]*u[s].z,C=h[1]*u[g].x+h[4]*u[g].y+h[7]*
u[g].z,Q=h[1]*u[m].x+h[4]*u[m].y+h[7]*u[m].z,K=h[1]*u[p].x+h[4]*u[p].y+h[7]*u[p].z,Y=h[1]*u[s].x+h[4]*u[s].y+h[7]*u[s].z,W=h[5]*u[g].y+h[8]*u[g].z,aa=h[5]*u[m].y+h[8]*u[m].z,ka=h[5]*u[p].y+h[8]*u[p].z,la=h[5]*u[s].y+h[8]*u[s].z,0===L?(a.__normalArray[y]=U,a.__normalArray[z]=T,a.__normalArray[ca]=Z,a.__normalArray[y+1]=C,a.__normalArray[z+1]=K,a.__normalArray[ca+1]=Y,a.__normalArray[y+2]=W,a.__normalArray[z+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[t]=g+x,a.__faceArray[t+1]=p+x,a.__faceArray[t+
2]=s+x,a.faceidx+=3):L===d-1?(a.__normalArray[y]=U,a.__normalArray[I]=O,a.__normalArray[z]=T,a.__normalArray[y+1]=C,a.__normalArray[I+1]=Q,a.__normalArray[z+1]=K,a.__normalArray[y+2]=W,a.__normalArray[I+2]=aa,a.__normalArray[z+2]=ka,a.__faceArray[t]=g+x,a.__faceArray[t+1]=m+x,a.__faceArray[t+2]=p+x,a.faceidx+=3):(a.__normalArray[y]=U,a.__normalArray[I]=O,a.__normalArray[ca]=Z,a.__normalArray[y+1]=C,a.__normalArray[I+1]=Q,a.__normalArray[ca+1]=Y,a.__normalArray[y+2]=W,a.__normalArray[I+2]=aa,a.__normalArray[ca+
2]=la,a.__normalArray[I]=O,a.__normalArray[z]=T,a.__normalArray[ca]=Z,a.__normalArray[I+1]=Q,a.__normalArray[z+1]=K,a.__normalArray[ca+1]=Y,a.__normalArray[I+2]=aa,a.__normalArray[z+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[t]=g+x,a.__faceArray[t+1]=m+x,a.__faceArray[t+2]=s+x,a.__faceArray[t+3]=m+x,a.__faceArray[t+4]=p+x,a.__faceArray[t+5]=s+x,a.faceidx+=6)}}a.vertices+=r}}function f(q,b){if(q.style.sphere){var c=q.style.sphere;if(!c.hidden){var e=q.color;"undefined"!=typeof c.color&&(e=c.color);
var f=WebMol.m.color(e),d,c=a(q,c);!0===q.clickable&&void 0!==q.e&&(e=new WebMol.Vector3(q.x,q.y,q.z),q.e.sphere.push(new WebMol.Sphere(e,c)));d=p.D(c);for(var e=d.vertices,g=d.s,m=b.updateGeoGroup(e.length),h=m.vertices,u=0,n=e.length;u<n;++u){var r=3*(h+u),l=e[u];m.__vertexArray[r]=l.x+q.x;m.__vertexArray[r+1]=l.y+q.y;m.__vertexArray[r+2]=l.z+q.z;m.__colorArray[r]=f.r;m.__colorArray[r+1]=f.g;m.__colorArray[r+2]=f.b}m.vertices+=e.length;u=d.t;n=u.length-1;for(d=0;d<n;d++)for(r=u[d].length-1,f=0;f<
r;f++){var l=m.faceidx,z=u[d][f+1]+h,s=3*z,t=u[d][f]+h,x=3*t,w=u[d+1][f]+h,y=3*w,v=u[d+1][f+1]+h,G=3*v,D=g[z-h],I=g[t-h],U=g[w-h],O=g[v-h];Math.abs(e[z-h].y)===c?(m.__normalArray[s]=D.x,m.__normalArray[y]=U.x,m.__normalArray[G]=O.x,m.__normalArray[s+1]=D.y,m.__normalArray[y+1]=U.y,m.__normalArray[G+1]=O.y,m.__normalArray[s+2]=D.z,m.__normalArray[y+2]=U.z,m.__normalArray[G+2]=O.z,m.__faceArray[l]=z,m.__faceArray[l+1]=w,m.__faceArray[l+2]=v,m.faceidx+=3):Math.abs(e[w-h].y)===c?(m.__normalArray[s]=D.x,
m.__normalArray[x]=I.x,m.__normalArray[y]=U.x,m.__normalArray[s+1]=D.y,m.__normalArray[x+1]=I.y,m.__normalArray[y+1]=U.y,m.__normalArray[s+2]=D.z,m.__normalArray[x+2]=I.z,m.__normalArray[y+2]=U.z,m.__faceArray[l]=z,m.__faceArray[l+1]=t,m.__faceArray[l+2]=w,m.faceidx+=3):(m.__normalArray[s]=D.x,m.__normalArray[x]=I.x,m.__normalArray[G]=O.x,m.__normalArray[s+1]=D.y,m.__normalArray[x+1]=I.y,m.__normalArray[G+1]=O.y,m.__normalArray[s+2]=D.z,m.__normalArray[x+2]=I.z,m.__normalArray[G+2]=O.z,m.__normalArray[x]=
I.x,m.__normalArray[y]=U.x,m.__normalArray[G]=O.x,m.__normalArray[x+1]=I.y,m.__normalArray[y+1]=U.y,m.__normalArray[G+1]=O.y,m.__normalArray[x+2]=I.z,m.__normalArray[y+2]=U.z,m.__normalArray[G+2]=O.z,m.__faceArray[l]=z,m.__faceArray[l+1]=t,m.__faceArray[l+2]=v,m.__faceArray[l+3]=t,m.__faceArray[l+4]=w,m.__faceArray[l+5]=v,m.faceidx+=6)}}}}function a(a,b){var c=1.5;"undefined"!=typeof b.l?c=b.l:s[a.elem]&&(c=s[a.elem]);"undefined"!=typeof b.scale&&(c*=b.scale);return c}var b=[],u=null,x=null,n=null,
y=null,z=WebMol.Ga;ElementColors=c?c:WebMol.ja;var v={M:function(){var a=[];a[0]=new WebMol.Vector3(-1,0,0);a[4]=new WebMol.Vector3(0,0,1);a[8]=new WebMol.Vector3(1,0,0);a[12]=new WebMol.Vector3(0,0,-1);a[2]=a[0].clone().add(a[4]).normalize();a[6]=a[4].clone().add(a[8]).normalize();a[10]=a[8].clone().add(a[12]).normalize();a[14]=a[12].clone().add(a[0]).normalize();a[1]=a[0].clone().add(a[2]).normalize();a[3]=a[2].clone().add(a[4]).normalize();a[5]=a[4].clone().add(a[6]).normalize();a[7]=a[6].clone().add(a[8]).normalize();
a[9]=a[8].clone().add(a[10]).normalize();a[11]=a[10].clone().add(a[12]).normalize();a[13]=a[12].clone().add(a[14]).normalize();a[15]=a[14].clone().add(a[0]).normalize();return a}(),k:{},D:function(a){if(void 0!==this.k[a])return this.k[a];new WebMol.Vector3(0,1,0);for(var b=this.M.length,c=[],e=[],f,d=0;d<b;d++)c.push(this.M[d].clone().multiplyScalar(a)),c.push(this.M[d].clone().multiplyScalar(a)),f=this.M[d].clone().normalize(),e.push(f),e.push(f);var d=[],g=2*Math.PI,m=Math.PI,h,u,n=!1,p=!1;for(u=
0;10>=u;u++){var n=0===u||10===u?!0:!1,p=5===u?!0:!1,l=[],r=[];for(h=0;h<=b;h++)if(p){var s=h<b?2*h:0;r.push(s+1);l.push(s)}else{f=h/b;var z=u/10;n&&0!==h?n&&l.push(c.length-1):h<b?(s=new WebMol.Vector3,s.x=-a*Math.cos(0+f*g)*Math.sin(0+z*m),s.y=a*Math.cos(0+z*m),s.z=a*Math.sin(0+f*g)*Math.sin(0+z*m),1E-5>Math.abs(s.x)&&(s.x=0),1E-5>Math.abs(s.y)&&(s.y=0),1E-5>Math.abs(s.z)&&(s.z=0),f=new WebMol.Vector3(s.x,s.y,s.z),f.normalize(),c.push(s),e.push(f),l.push(c.length-1)):l.push(c.length-b)}p&&d.push(r);
d.push(l)}b={vertices:c,s:e,t:d,w:b,Sa:10};return this.k[a]=b}},p={k:{},D:function(a){if("undefined"!=typeof this.k[a])return this.k[a];var b={vertices:[],t:[],s:[]},c=12,e=10;1>a&&(c=8,e=6);var f=2*Math.PI,d=Math.PI,g,m;for(m=0;m<=e;m++){var h=[];for(g=0;g<=c;g++){var u=g/c,n=m/e,p={};p.x=-a*Math.cos(0+u*f)*Math.sin(0+n*d);p.y=a*Math.cos(0+n*d);p.z=a*Math.sin(0+u*f)*Math.sin(0+n*d);u=new WebMol.Vector3(p.x,p.y,p.z);u.normalize();b.vertices.push(p);b.s.push(u);h.push(b.vertices.length-1)}b.t.push(h)}return this.k[a]=
b}},B=function(){var a=new WebMol.Vector3;return function(b){a.copy(b);var c=a.x,e=a.y,f=a.z,d=Math.sqrt(c*c+e*e);1E-4>d?(b=0,d=1):(b=-c/d,d=e/d);e=-b*c+d*e;c=Math.sqrt(e*e+f*f);1E-4>c?(f=0,e=1):(f/=c,e/=c);rot=new Float32Array(9);rot[0]=d;rot[1]=b;rot[2]=0;rot[3]=-b*e;rot[4]=d*e;rot[5]=f;rot[6]=b*f;rot[7]=-d*f;rot[8]=e;return rot}}(),w=0;this.getID=function(){return d};this.addMolData=function(a,c){a||console.error("Erorr with addMolData: No input data specified");switch(c){case "xyz":var e=b,f=
a.split("\n");if(!(3>f.length)){var u=parseInt(f[0].substr(0,3));if(!(isNaN(u)||0>=u||f.length<u+2)){for(var n=2,p=e.length,u=p+u;p<u;p++){var m=f[n++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),h={};h.serial=p;h.atom=h.elem=m[0];h.x=parseFloat(m[1]);h.y=parseFloat(m[2]);h.z=parseFloat(m[3]);h.hetflag=!0;h.bonds=[];h.bondOrder=[];h.singleBonds=!0;h.properties={};e[p]=h}C(e)}}break;case "pdb":var e=b,f=e.length,s,n=[],u=[],m=[],h=a.split("\n"),t,x,l;for(t=0;t<h.length;t++){l=h[t].replace(/^\s*/,
"");s=l.substr(0,6);var y;if("ATOM  "==s||"HETATM"==s){var w,v,G,B,J,da,V,L,I;s=l.substr(16,1);if(" "==s||"A"==s)L=parseInt(l.substr(6,5)),s=l.substr(12,4).replace(/ /g,""),x=l.substr(17,3),y=l.substr(21,1),w=parseInt(l.substr(22,4)),v=l.substr(26,1),G=parseFloat(l.substr(30,8)),B=parseFloat(l.substr(38,8)),J=parseFloat(l.substr(46,8)),I=parseFloat(l.substr(60,8)),V=l.substr(76,2).replace(/ /g,""),""===V&&(V=l.substr(12,2).replace(/ /g,"")),"H"!=V&&"HH"!=V&&"HD"!=V&&(da="H"==l[0]?!0:!1,m[L]=e.length,
e.push({resn:x,x:G,y:B,z:J,elem:V,hetflag:da,chain:y,resi:w,icode:v,rescode:w+(" "!=v?"^"+v:""),serial:L,atom:s,bonds:[],ss:"c",singleBonds:!0,bondOrder:[],properties:{},b:I,pdbline:l}))}else if("SHEET "==s)s=l.substr(21,1),x=parseInt(l.substr(22,4)),y=l.substr(32,1),l=parseInt(l.substr(33,4)),n.push([s,x,y,l]);else if("CONECT"==s)for(s=e[m[parseInt(l.substr(6,5))]],x=0;4>x;x++)y=parseInt(l.substr([11,16,21,26][x],5)),w=e[m[y]],void 0!==s&&void 0!==w&&(s.bonds.push(m[y]),s.bondOrder.push(1));else"HELIX "==
s&&(s=l.substr(19,1),x=parseInt(l.substr(21,4)),y=l.substr(31,1),l=parseInt(l.substr(33,4)),u.push([s,x,y,l]))}m=(new Date).getTime();D(e);console.log("bond connecting "+((new Date).getTime()-m));m=(new Date).getTime();g(e);h={};l=0;for(s=e.length;l<s;l++)x=e[l],"undefined"===typeof h[x.chain]&&(h[x.chain]=[]),isFinite(x.G)&&(h[x.chain][x.resi]=4===Math.abs(x.ca.resi-x.resi)?"h":"s");for(p in h){for(l=1;l<h[p].length-1;l++)s=h[p][l-1],x=h[p][l+1],t=h[p][l],s==x&&t!=s&&(h[p][l]=s);for(l=0;l<h[p].length;l++)t=
h[p][l],"h"!=t&&"s"!=t||h[p][l-1]==t||h[p][l+1]==t||delete h[p][l]}l=0;for(s=e.length;l<s;l++)x=e[l],t=h[x.chain][x.resi],"undefined"!=typeof t&&(x.ss=t,h[x.chain][x.resi-1]!=t&&(x.ua=!0),h[x.chain][x.resi+1]!=t&&(x.va=!0));console.log("secondary structure "+((new Date).getTime()-m));for(t=f;t<e.length;t++)if(s=e[t],void 0!==s){for(x=0;x<n.length;x++)s.chain!=n[x][0]||s.resi<n[x][1]||s.resi>n[x][3]||(s.ss="s",s.resi==n[x][1]&&(s.ua=!0),s.resi==n[x][3]&&(s.va=!0));for(x=0;x<u.length;x++)s.chain!=u[x][0]||
s.resi<u[x][1]||s.resi>u[x][3]||(s.ss="h",s.resi==u[x][1]?s.ua=!0:s.resi==u[x][3]&&(s.va=!0))}break;case "sdf":e=b;f=a.split("\n");if(!(4>f.length||(m=parseInt(f[3].substr(0,3)),isNaN(m)||0>=m||(n=parseInt(f[3].substr(3,3)),u=4,f.length<4+m+n)))){p=e.length;t=p+m;for(m=p;m<t;m++)h=f[u],u++,l={},l.serial=m,l.x=parseFloat(h.substr(0,10)),l.y=parseFloat(h.substr(10,10)),l.z=parseFloat(h.substr(20,10)),l.hetflag=!0,l.singleBonds=!0,l.atom=l.elem=h.substr(31,3).replace(/ /g,""),l.bonds=[],l.bondOrder=
[],l.properties={},e[m]=l;for(m=0;m<n;m++)h=f[u],u++,t=parseInt(h.substr(0,3))-1+p,l=parseInt(h.substr(3,3))-1+p,h=parseInt(h.substr(6,3)),1<h&&(e[t].singleBonds=!1,e[l].singleBonds=!1),e[t].bonds.push(l),e[t].bondOrder.push(h),e[l].bonds.push(t),e[l].bondOrder.push(h)}break;case "mol2":e=b;n=a.search(/@<TRIPOS>MOLECULE/);f=a.search(/@<TRIPOS>ATOM/);if(-1!=n&&-1!=f){f=[];n=a.substr(n,a.length).split("\n");h=n[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");t=parseInt(h[0]);u=0;1<h.length&&(u=
parseInt(h[1]));p=4;for(m=3;m<n.length;m++)if("@<TRIPOS>ATOM"==n[m]){p=m+1;break}m=e.length;for(t=m+t;m<t;m++)h=n[p++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),l={},s=m,x=parseInt(h[0]),l.serial=x,l.x=parseFloat(h[2]),l.y=parseFloat(h[3]),l.z=parseFloat(h[4]),l.atom=l.elem=h[5].split(".")[0],l.singleBonds=!0,"H"!=l.elem&&(l.bonds=[],l.bondOrder=[],l.properties={},f[x]=s,e.push(l));for(m=!1;p<n.length;)if("@<TRIPOS>BOND"==n[p++]){m=!0;break}if(m&&u)for(m=0;m<u;m++)h=n[p++],h=h.replace(/^\s+/,
"").replace(/\s+/g," ").split(" "),t=parseInt(h[1]),fromAtom=e[f[t]],l=parseInt(h[2]),toAtom=e[f[l]],h=parseInt(h[3]),isNaN(h)&&(h=1),1<h&&(fromAtom.singleBonds=!1,toAtom.singleBonds=!1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(f[l]),fromAtom.bondOrder.push(h),toAtom.bonds.push(f[t]),toAtom.bondOrder.push(h))}break;case "cube":if(e=b,f=a.replace(/^\s+/,"").split(/[\n\r]+/),!(6>f.length)){n=f[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");u=Math.abs(parseFloat(n[0]));n=f[3].replace(/^\s+/,
"").replace(/\s+/g," ").split(" ");n=0<parseFloat(n[0])?.529177:1;f=f.splice(6,u);u=e.length;p=u+f.length;for(m=u;m<p;++m)h={},h.serial=m,t=f[m-u].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),6==t[0]?h.elem="C":1==t[0]?h.elem="H":8==t[0]?h.elem="O":17==t[0]&&(h.elem="CL"),h.x=parseFloat(t[2])*n,h.y=parseFloat(t[3])*n,h.z=parseFloat(t[4])*n,h.hetflag=!0,h.singleBonds=!0,h.bonds=[],h.bondOrder=[],h.properties={},e.push(h);C(e)}}e=b;for(f=0;f<e.length;f++)if(n=e[f])n.style=n.style||r,n.color=n.color||
ElementColors[n.elem]||z,n.oa=d,n.clickable&&(n.e={sphere:[],j:[],line:[],i:[]})};this.atomIsSelected=function(a,b){if("undefined"===typeof b)return!0;var c=!!b.$a,e=!0,f;for(f in b)if(b.hasOwnProperty(f)&&"props"!=f&&"invert"!=f&&"model"!=f){if("undefined"===typeof a[f]){e=!1;break}var d=!1;if($.isArray(b[f])){for(var u=b[f],m=0;m<u.length;m++)if(a[f]==u[m]){d=!0;break}if(!d){e=!1;break}}else if(a[f]!=b[f]){e=!1;break}}return c?!e:e};this.selectedAtoms=function(a){for(var c=[],e=0;e<b.length;e++){var f=
b[e];f&&this.atomIsSelected(f,a)&&c.push(f)}return c};this.addAtoms=function(a){u=null;var c=b.length,e=[],f;for(f=0;f<a.length;f++)e[a[f].index]=c+f;for(f=0;f<a.length;f++){var c=a[f],d=e[c.index],n=$.extend(!1,{},c);n.index=d;n.bonds=[];n.bondOrder=[];for(d=0;d<c.bonds.length;d++){var g=e[c.bonds[d]];"undefined"!=typeof g&&(n.bonds.push(g),n.bondOrder.push(c.bondOrder[d]))}b.push(n)}};this.removeAtoms=function(a){u=null;var c=[],e;for(e=0;e<a.length;e++)c[a[e].index]=!0;a=[];for(e=0;e<b.length;e++){var f=
b[e];c[f.index]||a.push(f)}b=[];this.addAtoms(a)};this.setStyle=function(a,b,c){if(c||null===u||!t(b,n)){n=c?null:b;a=this.selectedAtoms(a);0<a.length&&(u=null);b=$.extend(!0,{},b);for(var e=0;e<a.length;e++){a[e].clickable&&(a[e].e={sphere:[],j:[],line:[],i:[]});a[e].Q=!1;c||(a[e].style={});for(var f in b)b.hasOwnProperty(f)&&(a[e].style[f]=b[f])}}};this.setColorByElement=function(a,b){if(null===u||!t(b,y)){y=b;var c=this.selectedAtoms(a);0<c.length&&(u=null);for(var e=0;e<c.length;e++){var f=c[e];
"undefined"!==typeof b[f.elem]&&(f.color=b[f.elem])}}};this.setColorByProperty=function(a,b,c){a=this.selectedAtoms(a);y=null;0<a.length&&(u=null);var e=Number.POSITIVE_INFINITY,f=Number.NEGATIVE_INFINITY,d,n;for(d=0;d<a.length;d++)n=a[d],n.properties&&void 0!==typeof n.properties[b]&&(n=parseFloat(n.properties[b]),n<e&&(e=n),n>f&&(f=n));for(d=0;d<a.length;d++)if(n=a[d],n.properties&&void 0!==typeof n.properties[b]){var m=c.valueToHex(parseFloat(n.properties[b]),[e,f]);n.color=m}};this.globj=function(c){var n=
new Date;if(null===u){var g=b;console.log("creating for "+d);var p=new WebMol.Object3D,s=[],t={},r={},m=new WebMol.Geometry(!0),h=new WebMol.Geometry(!0),z,y;z=0;for(y=g.length;z<y;z++){var w=g[z];if(w&&w.style){w.clickable&&void 0===w.e&&(w.e={sphere:[],j:[],line:[],i:[]});f(w,m);var l=w,v=r;if(l.style.cross){var A=l.style.cross;if(!A.hidden){var G=A.linewidth||1;v[G]||(v[G]=new WebMol.Geometry);v=v[G].updateGeoGroup(6);A=a(l,A);A=[[A,0,0],[-A,0,0],[0,A,0],[0,-A,0],[0,0,A],[0,0,-A]];(G=l.clickable)&&
void 0===l.e&&(l.e={sphere:[],j:[],line:[]});for(var D=WebMol.m.color(l.color),B=0;6>B;B++){var C=3*v.vertices;v.vertices++;v.__vertexArray[C]=l.x+A[B][0];v.__vertexArray[C+1]=l.y+A[B][1];v.__vertexArray[C+2]=l.z+A[B][2];v.__colorArray[C]=D.r;v.__colorArray[C+1]=D.g;v.__colorArray[C+2]=D.b;G&&(C=new WebMol.Vector3(A[B][0],A[B][1],A[B][2]),C.multiplyScalar(.1),C.set(C.x+l.x,C.y+l.y,C.z+l.z),l.e.line.push(C))}}}l=w;v=g;A=t;if(l.style.line&&(G=l.style.line,!G.hidden))for(G=G.linewidth||1,A[G]||(A[G]=
new WebMol.Geometry),A=A[G].updateGeoGroup(2*l.bonds.length),G=0;G<l.bonds.length;G++)if(B=v[l.bonds[G]],B.style.line){D=new WebMol.Vector3(l.x,l.y,l.z);B=new WebMol.Vector3(B.x,B.y,B.z);B=D.clone().add(B).multiplyScalar(.5);l.clickable&&(void 0===l.e&&(l.e={sphere:[],j:[],line:[],i:[]}),l.e.line.push(D),l.e.line.push(B));var C=WebMol.m.color(l.color),J=3*A.vertices;A.vertices+=2;A.__vertexArray[J]=D.x;A.__vertexArray[J+1]=D.y;A.__vertexArray[J+2]=D.z;A.__colorArray[J]=C.r;A.__colorArray[J+1]=C.g;
A.__colorArray[J+2]=C.b;A.__vertexArray[J+3]=B.x;A.__vertexArray[J+4]=B.y;A.__vertexArray[J+5]=B.z;A.__colorArray[J+3]=C.r;A.__colorArray[J+4]=C.g;A.__colorArray[J+5]=C.b}l=w;D=g;v=h;if(l.style.stick&&(B=l.style.stick,!B.hidden)){A=B.l||.25;J=C=!1;G=l.color;"undefined"!=typeof B.color&&(G=B.color);var V=WebMol.m.color(G),L=void 0,I=void 0;!l.Q&&4>l.bonds.length&&(C=!0);for(var U=0;U<l.bonds.length;U++){var O=D[l.bonds[U]];if(l.serial<O.serial&&O.style.stick){var T=new WebMol.Vector3(l.x,l.y,l.z),
Z=new WebMol.Vector3(O.x,O.y,O.z),L=O.color;"undefined"!=typeof B.color&&(L=B.color);var ea=WebMol.m.color(L);if(1===l.bondOrder[U]){if(!O.Q&&4>O.bonds.length&&(J=!0),G!=L?(L=(new WebMol.Vector3).addVectors(T,Z).multiplyScalar(.5),e(v,T,L,A,V,C,!1),e(v,L,Z,A,ea,!1,J)):e(v,T,Z,A,V,C,J),l.clickable||O.clickable)L=(new WebMol.Vector3).addVectors(T,Z).multiplyScalar(.5),l.clickable&&(ea=new WebMol.Cylinder(T.clone(),L.clone(),A),T=new WebMol.Sphere(T.clone(),A),l.e.j.push(ea),l.e.sphere.push(T)),O.clickable&&
(T=new WebMol.Cylinder(Z.clone(),L.clone(),A),Z=new WebMol.Sphere(Z.clone(),A),O.e.j.push(T),O.e.sphere.push(Z))}else if(1<l.bondOrder[U]){var J=C=!1,I=Z.clone(),Q=null;I.sub(T);var K,Y,W,aa;1===l.bonds.length?1===O.bonds.length?(Q=I.clone(),1E-4<Math.abs(Q.x)?Q.y+=1:Q.x+=1):(K=(U+1)%O.bonds.length,K=O.bonds[K],K=D[K],K=new WebMol.Vector3(K.x,K.y,K.z),K=K.clone(),K.sub(T),Q=K.clone(),Q.cross(I)):(K=(U+1)%l.bonds.length,K=l.bonds[K],K=D[K],K=new WebMol.Vector3(K.x,K.y,K.z),K=K.clone(),K.sub(T),Q=K.clone(),
Q.cross(I));if(2==l.bondOrder[U]){if(K=A/2.5,Q.cross(I),Q.normalize(),Q.multiplyScalar(1.5*K),Y=T.clone(),Y.add(Q),W=T.clone(),W.sub(Q),Q=Y.clone(),Q.add(I),aa=W.clone(),aa.add(I),G!=L?(L=(new WebMol.Vector3).addVectors(Y,Q).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),e(v,Y,L,K,V,C,!1),e(v,L,Q,K,ea,!1,J),e(v,W,I,K,V,C,!1),e(v,I,aa,K,ea,!1,J)):(e(v,Y,Q,K,V,C,J),e(v,W,aa,K,V,C,J)),l.clickable||O.clickable)L=(new WebMol.Vector3).addVectors(Y,Q).multiplyScalar(.5),I=
(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),l.clickable&&(ea=new WebMol.Cylinder(Y.clone(),L.clone(),K),W=new WebMol.Cylinder(W.clone(),I.clone(),K),l.e.j.push(ea),l.e.j.push(W)),O.clickable&&(cylinder2a=new WebMol.Cylinder(Q.clone(),L.clone(),K),cylinder2b=new WebMol.Cylinder(aa.clone(),I.clone(),K),O.e.j.push(cylinder2a),O.e.j.push(cylinder2b))}else 3==l.bondOrder[U]&&(K=A/4,Q.cross(I),Q.normalize(),Q.multiplyScalar(3*K),Y=T.clone(),Y.add(Q),W=T.clone(),W.sub(Q),Q=Y.clone(),Q.add(I),
aa=W.clone(),aa.add(I),G!=L?(L=(new WebMol.Vector3).addVectors(Y,Q).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(T,Z).multiplyScalar(.5),e(v,Y,L,K,V,C,!1),e(v,L,Q,K,ea,!1,J),e(v,T,mp3,K,V,C,!1),e(v,mp3,Z,K,ea,!1,J),e(v,W,I,K,V,C,!1),e(v,I,aa,K,ea,!1,J)):(e(v,Y,Q,K,V,C,J),e(v,T,Z,K,V,C,J),e(v,W,aa,K,V,C,J)),l.clickable||O.clickable)&&(L=(new WebMol.Vector3).addVectors(Y,Q).multiplyScalar(.5),I=(new WebMol.Vector3).addVectors(W,aa).multiplyScalar(.5),
mp3=(new WebMol.Vector3).addVectors(T,Z).multiplyScalar(.5),l.clickable&&(ea=new WebMol.Cylinder(Y.clone(),L.clone(),K),W=new WebMol.Cylinder(W.clone(),I.clone(),K),T=new WebMol.Cylinder(T.clone(),mp3.clone(),K),l.e.j.push(ea),l.e.j.push(W),l.e.j.push(T)),O.clickable&&(cylinder2a=new WebMol.Cylinder(Q.clone(),L.clone(),K),cylinder2b=new WebMol.Cylinder(aa.clone(),I.clone(),K),cylinder2c=new WebMol.Cylinder(Z.clone(),mp3.clone(),K),O.e.j.push(cylinder2a),O.e.j.push(cylinder2b),O.e.j.push(cylinder2c)))}if(J||
3<O.bonds.length)O.Q=!0;if(C||3<l.bonds.length)l.Q=!0}}if(!l.singleBonds&&1===l.bonds.length||!l.bonds.length)D=l.style,l.style={sphere:{l:A,color:G}},f(l,v),l.style=D}"undefined"===typeof w.style.cartoon||w.style.cartoon.hidden||s.push(w)}}if(0<s.length)for(WebMol.Ha(p,s,!1),z=0;z<p.children.length;z++);0<m.vertices&&(g=new WebMol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),m.initTypedArrays(),g=new WebMol.Mesh(m,g),console.log("sphere geometry "+m.vertices.length),p.add(g));
0<h.vertices&&(m=new WebMol.MeshLambertMaterial({vertexColors:!0,ambient:0,reflectivity:0}),h.initTypedArrays(),m.wireframe&&h.setUpWireframe(),h=new WebMol.Mesh(h,m),p.add(h));for(z in t)t.hasOwnProperty(z)&&(h=z,h=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),t[z].initTypedArrays(),h=new WebMol.Line(t[z],h,WebMol.LinePieces),p.add(h));for(z in r)r.hasOwnProperty(z)&&(h=z,t=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),r[z].initTypedArrays(),t=new WebMol.Line(r[z],t,WebMol.LinePieces),
p.add(t));u=p;console.log("object creation time: "+(new Date-n));x&&(c.remove(x),x=null);x=u.clone();c.add(x)}};this.removegl=function(a){x&&(void 0!==x.geometry&&x.geometry.dispose(),void 0!==x.material&&x.material.dispose(),a.remove(x),x=null);u=null}}}();
WebMol.v=function(){function g(g,r){r=r||{};WebMol.Da++;this.id=g;this.p=new WebMol.Sphere;this.e={sphere:[],j:[],line:[],i:[]};B(this,r);var s=[],d=null,c=null,e=new WebMol.Geometry(!0);this.Xa=function(c){for(var a in c)r[a]=c[a];B(this,r)};this.addCustom=function(c){c.fa=c.fa||[];c.Z=c.Z||[];c.ea=c.ea||[];c.da=c.da||[];var a=e.addGeoGroup();C(this,a,c);a.truncateArrayBuffers(!0);for(c=0;c<a.__colorArray.length/3;++c)a.__colorArray[3*c]=this.color.r,a.__colorArray[3*c+1]=this.color.g,a.__colorArray[3*
c+2]=this.color.b;s.push({id:a.id,ba:a,R:a.getCentroid()});D(this.p,s,a.__vertexArray)};this.addSphere=function(c){c.center=c.center||{x:0,y:0,z:0};c.l=c.l?WebMol.Math.clamp(c.l,0,Infinity):1.5;var a=e.addGeoGroup(),b=c.center,d=c.l,g=new WebMol.Vector3(b.x,b.y,b.z);this.e.sphere.push(new WebMol.Sphere(g,d));var n;n=v.D(d);for(var g=n.vertices,t=n.s,r=a.vertices,G=0,p=g.length;G<p;++G){var B=3*(r+G),w=g[G];a.__vertexArray[B]=w.x+b.x;a.__vertexArray[B+1]=w.y+b.y;a.__vertexArray[B+2]=w.z+b.z}a.vertices+=
g.length;G=n.t;p=G.length-1;for(n=0;n<p;n++)for(B=G[n].length-1,b=0;b<B;b++){var w=a.faceidx,q=a.lineidx,F=G[n][b+1]+r,C=3*F,N=G[n][b]+r,H=3*N,M=G[n+1][b]+r,S=3*M,m=G[n+1][b+1]+r,h=3*m,E=t[F-r],X=t[N-r],R=t[M-r],l=t[m-r];Math.abs(g[F-r].y)===d?(a.__normalArray[C]=E.x,a.__normalArray[S]=R.x,a.__normalArray[h]=l.x,a.__normalArray[C+1]=E.y,a.__normalArray[S+1]=R.y,a.__normalArray[h+1]=l.y,a.__normalArray[C+2]=E.z,a.__normalArray[S+2]=R.z,a.__normalArray[h+2]=l.z,a.__faceArray[w]=F,a.__faceArray[w+1]=
M,a.__faceArray[w+2]=m,a.__lineArray[q]=F,a.__lineArray[q+1]=M,a.__lineArray[q+2]=F,a.__lineArray[q+3]=m,a.__lineArray[q+4]=M,a.__lineArray[q+5]=m,a.faceidx+=3,a.lineidx+=6):Math.abs(g[M-r].y)===d?(a.__normalArray[C]=E.x,a.__normalArray[H]=X.x,a.__normalArray[S]=R.x,a.__normalArray[C+1]=E.y,a.__normalArray[H+1]=X.y,a.__normalArray[S+1]=R.y,a.__normalArray[C+2]=E.z,a.__normalArray[H+2]=X.z,a.__normalArray[S+2]=R.z,a.__faceArray[w]=F,a.__faceArray[w+1]=N,a.__faceArray[w+2]=M,a.__lineArray[q]=F,a.__lineArray[q+
1]=N,a.__lineArray[q+2]=F,a.__lineArray[q+3]=M,a.__lineArray[q+4]=N,a.__lineArray[q+5]=M,a.faceidx+=3,a.lineidx+=6):(a.__normalArray[C]=E.x,a.__normalArray[H]=X.x,a.__normalArray[h]=l.x,a.__normalArray[C+1]=E.y,a.__normalArray[H+1]=X.y,a.__normalArray[h+1]=l.y,a.__normalArray[C+2]=E.z,a.__normalArray[H+2]=X.z,a.__normalArray[h+2]=l.z,a.__normalArray[H]=X.x,a.__normalArray[S]=R.x,a.__normalArray[h]=l.x,a.__normalArray[H+1]=X.y,a.__normalArray[S+1]=R.y,a.__normalArray[h+1]=l.y,a.__normalArray[H+2]=
X.z,a.__normalArray[S+2]=R.z,a.__normalArray[h+2]=l.z,a.__faceArray[w]=F,a.__faceArray[w+1]=N,a.__faceArray[w+2]=m,a.__faceArray[w+3]=N,a.__faceArray[w+4]=M,a.__faceArray[w+5]=m,a.__lineArray[q]=F,a.__lineArray[q+1]=N,a.__lineArray[q+2]=F,a.__lineArray[q+3]=m,a.__lineArray[q+4]=N,a.__lineArray[q+5]=M,a.__lineArray[q+6]=M,a.__lineArray[q+7]=m,a.faceidx+=6,a.lineidx+=8)}a.truncateArrayBuffers(!0);s.push({id:a.id,ba:a,R:new WebMol.Vector3(c.center.x,c.center.y,c.center.z)});D(this.p,s,a.__vertexArray)};
this.addArrow=function(c){c.start=c.start||{};c.end=c.end||{};c.start=new WebMol.Vector3(c.start.x||0,c.start.y||0,c.start.z||0);c.end=new WebMol.Vector3(c.end.x||3,c.end.y||0,c.end.z||0);c.l=c.l||.25;c.sa=c.sa||1.618034;c.W=0<c.W&&1>c.W?c.W:.618034;var a=e.addGeoGroup(),b=c.start,d=c.end,g=c.l,n=c.sa,t=c.W;if(b&&d){var r=d.clone();r.sub(b).multiplyScalar(t);var v=b.clone().add(r),t=r.clone().negate();this.e.j.push(new WebMol.Cylinder(b.clone(),v.clone(),g));this.e.sphere.push(new WebMol.Sphere(b.clone(),
g));var p=[];p[0]=r.clone();1E-4<Math.abs(p[0].x)?p[0].y+=1:p[0].x+=1;p[0].cross(r);p[0].normalize();p[0]=p[0];p[4]=p[0].clone();p[4].crossVectors(p[0],r);p[4].normalize();p[8]=p[0].clone().negate();p[12]=p[4].clone().negate();p[2]=p[0].clone().add(p[4]).normalize();p[6]=p[4].clone().add(p[8]).normalize();p[10]=p[8].clone().add(p[12]).normalize();p[14]=p[12].clone().add(p[0]).normalize();p[1]=p[0].clone().add(p[2]).normalize();p[3]=p[2].clone().add(p[4]).normalize();p[5]=p[4].clone().add(p[6]).normalize();
p[7]=p[6].clone().add(p[8]).normalize();p[9]=p[8].clone().add(p[10]).normalize();p[11]=p[10].clone().add(p[12]).normalize();p[13]=p[12].clone().add(p[14]).normalize();p[15]=p[14].clone().add(p[0]).normalize();var B=a.vertices,w,q,C;q=0;for(C=p.length;q<C;++q){w=3*(B+3*q);var P=p[q].clone().multiplyScalar(g).add(b),N=p[q].clone().multiplyScalar(g).add(v),H=p[q].clone().multiplyScalar(g*n).add(v);a.__vertexArray[w]=P.x;a.__vertexArray[w+1]=P.y;a.__vertexArray[w+2]=P.z;a.__vertexArray[w+3]=N.x;a.__vertexArray[w+
4]=N.y;a.__vertexArray[w+5]=N.z;a.__vertexArray[w+6]=H.x;a.__vertexArray[w+7]=H.y;a.__vertexArray[w+8]=H.z;0<q&&(w=new WebMol.Vector3(a.__vertexArray[w-3],a.__vertexArray[w-2],a.__vertexArray[w-1]),P=d.clone(),N=v.clone(),H=new WebMol.Vector3(H.x,H.y,H.z),this.e.i.push(new WebMol.Triangle(H,P,w)),this.e.i.push(new WebMol.Triangle(w.clone(),N,H.clone())))}a.vertices+=48;w=3*a.vertices;a.__vertexArray[w]=b.x;a.__vertexArray[w+1]=b.y;a.__vertexArray[w+2]=b.z;a.__vertexArray[w+3]=v.x;a.__vertexArray[w+
4]=v.y;a.__vertexArray[w+5]=v.z;a.__vertexArray[w+6]=d.x;a.__vertexArray[w+7]=d.y;a.__vertexArray[w+8]=d.z;a.vertices+=3;var M,S,m,h,E,X,R,l,ba,A=a.vertices-3,ia=a.vertices-2,ga=a.vertices-1,ha=3*A,ja=3*ia,da=3*ga;q=0;for(C=p.length-1;q<C;++q)M=B+3*q,b=a.faceidx,d=a.lineidx,g=M,P=3*g,n=M+1,N=3*n,v=M+2,S=3*v,H=M+4,m=3*H,w=M+5,h=3*w,M+=3,E=3*M,X=R=p[q],l=ba=p[q+1],a.__normalArray[P]=X.x,a.__normalArray[N]=R.x,a.__normalArray[E]=ba.x,a.__normalArray[P+1]=X.y,a.__normalArray[N+1]=R.y,a.__normalArray[E+
1]=ba.y,a.__normalArray[P+2]=X.z,a.__normalArray[N+2]=R.z,a.__normalArray[E+2]=ba.z,a.__normalArray[N]=R.x,a.__normalArray[m]=l.x,a.__normalArray[E]=ba.x,a.__normalArray[N+1]=R.y,a.__normalArray[m+1]=l.y,a.__normalArray[E+1]=ba.y,a.__normalArray[N+2]=R.z,a.__normalArray[m+2]=l.z,a.__normalArray[E+2]=ba.z,a.__normalArray[S]=R.x,a.__normalArray[h]=l.x,a.__normalArray[S+1]=R.y,a.__normalArray[h+1]=l.y,a.__normalArray[S+2]=R.z,a.__normalArray[h+2]=l.z,a.__faceArray[b]=g,a.__faceArray[b+1]=n,a.__faceArray[b+
2]=M,a.__faceArray[b+3]=n,a.__faceArray[b+4]=H,a.__faceArray[b+5]=M,a.__faceArray[b+6]=g,a.__faceArray[b+7]=M,a.__faceArray[b+8]=A,a.__faceArray[b+9]=v,a.__faceArray[b+10]=ia,a.__faceArray[b+11]=w,a.__faceArray[b+12]=v,a.__faceArray[b+13]=ga,a.__faceArray[b+14]=w,a.__lineArray[d]=g,a.__lineArray[d+1]=n,a.__lineArray[d+2]=g,a.__lineArray[d+3]=M,a.__lineArray[d+4]=H,a.__lineArray[d+5]=M,a.__lineArray[d+6]=g,a.__lineArray[d+7]=M,a.__lineArray[d+8]=v,a.__lineArray[d+9]=n,a.__lineArray[d+10]=v,a.__lineArray[d+
11]=w,a.__lineArray[d+12]=H,a.__lineArray[d+13]=w,a.__lineArray[d+14]=v,a.__lineArray[d+15]=ga,a.__lineArray[d+16]=v,a.__lineArray[d+17]=w,a.__lineArray[d+18]=ga,a.__lineArray[d+19]=w,a.faceidx+=15,a.lineidx+=20;B=[B+45,B+46,B+1,B,B+47,B+2];b=a.faceidx;d=a.lineidx;g=B[0];P=3*g;n=B[1];N=3*n;v=B[4];S=3*v;H=B[2];m=3*H;w=B[5];h=3*w;M=B[3];E=3*M;X=R=p[15];l=ba=p[0];a.__normalArray[P]=X.x;a.__normalArray[N]=R.x;a.__normalArray[E]=ba.x;a.__normalArray[P+1]=X.y;a.__normalArray[N+1]=R.y;a.__normalArray[E+
1]=ba.y;a.__normalArray[P+2]=X.z;a.__normalArray[N+2]=R.z;a.__normalArray[E+2]=ba.z;a.__normalArray[N]=R.x;a.__normalArray[m]=l.x;a.__normalArray[E]=ba.x;a.__normalArray[N+1]=R.y;a.__normalArray[m+1]=l.y;a.__normalArray[E+1]=ba.y;a.__normalArray[N+2]=R.z;a.__normalArray[m+2]=l.z;a.__normalArray[E+2]=ba.z;a.__normalArray[S]=R.x;a.__normalArray[h]=l.x;a.__normalArray[S+1]=R.y;a.__normalArray[h+1]=l.y;a.__normalArray[S+2]=R.z;a.__normalArray[h+2]=l.z;r.normalize();t.normalize();a.__normalArray[ha]=t.x;
a.__normalArray[ja]=a.__normalArray[da]=r.x;a.__normalArray[ha+1]=t.y;a.__normalArray[ja+1]=a.__normalArray[da+1]=r.y;a.__normalArray[ha+2]=t.z;a.__normalArray[ja+2]=a.__normalArray[da+2]=r.z;a.__faceArray[b]=g;a.__faceArray[b+1]=n;a.__faceArray[b+2]=M;a.__faceArray[b+3]=n;a.__faceArray[b+4]=H;a.__faceArray[b+5]=M;a.__faceArray[b+6]=g;a.__faceArray[b+7]=M;a.__faceArray[b+8]=A;a.__faceArray[b+9]=v;a.__faceArray[b+10]=ia;a.__faceArray[b+11]=w;a.__faceArray[b+12]=v;a.__faceArray[b+13]=ga;a.__faceArray[b+
14]=w;a.__lineArray[d]=g;a.__lineArray[d+1]=n;a.__lineArray[d+2]=g;a.__lineArray[d+3]=M;a.__lineArray[d+4]=H;a.__lineArray[d+5]=M;a.__lineArray[d+6]=g;a.__lineArray[d+7]=M;a.__lineArray[d+8]=v;a.__lineArray[d+9]=n;a.__lineArray[d+10]=v;a.__lineArray[d+11]=w;a.__lineArray[d+12]=H;a.__lineArray[d+13]=w;a.__lineArray[d+14]=v;a.__lineArray[d+15]=ga;a.__lineArray[d+16]=v;a.__lineArray[d+17]=w;a.__lineArray[d+18]=ga;a.__lineArray[d+19]=w;a.faceidx+=15;a.lineidx+=20}a.truncateArrayBuffers(!0);r=new WebMol.Vector3;
s.push({id:a.id,ba:a,R:r.addVectors(c.start,c.end).multiplyScalar(.5)});D(this.p,s,a.__vertexArray)};this.addVolumetricData=function(c,a,b){var d=void 0!==b.ka&&"number"===typeof b.ka?b.ka:0,g=b.xa?!0:!1,n=e.addGeoGroup();switch(a){case "cube":var r=c.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>r.length)){var t=r[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),v=Math.abs(parseFloat(t[0]));c=new WebMol.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]));var t=r[3].replace(/^\s+/,"").replace(/\s+/g,
" ").split(" "),p=0<parseFloat(t[0])?.529177:1;c.multiplyScalar(p);a=Math.abs(t[0]);var B=(new WebMol.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]))).multiplyScalar(p),t=r[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),w=Math.abs(t[0]);(new WebMol.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]))).multiplyScalar(p);var t=r[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),q=Math.abs(t[0]);(new WebMol.Vector3(parseFloat(t[1]),parseFloat(t[2]),parseFloat(t[3]))).multiplyScalar(p);
r=new Float32Array(r.splice(v+7).join(" ").replace(/^\s+/,"").split(/[\s\r]+/));t=new Int16Array(a*w*q);v=0;for(p=t.length;v<p;++v)t[v]=-1;t=new Uint8Array(a*w*q);v=0;for(p=r.length;v<p;++v)0<(0<=d?r[v]-d:d-r[v])&&(t[v]|=2);d=[];r=[];WebMol.L.ma(t,d,r,{Qa:!0,xa:g,scale:B.length(),origin:c,pa:a,qa:w,ra:q});g||WebMol.L.la(10,d,r);C(this,n,{fa:d,Z:r,ea:[],da:[]})}}s.push({id:n.id,ba:n,R:n.getCentroid()});this.Xa(b);D(this.p,s,n.__vertexArray)};this.globj=function(f){e.initTypedArrays();var a=this.color,
a=a||WebMol.m.color(a);e.colorsNeedUpdate=!0;for(var b in e.geometryGroups)for(var g=e.geometryGroups[b],t=g.__colorArray,n=0,g=g.vertices;n<g;++n)t[3*n]=a.r,t[3*n+1]=a.g,t[3*n+2]=a.b;d=new WebMol.Object3D;b=new WebMol.MeshLambertMaterial({wireframe:this.wireframe,vertexColors:!0,ambient:0,reflectivity:0,side:this.side,transparent:1>this.alpha?!0:!1,opacity:this.alpha});b=new WebMol.Mesh(e,b);d.add(b);c&&(f.remove(c),c=null);c=d.clone();f.add(c)}}function B(g,r){g.color=r.color||new WebMol.Color;
g.wireframe=r.wireframe?!0:!1;g.alpha=r.alpha?WebMol.Math.clamp(r.alpha,0,1):1;g.side=void 0!==r.side?r.side:WebMol.DoubleSide;g.clickable=r.clickable?!0:!1;g.callback="function"===typeof r.callback?r.callback:null}function D(g,r,s){g.center.set(0,0,0);var d,c;if(0<r.length){d=0;for(c=r.length;d<c;++d)g.center.add(r[d].R);g.center.divideScalar(r.length)}r=g.l*g.l;d=0;for(c=s.length/3;d<c;d++){var e=g.center.distanceToSquared({x:s[3*d],y:s[3*d+1],z:s[3*d+2]});r=Math.max(r,e)}g.l=Math.sqrt(r)}function C(g,
r,s){var d=s.fa,c=s.ea,e=s.Z;s=s.da;0!==d.length&&0!==e.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");r.vertices=d.length;r.faceidx=e.length;var f,a,b,u,v;u=0;for(v=r.vertices;u<v;++u)f=3*u,a=d[u],r.__vertexArray[f]=a.x,r.__vertexArray[f+1]=a.y,r.__vertexArray[f+2]=a.z;u=0;for(v=r.faceidx/3;u<v;++u){f=3*u;a=e[f];b=e[f+1];f=e[f+2];var n=new WebMol.Vector3,y=new WebMol.Vector3,z=new WebMol.Vector3;g.e.i.push(new WebMol.Triangle(n.copy(d[a]),y.copy(d[b]),
z.copy(d[f])))}r.__faceArray=new Uint16Array(e);r.truncateArrayBuffers(!0);if(c.length<r.vertices)r.setNormals();else for(r.__normalArray=new Float32Array(3*r.vertices),u=0,v=r.vertices;u<v;++u)f=3*u,g=c[u],r.__normalArray[f]=g.x,r.__normalArray[f+1]=g.y,r.__normalArray[f+2]=g.z;s.length?r.__lineArray=new Uint16Array(s):r.setLineIndices();r.lineidx=r.__lineArray.length}var v={k:{},D:function(g){if("undefined"!==typeof this.k[g])return this.k[g];var r={vertices:[],t:[],s:[]},s=16,d=10;1>g&&(s=8,d=
6);var c=2*Math.PI,e=Math.PI,f,a;for(a=0;a<=d;a++){var b=[];for(f=0;f<=s;f++){var u=f/s,v=a/d,n={};n.x=-g*Math.cos(0+u*c)*Math.sin(0+v*e);n.y=g*Math.cos(0+v*e);n.z=g*Math.sin(0+u*c)*Math.sin(0+v*e);u=new WebMol.Vector3(n.x,n.y,n.z);u.normalize();r.vertices.push(n);r.s.push(u);b.push(r.vertices.length-1)}r.t.push(b)}return this.k[g]=r}};Object.defineProperty(g.prototype,"position",{get:function(){return this.p.center}});Object.defineProperty(g.prototype,"x",{get:function(){return this.p.center.x}});
Object.defineProperty(g.prototype,"y",{get:function(){return this.p.center.y}});Object.defineProperty(g.prototype,"z",{get:function(){return this.p.center.z}});return g}();WebMol.Da=0;WebMol.za=0;function ma(g,B){this.id=WebMol.za++;this.h=B||{};this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.n=new WebMol.Sprite;this.text=g}ma.prototype={dispose:function(){void 0!==this.n.material.map&&this.n.material.map.dispose();void 0!==this.n.material&&this.n.material.dispose()}};
function na(g){g.font=g.h.font=g.h.font?g.h.font:"Arial";g.fontSize=g.h.fontSize=g.h.fontSize?g.h.fontSize:20;g.q=g.h.q=g.h.q?g.h.q:{r:255,g:255,b:255,u:1};g.o=g.h.o=g.h.o?g.h.o:4;g.borderColor=g.h.borderColor=g.h.borderColor?g.h.borderColor:{r:0,g:0,b:0,u:1};g.backgroundColor=g.h.backgroundColor=g.h.backgroundColor?g.h.backgroundColor:{r:0,g:0,b:0,u:1};g.position=g.h.position=g.h.position?g.h.position:{x:-10,y:1,z:1};g.U=g.h.U=void 0!==g.h.U?g.h.U:!0;g.context.clearRect(0,0,g.canvas.width,g.canvas.height);
var B=WebMol.SpriteAlignment.topLeft;g.context.font=g.fontSize+"pt "+g.font;var D=g.context.measureText(g.text).width;g.context.fillStyle="rgba("+g.backgroundColor.r+","+g.backgroundColor.g+","+g.backgroundColor.b+","+g.backgroundColor.u+")";g.context.strokeStyle="rgba("+g.borderColor.r+","+g.borderColor.g+","+g.borderColor.b+","+g.borderColor.u+")";g.context.lineWidth=g.o;roundRect(g.context,g.o/2,g.o/2,D+g.o,1.4*g.fontSize+g.o,6);g.context.fillStyle="rgba("+g.q.r+","+g.q.g+","+g.q.b+","+g.q.u+")";
g.context.fillText(g.text,g.o,g.fontSize+g.o,D);D=new WebMol.Texture(g.canvas);D.needsUpdate=!0;g.n.material=new WebMol.SpriteMaterial({map:D,useScreenCoordinates:!1,alignment:B,depthTest:!g.U});g.n.scale.set(2*g.fontSize,g.fontSize,1);g.n.position.set(g.position.x,g.position.y,g.position.z)}
WebMol.GLViewer=function(){function g(g){var D,C,v,t,r,s,d,c,e,f;D=C=v=9999;t=r=s=-9999;d=c=e=f=0;if(0===g.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var a=0;a<g.length;a++){var b=g[a];void 0!==b&&(f++,d+=b.x,c+=b.y,e+=b.z,D=D<b.x?D:b.x,C=C<b.y?C:b.y,v=v<b.z?v:b.z,t=t>b.x?t:b.x,r=r>b.y?r:b.y,s=s>b.z?s:b.z)}return[[D,C,v],[t,r,s],[d/f,c/f,e/f]]}return function(B,D,C){function v(a,c,b,e,d,g){var f=new Date,h=new WebMol.Aa;h.Ta(c,1===a?!1:!0,g);g=new Date;console.log("initialize "+(g-f)+"ms");h.Oa(d,
b);c=new Date;console.log("fillvoxels "+(c-g)+"  "+(c-f)+"ms");h.Fa();a==WebMol.SurfaceType.SES&&(h.Ja(),h.ia(!1),h.Pa(d,b));b=new Date;console.log("buildboundaryetc "+(b-c)+"  "+(b-f)+"ms");h.Ua(a);a=new Date;console.log("marching cube "+(a-b)+"  "+(a-f)+"ms");return h.Ra(e)}function t(a,c,b){var e=new WebMol.Geometry(!0),d=e.updateGeoGroup(0),g=c.vertices,f,h,n;h=0;for(n=g.length;h<n;h++)f=3*d.vertices,d.__vertexArray[f]=g[h].x,d.__vertexArray[f+1]=g[h].y,d.__vertexArray[f+2]=g[h].z,d.vertices++;
c=c.faces;d.faceidx=c.length;e.initTypedArrays();f=[];h=0;for(n=a.length;h<n;h++){var m=a[h];m&&("undefined"!=typeof m.surfaceColor?f[h]=WebMol.m.color(m.surfaceColor):m.color&&(f[h]=WebMol.m.color(m.color)))}a=d.__vertexArray;var l,q,p;h=0;for(n=c.length;h<n;h+=3){l=h;var m=c[h],r=c[h+1],s=c[h+2];q=g[m].atomid;p=g[r].atomid;var t=g[s].atomid,m=3*m,r=3*r,s=3*s;d.__faceArray[l]=c[h].u;d.__faceArray[l+1]=c[h].b;d.__faceArray[l+2]=c[h].Ya;d.__colorArray[m]=f[q].r;d.__colorArray[m+1]=f[q].g;d.__colorArray[m+
2]=f[q].b;d.__colorArray[r]=f[p].r;d.__colorArray[r+1]=f[p].g;d.__colorArray[r+2]=f[p].b;d.__colorArray[s]=f[t].r;d.__colorArray[s+1]=f[t].g;d.__colorArray[s+2]=f[t].b;l=new WebMol.Vector3(a[m],a[m+1],a[m+2]);q=new WebMol.Vector3(a[r],a[r+1],a[r+2]);p=new WebMol.Vector3(a[s],a[s+1],a[s+2]);p.subVectors(p,q);l.subVectors(l,q);p.cross(l);l=p;l.normalize();d.__normalArray[m]+=l.x;d.__normalArray[r]+=l.x;d.__normalArray[s]+=l.x;d.__normalArray[m+1]+=l.y;d.__normalArray[r+1]+=l.y;d.__normalArray[s+1]+=
l.y;d.__normalArray[m+2]+=l.z;d.__normalArray[r+2]+=l.z;d.__normalArray[s+2]+=l.z}d.__faceArray=new Uint16Array(c);b=new WebMol.Mesh(e,b);b.Za=!0;return b}function r(a,c,b){function e(a){if(64E3>s(a))return[a];var c=a[1][0]-a[0][0],b=a[1][1]-a[0][1],d=a[1][2]-a[0][2],b=c>b&&c>d?0:b>c&&b>d?1:2,d=g(a),c=g(a);a=(a[1][b]-a[0][b])/2+a[0][b];d[1][b]=a;c[0][b]=a;a=e(d);c=e(c);return a.concat(c)}function g(a){var c=[];c[0]=[a[0][0],a[0][1],a[0][2]];c[1]=[a[1][0],a[1][1],a[1][2]];return c}var f=[];a=e(a);
for(var h=0,m=a.length;h<m;h++){var l=g(a[h]);l[0][0]-=6;l[0][1]-=6;l[0][2]-=6;l[1][0]+=6;l[1][1]+=6;l[1][2]+=6;var l=d(c,l),n=d(b,a[h]);f.push({Y:a[h],ha:l,wa:n})}return f}function s(a){return(a[1][0]-a[0][0])*(a[1][1]-a[0][1])*(a[1][2]-a[0][2])}function d(a,c){for(var b=[],d=0;d<a.length;d++){var e=a[d];"undefined"!=typeof e&&(e.x<c[0][0]||e.x>c[1][0]||e.y<c[0][1]||e.y>c[1][1]||e.z<c[0][2]||e.z>c[1][2]||b.push(d))}return b}function c(){if(S){var a=F.position.z-m.position.z;1>a&&(a=1);F.near=a+X;
1>F.near&&(F.near=1);F.far=a+R;F.near+1>F.far&&(F.far=F.near+1);F instanceof WebMol.Camera?F.fov=20:(F.right=a*Math.tan(Math.PI/180*20),F.left=-F.right,F.top=F.right/w,F.bottom=-F.top);F.updateProjectionMatrix();S.fog.near=F.near+.4*(F.far-F.near);S.fog.far=F.far;q.render(S,F)}}function e(a){var c=[];"undefined"===typeof a&&(a={});var b=[],d;if("undefined"===typeof a.oa)for(d=0;d<n.length;d++)n[d]&&b.push(n[d]);else b=a.oa,$.isArray(b)||(b=[b]);for(d=0;d<b.length;d++)c=c.concat(b[d].selectedAtoms(a));
return c}function f(a,c,b,d){for(var e=0;e<n.length;e++)if(n[e])n[e][a](c,b,d)}function a(a){var c=new WebMol.MeshLambertMaterial;c.vertexColors=WebMol.VertexColors;for(var b in a)"color"===b?(c[b]=WebMol.m.color(a.color),delete c.vertexColors):"map"!==b&&a.hasOwnProperty(b)&&(c[b]=a[b]);void 0!==a.opacity&&(c.transparent=1===a.opacity?!1:!0);return c}function b(a,c){for(var b=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=0,g=a.length;e<g;e++){var f=a[e];f.properties&&"undefined"!=typeof f.properties[c]&&
(f=f.properties[c],f<b&&(b=f),f>d&&(d=f))}isFinite(b)||isFinite(d)?isFinite(b)?isFinite(d)||(d=b):b=d:b=d=0;return[b,d]}var u=this,x=B.id,n=[],y=[],z=[],G=B.width(),p=B.height(),J=$('<div class="glviewerSpinnerWrap" style = "position: absolute; width: 100%; height: 100%; display: table; z-index: 1;"><div class="glviewerSpinner" style="display: table-cell; text-align: center; vertical-align: middle; z-index:1"><img src="webmol/spinner.gif"></div></div>');$(B).append(J);J.hide();var w=G/p,q=new WebMol.Renderer({antialias:!0});
q.domElement.style.width="100%";q.domElement.style.height="100%";q.domElement.style.position="absolute";q.domElement.style.top="0px";q.domElement.style.zIndex="0";B.append(q.domElement);q.setSize(G,p);var F=new WebMol.Camera(20,w,1,800);F.position=new WebMol.Vector3(0,0,150);var P=new WebMol.Vector3;F.lookAt(P);var N=new WebMol.Raycaster(new WebMol.Vector3(0,0,0),new WebMol.Vector3(0,0,0)),H=new WebMol.Projector,M=new WebMol.Vector3(0,0,0),S=null,m=null,h=null,E=0,X=-50,R=50,l=new WebMol.Quaternion(0,
0,0,1),ba=new WebMol.Quaternion(0,0,0,1),A=!1,ia=0,ga=0,ha=0,ja=0,da=0,V=0;(function(){S=new WebMol.Scene;S.fog=new WebMol.Fog(E,100,200);h=new WebMol.Object3D;m=new WebMol.Object3D;m.useQuaternion=!0;m.quaternion=new WebMol.Quaternion(0,0,0,1);m.add(h);S.add(m);var a=new WebMol.Light(16777215);a.position=(new WebMol.Vector3(.2,.2,1)).normalize();a.intensity=1;S.add(a)})();q.setClearColorHex(E,1);S.fog.color=WebMol.m.color(E);P=$(q.domElement);P.bind("mousedown touchstart",function(a){a.preventDefault();
if(S){var b=a.pageX,d=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(b=a.originalEvent.targetTouches[0].pageX,d=a.originalEvent.targetTouches[0].pageY);if(void 0!==b){A=!0;mouseButton=a.which;ia=b;ga=d;l=m.quaternion;ja=m.position.z;ha=h.position.clone();da=X;V=R;a=b/$(window).width()*2-1;M.set(a,2*-(d/p)+1,-1);H.unprojectVector(M,F);M.sub(F.position).normalize();N.set(F.position,M);d=[];a=[];a=0;for(b=n.length;a<b;a++)var e=n[a].selectedAtoms({clickable:!0}),d=d.concat(e);
a=0;for(b=z.length;a<b;a++)e=z[a],e.clickable&&d.push(e);a=N.intersectObjects(h,d);a.length&&(d=a[0].clickable,void 0!==d.callback&&"function"===typeof d.callback&&d.callback(d,u));c()}}});P.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(S){var b=.85*(150-m.position.z);a.originalEvent.detail?m.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(m.position.z-=b*a.originalEvent.wheelDelta/400);c()}});P.bind("contextmenu",function(a){a.preventDefault()});$("body").bind("mouseup touchend",
function(){A=!1});P.bind("mousemove touchmove",function(a){a.preventDefault();if(S&&A){var b=0,d=$("input[name="+x+"_mouseMode]:checked");0<d.length&&(b=parseInt(d.val()));var d=a.pageX,e=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(d=a.originalEvent.targetTouches[0].pageX,e=a.originalEvent.targetTouches[0].pageY);if(void 0!==d){var d=(d-ia)/G,e=(e-ga)/p,g=Math.sqrt(d*d+e*e);3==b||3==mouseButton&&a.ctrlKey?(X=da+100*d,R=V+100*e):2==b||3==mouseButton||a.shiftKey?(a=.85*
(150-m.position.z),80>a&&(a=80),m.position.z=ja-e*a):1==b||2==mouseButton||a.ctrlKey?(a=.85*(150-m.position.z),20>a&&(a=20),a=new WebMol.Vector3(d*a,-e*a,0),b=m.quaternion,b=(new WebMol.Quaternion(b.x,b.y,b.z,b.w)).inverse().normalize(),a=a.applyQuaternion(b),h.position.x=ha.x+a.x,h.position.y=ha.y+a.y,h.position.z=ha.z+a.z):0!==b&&1!=mouseButton||0===g||(a=Math.sin(g*Math.PI)/g,ba.x=Math.cos(g*Math.PI),ba.y=0,ba.z=a*d,ba.w=-a*e,m.quaternion=new WebMol.Quaternion(1,0,0,0),m.quaternion.multiply(ba),
m.quaternion.multiply(l));c()}}});this.setBackgroundColor=function(a,b){E=a;q.setClearColorHex(a,b|1);S.fog.color=WebMol.m.color(a);c()};this.setWidth=function(a){G=a||G;q.setSize(G,p)};this.setHeight=function(a){p=a||p;q.setSize(G,p)};this.resize=function(){G=B.width();p=B.height();w=G/p;q.setSize(G,p);F.aspect=w;F.updateProjectionMatrix();c()};$(window).resize(this.resize);this.getModel=function(a){a=a||n.length-1;return n[a]};this.getView=function(){if(!h)return[0,0,0,0,0,0,0,1];var a=h.position,
c=m.quaternion;return[a.x,a.y,a.z,m.position.z,c.x,c.y,c.z,c.w]};this.setView=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&h&&m&&(h.position.x=a[0],h.position.y=a[1],h.position.z=a[2],m.position.z=a[3],m.quaternion.x=a[4],m.quaternion.y=a[5],m.quaternion.z=a[6],m.quaternion.w=a[7],c())};this.render=function(){var a=new Date,c=this.getView(),b;for(b=0;b<n.length;b++)n[b]&&n[b].globj(h);for(b=0;b<z.length;b++)z[b]&&z[b].globj(h);for(b in y)if(y.hasOwnProperty(b)){var d=y[b].A;y[b].aa||
(d.verticesNeedUpdate=!0,d.elementsNeedUpdate=!0,d.normalsNeedUpdate=!0,d.colorsNeedUpdate=!0,d.buffersNeedUpdate=!0,d.p=null,y[b].done&&(y[b].aa=!0),y[b].V&&h.remove(y[b].V),d=new WebMol.Mesh(d,y[b].J),y[b].V=d,h.add(d))}this.setView(c);c=new Date;J.hide();console.log("render time: "+(c-a))};this.pdbData=function(a){a=e(a);for(var c="",b=0,d=a.length;b<d;++b)c+=a[b].pdbline+"\n";return c};this.zoomTo=function(a){a=e(a).concat(z);var b=e({}).concat(z);a=g(a);var b=g(b),d=new WebMol.Vector3(a[2][0],
a[2][1],a[2][2]);h.position=d.multiplyScalar(-1);var d=b[1][0]-b[0][0],f=b[1][1]-b[0][1],b=b[1][2]-b[0][2],b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);X=-b/1.9;R=b/3;d=a[1][0]-a[0][0];f=a[1][1]-a[0][1];b=a[1][2]-a[0][2];b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);m.position.z=-(.35*b/Math.tan(Math.PI/180*F.fov/2)-150);c()};this.addLabel=function(a,b){var c=new ma(a,b);na(c);h.add(c.n);return c};this.removeLabel=function(a){a.dispose();h.remove(a.n)};this.setLabelStyle=function(a,b){a.dispose();a.h=b;na(a);h.add(a.n);
return a};this.setLabelText=function(a,b){a.dispose();a.text=b;na(a);h.add(a.n);return a};this.addShape=function(a){a=a||{};a=new WebMol.v(z.length,a);z.push(a);return a};this.addSphere=function(a){var b=new WebMol.v(z.length);a=a||{};b.addSphere(a);z.push(b);return b};this.addArrow=function(a){var b=new WebMol.v(z.length);a=a||{};b.addArrow(a);z.push(b);return b};this.addCustom=function(a){var b=new WebMol.v(z.length);a=a||{};b.addCustom(a);z.push(b);return b};this.addVolumetricData=function(a,b,
c){var d=new WebMol.v(z.length);c=c||{};d.addVolumetricData(a,b,c);z.push(d);return d};this.addModel=function(a,b){var c=new WebMol.GLModel(n.length,C);c.addMolData(a,b);n.push(c);return c};this.removeModel=function(a){if(a)for(a.removegl(h),delete n[a.getID()];0<n.length&&"undefined"===typeof n[n.length-1];)n.pop()};this.removeAllModels=function(){for(var a=0;a<n.length;a++)n[a].removegl(h);n=[]};this.createModelFrom=function(a,b){for(var c=new WebMol.GLModel(n.length,C),d=0;d<n.length;d++)if(n[d]){var e=
n[d].selectedAtoms(a);c.addAtoms(e);b&&n[d].removeAtoms(e)}n.push(c);return c};this.setStyle=function(a,b){f("setStyle",a,b,!1)};this.addStyle=function(a,b){f("setStyle",a,b,!0)};this.setColorByProperty=function(a,b,c){f("setColorByProperty",a,b,c)};this.setColorByElement=function(a,b){f("setColorByElement",a,b)};this.addSurface=function(c,d,f,h,l){f=e(f);var m=e(h),n=e(l),p,q=new Date,w=a(d),x=g(f);if(d.map&&d.map.prop){l=d.map.prop;var z=d.map.scheme||new WebMol.RWB,B=z.range();B||(B=b(f,l));d=
0;for(h=f.length;d<h;d++)p=f[d],p.surfaceColor=z.valueToHex(p.properties[l],B)}l=s(x);var A=r(x,m,f);if(n&&n.length&&0<n.length){var D=g(n);A.sort(function(a,b){function c(a,b){var d=a.Y,e=d[1][1]-d[0][1],f=d[1][2]-d[0][2],d=d[1][0]-d[0][0]-b[2][0],e=e-b[2][1],f=f-b[2][2];return d*d+e*e+f*f}return c(a,D)-c(b,D)})}console.log("Extents "+A.length+"  "+(+new Date-q)+"ms");var C={A:new WebMol.Geometry(!0),J:w,done:!1,aa:!1};f=y.length;y[f]=C;n=[];d=0;for(h=m.length;d<h;d++)p=m[d],n[d]={x:p.x,y:p.y,z:p.z,
serial:d,elem:p.elem};if(WebMol.syncSurface)for(d=0,h=A.length;d<h;d++)p=v(c,A[d].Y,A[d].ha,A[d].wa,n,l),p=t(m,p,w),WebMol.na(C.A,p),u.render();else{p=[];0>c&&(c=0);d=0;for(h=4;d<h;d++)x=new Worker(WebMol.ga),p.push(x),x.postMessage({type:-1,atoms:n,volume:l});var E=0;h=function(a){a=t(m,a.data,w);WebMol.na(C.A,a);u.render();console.log("async mesh generation "+(+new Date-q)+"ms");E++;E==A.length&&(C.done=!0)};l=function(a){console.log(a.message+" ("+a.filename+":"+a.ab+")")};for(d=0;d<A.length;d++)n=
p[d%p.length],n.onmessage=h,n.onerror=l,n.postMessage({type:c,expandedExtent:A[d].Y,extendedAtoms:A[d].ha,atomsToShow:A[d].wa})}console.log("full mesh generation "+(+new Date-q)+"ms");return f};this.setSurfaceMaterialStyle=function(b,c){y[b]&&(y[b].J=a(c),y[b].J.side=WebMol.FrontSide,y[b].aa=!1)};this.removeSurface=function(a){y[a]&&y[a].V&&(void 0!==y[a].A&&y[a].A.dispose(),void 0!==y[a].J&&y[a].J.dispose(),h.remove(y[a].V));delete y[a];c()};this.clear=function(){y=[];this.removeAllModels();c()};
getModelGroup=function(){return h};try{"function"===typeof D&&D(this)}catch(L){console.log("error with glviewer callback: "+L)}}}();WebMol.glmolViewer=WebMol.GLViewer;WebMol=WebMol||{};
WebMol.cb=[{resn:"ALA",atom:"N",props:{a:-.15}},{resn:"ALA",atom:"CA",props:{a:.1}},{resn:"ALA",atom:"CB",props:{a:0}},{resn:"ALA",atom:"C",props:{a:.6}},{resn:"ALA",atom:"O",props:{a:-.55}},{resn:"ARG",atom:"N",props:{a:-.15}},{resn:"ARG",atom:"CA",props:{a:.1}},{resn:"ARG",atom:"CB",props:{a:0}},{resn:"ARG",atom:"CG",props:{a:0}},{resn:"ARG",atom:"CD",props:{a:.1}},{resn:"ARG",atom:"NE",props:{a:-.1}},{resn:"ARG",atom:"CZ",props:{a:.5}},{resn:"ARG",atom:"NH1",props:{a:.25}},{resn:"ARG",atom:"NH2",
props:{a:.25}},{resn:"ARG",atom:"C",props:{a:.6}},{resn:"ARG",atom:"O",props:{a:-.55}},{resn:"ASN",atom:"N",props:{a:-.15}},{resn:"ASN",atom:"CA",props:{a:.1}},{resn:"ASN",atom:"CB",props:{a:0}},{resn:"ASN",atom:"CG",props:{a:.55}},{resn:"ASN",atom:"OD1",props:{a:-.55}},{resn:"ASN",atom:"ND2",props:{a:0}},{resn:"ASN",atom:"C",props:{a:.6}},{resn:"ASN",atom:"O",props:{a:-.55}},{resn:"ASP",atom:"N",props:{a:-.15}},{resn:"ASP",atom:"CA",props:{a:.1}},{resn:"ASP",atom:"CB",props:{a:0}},{resn:"ASP",atom:"CG",
props:{a:.14}},{resn:"ASP",atom:"OD1",props:{a:-.57}},{resn:"ASP",atom:"OD2",props:{a:-.57}},{resn:"ASP",atom:"C",props:{a:.6}},{resn:"ASP",atom:"O",props:{a:-.55}},{resn:"CYS",atom:"N",props:{a:-.15}},{resn:"CYS",atom:"CA",props:{a:.1}},{resn:"CYS",atom:"CB",props:{a:.19}},{resn:"CYS",atom:"SG",props:{a:-.19}},{resn:"CYS",atom:"C",props:{a:.6}},{resn:"CYS",atom:"O",props:{a:-.55}},{resn:"GLN",atom:"N",props:{a:-.15}},{resn:"GLN",atom:"CA",props:{a:.1}},{resn:"GLN",atom:"CB",props:{a:0}},{resn:"GLN",
atom:"CG",props:{a:0}},{resn:"GLN",atom:"CD",props:{a:.55}},{resn:"GLN",atom:"OE1",props:{a:-.55}},{resn:"GLN",atom:"NE2",props:{a:0}},{resn:"GLN",atom:"C",props:{a:.6}},{resn:"GLN",atom:"O",props:{a:-.55}},{resn:"GLU",atom:"N",props:{a:-.15}},{resn:"GLU",atom:"CA",props:{a:.1}},{resn:"GLU",atom:"CB",props:{a:0}},{resn:"GLU",atom:"CG",props:{a:0}},{resn:"GLU",atom:"CD",props:{a:.14}},{resn:"GLU",atom:"OE1",props:{a:-.57}},{resn:"GLU",atom:"OE2",props:{a:-.57}},{resn:"GLU",atom:"C",props:{a:.6}},{resn:"GLU",
atom:"O",props:{a:-.55}},{resn:"GLY",atom:"N",props:{a:-.15}},{resn:"GLY",atom:"CA",props:{a:.1}},{resn:"GLY",atom:"C",props:{a:.6}},{resn:"GLY",atom:"O",props:{a:-.55}},{resn:"HIS",atom:"N",props:{a:-.15}},{resn:"HIS",atom:"CA",props:{a:.1}},{resn:"HIS",atom:"CB",props:{a:0}},{resn:"HIS",atom:"CG",props:{a:.1}},{resn:"HIS",atom:"ND1",props:{a:-.1}},{resn:"HIS",atom:"CD2",props:{a:.1}},{resn:"HIS",atom:"NE2",props:{a:-.4}},{resn:"HIS",atom:"CE1",props:{a:.3}},{resn:"HIS",atom:"C",props:{a:.6}},{resn:"HIS",
atom:"O",props:{a:-.55}},{resn:"ILE",atom:"N",props:{a:-.15}},{resn:"ILE",atom:"CA",props:{a:.1}},{resn:"ILE",atom:"CB",props:{a:0}},{resn:"ILE",atom:"CG2",props:{a:0}},{resn:"ILE",atom:"CG1",props:{a:0}},{resn:"ILE",atom:"CD",props:{a:0}},{resn:"ILE",atom:"C",props:{a:.6}},{resn:"ILE",atom:"O",props:{a:-.55}},{resn:"LEU",atom:"N",props:{a:-.15}},{resn:"LEU",atom:"CA",props:{a:.1}},{resn:"LEU",atom:"CB",props:{a:0}},{resn:"LEU",atom:"CG",props:{a:0}},{resn:"LEU",atom:"CD1",props:{a:0}},{resn:"LEU",
atom:"CD2",props:{a:0}},{resn:"LEU",atom:"C",props:{a:.6}},{resn:"LEU",atom:"O",props:{a:-.55}},{resn:"LYS",atom:"N",props:{a:-.15}},{resn:"LYS",atom:"CA",props:{a:.1}},{resn:"LYS",atom:"CB",props:{a:0}},{resn:"LYS",atom:"CG",props:{a:0}},{resn:"LYS",atom:"CD",props:{a:0}},{resn:"LYS",atom:"CE",props:{a:.25}},{resn:"LYS",atom:"NZ",props:{a:.75}},{resn:"LYS",atom:"C",props:{a:.6}},{resn:"LYS",atom:"O",props:{a:-.55}},{resn:"MET",atom:"N",props:{a:-.15}},{resn:"MET",atom:"CA",props:{a:.1}},{resn:"MET",
atom:"CB",props:{a:0}},{resn:"MET",atom:"CG",props:{a:.06}},{resn:"MET",atom:"SD",props:{a:-.12}},{resn:"MET",atom:"CE",props:{a:.06}},{resn:"MET",atom:"C",props:{a:.6}},{resn:"MET",atom:"O",props:{a:-.55}},{resn:"PHE",atom:"N",props:{a:-.15}},{resn:"PHE",atom:"CA",props:{a:.1}},{resn:"PHE",atom:"CB",props:{a:0}},{resn:"PHE",atom:"CG",props:{a:0}},{resn:"PHE",atom:"CD1",props:{a:0}},{resn:"PHE",atom:"CD2",props:{a:0}},{resn:"PHE",atom:"CE1",props:{a:0}},{resn:"PHE",atom:"CE2",props:{a:0}},{resn:"PHE",
atom:"CZ",props:{a:0}},{resn:"PHE",atom:"C",props:{a:.6}},{resn:"PHE",atom:"O",props:{a:-.55}},{resn:"PRO",atom:"N",props:{a:-.25}},{resn:"PRO",atom:"CD",props:{a:.1}},{resn:"PRO",atom:"CA",props:{a:.1}},{resn:"PRO",atom:"CB",props:{a:0}},{resn:"PRO",atom:"CG",props:{a:0}},{resn:"PRO",atom:"C",props:{a:.6}},{resn:"PRO",atom:"O",props:{a:-.55}},{resn:"SER",atom:"N",props:{a:-.15}},{resn:"SER",atom:"CA",props:{a:.1}},{resn:"SER",atom:"CB",props:{a:.25}},{resn:"SER",atom:"OG",props:{a:-.25}},{resn:"SER",
atom:"C",props:{a:.6}},{resn:"SER",atom:"O",props:{a:-.55}},{resn:"THR",atom:"N",props:{a:-.15}},{resn:"THR",atom:"CA",props:{a:.1}},{resn:"THR",atom:"CB",props:{a:.25}},{resn:"THR",atom:"OG1",props:{a:-.25}},{resn:"THR",atom:"CG2",props:{a:0}},{resn:"THR",atom:"C",props:{a:.6}},{resn:"THR",atom:"O",props:{a:-.55}},{resn:"TRP",atom:"N",props:{a:-.15}},{resn:"TRP",atom:"CA",props:{a:.1}},{resn:"TRP",atom:"CB",props:{a:0}},{resn:"TRP",atom:"CG",props:{a:-.03}},{resn:"TRP",atom:"CD2",props:{a:.1}},{resn:"TRP",
atom:"CE2",props:{a:-.04}},{resn:"TRP",atom:"CE3",props:{a:-.03}},{resn:"TRP",atom:"CD1",props:{a:.06}},{resn:"TRP",atom:"NE1",props:{a:-.06}},{resn:"TRP",atom:"CZ2",props:{a:0}},{resn:"TRP",atom:"CZ3",props:{a:0}},{resn:"TRP",atom:"CH2",props:{a:0}},{resn:"TRP",atom:"C",props:{a:.6}},{resn:"TRP",atom:"O",props:{a:-.55}},{resn:"TYR",atom:"N",props:{a:-.15}},{resn:"TYR",atom:"CA",props:{a:.1}},{resn:"TYR",atom:"CB",props:{a:0}},{resn:"TYR",atom:"CG",props:{a:0}},{resn:"TYR",atom:"CD1",props:{a:0}},
{resn:"TYR",atom:"CE1",props:{a:0}},{resn:"TYR",atom:"CD2",props:{a:0}},{resn:"TYR",atom:"CE2",props:{a:0}},{resn:"TYR",atom:"CZ",props:{a:.25}},{resn:"TYR",atom:"OH",props:{a:-.25}},{resn:"TYR",atom:"C",props:{a:.6}},{resn:"TYR",atom:"O",props:{a:-.55}},{resn:"VAL",atom:"N",props:{a:-.15}},{resn:"VAL",atom:"CA",props:{a:.1}},{resn:"VAL",atom:"CB",props:{a:0}},{resn:"VAL",atom:"CG1",props:{a:0}},{resn:"VAL",atom:"CG2",props:{a:0}},{resn:"VAL",atom:"C",props:{a:.6}},{resn:"VAL",atom:"O",props:{a:-.55}}];
