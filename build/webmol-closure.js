WebMol=window.WebMol||{};WebMol.createViewer=function(u,D){"string"===$.type(u)&&(u=$("#"+u));if(u){D=D||{};D.order||(D.order=["glmol","jmol"]);D.defaultcolors||(D.defaultcolors=WebMol.R);for(var B=0;B<D.order.length;B++){var C=D.order[B],s=C+"Viewer";if("function"===typeof this[s])try{return new this[s](u,D.callback,D.defaultcolors)}catch(n){console.log("error with "+C+":"+n)}}alert("Unable to instantiate webmol viewer: "+D.order);return null}};
WebMol.download=function(u,D){var B="";if("pdb:"===u.substr(0,4)){B="pdb";u=u.substr(4).toUpperCase();if(!u.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri="http://www.pdb.org/pdb/files/"+u+".pdb"}else if("cid:"==u.substr(0,4)){B="sdf";u=u.substr(4);if(!u.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+u+"/SDF?record_type=3d"}$.get(uri,function(C){D.addModel(C,B);D.zoomTo();D.render()});return null};
WebMol.SurfaceType={VDW:1,MS:2,SAS:3,SES:4};WebMol.i={h:{},color:function(u){if("undefined"!==typeof this.h[u])return this.h[u];var D=new WebMol.Color(u);return this.h[u]=D}};WebMol.CC=WebMol.i;WebMol.CC.color=WebMol.i.color;WebMol.V=function(u,D){var B=D.geometry;void 0!==B&&u.geometryGroups.push(B.geometryGroups[0])};WebMol.Fa=function(u){return u.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};WebMol.syncSurface=!1;WebMol=WebMol||{};
WebMol.p=function(){var u={U:function(n,q,t,d){function c(p,Q,e,l,h,b){var c=new WebMol.Vector3;c.copy(g);var M=h;l&1<<h||!(l&1<<b)||(M=b);M&1&&e++;M&2&&Q++;M&4&&p++;c.x+=f.x*p;c.y+=f.y*Q;c.z+=f.z*e;p=(y*p+Q)*v+e;if(a)return q.push(c),q.length-1;0>A[p]&&(A[p]=q.length,q.push(c));return A[p]}var e=!!d.sa,g=d.hasOwnProperty("origin")&&d.origin.hasOwnProperty("x")?d.origin:{x:0,y:0,z:0},a=!!d.voxel,b=d.Y||0,y=d.Z||0,v=d.aa||0;d=d.scale||1;var f=(new WebMol.Vector3(1,1,1)).multiplyScalar(d),A=new Int32Array(b*
y*v),z;d=0;for(z=A.length;d<z;++d)A[d]=-1;z=new Int32Array(12);var J=e?C:D,e=e?s:B;for(d=0;d<b-1;++d)for(var r=0;r<y-1;++r)for(var u=0;u<v-1;++u){for(var x=0,p=0;8>p;++p)x|=!!(n[(y*(d+((p&4)>>2))+r+((p&2)>>1))*v+u+(p&1)]&2)<<p;if(0!==x&&255!==x){var F=J[x];if(0!==F)for(p=e[x],F&1&&(z[0]=c(d,r,u,x,0,1)),F&2&&(z[1]=c(d,r,u,x,1,3)),F&4&&(z[2]=c(d,r,u,x,3,2)),F&8&&(z[3]=c(d,r,u,x,2,0)),F&16&&(z[4]=c(d,r,u,x,4,5)),F&32&&(z[5]=c(d,r,u,x,5,7)),F&64&&(z[6]=c(d,r,u,x,7,6)),F&128&&(z[7]=c(d,r,u,x,6,4)),F&256&&
(z[8]=c(d,r,u,x,0,4)),F&512&&(z[9]=c(d,r,u,x,1,5)),F&1024&&(z[10]=c(d,r,u,x,3,7)),F&2048&&(z[11]=c(d,r,u,x,2,6)),x=0;x<p.length;x+=3){var F=z[p[x]],Q=z[p[x+1]],M=z[p[x+2]];a&&3<=x&&(q.push(q[F]),F=q.length-1,q.push(q[Q]),Q=q.length-1,q.push(q[M]),M=q.length-1);t.push(F);t.push(Q);t.push(M)}}}},T:function(n,q,t){var d=Array(q.length),c,e,g,a;c=0;for(e=q.length;c<e;c++)d[c]={x:0,y:0,z:0};var b=Array(20),y;for(c=0;20>c;c++)b[c]=Array(q.length);c=0;for(e=q.length;c<e;c++)b[0][c]=0;c=0;for(e=t.length/
3;c<e;c++){var v=3*c,f=3*c+1,A=3*c+2;y=!0;g=0;for(a=b[0][t[v]];g<a;g++)if(t[f]==b[g+1][t[v]]){y=!1;break}y&&(b[0][t[v]]++,b[b[0][t[v]]][t[v]]=t[f]);y=!0;g=0;for(a=b[0][t[v]];g<a;g++)if(t[A]==b[g+1][t[v]]){y=!1;break}y&&(b[0][t[v]]++,b[b[0][t[v]]][t[v]]=t[A]);y=!0;g=0;for(a=b[0][t[f]];g<a;g++)if(t[v]==b[g+1][t[f]]){y=!1;break}y&&(b[0][t[f]]++,b[b[0][t[f]]][t[f]]=t[v]);y=!0;g=0;for(a=b[0][t[f]];g<a;g++)if(t[A]==b[g+1][t[f]]){y=!1;break}y&&(b[0][t[f]]++,b[b[0][t[f]]][t[f]]=t[A]);y=!0;for(g=0;g<b[0][t[A]];g++)if(t[v]==
b[g+1][t[A]]){y=!1;break}y&&(b[0][t[A]]++,b[b[0][t[A]]][t[A]]=t[v]);y=!0;g=0;for(a=b[0][t[A]];g<a;g++)if(t[f]==b[g+1][t[A]]){y=!1;break}y&&(b[0][t[A]]++,b[b[0][t[A]]][t[A]]=t[f])}for(t=0;t<n;t++){c=0;for(e=q.length;c<e;c++)if(3>b[0][c])d[c].x=q[c].x,d[c].y=q[c].y,d[c].z=q[c].z;else if(3==b[0][c]||4==b[0][c]){d[c].x=0;d[c].y=0;g=d[c].z=0;for(a=b[0][c];g<a;g++)d[c].x+=q[b[g+1][c]].x,d[c].y+=q[b[g+1][c]].y,d[c].z+=q[b[g+1][c]].z;d[c].x+=.5*q[c].x;d[c].y+=.5*q[c].y;d[c].z+=.5*q[c].z;d[c].x/=.5+b[0][c];
d[c].y/=.5+b[0][c];d[c].z/=.5+b[0][c]}else{d[c].x=0;d[c].y=0;g=d[c].z=0;for(a=b[0][c];g<a;g++)d[c].x+=q[b[g+1][c]].x,d[c].y+=q[b[g+1][c]].y,d[c].z+=q[b[g+1][c]].z;d[c].x+=1*q[c].x;d[c].y+=1*q[c].y;d[c].z+=1*q[c].z;d[c].x/=1+b[0][c];d[c].y/=1+b[0][c];d[c].z/=1+b[0][c]}c=0;for(e=q.length;c<e;c++)q[c].x=d[c].x,q[c].y=d[c].y,q[c].z=d[c].z}},la:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,
2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,
2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},D=new Uint32Array(u.la),B=u.Ia=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,
4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,
4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,
1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,
1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,
7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,
3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],C=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,
2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,
3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],s=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,
2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,
11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,
5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,
6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],
[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,
2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,
4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,
6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,
10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,
5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,
10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return u}();"undefined"===typeof console&&(console={log:function(){}});
WebMol.ga=function(){function u(a,p,e){var b=new Int32Array(a*p*e*3);this.set=function(a,l,h,Q){a=3*((a*p+l)*e+h);b[a]=Q.d;b[a+1]=Q.e;b[a+2]=Q.f};this.get=function(a,l,h){a=3*((a*p+l)*e+h);return{d:b[a],e:b[a+1],f:b[a+2]}}}function D(a){return a.elem&&"undefined"!=typeof J[a.elem]?a.elem:"X"}var B=0,C=0,s=0,n=2,q=0,t=0,d=0,c=0,e=null,g=null,a=null,b=0,y=0,v=0,f=0,A=0,z=0,J={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},r={},
N={},x,p,F=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,
1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.ta=function(b){var c={},G,d;G=0;for(d=b.length;G<d;G++)c[b[G]]=!0;b=p;G=0;for(d=b.length;G<d;G++)b[G].x=b[G].x/n-B,b[G].y=b[G].y/n-C,b[G].z=b[G].z/n-s;var q=[];G=0;for(d=x.length;G<d;G+=3){var l=x[G],h=x[G+1],E=x[G+2],F=b[h].atomid,f=b[E].atomid,m=b[l].atomid;F<m&&(m=F);f<m&&(m=f);c[m]&&l!==h&&h!==E&&l!==E&&(q.push(l),q.push(h),q.push(E))}a=
g=e=null;return{vertices:b,faces:q}};this.va=function(p,M,G){1E6<G&&(n=1);G=1/n*5.5;b=p[0][0];f=p[1][0];y=p[0][1];A=p[1][1];v=p[0][2];z=p[1][2];M?(b-=1.4+G,y-=1.4+G,v-=1.4+G,f+=1.4+G,A+=1.4+G,z+=1.4+G):(b-=G,y-=G,v-=G,f+=G,A+=G,z+=G);b=Math.floor(b*n)/n;y=Math.floor(y*n)/n;v=Math.floor(v*n)/n;f=Math.ceil(f*n)/n;A=Math.ceil(A*n)/n;z=Math.ceil(z*n)/n;B=-b;C=-y;s=-v;d=Math.ceil(n*(f-b))+1;t=Math.ceil(n*(A-y))+1;q=Math.ceil(n*(z-v))+1;this.Q(M);c=1.4*n;e=new Uint8Array(d*t*q);g=new Float64Array(d*t*q);
a=new Int32Array(d*t*q);console.log("Box size: ",d,t,q,e.length)};this.Q=function(a){var p=[],b,e;flagradius=a;for(var c in J)if(J.hasOwnProperty(c))for(e=J[c],p[c]=a?(e+1.4)*n+.5:e*n+.5,e=p[c]*p[c],N[c]=Math.floor(p[c])+1,r[c]=new Int32Array(N[c]*N[c]),j=indx=0;j<N[c];j++)for(k=0;k<N[c];k++)b=j*j+k*k,b>e?r[c][indx]=-1:(b=Math.sqrt(e-b),r[c][indx]=Math.floor(b)),indx++};this.qa=function(p,b){var c,d;c=0;for(d=e.length;c<d;c++)e[c]=0,g[c]=-1,a[c]=-1;for(c in b)d=p[b[c]],void 0!==d&&this.oa(d,p);c=
0;for(d=e.length;c<d;c++)e[c]&1&&(e[c]|=2)};this.oa=function(p,b){var c,g,F,l,h,E,f,y,m,K,w,v,x,z,A,u,J;c=Math.floor(.5+n*(p.x+B));g=Math.floor(.5+n*(p.y+C));F=Math.floor(.5+n*(p.z+s));var R=D(p),H=0,V=t*q;K=0;for(J=N[R];K<J;K++)for(w=0;w<J;w++){if(-1!=r[R][H])for(z=-1;2>z;z++)for(A=-1;2>A;A++)for(u=-1;2>u;u++)if(0!==z&&0!==A&&0!==u)for(f=z*K,m=u*w,v=0;v<=r[R][H];v++)y=v*A,l=c+f,h=g+y,x=F+m,0>l||0>h||0>x||l>=d||h>=t||x>=q||(x=l*V+h*q+x,e[x]&1?(E=b[a[x]],l=Math.floor(.5+n*(E.x+B)),h=Math.floor(.5+
n*(E.y+C)),E=Math.floor(.5+n*(E.z+s)),f*f+y*y+m*m<l*l+h*h+E*E&&(a[x]=p.serial)):(e[x]|=1,a[x]=p.serial));H++}};this.ra=function(a,p){var b,c;b=0;for(c=e.length;b<c;b++)e[b]&=-3;for(b in p)c=a[p[b]],void 0!==c&&this.pa(c,a)};this.pa=function(p,b){var c,g,F,l,h,E,f=0,y,m,K,w,x,v,z,A,u,J,R;c=Math.floor(.5+n*(p.x+B));g=Math.floor(.5+n*(p.y+C));F=Math.floor(.5+n*(p.z+s));var H=D(p),V=t*q;x=0;for(R=N[H];x<R;x++)for(v=0;v<R;v++){if(-1!=r[H][f])for(A=-1;2>A;A++)for(u=-1;2>u;u++)for(J=-1;2>J;J++)if(0!==A&&
0!==u&&0!==J)for(y=A*x,K=J*v,z=0;z<=r[H][f];z++)m=z*u,l=c+y,h=g+m,w=F+K,0>l||0>h||0>w||l>=d||h>=t||w>=q||(w=l*V+h*q+w,e[w]&2?(E=b[a[w]],l=Math.floor(.5+n*(E.x+B)),h=Math.floor(.5+n*(E.y+C)),E=Math.floor(.5+n*(E.z+s)),y*y+m*m+K*K<l*l+h*h+E*E&&(a[w]=p.serial)):(e[w]|=2,a[w]=p.serial));f++}};this.ia=function(){var a=t*q;for(i=0;i<d;i++)for(j=0;j<q;j++)for(k=0;k<t;k++){var p=i*a+k*q+j;if(e[p]&1)for(var b=0;26>b;){var c=i+F[b][0],g=j+F[b][2],l=k+F[b][1];if(-1<c&&c<d&&-1<l&&l<t&&-1<g&&g<q&&!(e[c*a+l*q+
g]&1)){e[p]|=4;break}else b++}}};this.ma=function(){var p,a,b,F=new u(d,t,q),f=t*q,l=c*c,h=[];b=[];var E;for(p=0;p<d;p++)for(a=0;a<t;a++)for(b=0;b<q;b++)if(E=p*f+a*q+b,e[E]&=-3,e[E]&1&&e[E]&4){var y={d:p,e:a,f:b};F.set(p,a,b,y);h.push(y);g[E]=0;e[E]|=2;e[E]&=-5}do for(b=this.na(h,F),h=[],p=0,a=b.length;p<a;p++)E=f*b[p].d+q*b[p].e+b[p].f,e[E]&=-5,g[E]<=1.0404*l&&h.push({d:b[p].d,e:b[p].e,f:b[p].f});while(0!==h.length);p=n-.5;0>p&&(p=0);l-=.5/(.1+p);for(p=0;p<d;p++)for(a=0;a<t;a++)for(b=0;b<q;b++)E=
p*f+a*q+b,e[E]&=-5,e[E]&1&&(!(e[E]&2)||e[E]&2&&g[E]>=l)&&(e[E]|=4)};this.na=function(p,a){var b,c,f,l,h,E,y,r,m,K,w,n=[];if(0===p.length)return n;tnv={d:-1,e:-1,f:-1};var x=t*q;y=0;for(m=p.length;y<m;y++)for(b=p[y].d,c=p[y].e,f=p[y].f,K=a.get(b,c,f),r=0;6>r;r++)tnv.d=b+F[r][0],tnv.e=c+F[r][1],tnv.f=f+F[r][2],tnv.d<d&&-1<tnv.d&&tnv.e<t&&-1<tnv.e&&tnv.f<q&&-1<tnv.f&&(w=tnv.d*x+q*tnv.e+tnv.f,e[w]&1&&!(e[w]&2)?(a.set(tnv.d,tnv.e,f+F[r][2],K),l=tnv.d-K.d,h=tnv.e-K.e,E=tnv.f-K.f,l=l*l+h*h+E*E,g[w]=l,e[w]|=
2,e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})):e[w]&1&&e[w]&2&&(l=tnv.d-K.d,h=tnv.e-K.e,E=tnv.f-K.f,l=l*l+h*h+E*E,l<g[w]&&(a.set(tnv.d,tnv.e,tnv.f,K),g[w]=l,e[w]&4||(e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})))));y=0;for(m=p.length;y<m;y++)for(b=p[y].d,c=p[y].e,f=p[y].f,K=a.get(b,c,f),r=6;18>r;r++)tnv.d=b+F[r][0],tnv.e=c+F[r][1],tnv.f=f+F[r][2],tnv.d<d&&-1<tnv.d&&tnv.e<t&&-1<tnv.e&&tnv.f<q&&-1<tnv.f&&(w=tnv.d*x+q*tnv.e+tnv.f,e[w]&1&&!(e[w]&2)?(a.set(tnv.d,tnv.e,f+F[r][2],K),l=tnv.d-K.d,h=tnv.e-K.e,E=
tnv.f-K.f,l=l*l+h*h+E*E,g[w]=l,e[w]|=2,e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})):e[w]&1&&e[w]&2&&(l=tnv.d-K.d,h=tnv.e-K.e,E=tnv.f-K.f,l=l*l+h*h+E*E,l<g[w]&&(a.set(tnv.d,tnv.e,tnv.f,K),g[w]=l,e[w]&4||(e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})))));y=0;for(m=p.length;y<m;y++)for(b=p[y].d,c=p[y].e,f=p[y].f,K=a.get(b,c,f),r=18;26>r;r++)tnv.d=b+F[r][0],tnv.e=c+F[r][1],tnv.f=f+F[r][2],tnv.d<d&&-1<tnv.d&&tnv.e<t&&-1<tnv.e&&tnv.f<q&&-1<tnv.f&&(w=tnv.d*x+q*tnv.e+tnv.f,e[w]&1&&!(e[w]&2)?(a.set(tnv.d,tnv.e,
f+F[r][2],K),l=tnv.d-K.d,h=tnv.e-K.e,E=tnv.f-K.f,l=l*l+h*h+E*E,g[w]=l,e[w]|=2,e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})):e[w]&1&&e[w]&2&&(l=tnv.d-K.d,h=tnv.e-K.e,E=tnv.f-K.f,l=l*l+h*h+E*E,l<g[w]&&(a.set(tnv.d,tnv.e,tnv.f,K),g[w]=l,e[w]&4||(e[w]|=4,n.push({d:tnv.d,e:tnv.e,f:tnv.f})))));return n};this.xa=function(p){for(var a=0,b=e.length;a<b;a++)1==p?e[a]&=-5:4==p?(e[a]&=-3,e[a]&4&&(e[a]|=2),e[a]&=-5):2==p?e[a]&4&&e[a]&2?e[a]&=-5:e[a]&4&&!(e[a]&2)&&(e[a]|=2):3==p&&(e[a]&=-5)};this.wa=function(b){this.xa(b);
p=[];x=[];WebMol.p.U(e,p,x,{Ha:1,Y:d,Z:t,aa:q});b=t*q;for(var c=0,g=p.length;c<g;c++)p[c].atomid=a[p[c].x*b+q*p[c].y+p[c].z];WebMol.p.T(1,p,x)}};WebMol.fa='self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(0>type)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1==type?!1:!0,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),(4===type||2===type)&&(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}};var Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0};Vector3.prototype={constructor:Vector3,copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this}};var ISDONE=2,ProteinSurface=function (){var faces,verts,origextent,INOUT=1,ISDONE=2,ISBOUND=4,ptranx=0,ptrany=0,ptranz=0,probeRadius=1.4,defaultScaleFactor=2,scaleFactor=defaultScaleFactor,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&"undefined"!=typeof vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;il>i;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;il>i;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;il>i;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(which>b&&(which=b),which>c&&(which=c),atomsToShow[which]){{vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]]}fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=defaultScaleFactor/2);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=probeRadius+margin,pminy-=probeRadius+margin,pminz-=probeRadius+margin,pmaxx+=probeRadius+margin,pmaxy+=probeRadius+margin,pmaxz+=probeRadius+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=probeRadius*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight),console.log("Box size: ",pLength,pWidth,pHeight,vpBits.length)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+probeRadius)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)txz=j*j+k*k,txz>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&INOUT&&(vpBits[i]|=ISDONE)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&INOUT){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=INOUT,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&=~ISDONE;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&ISDONE){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=ISDONE,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;pLength>i;i++)for(j=0;pHeight>j;j++)for(k=0;pWidth>k;k++){var index=i*pWH+k*pHeight+j;if(vpBits[index]&INOUT)for(var ii=0;26>ii;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&pLength>ti&&tk>-1&&pWidth>tk&&tj>-1&&pHeight>tj&&!(vpBits[ti*pWH+tk*pHeight+tj]&INOUT)){vpBits[index]|=ISBOUND;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=~ISDONE,vpBits[index]&INOUT&&vpBits[index]&ISBOUND){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=ISDONE,vpBits[index]&=~ISBOUND}do for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;n>i;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=~ISBOUND,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz});while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;0>cutsf&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)index=i*pWH+j*pHeight+k,vpBits[index]&=~ISBOUND,vpBits[index]&INOUT&&(!(vpBits[index]&ISDONE)||vpBits[index]&ISDONE&&vpDistance[index]>=cutoff)&&(vpBits[index]|=ISBOUND)},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;6>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;18>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;26>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;lim>i;i++)1==stype?vpBits[i]&=~ISBOUND:4==stype?(vpBits[i]&=~ISDONE,vpBits[i]&ISBOUND&&(vpBits[i]|=ISDONE),vpBits[i]&=~ISBOUND):2==stype?vpBits[i]&ISBOUND&&vpBits[i]&ISDONE?vpBits[i]&=~ISBOUND:vpBits[i]&ISBOUND&&!(vpBits[i]&ISDONE)&&(vpBits[i]|=ISDONE):3==stype&&(vpBits[i]&=~ISBOUND)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;vlen>i;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];laplacianSmooth(1,verts,faces)}},march=function (data,verts,faces,spec){var i,il,fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=new Vector3(1,1,1).multiplyScalar(scale),vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;il>i;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt=new Vector3;pt.copy(origin);var val1=!!(code&1<<p1),val2=!!(code&1<<p2),p=p1;!val1&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,pt.x+=unitCube.x*i,pt.y+=unitCube.y*j,pt.z+=unitCube.z*k;var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;nX-1>i;++i)for(var j=0;nY-1>j;++j)for(var k=0;nZ-1>k;++k){for(var code=0,p=0;8>p;++p){var index=(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p),val=!!(data[index]&ISDONE);code|=val<<p}if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},laplacianSmooth=function (numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;20>i;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;il>i;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}var wt=1,wt2=.5;for(k=0;numiter>k;k++){for(i=0,il=verts.length;il>i;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt2*verts[i].x,tps[i].y+=wt2*verts[i].y,tps[i].z+=wt2*verts[i].z,tps[i].x/=wt2+vertdeg[0][i],tps[i].y/=wt2+vertdeg[0][i],tps[i].z/=wt2+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt*verts[i].x,tps[i].y+=wt*verts[i].y,tps[i].z+=wt*verts[i].z,tps[i].x/=wt+vertdeg[0][i],tps[i].y/=wt+vertdeg[0][i],tps[i].z/=wt+vertdeg[0][i]}for(i=0,il=verts.length;il>i;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]';
WebMol.L=window.URL.createObjectURL(new Blob([WebMol.fa]));WebMol.workerString=WebMol.fa;WebMol.SurfaceWorker=WebMol.L;
$(document).ready(function(){void 0!==$("#webmoljs_viewer")[0]&&(WebMol.ha=!0);if(WebMol.ha){var u=WebMol.Ja=$("#webmoljs_viewer"),D=null;u.data("pdb")?D="http://www.pdb.org/pdb/files/"+u.data("pdb")+".pdb":u.data("href")&&(D=u.data("href"));var B=Number(u.data("backgroundcolor"))||0,C=u.data("style")||{line:{}};WebMol.u=WebMol.createViewer("webmoljs_viewer",{defaultcolors:WebMol.rasmolElementColors,callback:function(n){n.setBackgroundColor(B)}});if(D){var s=u.data("datatype")||"pdb";$.get(D,function(n){WebMol.u.addModel(n,
s);WebMol.u.setStyle({},C);WebMol.u.zoomTo();WebMol.u.render()},"text")}}});WebMol.ja=16716947;
WebMol.JmolElementColors={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,
I:9699476,Ba:51456,BA:51456,Au:16765219,AU:16765219};
WebMol.rasmolElementColors={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,
Ba:16753920,BA:16753920,Au:14329120,AU:14329120};WebMol.R=WebMol.JmolElementColors;var WebMol=WebMol||{};
WebMol.RWB=function(u,D){this.valueToHex=function(B,C){var s,n;C?(s=C[0],n=C[1]):(s=u,n=D);if(void 0===B)return 16777215;B<s&&(B=s);B>n&&(B=n);var q=(n+s)/2;B<=q?(s=Math.floor(255*Math.sqrt((B-s)/(q-s))),s=16711680+256*s+s):(s=Math.floor(255*Math.sqrt(1-(B-q)/(n-q))),s=65536*s+256*s+255);return s};this.jmolID=function(){return"rwb"};this.range=function(){return"undefined"!=typeof u&&"undefined"!=typeof D?[u,D]:null}};
WebMol.ROYGB=function(u,D){this.valueToHex=function(B,C){var s,n;C?(s=C[0],n=C[1]):(s=u,n=D);if("undefined"==typeof B)return 16777215;B<s&&(B=s);B>n&&(B=n);var q=(s+n)/2,t=(s+q)/2,d=(q+n)/2;B<t?(s=Math.floor(255*Math.sqrt((B-s)/(t-s))),s=256*s+16711680):B<q?(s=Math.floor(255*Math.sqrt(1-(B-t)/(q-t))),s=65536*s+65280):B<d?(s=Math.floor(255*Math.sqrt((B-q)/(d-q))),s=65280+1*s):(s=Math.floor(255*Math.sqrt(1-(B-d)/(n-d))),s=256*s+255);return s};this.jmolID=function(){return"roygb"};this.range=function(){return"undefined"!=
typeof u&&"undefined"!=typeof D?[u,D]:null}};
WebMol.Sinebow=function(u,D){this.valueToHex=function(B,C){var s,n;C?(s=C[0],n=C[1]):(s=u,n=D);if("undefined"==typeof B)return 16777215;B<s&&(B=s);B>n&&(B=n);var q=(B-s)/(n-s)*5/6+.5;s=Math.sin(Math.PI*q);n=Math.sin(Math.PI*(q+1/3));q=Math.sin(Math.PI*(q+2/3));return 65536*Math.floor(255*s*s)+256*Math.floor(255*q*q)+1*Math.floor(255*n*n)};this.jmolID=function(){return"sinebow"};this.range=function(){return"undefined"!=typeof u&&"undefined"!=typeof D?[u,D]:null}};WebMol=WebMol||{};
WebMol.ka=function(){function u(u,C,s,n,q){if(!(2>C.length)){q=q||5;C=D(C,q);s=D(s,q);var t=new WebMol.Geometry(!0),d=[],c,e,g,a,b,y=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],v,f,A,z,J,r,N,x,p;r=0;for(N=C.length;r<N;r++){A=WebMol.i.color(n[Math.round((r-1)/q)]);d.push(e=C[r]);d.push(e);d.push(g=s[r]);d.push(g);r<N-1&&(v=C[r+1].clone().sub(C[r]),c=s[r].clone().sub(C[r]).cross(v).normalize().multiplyScalar(.4));d.push(a=C[r].clone().add(c));d.push(a);d.push(b=s[r].clone().add(c));d.push(b);
void 0!==e.atom&&(z=e.atom);p=t.updateGeoGroup(8);v=p.vertices;f=3*v;p.__vertexArray[f]=e.x;p.__vertexArray[f+1]=e.y;p.__vertexArray[f+2]=e.z;p.__vertexArray[f+3]=e.x;p.__vertexArray[f+4]=e.y;p.__vertexArray[f+5]=e.z;p.__vertexArray[f+6]=g.x;p.__vertexArray[f+7]=g.y;p.__vertexArray[f+8]=g.z;p.__vertexArray[f+9]=g.x;p.__vertexArray[f+10]=g.y;p.__vertexArray[f+11]=g.z;p.__vertexArray[f+12]=a.x;p.__vertexArray[f+13]=a.y;p.__vertexArray[f+14]=a.z;p.__vertexArray[f+15]=a.x;p.__vertexArray[f+16]=a.y;p.__vertexArray[f+
17]=a.z;p.__vertexArray[f+18]=b.x;p.__vertexArray[f+19]=b.y;p.__vertexArray[f+20]=b.z;p.__vertexArray[f+21]=b.x;p.__vertexArray[f+22]=b.y;p.__vertexArray[f+23]=b.z;for(e=0;8>e;++e)p.__colorArray[f+3*e]=A.r,p.__colorArray[f+1+3*e]=A.g,p.__colorArray[f+2+3*e]=A.b;if(0<r)for(f=void 0!==J&&void 0!==z&&J.serial!==z.serial,e=0;4>e;e++)if(g=[v+y[e][0],v+y[e][1],v+y[e][2],v+y[e][3]],b=p.faceidx,p.__faceArray[b]=g[0],p.__faceArray[b+1]=g[1],p.__faceArray[b+2]=g[3],p.__faceArray[b+3]=g[1],p.__faceArray[b+4]=
g[2],p.__faceArray[b+5]=g[3],p.faceidx+=6,z.clickable||J.clickable){x=d[g[3]].clone();b=d[g[0]].clone();var F=d[g[2]].clone(),Q=d[g[1]].clone();x.atom=d[g[3]].atom||null;F.atom=d[g[2]].atom||null;b.atom=d[g[0]].atom||null;Q.atom=d[g[1]].atom||null;if(f){var M=x.clone().add(b).multiplyScalar(.5),G=F.clone().add(Q).multiplyScalar(.5),L=x.clone().add(Q).multiplyScalar(.5);0===e%2?(J.clickable&&(g=new WebMol.Triangle(M,L,x),a=new WebMol.Triangle(G,F,L),x=new WebMol.Triangle(L,F,x),J.intersectionShape.triangle.push(g),
J.intersectionShape.triangle.push(a),J.intersectionShape.triangle.push(x)),z.clickable&&(g=new WebMol.Triangle(b,Q,L),a=new WebMol.Triangle(Q,G,L),x=new WebMol.Triangle(b,L,M),z.intersectionShape.triangle.push(g),z.intersectionShape.triangle.push(a),z.intersectionShape.triangle.push(x))):(z.clickable&&(g=new WebMol.Triangle(M,L,x),a=new WebMol.Triangle(G,F,L),x=new WebMol.Triangle(L,F,x),z.intersectionShape.triangle.push(g),z.intersectionShape.triangle.push(a),z.intersectionShape.triangle.push(x)),
J.clickable&&(g=new WebMol.Triangle(b,Q,L),a=new WebMol.Triangle(Q,G,L),x=new WebMol.Triangle(b,L,M),J.intersectionShape.triangle.push(g),J.intersectionShape.triangle.push(a),J.intersectionShape.triangle.push(x)))}else z.clickable&&(g=new WebMol.Triangle(b,Q,x),a=new WebMol.Triangle(Q,F,x),z.intersectionShape.triangle.push(g),z.intersectionShape.triangle.push(a))}p.vertices+=8;J=z}C=d.length-8;p=t.updateGeoGroup(8);v=p.vertices;f=3*v;b=p.faceidx;for(r=0;4>r;r++)d.push(d[2*r]),d.push(d[C+2*r]),s=d[2*
r],n=d[C+2*r],p.__vertexArray[f+6*r]=s.x,p.__vertexArray[f+1+6*r]=s.y,p.__vertexArray[f+2+6*r]=s.z,p.__vertexArray[f+3+6*r]=n.x,p.__vertexArray[f+4+6*r]=n.y,p.__vertexArray[f+5+6*r]=n.z,p.__colorArray[f+6*r]=A.r,p.__colorArray[f+1+6*r]=A.g,p.__colorArray[f+2+6*r]=A.b,p.__colorArray[f+3+6*r]=A.r,p.__colorArray[f+4+6*r]=A.g,p.__colorArray[f+5+6*r]=A.b;g=[v,v+2,v+6,v+4];a=[v+1,v+5,v+7,v+3];p.__faceArray[b]=g[0];p.__faceArray[b+1]=g[1];p.__faceArray[b+2]=g[3];p.__faceArray[b+3]=g[1];p.__faceArray[b+4]=
g[2];p.__faceArray[b+5]=g[3];p.__faceArray[b+6]=a[0];p.__faceArray[b+7]=a[1];p.__faceArray[b+8]=a[3];p.__faceArray[b+9]=a[1];p.__faceArray[b+10]=a[2];p.__faceArray[b+11]=a[3];p.faceidx+=12;p.vertices+=8;t.initTypedArrays();t.setUpNormals();d=new WebMol.MeshLambertMaterial;d.vertexColors=WebMol.FaceColors;d.side=WebMol.DoubleSide;t=new WebMol.Mesh(t,d);u.add(t)}}function D(u,C){var s=[],n=u,n=[];n.push(u[0]);var q,t,d,c,e,g;q=1;for(t=u.length-1;q<t;q++)c=u[q],e=u[q+1],c.ya?n.push(new WebMol.Vector3((c.x+
e.x)/2,(c.y+e.y)/2,(c.z+e.z)/2)):n.push(c);n.push(u[u.length-1]);q=-1;for(t=n.length;q<=t-3;q++){d=n[-1===q?0:q];c=n[q+1];e=n[q+2];g=n[q===t-3?t-1:q+3];d=(new WebMol.Vector3).subVectors(e,d).multiplyScalar(.5);g=(new WebMol.Vector3).subVectors(g,c).multiplyScalar(.5);for(var a=0;a<C;a++){var b=1/C*a,b=new WebMol.Vector3(c.x+b*d.x+b*b*(-3*c.x+3*e.x-2*d.x-g.x)+b*b*b*(2*c.x-2*e.x+d.x+g.x),c.y+b*d.y+b*b*(-3*c.y+3*e.y-2*d.y-g.y)+b*b*b*(2*c.y-2*e.y+d.y+g.y),c.z+b*d.z+b*b*(-3*c.z+3*e.z-2*d.z-g.z)+b*b*b*
(2*c.z-2*e.z+d.z+g.z)),y=Math.floor((s.length+2)/C);void 0!==u[y]&&void 0!==u[y].atom&&(b.atom=u[y].atom);s.push(b)}}s.push(n[n.length-1]);return s}return function(B,C){var s,n,q;s=2;n=5;q=!1;var t=[],d,c,e;for(e=0;e<s;e++)t[e]=[];e=[];var g,a,b,y,v=null,f=null;for(d in C)if(c=C[d],void 0!==c&&("O"==c.atom||"CA"==c.atom)&&!c.hetflag)if("CA"==c.atom){if(g!=c.chain||b+1!=c.resi||a!=c.ba){u(B,t[0],t[s-1],e,n);t=[];for(e=0;e<s;e++)t[e]=[];e=[];v=null}y=new WebMol.Vector3(c.x,c.y,c.z);currentAtom=c;g=
c.chain;a=c.ba;b=c.resi;var f=c.ss,A=c.color;"undefined"!=typeof c.style.cartoon.color&&(A=c.style.cartoon.color);e.push(A);!0!==c.clickable||void 0!==c.intersectionShape&&void 0!==c.intersectionShape.triangle||(c.intersectionShape={sphere:null,cylinder:[],line:[],triangle:[]})}else for(c=new WebMol.Vector3(c.x,c.y,c.z),c.sub(y),c.normalize(),c.multiplyScalar("c"==f?.3:1.3),null!==v&&0>c.dot(v)&&c.negate(),v=c,c=0;c<s;c++)A=-1+2/(s-1)*c,A=new WebMol.Vector3(y.x+v.x*A,y.y+v.y*A,y.z+v.z*A),A.atom=currentAtom,
q||"s"!=f||(A.ya=!0),t[c].push(A);u(B,t[0],t[s-1],e,n)}}();WebMol=WebMol||{};
WebMol.GLModel=function(){function u(d){var c=[],e,g;e=0;for(g=d.length;e<g;e++){d[e].index=e;var a=d[e];a.hetflag||"N"!==a.atom&&"O"!==a.atom||(c.push(a),a.J=null,a.n=Number.POSITIVE_INFINITY)}c.sort(function(a,b){return a.z-b.z});e=0;for(g=c.length;e<g;e++)for(a=c[e],d=e+1;d<g;d++){var b=c[d];if(3.5<b.z-a.z)break;var y=D(a,b);y<a.n&&(a.J=b,a.n=y);y<b.n&&(b.J=a,b.n=y)}}function D(d,c){if(d.chain==c.chain&&4>Math.abs(d.resi-c.resi))return Number.POSITIVE_INFINITY;if("O"===d.atom&&"N"===c.atom||"N"===
d.atom&&"O"===c.atom){var e=d.x-c.x;if(3.5<e)return Number.POSITIVE_INFINITY;var g=d.y-c.y;if(3.5<g)return Number.POSITIVE_INFINITY;var a=d.z-c.z;if(3.5<a)return Number.POSITIVE_INFINITY;e=Math.sqrt(e*e+g*g+a*a);if(3.5>e)return e}return Number.POSITIVE_INFINITY}function B(d){var c=[],e=[],g,a;g=0;for(a=d.length;g<a;g++){var b=d[g];b.index=g;b.hetflag?e.push(b):c.push(b)}C(e);c.sort(function(a,b){return a.chain!=b.chain?a.chain<b.chain?-1:1:a.resi-b.resi});var e=d=-1,y;g=0;for(a=c.length;g<a;g++){b=
c[g];b.resi!==d&&(d=b.resi,y||e++,y=!1);b.ba=e;for(var q=g+1;q<c.length;q++){var f=c[q];if(f.chain!=b.chain)break;if(1<f.resi-b.resi)break;s(b,f)&&(-1===b.bonds.indexOf(f.index)&&(b.bonds.push(f.index),b.bondOrder.push(1),f.bonds.push(b.index),f.bondOrder.push(1)),b.resi!==f.resi&&(y=!0))}}}function C(d){var c=d.slice(0),e,g;e=0;for(g=d.length;e<g;e++)d[e].index||(d[e].index=e);c.sort(function(a,b){return a.z-b.z});e=0;for(g=c.length;e<g;e++){var a=c[e];for(d=e+1;d<g;d++){var b=c[d];if(1.9<b.z-a.z)break;
s(a,b)&&-1==a.bonds.indexOf(b.index)&&(a.bonds.push(b.index),a.bondOrder.push(1),b.bonds.push(a.index),b.bondOrder.push(1))}}}function s(d,c){var e=d.x-c.x,e=e*e;if(3.6<e)return!1;var g=d.y-c.y,g=g*g;if(3.6<g)return!1;var a=d.z-c.z,a=a*a;if(3.6<a)return!1;e=e+g+a;return isNaN(e)||.5>e||1.3<e&&("H"==d.elem||"H"==c.elem||"D"==d.elem||"D"==c.elem)?!1:3.6>e&&("S"==d.elem||"S"==c.elem)?!0:2.78<e?!1:!0}function n(d,c){return d&&c?JSON.stringify(d)==JSON.stringify(c):d==c}var q={line:{}},t={H:1.2,Li:1.82,
Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63};return function(d,c){function e(a,b,c,e,g,d,f){if(b&&c){x++;var l=d||f,h=c.clone();h.sub(b);var h=D(h),E=s.m(e);e=E.w;var q=E.ua,y=l?q*e+2:2*e;a=a.updateGeoGroup(y);var m=E.vertices,r=E.j,E=E.k,w=E[q/2],n=E[q/2+1],t=a.vertices,z,v,A,u,B,H;for(A=0;A<e;++A)v=2*A,u=h[0]*m[v].x+h[3]*m[v].y+h[6]*m[v].z,B=h[1]*m[v].x+h[4]*m[v].y+h[7]*m[v].z,H=h[5]*m[v].y+h[8]*m[v].z,z=3*(t+v),v=a.faceidx,a.__vertexArray[z]=
u+b.x,a.__vertexArray[z+1]=B+b.y,a.__vertexArray[z+2]=H+b.z,a.__vertexArray[z+3]=u+c.x,a.__vertexArray[z+4]=B+c.y,a.__vertexArray[z+5]=H+c.z,a.__normalArray[z]=u,a.__normalArray[z+3]=u,a.__normalArray[z+1]=B,a.__normalArray[z+4]=B,a.__normalArray[z+2]=H,a.__normalArray[z+5]=H,a.__colorArray[z]=g.r,a.__colorArray[z+3]=g.r,a.__colorArray[z+1]=g.g,a.__colorArray[z+4]=g.g,a.__colorArray[z+2]=g.b,a.__colorArray[z+5]=g.b,a.__faceArray[v]=n[A]+t,a.__faceArray[v+1]=n[A+1]+t,a.__faceArray[v+2]=w[A]+t,a.__faceArray[v+
3]=w[A]+t,a.__faceArray[v+4]=n[A+1]+t,a.__faceArray[v+5]=w[A+1]+t,a.faceidx+=6;if(l){d=d?q+1:q/2+1;var V,O,U,aa,C,P,I,Z,W,ba,ka,la,ca;for(B=f?0:q/2;B<d;B++)if(B!==q/2){var ea=B<=q/2?c:b;for(u=0;u<e;u++)v=a.faceidx,f=E[B][u+1],A=3*(f+t),l=E[B][u],H=3*(l+t),w=E[B+1][u],z=3*(w+t),n=E[B+1][u+1],ca=3*(n+t),V=h[0]*m[f].x+h[3]*m[f].y+h[6]*m[f].z,O=h[0]*m[l].x+h[3]*m[l].y+h[6]*m[l].z,U=h[0]*m[w].x+h[3]*m[w].y+h[6]*m[w].z,aa=h[0]*m[n].x+h[3]*m[n].y+h[6]*m[n].z,C=h[1]*m[f].x+h[4]*m[f].y+h[7]*m[f].z,P=h[1]*
m[l].x+h[4]*m[l].y+h[7]*m[l].z,I=h[1]*m[w].x+h[4]*m[w].y+h[7]*m[w].z,Z=h[1]*m[n].x+h[4]*m[n].y+h[7]*m[n].z,W=h[5]*m[f].y+h[8]*m[f].z,ba=h[5]*m[l].y+h[8]*m[l].z,ka=h[5]*m[w].y+h[8]*m[w].z,la=h[5]*m[n].y+h[8]*m[n].z,a.__vertexArray[A]=V+ea.x,a.__vertexArray[H]=O+ea.x,a.__vertexArray[z]=U+ea.x,a.__vertexArray[ca]=aa+ea.x,a.__vertexArray[A+1]=C+ea.y,a.__vertexArray[H+1]=P+ea.y,a.__vertexArray[z+1]=I+ea.y,a.__vertexArray[ca+1]=Z+ea.y,a.__vertexArray[A+2]=W+ea.z,a.__vertexArray[H+2]=ba+ea.z,a.__vertexArray[z+
2]=ka+ea.z,a.__vertexArray[ca+2]=la+ea.z,a.__colorArray[A]=g.r,a.__colorArray[H]=g.r,a.__colorArray[z]=g.r,a.__colorArray[ca]=g.r,a.__colorArray[A+1]=g.g,a.__colorArray[H+1]=g.g,a.__colorArray[z+1]=g.g,a.__colorArray[ca+1]=g.g,a.__colorArray[A+2]=g.b,a.__colorArray[H+2]=g.b,a.__colorArray[z+2]=g.b,a.__colorArray[ca+2]=g.b,V=h[0]*r[f].x+h[3]*r[f].y+h[6]*r[f].z,O=h[0]*r[l].x+h[3]*r[l].y+h[6]*r[l].z,U=h[0]*r[w].x+h[3]*r[w].y+h[6]*r[w].z,aa=h[0]*r[n].x+h[3]*r[n].y+h[6]*r[n].z,C=h[1]*r[f].x+h[4]*r[f].y+
h[7]*r[f].z,P=h[1]*r[l].x+h[4]*r[l].y+h[7]*r[l].z,I=h[1]*r[w].x+h[4]*r[w].y+h[7]*r[w].z,Z=h[1]*r[n].x+h[4]*r[n].y+h[7]*r[n].z,W=h[5]*r[f].y+h[8]*r[f].z,ba=h[5]*r[l].y+h[8]*r[l].z,ka=h[5]*r[w].y+h[8]*r[w].z,la=h[5]*r[n].y+h[8]*r[n].z,0===B?(a.__normalArray[A]=V,a.__normalArray[z]=U,a.__normalArray[ca]=aa,a.__normalArray[A+1]=C,a.__normalArray[z+1]=I,a.__normalArray[ca+1]=Z,a.__normalArray[A+2]=W,a.__normalArray[z+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[v]=f+t,a.__faceArray[v+1]=w+t,a.__faceArray[v+
2]=n+t,a.faceidx+=3):B===d-1?(a.__normalArray[A]=V,a.__normalArray[H]=O,a.__normalArray[z]=U,a.__normalArray[A+1]=C,a.__normalArray[H+1]=P,a.__normalArray[z+1]=I,a.__normalArray[A+2]=W,a.__normalArray[H+2]=ba,a.__normalArray[z+2]=ka,a.__faceArray[v]=f+t,a.__faceArray[v+1]=l+t,a.__faceArray[v+2]=w+t,a.faceidx+=3):(a.__normalArray[A]=V,a.__normalArray[H]=O,a.__normalArray[ca]=aa,a.__normalArray[A+1]=C,a.__normalArray[H+1]=P,a.__normalArray[ca+1]=Z,a.__normalArray[A+2]=W,a.__normalArray[H+2]=ba,a.__normalArray[ca+
2]=la,a.__normalArray[H]=O,a.__normalArray[z]=U,a.__normalArray[ca]=aa,a.__normalArray[H+1]=P,a.__normalArray[z+1]=I,a.__normalArray[ca+1]=Z,a.__normalArray[H+2]=ba,a.__normalArray[z+2]=ka,a.__normalArray[ca+2]=la,a.__faceArray[v]=f+t,a.__faceArray[v+1]=l+t,a.__faceArray[v+2]=n+t,a.__faceArray[v+3]=l+t,a.__faceArray[v+4]=w+t,a.__faceArray[v+5]=n+t,a.faceidx+=6)}}a.vertices+=y}}function g(p,b){if(p.style.sphere){var c=p.style.sphere;if(!c.hidden){var e=p.color;"undefined"!=typeof c.color&&(e=c.color);
var g=WebMol.i.color(e),d,c=a(p,c);!0===p.clickable&&void 0!==p.intersectionShape&&(e=new WebMol.Vector3(p.x,p.y,p.z),p.intersectionShape.sphere.push(new WebMol.Sphere(e,c)));d=r.m(c);for(var e=d.vertices,f=d.j,l=b.updateGeoGroup(e.length),h=l.vertices,q=0,y=e.length;q<y;++q){var n=3*(h+q),m=e[q];l.__vertexArray[n]=m.x+p.x;l.__vertexArray[n+1]=m.y+p.y;l.__vertexArray[n+2]=m.z+p.z;l.__colorArray[n]=g.r;l.__colorArray[n+1]=g.g;l.__colorArray[n+2]=g.b}l.vertices+=e.length;q=d.k;y=q.length-1;for(d=0;d<
y;d++)for(n=q[d].length-1,g=0;g<n;g++){var m=l.faceidx,z=q[d][g+1]+h,w=3*z,t=q[d][g]+h,v=3*t,A=q[d+1][g]+h,x=3*A,u=q[d+1][g+1]+h,s=3*u,B=f[z-h],H=f[t-h],V=f[A-h],O=f[u-h];Math.abs(e[z-h].y)===c?(l.__normalArray[w]=B.x,l.__normalArray[x]=V.x,l.__normalArray[s]=O.x,l.__normalArray[w+1]=B.y,l.__normalArray[x+1]=V.y,l.__normalArray[s+1]=O.y,l.__normalArray[w+2]=B.z,l.__normalArray[x+2]=V.z,l.__normalArray[s+2]=O.z,l.__faceArray[m]=z,l.__faceArray[m+1]=A,l.__faceArray[m+2]=u,l.faceidx+=3):Math.abs(e[A-
h].y)===c?(l.__normalArray[w]=B.x,l.__normalArray[v]=H.x,l.__normalArray[x]=V.x,l.__normalArray[w+1]=B.y,l.__normalArray[v+1]=H.y,l.__normalArray[x+1]=V.y,l.__normalArray[w+2]=B.z,l.__normalArray[v+2]=H.z,l.__normalArray[x+2]=V.z,l.__faceArray[m]=z,l.__faceArray[m+1]=t,l.__faceArray[m+2]=A,l.faceidx+=3):(l.__normalArray[w]=B.x,l.__normalArray[v]=H.x,l.__normalArray[s]=O.x,l.__normalArray[w+1]=B.y,l.__normalArray[v+1]=H.y,l.__normalArray[s+1]=O.y,l.__normalArray[w+2]=B.z,l.__normalArray[v+2]=H.z,l.__normalArray[s+
2]=O.z,l.__normalArray[v]=H.x,l.__normalArray[x]=V.x,l.__normalArray[s]=O.x,l.__normalArray[v+1]=H.y,l.__normalArray[x+1]=V.y,l.__normalArray[s+1]=O.y,l.__normalArray[v+2]=H.z,l.__normalArray[x+2]=V.z,l.__normalArray[s+2]=O.z,l.__faceArray[m]=z,l.__faceArray[m+1]=t,l.__faceArray[m+2]=u,l.__faceArray[m+3]=t,l.__faceArray[m+4]=A,l.__faceArray[m+5]=u,l.faceidx+=6)}}}}function a(a,b){var c=1.5;"undefined"!=typeof b.radius?c=b.radius:t[a.elem]&&(c=t[a.elem]);"undefined"!=typeof b.scale&&(c*=b.scale);return c}
var b=[],y=null,v=null,f=null,A=null,z=WebMol.ja;ElementColors=c?c:WebMol.R;var s={q:function(){var a=[];a[0]=new WebMol.Vector3(-1,0,0);a[4]=new WebMol.Vector3(0,0,1);a[8]=new WebMol.Vector3(1,0,0);a[12]=new WebMol.Vector3(0,0,-1);a[2]=a[0].clone().add(a[4]).normalize();a[6]=a[4].clone().add(a[8]).normalize();a[10]=a[8].clone().add(a[12]).normalize();a[14]=a[12].clone().add(a[0]).normalize();a[1]=a[0].clone().add(a[2]).normalize();a[3]=a[2].clone().add(a[4]).normalize();a[5]=a[4].clone().add(a[6]).normalize();
a[7]=a[6].clone().add(a[8]).normalize();a[9]=a[8].clone().add(a[10]).normalize();a[11]=a[10].clone().add(a[12]).normalize();a[13]=a[12].clone().add(a[14]).normalize();a[15]=a[14].clone().add(a[0]).normalize();return a}(),h:{},m:function(a){if(void 0!==this.h[a])return this.h[a];new WebMol.Vector3(0,1,0);for(var b=this.q.length,c=[],e=[],g,d=0;d<b;d++)c.push(this.q[d].clone().multiplyScalar(a)),c.push(this.q[d].clone().multiplyScalar(a)),g=this.q[d].clone().normalize(),e.push(g),e.push(g);var d=[],
f=2*Math.PI,l=Math.PI,h,q,r=!1,y=!1;for(q=0;10>=q;q++){var r=0===q||10===q?!0:!1,y=5===q?!0:!1,m=[],n=[];for(h=0;h<=b;h++)if(y){var w=h<b?2*h:0;n.push(w+1);m.push(w)}else{g=h/b;var z=q/10;r&&0!==h?r&&m.push(c.length-1):h<b?(w=new WebMol.Vector3,w.x=-a*Math.cos(0+g*f)*Math.sin(0+z*l),w.y=a*Math.cos(0+z*l),w.z=a*Math.sin(0+g*f)*Math.sin(0+z*l),1E-5>Math.abs(w.x)&&(w.x=0),1E-5>Math.abs(w.y)&&(w.y=0),1E-5>Math.abs(w.z)&&(w.z=0),g=new WebMol.Vector3(w.x,w.y,w.z),g.normalize(),c.push(w),e.push(g),m.push(c.length-
1)):m.push(c.length-b)}y&&d.push(n);d.push(m)}b={vertices:c,j:e,k:d,w:b,ua:10};return this.h[a]=b}},r={h:{},m:function(a){if("undefined"!=typeof this.h[a])return this.h[a];var b={vertices:[],k:[],j:[]},c=12,e=10;1>a&&(c=8,e=6);var g=2*Math.PI,d=Math.PI,f,l;for(l=0;l<=e;l++){var h=[];for(f=0;f<=c;f++){var q=f/c,r=l/e,y={};y.x=-a*Math.cos(0+q*g)*Math.sin(0+r*d);y.y=a*Math.cos(0+r*d);y.z=a*Math.sin(0+q*g)*Math.sin(0+r*d);q=new WebMol.Vector3(y.x,y.y,y.z);q.normalize();b.vertices.push(y);b.j.push(q);
h.push(b.vertices.length-1)}b.k.push(h)}return this.h[a]=b}},D=function(){var a=new WebMol.Vector3;return function(b){a.copy(b);var c=a.x,e=a.y,g=a.z,d=Math.sqrt(c*c+e*e);1E-4>d?(b=0,d=1):(b=-c/d,d=e/d);e=-b*c+d*e;c=Math.sqrt(e*e+g*g);1E-4>c?(g=0,e=1):(g/=c,e/=c);rot=new Float32Array(9);rot[0]=d;rot[1]=b;rot[2]=0;rot[3]=-b*e;rot[4]=d*e;rot[5]=g;rot[6]=b*g;rot[7]=-d*g;rot[8]=e;return rot}}(),x=0;this.getID=function(){return d};this.addMolData=function(a,c){a||console.error("Erorr with addMolData: No input data specified");
switch(c){case "xyz":var e=b,g=a.split("\n");if(!(3>g.length)){var f=parseInt(g[0].substr(0,3));if(!(isNaN(f)||0>=f||g.length<f+2)){for(var y=2,r=e.length,f=r+f;r<f;r++){var l=g[y++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),h={};h.serial=r;h.atom=h.elem=l[0];h.x=parseFloat(l[1]);h.y=parseFloat(l[2]);h.z=parseFloat(l[3]);h.hetflag=!0;h.bonds=[];h.bondOrder=[];h.singleBonds=!0;h.properties={};e[r]=h}C(e)}}break;case "pdb":var e=b,g=e.length,n,y=[],f=[],l=[],h=a.split("\n"),t,v,m;for(t=0;t<
h.length;t++){m=h[t].replace(/^\s*/,"");n=m.substr(0,6);var A;if("ATOM  "==n||"HETATM"==n){var w,x,s,J,D,N,Y,R,H;n=m.substr(16,1);if(" "==n||"A"==n)R=parseInt(m.substr(6,5)),n=m.substr(12,4).replace(/ /g,""),v=m.substr(17,3),A=m.substr(21,1),w=parseInt(m.substr(22,4)),x=m.substr(26,1),s=parseFloat(m.substr(30,8)),J=parseFloat(m.substr(38,8)),D=parseFloat(m.substr(46,8)),H=parseFloat(m.substr(60,8)),Y=m.substr(76,2).replace(/ /g,""),""===Y&&(Y=m.substr(12,2).replace(/ /g,"")),"H"!=Y&&"HH"!=Y&&"HD"!=
Y&&(N="H"==m[0]?!0:!1,l[R]=e.length,e.push({resn:v,x:s,y:J,z:D,elem:Y,hetflag:N,chain:A,resi:w,icode:x,rescode:w+(" "!=x?"^"+x:""),serial:R,atom:n,bonds:[],ss:"c",singleBonds:!0,bondOrder:[],properties:{},b:H,pdbline:m}))}else if("SHEET "==n)n=m.substr(21,1),v=parseInt(m.substr(22,4)),A=m.substr(32,1),m=parseInt(m.substr(33,4)),y.push([n,v,A,m]);else if("CONECT"==n)for(n=e[l[parseInt(m.substr(6,5))]],v=0;4>v;v++)A=parseInt(m.substr([11,16,21,26][v],5)),w=e[l[A]],void 0!==n&&void 0!==w&&(n.bonds.push(l[A]),
n.bondOrder.push(1));else"HELIX "==n&&(n=m.substr(19,1),v=parseInt(m.substr(21,4)),A=m.substr(31,1),m=parseInt(m.substr(33,4)),f.push([n,v,A,m]))}l=(new Date).getTime();B(e);console.log("bond connecting "+((new Date).getTime()-l));l=(new Date).getTime();u(e);h={};m=0;for(n=e.length;m<n;m++)v=e[m],"undefined"===typeof h[v.chain]&&(h[v.chain]=[]),isFinite(v.n)&&(h[v.chain][v.resi]=4===Math.abs(v.J.resi-v.resi)?"h":"s");for(r in h){for(m=1;m<h[r].length-1;m++)n=h[r][m-1],v=h[r][m+1],t=h[r][m],n==v&&
t!=n&&(h[r][m]=n);for(m=0;m<h[r].length;m++)t=h[r][m],"h"!=t&&"s"!=t||h[r][m-1]==t||h[r][m+1]==t||delete h[r][m]}m=0;for(n=e.length;m<n;m++)v=e[m],t=h[v.chain][v.resi],"undefined"!=typeof t&&(v.ss=t,h[v.chain][v.resi-1]!=t&&(v.ca=!0),h[v.chain][v.resi+1]!=t&&(v.da=!0));console.log("secondary structure "+((new Date).getTime()-l));for(t=g;t<e.length;t++)if(n=e[t],void 0!==n){for(v=0;v<y.length;v++)n.chain!=y[v][0]||n.resi<y[v][1]||n.resi>y[v][3]||(n.ss="s",n.resi==y[v][1]&&(n.ca=!0),n.resi==y[v][3]&&
(n.da=!0));for(v=0;v<f.length;v++)n.chain!=f[v][0]||n.resi<f[v][1]||n.resi>f[v][3]||(n.ss="h",n.resi==f[v][1]?n.ca=!0:n.resi==f[v][3]&&(n.da=!0))}break;case "sdf":e=b;g=a.split("\n");if(!(4>g.length||(l=parseInt(g[3].substr(0,3)),isNaN(l)||0>=l||(y=parseInt(g[3].substr(3,3)),f=4,g.length<4+l+y)))){r=e.length;t=r+l;for(l=r;l<t;l++)h=g[f],f++,m={},m.serial=l,m.x=parseFloat(h.substr(0,10)),m.y=parseFloat(h.substr(10,10)),m.z=parseFloat(h.substr(20,10)),m.hetflag=!0,m.singleBonds=!0,m.atom=m.elem=h.substr(31,
3).replace(/ /g,""),m.bonds=[],m.bondOrder=[],m.properties={},e[l]=m;for(l=0;l<y;l++)h=g[f],f++,t=parseInt(h.substr(0,3))-1+r,m=parseInt(h.substr(3,3))-1+r,h=parseInt(h.substr(6,3)),1<h&&(e[t].singleBonds=!1,e[m].singleBonds=!1),e[t].bonds.push(m),e[t].bondOrder.push(h),e[m].bonds.push(t),e[m].bondOrder.push(h)}break;case "mol2":e=b;y=a.search(/@<TRIPOS>MOLECULE/);g=a.search(/@<TRIPOS>ATOM/);if(-1!=y&&-1!=g){g=[];y=a.substr(y,a.length).split("\n");h=y[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");
t=parseInt(h[0]);f=0;1<h.length&&(f=parseInt(h[1]));r=4;for(l=3;l<y.length;l++)if("@<TRIPOS>ATOM"==y[l]){r=l+1;break}l=e.length;for(t=l+t;l<t;l++)h=y[r++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),m={},n=l,v=parseInt(h[0]),m.serial=v,m.x=parseFloat(h[2]),m.y=parseFloat(h[3]),m.z=parseFloat(h[4]),m.atom=m.elem=h[5].split(".")[0],m.singleBonds=!0,"H"!=m.elem&&(m.bonds=[],m.bondOrder=[],m.properties={},g[v]=n,e.push(m));for(l=!1;r<y.length;)if("@<TRIPOS>BOND"==y[r++]){l=!0;break}if(l&&f)for(l=
0;l<f;l++)h=y[r++],h=h.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),t=parseInt(h[1]),fromAtom=e[g[t]],m=parseInt(h[2]),toAtom=e[g[m]],h=parseInt(h[3]),isNaN(h)&&(h=1),1<h&&(fromAtom.singleBonds=!1,toAtom.singleBonds=!1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.bonds.push(g[m]),fromAtom.bondOrder.push(h),toAtom.bonds.push(g[t]),toAtom.bondOrder.push(h))}break;case "cube":if(e=b,g=a.replace(/^\s+/,"").split(/[\n\r]+/),!(6>g.length)){y=g[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");
f=Math.abs(parseFloat(y[0]));y=g[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");y=0<parseFloat(y[0])?.529177:1;g=g.splice(6,f);f=e.length;r=f+g.length;for(l=f;l<r;++l)h={},h.serial=l,t=g[l-f].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),6==t[0]?h.elem="C":1==t[0]?h.elem="H":8==t[0]?h.elem="O":17==t[0]&&(h.elem="CL"),h.x=parseFloat(t[2])*y,h.y=parseFloat(t[3])*y,h.z=parseFloat(t[4])*y,h.hetflag=!0,h.singleBonds=!0,h.bonds=[],h.bondOrder=[],h.properties={},e.push(h);C(e)}}e=b;for(g=0;g<e.length;g++)if(y=
e[g])y.style=y.style||q,y.color=y.color||ElementColors[y.elem]||z,y.W=d,y.clickable&&(y.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]})};this.atomIsSelected=function(a,b){if("undefined"===typeof b)return!0;var c=!!b.Da,e=!0,g;for(g in b)if(b.hasOwnProperty(g)&&"props"!=g&&"invert"!=g&&"model"!=g){if("undefined"===typeof a[g]){e=!1;break}var d=!1;if($.isArray(b[g])){for(var f=b[g],l=0;l<f.length;l++)if(a[g]==f[l]){d=!0;break}if(!d){e=!1;break}}else if(a[g]!=b[g]){e=!1;break}}return c?
!e:e};this.selectedAtoms=function(a){for(var c=[],e=0;e<b.length;e++){var g=b[e];g&&this.atomIsSelected(g,a)&&c.push(g)}return c};this.addAtoms=function(a){y=null;var c=b.length,e=[],g;for(g=0;g<a.length;g++)e[a[g].index]=c+g;for(g=0;g<a.length;g++){var c=a[g],d=e[c.index],f=$.extend(!1,{},c);f.index=d;f.bonds=[];f.bondOrder=[];for(d=0;d<c.bonds.length;d++){var r=e[c.bonds[d]];"undefined"!=typeof r&&(f.bonds.push(r),f.bondOrder.push(c.bondOrder[d]))}b.push(f)}};this.removeAtoms=function(a){y=null;
var c=[],e;for(e=0;e<a.length;e++)c[a[e].index]=!0;a=[];for(e=0;e<b.length;e++){var g=b[e];c[g.index]||a.push(g)}b=[];this.addAtoms(a)};this.setStyle=function(a,b,c){if(c||null===y||!n(b,f)){f=c?null:b;a=this.selectedAtoms(a);0<a.length&&(y=null);b=$.extend(!0,{},b);for(var e=0;e<a.length;e++){a[e].clickable&&(a[e].intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]});a[e].s=!1;c||(a[e].style={});for(var g in b)b.hasOwnProperty(g)&&(a[e].style[g]=b[g])}}};this.setColorByElement=function(a,
b){if(null===y||!n(b,A)){A=b;var c=this.selectedAtoms(a);0<c.length&&(y=null);for(var e=0;e<c.length;e++){var g=c[e];"undefined"!==typeof b[g.elem]&&(g.color=b[g.elem])}}};this.setColorByProperty=function(a,b,c){a=this.selectedAtoms(a);A=null;0<a.length&&(y=null);var e=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,d,f;for(d=0;d<a.length;d++)f=a[d],f.properties&&void 0!==typeof f.properties[b]&&(f=parseFloat(f.properties[b]),f<e&&(e=f),f>g&&(g=f));for(d=0;d<a.length;d++)if(f=a[d],f.properties&&
void 0!==typeof f.properties[b]){var l=c.valueToHex(parseFloat(f.properties[b]),[e,g]);f.color=l}};this.globj=function(c){var f=new Date;if(null===y){var r=b;console.log("creating for "+d);var n=new WebMol.Object3D,q=[],t={},z={},l=new WebMol.Geometry(!0),h=new WebMol.Geometry(!0),A,x;A=0;for(x=r.length;A<x;A++){var u=r[A];if(u&&u.style){u.clickable&&void 0===u.intersectionShape&&(u.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]});g(u,l);var m=u,s=z;if(m.style.cross){var w=m.style.cross;
if(!w.hidden){var B=w.linewidth||1;s[B]||(s[B]=new WebMol.Geometry);s=s[B].updateGeoGroup(6);w=a(m,w);w=[[w,0,0],[-w,0,0],[0,w,0],[0,-w,0],[0,0,w],[0,0,-w]];(B=m.clickable)&&void 0===m.intersectionShape&&(m.intersectionShape={sphere:[],cylinder:[],line:[]});for(var J=WebMol.i.color(m.color),C=0;6>C;C++){var D=3*s.vertices;s.vertices++;s.__vertexArray[D]=m.x+w[C][0];s.__vertexArray[D+1]=m.y+w[C][1];s.__vertexArray[D+2]=m.z+w[C][2];s.__colorArray[D]=J.r;s.__colorArray[D+1]=J.g;s.__colorArray[D+2]=J.b;
B&&(D=new WebMol.Vector3(w[C][0],w[C][1],w[C][2]),D.multiplyScalar(.1),D.set(D.x+m.x,D.y+m.y,D.z+m.z),m.intersectionShape.line.push(D))}}}m=u;s=r;w=t;if(m.style.line&&(B=m.style.line,!B.hidden))for(B=B.linewidth||1,w[B]||(w[B]=new WebMol.Geometry),w=w[B].updateGeoGroup(2*m.bonds.length),B=0;B<m.bonds.length;B++)if(C=s[m.bonds[B]],C.style.line){J=new WebMol.Vector3(m.x,m.y,m.z);C=new WebMol.Vector3(C.x,C.y,C.z);C=J.clone().add(C).multiplyScalar(.5);m.clickable&&(void 0===m.intersectionShape&&(m.intersectionShape=
{sphere:[],cylinder:[],line:[],triangle:[]}),m.intersectionShape.line.push(J),m.intersectionShape.line.push(C));var D=WebMol.i.color(m.color),N=3*w.vertices;w.vertices+=2;w.__vertexArray[N]=J.x;w.__vertexArray[N+1]=J.y;w.__vertexArray[N+2]=J.z;w.__colorArray[N]=D.r;w.__colorArray[N+1]=D.g;w.__colorArray[N+2]=D.b;w.__vertexArray[N+3]=C.x;w.__vertexArray[N+4]=C.y;w.__vertexArray[N+5]=C.z;w.__colorArray[N+3]=D.r;w.__colorArray[N+4]=D.g;w.__colorArray[N+5]=D.b}m=u;J=r;s=h;if(m.style.stick&&(C=m.style.stick,
!C.hidden)){w=C.radius||.25;N=D=!1;B=m.color;"undefined"!=typeof C.color&&(B=C.color);var Y=WebMol.i.color(B),R=void 0,H=void 0;!m.s&&4>m.bonds.length&&(D=!0);for(var V=0;V<m.bonds.length;V++){var O=J[m.bonds[V]];if(m.serial<O.serial&&O.style.stick){var U=new WebMol.Vector3(m.x,m.y,m.z),aa=new WebMol.Vector3(O.x,O.y,O.z),R=O.color;"undefined"!=typeof C.color&&(R=C.color);var da=WebMol.i.color(R);if(1===m.bondOrder[V]){if(!O.s&&4>O.bonds.length&&(N=!0),B!=R?(R=(new WebMol.Vector3).addVectors(U,aa).multiplyScalar(.5),
e(s,U,R,w,Y,D,!1),e(s,R,aa,w,da,!1,N)):e(s,U,aa,w,Y,D,N),m.clickable||O.clickable)R=(new WebMol.Vector3).addVectors(U,aa).multiplyScalar(.5),m.clickable&&(da=new WebMol.Cylinder(U.clone(),R.clone(),w),U=new WebMol.Sphere(U.clone(),w),m.intersectionShape.cylinder.push(da),m.intersectionShape.sphere.push(U)),O.clickable&&(U=new WebMol.Cylinder(aa.clone(),R.clone(),w),aa=new WebMol.Sphere(aa.clone(),w),O.intersectionShape.cylinder.push(U),O.intersectionShape.sphere.push(aa))}else if(1<m.bondOrder[V]){var N=
D=!1,H=aa.clone(),P=null;H.sub(U);var I,Z,W,ba;1===m.bonds.length?1===O.bonds.length?(P=H.clone(),1E-4<Math.abs(P.x)?P.y+=1:P.x+=1):(I=(V+1)%O.bonds.length,I=O.bonds[I],I=J[I],I=new WebMol.Vector3(I.x,I.y,I.z),I=I.clone(),I.sub(U),P=I.clone(),P.cross(H)):(I=(V+1)%m.bonds.length,I=m.bonds[I],I=J[I],I=new WebMol.Vector3(I.x,I.y,I.z),I=I.clone(),I.sub(U),P=I.clone(),P.cross(H));if(2==m.bondOrder[V]){if(I=w/2.5,P.cross(H),P.normalize(),P.multiplyScalar(1.5*I),Z=U.clone(),Z.add(P),W=U.clone(),W.sub(P),
P=Z.clone(),P.add(H),ba=W.clone(),ba.add(H),B!=R?(R=(new WebMol.Vector3).addVectors(Z,P).multiplyScalar(.5),H=(new WebMol.Vector3).addVectors(W,ba).multiplyScalar(.5),e(s,Z,R,I,Y,D,!1),e(s,R,P,I,da,!1,N),e(s,W,H,I,Y,D,!1),e(s,H,ba,I,da,!1,N)):(e(s,Z,P,I,Y,D,N),e(s,W,ba,I,Y,D,N)),m.clickable||O.clickable)R=(new WebMol.Vector3).addVectors(Z,P).multiplyScalar(.5),H=(new WebMol.Vector3).addVectors(W,ba).multiplyScalar(.5),m.clickable&&(da=new WebMol.Cylinder(Z.clone(),R.clone(),I),W=new WebMol.Cylinder(W.clone(),
H.clone(),I),m.intersectionShape.cylinder.push(da),m.intersectionShape.cylinder.push(W)),O.clickable&&(cylinder2a=new WebMol.Cylinder(P.clone(),R.clone(),I),cylinder2b=new WebMol.Cylinder(ba.clone(),H.clone(),I),O.intersectionShape.cylinder.push(cylinder2a),O.intersectionShape.cylinder.push(cylinder2b))}else 3==m.bondOrder[V]&&(I=w/4,P.cross(H),P.normalize(),P.multiplyScalar(3*I),Z=U.clone(),Z.add(P),W=U.clone(),W.sub(P),P=Z.clone(),P.add(H),ba=W.clone(),ba.add(H),B!=R?(R=(new WebMol.Vector3).addVectors(Z,
P).multiplyScalar(.5),H=(new WebMol.Vector3).addVectors(W,ba).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(U,aa).multiplyScalar(.5),e(s,Z,R,I,Y,D,!1),e(s,R,P,I,da,!1,N),e(s,U,mp3,I,Y,D,!1),e(s,mp3,aa,I,da,!1,N),e(s,W,H,I,Y,D,!1),e(s,H,ba,I,da,!1,N)):(e(s,Z,P,I,Y,D,N),e(s,U,aa,I,Y,D,N),e(s,W,ba,I,Y,D,N)),m.clickable||O.clickable)&&(R=(new WebMol.Vector3).addVectors(Z,P).multiplyScalar(.5),H=(new WebMol.Vector3).addVectors(W,ba).multiplyScalar(.5),mp3=(new WebMol.Vector3).addVectors(U,aa).multiplyScalar(.5),
m.clickable&&(da=new WebMol.Cylinder(Z.clone(),R.clone(),I),W=new WebMol.Cylinder(W.clone(),H.clone(),I),U=new WebMol.Cylinder(U.clone(),mp3.clone(),I),m.intersectionShape.cylinder.push(da),m.intersectionShape.cylinder.push(W),m.intersectionShape.cylinder.push(U)),O.clickable&&(cylinder2a=new WebMol.Cylinder(P.clone(),R.clone(),I),cylinder2b=new WebMol.Cylinder(ba.clone(),H.clone(),I),cylinder2c=new WebMol.Cylinder(aa.clone(),mp3.clone(),I),O.intersectionShape.cylinder.push(cylinder2a),O.intersectionShape.cylinder.push(cylinder2b),
O.intersectionShape.cylinder.push(cylinder2c)))}if(N||3<O.bonds.length)O.s=!0;if(D||3<m.bonds.length)m.s=!0}}if(!m.singleBonds&&1===m.bonds.length||!m.bonds.length)J=m.style,m.style={sphere:{radius:w,color:B}},g(m,s),m.style=J}"undefined"===typeof u.style.cartoon||u.style.cartoon.hidden||q.push(u)}}if(0<q.length)for(WebMol.ka(n,q,!1),A=0;A<n.children.length;A++);0<l.vertices&&(r=new WebMol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0}),l.initTypedArrays(),r=new WebMol.Mesh(l,r),console.log("sphere geometry "+
l.vertices.length),n.add(r));0<h.vertices&&(l=new WebMol.MeshLambertMaterial({vertexColors:!0,ambient:0,reflectivity:0}),h.initTypedArrays(),l.wireframe&&h.setUpWireframe(),h=new WebMol.Mesh(h,l),n.add(h));for(A in t)t.hasOwnProperty(A)&&(h=A,h=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),t[A].initTypedArrays(),h=new WebMol.Line(t[A],h,WebMol.LinePieces),n.add(h));for(A in z)z.hasOwnProperty(A)&&(h=A,t=new WebMol.LineBasicMaterial({linewidth:h,vertexColors:!0}),z[A].initTypedArrays(),
t=new WebMol.Line(z[A],t,WebMol.LinePieces),n.add(t));y=n;console.log("object creation time: "+(new Date-f));v&&(c.remove(v),v=null);v=y.clone();c.add(v)}};this.removegl=function(a){v&&(void 0!==v.geometry&&v.geometry.dispose(),void 0!==v.material&&v.material.dispose(),a.remove(v),v=null);y=null}}}();
WebMol.GLShape=function(){function u(n,q){q=q||{};WebMol.ShapeIDCount++;this.id=n;this.boundingSphere=new WebMol.Sphere;this.intersectionShape={sphere:[],cylinder:[],line:[],triangle:[]};D(this,q);var t=[],d=null,c=null,e=new WebMol.Geometry(!0);this.updateStyle=function(c){for(var a in c)q[a]=c[a];D(this,q)};this.addCustom=function(c){c.vertexArr=c.vertexArr||[];c.faceArr=c.faceArr||[];c.normalArr=c.normalArr||[];c.lineArr=c.lineArr||[];var a=e.addGeoGroup();C(this,a,c);a.truncateArrayBuffers(!0);
for(c=0;c<a.__colorArray.length/3;++c)a.__colorArray[3*c]=this.color.r,a.__colorArray[3*c+1]=this.color.g,a.__colorArray[3*c+2]=this.color.b;t.push({id:a.id,G:a,t:a.getCentroid()});B(this.boundingSphere,t,a.__vertexArray)};this.addSphere=function(c){c.center=c.center||{x:0,y:0,z:0};c.radius=c.radius?WebMol.Math.clamp(c.radius,0,Infinity):1.5;var a=e.addGeoGroup(),b=c.center,d=c.radius,n=new WebMol.Vector3(b.x,b.y,b.z);this.intersectionShape.sphere.push(new WebMol.Sphere(n,d));var f;f=s.m(d);for(var n=
f.vertices,q=f.j,z=a.vertices,u=0,r=n.length;u<r;++u){var C=3*(z+u),x=n[u];a.__vertexArray[C]=x.x+b.x;a.__vertexArray[C+1]=x.y+b.y;a.__vertexArray[C+2]=x.z+b.z}a.vertices+=n.length;u=f.k;r=u.length-1;for(f=0;f<r;f++)for(C=u[f].length-1,b=0;b<C;b++){var x=a.faceidx,p=a.lineidx,D=u[f][b+1]+z,Q=3*D,M=u[f][b]+z,G=3*M,L=u[f+1][b]+z,T=3*L,l=u[f+1][b+1]+z,h=3*l,E=q[D-z],X=q[M-z],S=q[L-z],m=q[l-z];Math.abs(n[D-z].y)===d?(a.__normalArray[Q]=E.x,a.__normalArray[T]=S.x,a.__normalArray[h]=m.x,a.__normalArray[Q+
1]=E.y,a.__normalArray[T+1]=S.y,a.__normalArray[h+1]=m.y,a.__normalArray[Q+2]=E.z,a.__normalArray[T+2]=S.z,a.__normalArray[h+2]=m.z,a.__faceArray[x]=D,a.__faceArray[x+1]=L,a.__faceArray[x+2]=l,a.__lineArray[p]=D,a.__lineArray[p+1]=L,a.__lineArray[p+2]=D,a.__lineArray[p+3]=l,a.__lineArray[p+4]=L,a.__lineArray[p+5]=l,a.faceidx+=3,a.lineidx+=6):Math.abs(n[L-z].y)===d?(a.__normalArray[Q]=E.x,a.__normalArray[G]=X.x,a.__normalArray[T]=S.x,a.__normalArray[Q+1]=E.y,a.__normalArray[G+1]=X.y,a.__normalArray[T+
1]=S.y,a.__normalArray[Q+2]=E.z,a.__normalArray[G+2]=X.z,a.__normalArray[T+2]=S.z,a.__faceArray[x]=D,a.__faceArray[x+1]=M,a.__faceArray[x+2]=L,a.__lineArray[p]=D,a.__lineArray[p+1]=M,a.__lineArray[p+2]=D,a.__lineArray[p+3]=L,a.__lineArray[p+4]=M,a.__lineArray[p+5]=L,a.faceidx+=3,a.lineidx+=6):(a.__normalArray[Q]=E.x,a.__normalArray[G]=X.x,a.__normalArray[h]=m.x,a.__normalArray[Q+1]=E.y,a.__normalArray[G+1]=X.y,a.__normalArray[h+1]=m.y,a.__normalArray[Q+2]=E.z,a.__normalArray[G+2]=X.z,a.__normalArray[h+
2]=m.z,a.__normalArray[G]=X.x,a.__normalArray[T]=S.x,a.__normalArray[h]=m.x,a.__normalArray[G+1]=X.y,a.__normalArray[T+1]=S.y,a.__normalArray[h+1]=m.y,a.__normalArray[G+2]=X.z,a.__normalArray[T+2]=S.z,a.__normalArray[h+2]=m.z,a.__faceArray[x]=D,a.__faceArray[x+1]=M,a.__faceArray[x+2]=l,a.__faceArray[x+3]=M,a.__faceArray[x+4]=L,a.__faceArray[x+5]=l,a.__lineArray[p]=D,a.__lineArray[p+1]=M,a.__lineArray[p+2]=D,a.__lineArray[p+3]=l,a.__lineArray[p+4]=M,a.__lineArray[p+5]=L,a.__lineArray[p+6]=L,a.__lineArray[p+
7]=l,a.faceidx+=6,a.lineidx+=8)}a.truncateArrayBuffers(!0);t.push({id:a.id,G:a,t:new WebMol.Vector3(c.center.x,c.center.y,c.center.z)});B(this.boundingSphere,t,a.__vertexArray)};this.addArrow=function(c){c.start=c.start||{};c.end=c.end||{};c.start=new WebMol.Vector3(c.start.x||0,c.start.y||0,c.start.z||0);c.end=new WebMol.Vector3(c.end.x||3,c.end.y||0,c.end.z||0);c.radius=c.radius||.25;c.radiusRatio=c.radiusRatio||1.618034;c.mid=0<c.mid&&1>c.mid?c.mid:.618034;var a=e.addGeoGroup(),b=c.start,d=c.end,
n=c.radius,f=c.radiusRatio,q=c.mid;if(b&&d){var z=d.clone();z.sub(b).multiplyScalar(q);var s=b.clone().add(z),q=z.clone().negate();this.intersectionShape.cylinder.push(new WebMol.Cylinder(b.clone(),s.clone(),n));this.intersectionShape.sphere.push(new WebMol.Sphere(b.clone(),n));var r=[];r[0]=z.clone();1E-4<Math.abs(r[0].x)?r[0].y+=1:r[0].x+=1;r[0].cross(z);r[0].normalize();r[0]=r[0];r[4]=r[0].clone();r[4].crossVectors(r[0],z);r[4].normalize();r[8]=r[0].clone().negate();r[12]=r[4].clone().negate();
r[2]=r[0].clone().add(r[4]).normalize();r[6]=r[4].clone().add(r[8]).normalize();r[10]=r[8].clone().add(r[12]).normalize();r[14]=r[12].clone().add(r[0]).normalize();r[1]=r[0].clone().add(r[2]).normalize();r[3]=r[2].clone().add(r[4]).normalize();r[5]=r[4].clone().add(r[6]).normalize();r[7]=r[6].clone().add(r[8]).normalize();r[9]=r[8].clone().add(r[10]).normalize();r[11]=r[10].clone().add(r[12]).normalize();r[13]=r[12].clone().add(r[14]).normalize();r[15]=r[14].clone().add(r[0]).normalize();var u=a.vertices,
x,p,D;p=0;for(D=r.length;p<D;++p){x=3*(u+3*p);var C=r[p].clone().multiplyScalar(n).add(b),M=r[p].clone().multiplyScalar(n).add(s),G=r[p].clone().multiplyScalar(n*f).add(s);a.__vertexArray[x]=C.x;a.__vertexArray[x+1]=C.y;a.__vertexArray[x+2]=C.z;a.__vertexArray[x+3]=M.x;a.__vertexArray[x+4]=M.y;a.__vertexArray[x+5]=M.z;a.__vertexArray[x+6]=G.x;a.__vertexArray[x+7]=G.y;a.__vertexArray[x+8]=G.z;0<p&&(x=new WebMol.Vector3(a.__vertexArray[x-3],a.__vertexArray[x-2],a.__vertexArray[x-1]),C=d.clone(),M=s.clone(),
G=new WebMol.Vector3(G.x,G.y,G.z),this.intersectionShape.triangle.push(new WebMol.Triangle(G,C,x)),this.intersectionShape.triangle.push(new WebMol.Triangle(x.clone(),M,G.clone())))}a.vertices+=48;x=3*a.vertices;a.__vertexArray[x]=b.x;a.__vertexArray[x+1]=b.y;a.__vertexArray[x+2]=b.z;a.__vertexArray[x+3]=s.x;a.__vertexArray[x+4]=s.y;a.__vertexArray[x+5]=s.z;a.__vertexArray[x+6]=d.x;a.__vertexArray[x+7]=d.y;a.__vertexArray[x+8]=d.z;a.vertices+=3;var L,T,l,h,E,X,S,m,K,w=a.vertices-3,ha=a.vertices-2,
fa=a.vertices-1,ga=3*w,ia=3*ha,ja=3*fa;p=0;for(D=r.length-1;p<D;++p)L=u+3*p,b=a.faceidx,d=a.lineidx,n=L,C=3*n,f=L+1,M=3*f,s=L+2,T=3*s,G=L+4,l=3*G,x=L+5,h=3*x,L+=3,E=3*L,X=S=r[p],m=K=r[p+1],a.__normalArray[C]=X.x,a.__normalArray[M]=S.x,a.__normalArray[E]=K.x,a.__normalArray[C+1]=X.y,a.__normalArray[M+1]=S.y,a.__normalArray[E+1]=K.y,a.__normalArray[C+2]=X.z,a.__normalArray[M+2]=S.z,a.__normalArray[E+2]=K.z,a.__normalArray[M]=S.x,a.__normalArray[l]=m.x,a.__normalArray[E]=K.x,a.__normalArray[M+1]=S.y,
a.__normalArray[l+1]=m.y,a.__normalArray[E+1]=K.y,a.__normalArray[M+2]=S.z,a.__normalArray[l+2]=m.z,a.__normalArray[E+2]=K.z,a.__normalArray[T]=S.x,a.__normalArray[h]=m.x,a.__normalArray[T+1]=S.y,a.__normalArray[h+1]=m.y,a.__normalArray[T+2]=S.z,a.__normalArray[h+2]=m.z,a.__faceArray[b]=n,a.__faceArray[b+1]=f,a.__faceArray[b+2]=L,a.__faceArray[b+3]=f,a.__faceArray[b+4]=G,a.__faceArray[b+5]=L,a.__faceArray[b+6]=n,a.__faceArray[b+7]=L,a.__faceArray[b+8]=w,a.__faceArray[b+9]=s,a.__faceArray[b+10]=ha,
a.__faceArray[b+11]=x,a.__faceArray[b+12]=s,a.__faceArray[b+13]=fa,a.__faceArray[b+14]=x,a.__lineArray[d]=n,a.__lineArray[d+1]=f,a.__lineArray[d+2]=n,a.__lineArray[d+3]=L,a.__lineArray[d+4]=G,a.__lineArray[d+5]=L,a.__lineArray[d+6]=n,a.__lineArray[d+7]=L,a.__lineArray[d+8]=s,a.__lineArray[d+9]=f,a.__lineArray[d+10]=s,a.__lineArray[d+11]=x,a.__lineArray[d+12]=G,a.__lineArray[d+13]=x,a.__lineArray[d+14]=s,a.__lineArray[d+15]=fa,a.__lineArray[d+16]=s,a.__lineArray[d+17]=x,a.__lineArray[d+18]=fa,a.__lineArray[d+
19]=x,a.faceidx+=15,a.lineidx+=20;u=[u+45,u+46,u+1,u,u+47,u+2];b=a.faceidx;d=a.lineidx;n=u[0];C=3*n;f=u[1];M=3*f;s=u[4];T=3*s;G=u[2];l=3*G;x=u[5];h=3*x;L=u[3];E=3*L;X=S=r[15];m=K=r[0];a.__normalArray[C]=X.x;a.__normalArray[M]=S.x;a.__normalArray[E]=K.x;a.__normalArray[C+1]=X.y;a.__normalArray[M+1]=S.y;a.__normalArray[E+1]=K.y;a.__normalArray[C+2]=X.z;a.__normalArray[M+2]=S.z;a.__normalArray[E+2]=K.z;a.__normalArray[M]=S.x;a.__normalArray[l]=m.x;a.__normalArray[E]=K.x;a.__normalArray[M+1]=S.y;a.__normalArray[l+
1]=m.y;a.__normalArray[E+1]=K.y;a.__normalArray[M+2]=S.z;a.__normalArray[l+2]=m.z;a.__normalArray[E+2]=K.z;a.__normalArray[T]=S.x;a.__normalArray[h]=m.x;a.__normalArray[T+1]=S.y;a.__normalArray[h+1]=m.y;a.__normalArray[T+2]=S.z;a.__normalArray[h+2]=m.z;z.normalize();q.normalize();a.__normalArray[ga]=q.x;a.__normalArray[ia]=a.__normalArray[ja]=z.x;a.__normalArray[ga+1]=q.y;a.__normalArray[ia+1]=a.__normalArray[ja+1]=z.y;a.__normalArray[ga+2]=q.z;a.__normalArray[ia+2]=a.__normalArray[ja+2]=z.z;a.__faceArray[b]=
n;a.__faceArray[b+1]=f;a.__faceArray[b+2]=L;a.__faceArray[b+3]=f;a.__faceArray[b+4]=G;a.__faceArray[b+5]=L;a.__faceArray[b+6]=n;a.__faceArray[b+7]=L;a.__faceArray[b+8]=w;a.__faceArray[b+9]=s;a.__faceArray[b+10]=ha;a.__faceArray[b+11]=x;a.__faceArray[b+12]=s;a.__faceArray[b+13]=fa;a.__faceArray[b+14]=x;a.__lineArray[d]=n;a.__lineArray[d+1]=f;a.__lineArray[d+2]=n;a.__lineArray[d+3]=L;a.__lineArray[d+4]=G;a.__lineArray[d+5]=L;a.__lineArray[d+6]=n;a.__lineArray[d+7]=L;a.__lineArray[d+8]=s;a.__lineArray[d+
9]=f;a.__lineArray[d+10]=s;a.__lineArray[d+11]=x;a.__lineArray[d+12]=G;a.__lineArray[d+13]=x;a.__lineArray[d+14]=s;a.__lineArray[d+15]=fa;a.__lineArray[d+16]=s;a.__lineArray[d+17]=x;a.__lineArray[d+18]=fa;a.__lineArray[d+19]=x;a.faceidx+=15;a.lineidx+=20}a.truncateArrayBuffers(!0);z=new WebMol.Vector3;t.push({id:a.id,G:a,t:z.addVectors(c.start,c.end).multiplyScalar(.5)});B(this.boundingSphere,t,a.__vertexArray)};this.addVolumetricData=function(c,a,b){var d=void 0!==b.isoval&&"number"===typeof b.isoval?
b.isoval:0,n=b.voxel?!0:!1,f=e.addGeoGroup();switch(a){case "cube":var q=c.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>q.length)){var s=q[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),u=Math.abs(parseFloat(s[0]));c=new WebMol.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]));var s=q[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),r=0<parseFloat(s[0])?.529177:1;c.multiplyScalar(r);a=Math.abs(s[0]);var D=(new WebMol.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]))).multiplyScalar(r),
s=q[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),x=Math.abs(s[0]);(new WebMol.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]))).multiplyScalar(r);var s=q[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p=Math.abs(s[0]);(new WebMol.Vector3(parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]))).multiplyScalar(r);q=new Float32Array(q.splice(u+7).join(" ").replace(/^\s+/,"").split(/[\s\r]+/));s=new Int16Array(a*x*p);u=0;for(r=s.length;u<r;++u)s[u]=-1;s=new Uint8Array(a*x*p);u=0;
for(r=q.length;u<r;++u)0<(0<=d?q[u]-d:d-q[u])&&(s[u]|=2);d=[];q=[];WebMol.p.U(s,d,q,{sa:!0,voxel:n,scale:D.length(),origin:c,Y:a,Z:x,aa:p});n||WebMol.p.T(10,d,q);C(this,f,{vertexArr:d,faceArr:q,normalArr:[],lineArr:[]})}}t.push({id:f.id,G:f,t:f.getCentroid()});this.updateStyle(b);B(this.boundingSphere,t,f.__vertexArray)};this.globj=function(g){e.initTypedArrays();var a=this.color,a=a||WebMol.i.color(a);e.colorsNeedUpdate=!0;for(var b in e.geometryGroups)for(var n=e.geometryGroups[b],q=n.__colorArray,
f=0,n=n.vertices;f<n;++f)q[3*f]=a.r,q[3*f+1]=a.g,q[3*f+2]=a.b;d=new WebMol.Object3D;b=new WebMol.MeshLambertMaterial({wireframe:this.wireframe,vertexColors:!0,ambient:0,reflectivity:0,side:this.side,transparent:1>this.alpha?!0:!1,opacity:this.alpha});b=new WebMol.Mesh(e,b);d.add(b);c&&(g.remove(c),c=null);c=d.clone();g.add(c)}}function D(n,q){n.color=q.color||new WebMol.Color;n.wireframe=q.wireframe?!0:!1;n.alpha=q.alpha?WebMol.Math.clamp(q.alpha,0,1):1;n.side=void 0!==q.side?q.side:WebMol.DoubleSide;
n.clickable=q.clickable?!0:!1;n.callback="function"===typeof q.callback?q.callback:null}function B(n,q,t){n.center.set(0,0,0);var d,c;if(0<q.length){d=0;for(c=q.length;d<c;++d)n.center.add(q[d].t);n.center.divideScalar(q.length)}q=n.radius*n.radius;d=0;for(c=t.length/3;d<c;d++){var e=n.center.distanceToSquared({x:t[3*d],y:t[3*d+1],z:t[3*d+2]});q=Math.max(q,e)}n.radius=Math.sqrt(q)}function C(n,q,t){var d=t.vertexArr,c=t.normalArr,e=t.faceArr;t=t.lineArr;0!==d.length&&0!==e.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");
q.vertices=d.length;q.faceidx=e.length;var g,a,b,s,u;s=0;for(u=q.vertices;s<u;++s)g=3*s,a=d[s],q.__vertexArray[g]=a.x,q.__vertexArray[g+1]=a.y,q.__vertexArray[g+2]=a.z;s=0;for(u=q.faceidx/3;s<u;++s){g=3*s;a=e[g];b=e[g+1];g=e[g+2];var f=new WebMol.Vector3,A=new WebMol.Vector3,z=new WebMol.Vector3;n.intersectionShape.triangle.push(new WebMol.Triangle(f.copy(d[a]),A.copy(d[b]),z.copy(d[g])))}q.__faceArray=new Uint16Array(e);q.truncateArrayBuffers(!0);if(c.length<q.vertices)q.setNormals();else for(q.__normalArray=
new Float32Array(3*q.vertices),s=0,u=q.vertices;s<u;++s)g=3*s,n=c[s],q.__normalArray[g]=n.x,q.__normalArray[g+1]=n.y,q.__normalArray[g+2]=n.z;t.length?q.__lineArray=new Uint16Array(t):q.setLineIndices();q.lineidx=q.__lineArray.length}var s={h:{},m:function(n){if("undefined"!==typeof this.h[n])return this.h[n];var q={vertices:[],k:[],j:[]},s=16,d=10;1>n&&(s=8,d=6);var c=2*Math.PI,e=Math.PI,g,a;for(a=0;a<=d;a++){var b=[];for(g=0;g<=s;g++){var u=g/s,v=a/d,f={};f.x=-n*Math.cos(0+u*c)*Math.sin(0+v*e);
f.y=n*Math.cos(0+v*e);f.z=n*Math.sin(0+u*c)*Math.sin(0+v*e);u=new WebMol.Vector3(f.x,f.y,f.z);u.normalize();q.vertices.push(f);q.j.push(u);b.push(q.vertices.length-1)}q.k.push(b)}return this.h[n]=q}};Object.defineProperty(u.prototype,"position",{get:function(){return this.boundingSphere.center}});Object.defineProperty(u.prototype,"x",{get:function(){return this.boundingSphere.center.x}});Object.defineProperty(u.prototype,"y",{get:function(){return this.boundingSphere.center.y}});Object.defineProperty(u.prototype,
"z",{get:function(){return this.boundingSphere.center.z}});return u}();WebMol.ShapeIDCount=0;WebMol.LabelCount=0;WebMol.Label=function(u,D){this.id=WebMol.LabelCount++;this.stylespec=D||{};this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.sprite=new WebMol.Sprite;this.text=u};
WebMol.Label.prototype={setContext:function(){this.font=this.stylespec.font=this.stylespec.font?this.stylespec.font:"Arial";this.fontSize=this.stylespec.fontSize=this.stylespec.fontSize?this.stylespec.fontSize:20;this.fontColor=this.stylespec.fontColor=this.stylespec.fontColor?this.stylespec.fontColor:{r:255,g:255,b:255,a:1};this.borderThickness=this.stylespec.borderThickness=this.stylespec.borderThickness?this.stylespec.borderThickness:4;this.borderColor=this.stylespec.borderColor=this.stylespec.borderColor?
this.stylespec.borderColor:{r:0,g:0,b:0,a:1};this.backgroundColor=this.stylespec.backgroundColor=this.stylespec.backgroundColor?this.stylespec.backgroundColor:{r:0,g:0,b:0,a:1};this.position=this.stylespec.position=this.stylespec.position?this.stylespec.position:{x:-10,y:1,z:1};this.inFront=this.stylespec.inFront=void 0!==this.stylespec.inFront?this.stylespec.inFront:!0;this.context.clearRect(0,0,this.canvas.width,this.canvas.height);var u=WebMol.SpriteAlignment.topLeft;this.context.font=this.fontSize+
"pt "+this.font;var D=this.context.measureText(this.text).width;this.context.fillStyle="rgba("+this.backgroundColor.r+","+this.backgroundColor.g+","+this.backgroundColor.b+","+this.backgroundColor.a+")";this.context.strokeStyle="rgba("+this.borderColor.r+","+this.borderColor.g+","+this.borderColor.b+","+this.borderColor.a+")";this.context.lineWidth=this.borderThickness;var B=this.context,C=this.borderThickness/2,s=this.borderThickness/2,n=D+this.borderThickness,q=1.4*this.fontSize+this.borderThickness;
B.beginPath();B.moveTo(C+6,s);B.lineTo(C+n-6,s);B.quadraticCurveTo(C+n,s,C+n,s+6);B.lineTo(C+n,s+q-6);B.quadraticCurveTo(C+n,s+q,C+n-6,s+q);B.lineTo(C+6,s+q);B.quadraticCurveTo(C,s+q,C,s+q-6);B.lineTo(C,s+6);B.quadraticCurveTo(C,s,C+6,s);B.closePath();B.fill();this.context.fillStyle="rgba("+this.fontColor.r+","+this.fontColor.g+","+this.fontColor.b+","+this.fontColor.a+")";this.context.fillText(this.text,this.borderThickness,this.fontSize+this.borderThickness,D);D=new WebMol.Texture(this.canvas);
D.needsUpdate=!0;this.sprite.material=new WebMol.SpriteMaterial({map:D,useScreenCoordinates:!1,alignment:u,depthTest:!this.inFront});this.sprite.scale.set(2*this.fontSize,this.fontSize,1);this.sprite.position.set(this.position.x,this.position.y,this.position.z)},dispose:function(){void 0!==this.sprite.material.map&&this.sprite.material.map.dispose();void 0!==this.sprite.material&&this.sprite.material.dispose()}};
WebMol.GLViewer=function(){function u(u){var B,C,s,n,q,t,d,c,e,g;B=C=s=9999;n=q=t=-9999;d=c=e=g=0;if(0===u.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var a=0;a<u.length;a++){var b=u[a];void 0!==b&&(g++,d+=b.x,c+=b.y,e+=b.z,B=B<b.x?B:b.x,C=C<b.y?C:b.y,s=s<b.z?s:b.z,n=n>b.x?n:b.x,q=q>b.y?q:b.y,t=t>b.z?t:b.z)}return[[B,C,s],[n,q,t],[d/g,c/g,e/g]]}return function(D,B,C){function s(a,c,b,e,d,g){var h=new Date,f=new WebMol.ga;f.va(c,1===a?!1:!0,g);g=new Date;console.log("initialize "+(g-h)+"ms");f.qa(d,
b);c=new Date;console.log("fillvoxels "+(c-g)+"  "+(c-h)+"ms");f.ia();a==WebMol.SurfaceType.SES&&(f.ma(),f.Q(!1),f.ra(d,b));b=new Date;console.log("buildboundaryetc "+(b-c)+"  "+(b-h)+"ms");f.wa(a);a=new Date;console.log("marching cube "+(a-b)+"  "+(a-h)+"ms");return f.ta(e)}function n(a,c,b){var e=new WebMol.Geometry(!0),d=e.updateGeoGroup(0),g=c.vertices,h,f,n;f=0;for(n=g.length;f<n;f++)h=3*d.vertices,d.__vertexArray[h]=g[f].x,d.__vertexArray[h+1]=g[f].y,d.__vertexArray[h+2]=g[f].z,d.vertices++;
c=c.faces;d.faceidx=c.length;e.initTypedArrays();h=[];f=0;for(n=a.length;f<n;f++){var l=a[f];l&&("undefined"!=typeof l.surfaceColor?h[f]=WebMol.i.color(l.surfaceColor):l.color&&(h[f]=WebMol.i.color(l.color)))}a=d.__vertexArray;var m,q,r;f=0;for(n=c.length;f<n;f+=3){m=f;var l=c[f],p=c[f+1],s=c[f+2];q=g[l].atomid;r=g[p].atomid;var t=g[s].atomid,l=3*l,p=3*p,s=3*s;d.__faceArray[m]=c[f].a;d.__faceArray[m+1]=c[f].b;d.__faceArray[m+2]=c[f].za;d.__colorArray[l]=h[q].r;d.__colorArray[l+1]=h[q].g;d.__colorArray[l+
2]=h[q].b;d.__colorArray[p]=h[r].r;d.__colorArray[p+1]=h[r].g;d.__colorArray[p+2]=h[r].b;d.__colorArray[s]=h[t].r;d.__colorArray[s+1]=h[t].g;d.__colorArray[s+2]=h[t].b;m=new WebMol.Vector3(a[l],a[l+1],a[l+2]);q=new WebMol.Vector3(a[p],a[p+1],a[p+2]);r=new WebMol.Vector3(a[s],a[s+1],a[s+2]);r.subVectors(r,q);m.subVectors(m,q);r.cross(m);m=r;m.normalize();d.__normalArray[l]+=m.x;d.__normalArray[p]+=m.x;d.__normalArray[s]+=m.x;d.__normalArray[l+1]+=m.y;d.__normalArray[p+1]+=m.y;d.__normalArray[s+1]+=
m.y;d.__normalArray[l+2]+=m.z;d.__normalArray[p+2]+=m.z;d.__normalArray[s+2]+=m.z}d.__faceArray=new Uint16Array(c);b=new WebMol.Mesh(e,b);b.Aa=!0;return b}function q(a,c,b){function e(a){if(64E3>t(a))return[a];var c=a[1][0]-a[0][0],b=a[1][1]-a[0][1],d=a[1][2]-a[0][2],b=c>b&&c>d?0:b>c&&b>d?1:2,d=g(a),c=g(a);a=(a[1][b]-a[0][b])/2+a[0][b];d[1][b]=a;c[0][b]=a;a=e(d);c=e(c);return a.concat(c)}function g(a){var c=[];c[0]=[a[0][0],a[0][1],a[0][2]];c[1]=[a[1][0],a[1][1],a[1][2]];return c}var h=[];a=e(a);
for(var f=0,l=a.length;f<l;f++){var m=g(a[f]);m[0][0]-=6;m[0][1]-=6;m[0][2]-=6;m[1][0]+=6;m[1][1]+=6;m[1][2]+=6;var m=d(c,m),n=d(b,a[f]);h.push({A:a[f],M:m,ea:n})}return h}function t(a){return(a[1][0]-a[0][0])*(a[1][1]-a[0][1])*(a[1][2]-a[0][2])}function d(a,c){for(var b=[],d=0;d<a.length;d++){var e=a[d];"undefined"!=typeof e&&(e.x<c[0][0]||e.x>c[1][0]||e.y<c[0][1]||e.y>c[1][1]||e.z<c[0][2]||e.z>c[1][2]||b.push(d))}return b}function c(){if(T){var a=F.position.z-l.position.z;1>a&&(a=1);F.near=a+X;
1>F.near&&(F.near=1);F.far=a+S;F.near+1>F.far&&(F.far=F.near+1);F instanceof WebMol.Camera?F.fov=20:(F.right=a*Math.tan(Math.PI/180*20),F.left=-F.right,F.top=F.right/x,F.bottom=-F.top);F.updateProjectionMatrix();T.fog.near=F.near+.4*(F.far-F.near);T.fog.far=F.far;p.render(T,F)}}function e(a){var c=[];"undefined"===typeof a&&(a={});var b=[],d;if("undefined"===typeof a.W)for(d=0;d<f.length;d++)f[d]&&b.push(f[d]);else b=a.W,$.isArray(b)||(b=[b]);for(d=0;d<b.length;d++)c=c.concat(b[d].selectedAtoms(a));
return c}function g(a,c,b,d){for(var e=0;e<f.length;e++)if(f[e])f[e][a](c,b,d)}function a(a){var c=new WebMol.MeshLambertMaterial;c.vertexColors=WebMol.VertexColors;for(var b in a)"color"===b?(c[b]=WebMol.i.color(a.color),delete c.vertexColors):"map"!==b&&a.hasOwnProperty(b)&&(c[b]=a[b]);void 0!==a.opacity&&(c.transparent=1===a.opacity?!1:!0);return c}function b(a,c){for(var b=Number.POSITIVE_INFINITY,d=Number.NEGATIVE_INFINITY,e=0,g=a.length;e<g;e++){var f=a[e];f.properties&&"undefined"!=typeof f.properties[c]&&
(f=f.properties[c],f<b&&(b=f),f>d&&(d=f))}isFinite(b)||isFinite(d)?isFinite(b)?isFinite(d)||(d=b):b=d:b=d=0;return[b,d]}var y=this,v=D.id,f=[],A=[],z=[],J=D.width(),r=D.height(),N=$('<div class="glviewerSpinnerWrap" style = "position: absolute; width: 100%; height: 100%; display: table; z-index: 1;"><div class="glviewerSpinner" style="display: table-cell; text-align: center; vertical-align: middle; z-index:1"><img src="webmol/spinner.gif"></div></div>');$(D).append(N);N.hide();var x=J/r,p=new WebMol.Renderer({antialias:!0});
p.domElement.style.width="100%";p.domElement.style.height="100%";p.domElement.style.position="absolute";p.domElement.style.top="0px";p.domElement.style.zIndex="0";D.append(p.domElement);p.setSize(J,r);var F=new WebMol.Camera(20,x,1,800);F.position=new WebMol.Vector3(0,0,150);var Q=new WebMol.Vector3;F.lookAt(Q);var M=new WebMol.Raycaster(new WebMol.Vector3(0,0,0),new WebMol.Vector3(0,0,0)),G=new WebMol.Projector,L=new WebMol.Vector3(0,0,0),T=null,l=null,h=null,E=0,X=-50,S=50,m=new WebMol.Quaternion(0,
0,0,1),K=new WebMol.Quaternion(0,0,0,1),w=!1,ha=0,fa=0,ga=0,ia=0,ja=0,Y=0;(function(){T=new WebMol.Scene;T.fog=new WebMol.Fog(E,100,200);h=new WebMol.Object3D;l=new WebMol.Object3D;l.useQuaternion=!0;l.quaternion=new WebMol.Quaternion(0,0,0,1);l.add(h);T.add(l);var a=new WebMol.Light(16777215);a.position=(new WebMol.Vector3(.2,.2,1)).normalize();a.intensity=1;T.add(a)})();p.setClearColorHex(E,1);T.fog.color=WebMol.i.color(E);Q=$(p.domElement);Q.bind("mousedown touchstart",function(a){a.preventDefault();
if(T){var b=a.pageX,d=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(b=a.originalEvent.targetTouches[0].pageX,d=a.originalEvent.targetTouches[0].pageY);if(void 0!==b){w=!0;mouseButton=a.which;ha=b;fa=d;m=l.quaternion;ia=l.position.z;ga=h.position.clone();ja=X;Y=S;a=b/$(window).width()*2-1;L.set(a,2*-(d/r)+1,-1);G.unprojectVector(L,F);L.sub(F.position).normalize();M.set(F.position,L);d=[];a=[];a=0;for(b=f.length;a<b;a++)var e=f[a].selectedAtoms({clickable:!0}),d=d.concat(e);
a=0;for(b=z.length;a<b;a++)e=z[a],e.clickable&&d.push(e);a=M.intersectObjects(h,d);a.length&&(d=a[0].clickable,void 0!==d.callback&&"function"===typeof d.callback&&d.callback(d,y));c()}}});Q.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(T){var b=.85*(150-l.position.z);a.originalEvent.detail?l.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(l.position.z-=b*a.originalEvent.wheelDelta/400);c()}});Q.bind("contextmenu",function(a){a.preventDefault()});$("body").bind("mouseup touchend",
function(){w=!1});Q.bind("mousemove touchmove",function(a){a.preventDefault();if(T&&w){var b=0,d=$("input[name="+v+"_mouseMode]:checked");0<d.length&&(b=parseInt(d.val()));var d=a.pageX,e=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(d=a.originalEvent.targetTouches[0].pageX,e=a.originalEvent.targetTouches[0].pageY);if(void 0!==d){var d=(d-ha)/J,e=(e-fa)/r,f=Math.sqrt(d*d+e*e);3==b||3==mouseButton&&a.ctrlKey?(X=ja+100*d,S=Y+100*e):2==b||3==mouseButton||a.shiftKey?(a=.85*
(150-l.position.z),80>a&&(a=80),l.position.z=ia-e*a):1==b||2==mouseButton||a.ctrlKey?(a=.85*(150-l.position.z),20>a&&(a=20),a=new WebMol.Vector3(d*a,-e*a,0),b=l.quaternion,b=(new WebMol.Quaternion(b.x,b.y,b.z,b.w)).inverse().normalize(),a=a.applyQuaternion(b),h.position.x=ga.x+a.x,h.position.y=ga.y+a.y,h.position.z=ga.z+a.z):0!==b&&1!=mouseButton||0===f||(a=Math.sin(f*Math.PI)/f,K.x=Math.cos(f*Math.PI),K.y=0,K.z=a*d,K.w=-a*e,l.quaternion=new WebMol.Quaternion(1,0,0,0),l.quaternion.multiply(K),l.quaternion.multiply(m));
c()}}});this.setBackgroundColor=function(a,b){E=a;p.setClearColorHex(a,b|1);T.fog.color=WebMol.i.color(a);c()};this.setWidth=function(a){J=a||J;p.setSize(J,r)};this.setHeight=function(a){r=a||r;p.setSize(J,r)};this.resize=function(){J=D.width();r=D.height();x=J/r;p.setSize(J,r);F.aspect=x;F.updateProjectionMatrix();c()};$(window).resize(this.resize);this.getModel=function(a){a=a||f.length-1;return f[a]};this.getView=function(){if(!h)return[0,0,0,0,0,0,0,1];var a=h.position,c=l.quaternion;return[a.x,
a.y,a.z,l.position.z,c.x,c.y,c.z,c.w]};this.setView=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&h&&l&&(h.position.x=a[0],h.position.y=a[1],h.position.z=a[2],l.position.z=a[3],l.quaternion.x=a[4],l.quaternion.y=a[5],l.quaternion.z=a[6],l.quaternion.w=a[7],c())};this.render=function(){var a=new Date,c=this.getView(),b;for(b=0;b<f.length;b++)f[b]&&f[b].globj(h);for(b=0;b<z.length;b++)z[b]&&z[b].globj(h);for(b in A)if(A.hasOwnProperty(b)){var d=A[b].l;A[b].D||(d.verticesNeedUpdate=!0,
d.elementsNeedUpdate=!0,d.normalsNeedUpdate=!0,d.colorsNeedUpdate=!0,d.buffersNeedUpdate=!0,d.boundingSphere=null,A[b].done&&(A[b].D=!0),A[b].v&&h.remove(A[b].v),d=new WebMol.Mesh(d,A[b].o),A[b].v=d,h.add(d))}this.setView(c);c=new Date;N.hide();console.log("render time: "+(c-a))};this.pdbData=function(a){a=e(a);for(var c="",b=0,d=a.length;b<d;++b)c+=a[b].pdbline+"\n";return c};this.zoomTo=function(a){a=e(a).concat(z);var b=e({}).concat(z);a=u(a);var b=u(b),d=new WebMol.Vector3(a[2][0],a[2][1],a[2][2]);
h.position=d.multiplyScalar(-1);var d=b[1][0]-b[0][0],f=b[1][1]-b[0][1],b=b[1][2]-b[0][2],b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);X=-b/1.9;S=b/3;d=a[1][0]-a[0][0];f=a[1][1]-a[0][1];b=a[1][2]-a[0][2];b=Math.sqrt(d*d+f*f+b*b);25>b&&(b=25);l.position.z=-(.35*b/Math.tan(Math.PI/180*F.fov/2)-150);c()};this.addLabel=function(a,b){var c=new WebMol.Label(a,b);c.setContext();h.add(c.sprite);return c};this.removeLabel=function(a){a.dispose();h.remove(a.sprite)};this.setLabelStyle=function(a,b){a.dispose();a.stylespec=
b;a.setContext();h.add(a.sprite);return a};this.setLabelText=function(a,b){a.dispose();a.text=b;a.setContext();h.add(a.sprite);return a};this.addShape=function(a){a=a||{};a=new WebMol.GLShape(z.length,a);z.push(a);return a};this.addSphere=function(a){var b=new WebMol.GLShape(z.length);a=a||{};b.addSphere(a);z.push(b);return b};this.addArrow=function(a){var b=new WebMol.GLShape(z.length);a=a||{};b.addArrow(a);z.push(b);return b};this.addCustom=function(a){var b=new WebMol.GLShape(z.length);a=a||{};
b.addCustom(a);z.push(b);return b};this.addVolumetricData=function(a,b,c){var d=new WebMol.GLShape(z.length);c=c||{};d.addVolumetricData(a,b,c);z.push(d);return d};this.addModel=function(a,b){var c=new WebMol.GLModel(f.length,C);c.addMolData(a,b);f.push(c);return c};this.removeModel=function(a){if(a)for(a.removegl(h),delete f[a.getID()];0<f.length&&"undefined"===typeof f[f.length-1];)f.pop()};this.removeAllModels=function(){for(var a=0;a<f.length;a++)f[a].removegl(h);f=[]};this.createModelFrom=function(a,
b){for(var c=new WebMol.GLModel(f.length,C),d=0;d<f.length;d++)if(f[d]){var e=f[d].selectedAtoms(a);c.addAtoms(e);b&&f[d].removeAtoms(e)}f.push(c);return c};this.setStyle=function(a,b){g("setStyle",a,b,!1)};this.addStyle=function(a,b){g("setStyle",a,b,!0)};this.setColorByProperty=function(a,b,c){g("setColorByProperty",a,b,c)};this.setColorByElement=function(a,b){g("setColorByElement",a,b)};this.addSurface=function(c,d,f,g,h){f=e(f);var m=e(g),l=e(h),p,r=new Date,w=a(d),v=u(f);if(d.map&&d.map.prop){h=
d.map.prop;var x=d.map.scheme||new WebMol.RWB,z=x.range();z||(z=b(f,h));d=0;for(g=f.length;d<g;d++)p=f[d],p.surfaceColor=x.valueToHex(p.properties[h],z)}h=t(v);var B=q(v,m,f);if(l&&l.length&&0<l.length){var C=u(l);B.sort(function(a,b){function c(a,b){var d=a.A,e=d[1][1]-d[0][1],f=d[1][2]-d[0][2],d=d[1][0]-d[0][0]-b[2][0],e=e-b[2][1],f=f-b[2][2];return d*d+e*e+f*f}return c(a,C)-c(b,C)})}console.log("Extents "+B.length+"  "+(+new Date-r)+"ms");var D={l:new WebMol.Geometry(!0),o:w,done:!1,D:!1};f=A.length;
A[f]=D;l=[];d=0;for(g=m.length;d<g;d++)p=m[d],l[d]={x:p.x,y:p.y,z:p.z,serial:d,elem:p.elem};if(WebMol.syncSurface)for(d=0,g=B.length;d<g;d++)p=s(c,B[d].A,B[d].M,B[d].ea,l,h),p=n(m,p,w),WebMol.V(D.l,p),y.render();else{p=[];0>c&&(c=0);d=0;for(g=4;d<g;d++)v=new Worker(WebMol.L),p.push(v),v.postMessage({type:-1,atoms:l,volume:h});var E=0;g=function(a){a=n(m,a.data,w);WebMol.V(D.l,a);y.render();console.log("async mesh generation "+(+new Date-r)+"ms");E++;E==B.length&&(D.done=!0)};h=function(a){console.log(a.message+
" ("+a.filename+":"+a.Ea+")")};for(d=0;d<B.length;d++)l=p[d%p.length],l.onmessage=g,l.onerror=h,l.postMessage({type:c,expandedExtent:B[d].A,extendedAtoms:B[d].M,atomsToShow:B[d].ea})}console.log("full mesh generation "+(+new Date-r)+"ms");return f};this.setSurfaceMaterialStyle=function(b,c){A[b]&&(A[b].o=a(c),A[b].o.side=WebMol.FrontSide,A[b].D=!1)};this.removeSurface=function(a){A[a]&&A[a].v&&(void 0!==A[a].l&&A[a].l.dispose(),void 0!==A[a].o&&A[a].o.dispose(),h.remove(A[a].v));delete A[a];c()};
this.clear=function(){A=[];this.removeAllModels();c()};getModelGroup=function(){return h};try{"function"===typeof B&&B(this)}catch(R){console.log("error with glviewer callback: "+R)}}}();WebMol.glmolViewer=WebMol.GLViewer;WebMol=WebMol||{};
WebMol.Ga=[{resn:"ALA",atom:"N",props:{c:-.15}},{resn:"ALA",atom:"CA",props:{c:.1}},{resn:"ALA",atom:"CB",props:{c:0}},{resn:"ALA",atom:"C",props:{c:.6}},{resn:"ALA",atom:"O",props:{c:-.55}},{resn:"ARG",atom:"N",props:{c:-.15}},{resn:"ARG",atom:"CA",props:{c:.1}},{resn:"ARG",atom:"CB",props:{c:0}},{resn:"ARG",atom:"CG",props:{c:0}},{resn:"ARG",atom:"CD",props:{c:.1}},{resn:"ARG",atom:"NE",props:{c:-.1}},{resn:"ARG",atom:"CZ",props:{c:.5}},{resn:"ARG",atom:"NH1",props:{c:.25}},{resn:"ARG",atom:"NH2",
props:{c:.25}},{resn:"ARG",atom:"C",props:{c:.6}},{resn:"ARG",atom:"O",props:{c:-.55}},{resn:"ASN",atom:"N",props:{c:-.15}},{resn:"ASN",atom:"CA",props:{c:.1}},{resn:"ASN",atom:"CB",props:{c:0}},{resn:"ASN",atom:"CG",props:{c:.55}},{resn:"ASN",atom:"OD1",props:{c:-.55}},{resn:"ASN",atom:"ND2",props:{c:0}},{resn:"ASN",atom:"C",props:{c:.6}},{resn:"ASN",atom:"O",props:{c:-.55}},{resn:"ASP",atom:"N",props:{c:-.15}},{resn:"ASP",atom:"CA",props:{c:.1}},{resn:"ASP",atom:"CB",props:{c:0}},{resn:"ASP",atom:"CG",
props:{c:.14}},{resn:"ASP",atom:"OD1",props:{c:-.57}},{resn:"ASP",atom:"OD2",props:{c:-.57}},{resn:"ASP",atom:"C",props:{c:.6}},{resn:"ASP",atom:"O",props:{c:-.55}},{resn:"CYS",atom:"N",props:{c:-.15}},{resn:"CYS",atom:"CA",props:{c:.1}},{resn:"CYS",atom:"CB",props:{c:.19}},{resn:"CYS",atom:"SG",props:{c:-.19}},{resn:"CYS",atom:"C",props:{c:.6}},{resn:"CYS",atom:"O",props:{c:-.55}},{resn:"GLN",atom:"N",props:{c:-.15}},{resn:"GLN",atom:"CA",props:{c:.1}},{resn:"GLN",atom:"CB",props:{c:0}},{resn:"GLN",
atom:"CG",props:{c:0}},{resn:"GLN",atom:"CD",props:{c:.55}},{resn:"GLN",atom:"OE1",props:{c:-.55}},{resn:"GLN",atom:"NE2",props:{c:0}},{resn:"GLN",atom:"C",props:{c:.6}},{resn:"GLN",atom:"O",props:{c:-.55}},{resn:"GLU",atom:"N",props:{c:-.15}},{resn:"GLU",atom:"CA",props:{c:.1}},{resn:"GLU",atom:"CB",props:{c:0}},{resn:"GLU",atom:"CG",props:{c:0}},{resn:"GLU",atom:"CD",props:{c:.14}},{resn:"GLU",atom:"OE1",props:{c:-.57}},{resn:"GLU",atom:"OE2",props:{c:-.57}},{resn:"GLU",atom:"C",props:{c:.6}},{resn:"GLU",
atom:"O",props:{c:-.55}},{resn:"GLY",atom:"N",props:{c:-.15}},{resn:"GLY",atom:"CA",props:{c:.1}},{resn:"GLY",atom:"C",props:{c:.6}},{resn:"GLY",atom:"O",props:{c:-.55}},{resn:"HIS",atom:"N",props:{c:-.15}},{resn:"HIS",atom:"CA",props:{c:.1}},{resn:"HIS",atom:"CB",props:{c:0}},{resn:"HIS",atom:"CG",props:{c:.1}},{resn:"HIS",atom:"ND1",props:{c:-.1}},{resn:"HIS",atom:"CD2",props:{c:.1}},{resn:"HIS",atom:"NE2",props:{c:-.4}},{resn:"HIS",atom:"CE1",props:{c:.3}},{resn:"HIS",atom:"C",props:{c:.6}},{resn:"HIS",
atom:"O",props:{c:-.55}},{resn:"ILE",atom:"N",props:{c:-.15}},{resn:"ILE",atom:"CA",props:{c:.1}},{resn:"ILE",atom:"CB",props:{c:0}},{resn:"ILE",atom:"CG2",props:{c:0}},{resn:"ILE",atom:"CG1",props:{c:0}},{resn:"ILE",atom:"CD",props:{c:0}},{resn:"ILE",atom:"C",props:{c:.6}},{resn:"ILE",atom:"O",props:{c:-.55}},{resn:"LEU",atom:"N",props:{c:-.15}},{resn:"LEU",atom:"CA",props:{c:.1}},{resn:"LEU",atom:"CB",props:{c:0}},{resn:"LEU",atom:"CG",props:{c:0}},{resn:"LEU",atom:"CD1",props:{c:0}},{resn:"LEU",
atom:"CD2",props:{c:0}},{resn:"LEU",atom:"C",props:{c:.6}},{resn:"LEU",atom:"O",props:{c:-.55}},{resn:"LYS",atom:"N",props:{c:-.15}},{resn:"LYS",atom:"CA",props:{c:.1}},{resn:"LYS",atom:"CB",props:{c:0}},{resn:"LYS",atom:"CG",props:{c:0}},{resn:"LYS",atom:"CD",props:{c:0}},{resn:"LYS",atom:"CE",props:{c:.25}},{resn:"LYS",atom:"NZ",props:{c:.75}},{resn:"LYS",atom:"C",props:{c:.6}},{resn:"LYS",atom:"O",props:{c:-.55}},{resn:"MET",atom:"N",props:{c:-.15}},{resn:"MET",atom:"CA",props:{c:.1}},{resn:"MET",
atom:"CB",props:{c:0}},{resn:"MET",atom:"CG",props:{c:.06}},{resn:"MET",atom:"SD",props:{c:-.12}},{resn:"MET",atom:"CE",props:{c:.06}},{resn:"MET",atom:"C",props:{c:.6}},{resn:"MET",atom:"O",props:{c:-.55}},{resn:"PHE",atom:"N",props:{c:-.15}},{resn:"PHE",atom:"CA",props:{c:.1}},{resn:"PHE",atom:"CB",props:{c:0}},{resn:"PHE",atom:"CG",props:{c:0}},{resn:"PHE",atom:"CD1",props:{c:0}},{resn:"PHE",atom:"CD2",props:{c:0}},{resn:"PHE",atom:"CE1",props:{c:0}},{resn:"PHE",atom:"CE2",props:{c:0}},{resn:"PHE",
atom:"CZ",props:{c:0}},{resn:"PHE",atom:"C",props:{c:.6}},{resn:"PHE",atom:"O",props:{c:-.55}},{resn:"PRO",atom:"N",props:{c:-.25}},{resn:"PRO",atom:"CD",props:{c:.1}},{resn:"PRO",atom:"CA",props:{c:.1}},{resn:"PRO",atom:"CB",props:{c:0}},{resn:"PRO",atom:"CG",props:{c:0}},{resn:"PRO",atom:"C",props:{c:.6}},{resn:"PRO",atom:"O",props:{c:-.55}},{resn:"SER",atom:"N",props:{c:-.15}},{resn:"SER",atom:"CA",props:{c:.1}},{resn:"SER",atom:"CB",props:{c:.25}},{resn:"SER",atom:"OG",props:{c:-.25}},{resn:"SER",
atom:"C",props:{c:.6}},{resn:"SER",atom:"O",props:{c:-.55}},{resn:"THR",atom:"N",props:{c:-.15}},{resn:"THR",atom:"CA",props:{c:.1}},{resn:"THR",atom:"CB",props:{c:.25}},{resn:"THR",atom:"OG1",props:{c:-.25}},{resn:"THR",atom:"CG2",props:{c:0}},{resn:"THR",atom:"C",props:{c:.6}},{resn:"THR",atom:"O",props:{c:-.55}},{resn:"TRP",atom:"N",props:{c:-.15}},{resn:"TRP",atom:"CA",props:{c:.1}},{resn:"TRP",atom:"CB",props:{c:0}},{resn:"TRP",atom:"CG",props:{c:-.03}},{resn:"TRP",atom:"CD2",props:{c:.1}},{resn:"TRP",
atom:"CE2",props:{c:-.04}},{resn:"TRP",atom:"CE3",props:{c:-.03}},{resn:"TRP",atom:"CD1",props:{c:.06}},{resn:"TRP",atom:"NE1",props:{c:-.06}},{resn:"TRP",atom:"CZ2",props:{c:0}},{resn:"TRP",atom:"CZ3",props:{c:0}},{resn:"TRP",atom:"CH2",props:{c:0}},{resn:"TRP",atom:"C",props:{c:.6}},{resn:"TRP",atom:"O",props:{c:-.55}},{resn:"TYR",atom:"N",props:{c:-.15}},{resn:"TYR",atom:"CA",props:{c:.1}},{resn:"TYR",atom:"CB",props:{c:0}},{resn:"TYR",atom:"CG",props:{c:0}},{resn:"TYR",atom:"CD1",props:{c:0}},
{resn:"TYR",atom:"CE1",props:{c:0}},{resn:"TYR",atom:"CD2",props:{c:0}},{resn:"TYR",atom:"CE2",props:{c:0}},{resn:"TYR",atom:"CZ",props:{c:.25}},{resn:"TYR",atom:"OH",props:{c:-.25}},{resn:"TYR",atom:"C",props:{c:.6}},{resn:"TYR",atom:"O",props:{c:-.55}},{resn:"VAL",atom:"N",props:{c:-.15}},{resn:"VAL",atom:"CA",props:{c:.1}},{resn:"VAL",atom:"CB",props:{c:0}},{resn:"VAL",atom:"CG1",props:{c:0}},{resn:"VAL",atom:"CG2",props:{c:0}},{resn:"VAL",atom:"C",props:{c:.6}},{resn:"VAL",atom:"O",props:{c:-.55}}];
//# sourceMappingURL=../script.map