var $3Dmol=$3Dmol||{};$3Dmol.Math={clamp:function(a,b,c){return Math.min(Math.max(a,b),c)},degToRad:function(){var a=Math.PI/180;return function(b){return b*a}}()};$3Dmol.Quaternion=function(a,b,c,d){this.x=a||0;this.y=b||0;this.z=c||0;this.w=void 0!==d?d:1};
$3Dmol.Quaternion.prototype={constructor:$3Dmol.Quaternion,set:function(a,b,c,d){this.x=a;this.y=b;this.z=c;this.w=d;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.w=a.w;return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},inverse:function(){return this.conjugate().normalize()},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var a=this.length();0===a?(this.z=this.y=this.x=0,this.w=1):
(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.w*=a);return this},multiply:function(a){return this.multiplyQuaternions(this,a)},multiplyQuaternions:function(a,b){var c=a.x,d=a.y,f=a.z,h=a.w,e=b.x,l=b.y,k=b.z,m=b.w;this.x=c*m+h*e+d*k-f*l;this.y=d*m+h*l+f*e-c*k;this.z=f*m+h*k+c*l-d*e;this.w=h*m-c*e-d*l-f*k}};$3Dmol.Vector2=function(a,b){this.x=a||0;this.y=b||0};
$3Dmol.Vector2.prototype={constructor:$3Dmol.Vector2,set:function(a,b){this.x=a;this.y=b;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},copy:function(a){this.x=a.x;this.y=a.y;return this},clone:function(){return new $3Dmol.Vector2(this.x,this.y)}};$3Dmol.Vector3=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
$3Dmol.Vector3.prototype={constructor:$3Dmol.Vector3,set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},copy:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},addVectors:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},subVectors:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiplyScalar:function(a){this.x*=
a;this.y*=a;this.z*=a;return this},divideScalar:function(a){0!==a?(this.x/=a,this.y/=a,this.z/=a):this.z=this.y=this.x=0;return this},distanceTo:function(a){return Math.sqrt(this.distanceToSquared(a))},distanceToSquared:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},applyMatrix4:function(a){var b=this.x,c=this.y,d=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*d+a[12];this.y=a[1]*b+a[5]*c+a[9]*d+a[13];this.z=a[2]*b+a[6]*c+a[10]*d+a[14];return this},applyProjection:function(a){var b=
this.x,c=this.y,d=this.z;a=a.elements;var f=a[3]*b+a[7]*c+a[11]*d+a[15];this.x=(a[0]*b+a[4]*c+a[8]*d+a[12])/f;this.y=(a[1]*b+a[5]*c+a[9]*d+a[13])/f;this.z=(a[2]*b+a[6]*c+a[10]*d+a[14])/f;return this},applyQuaternion:function(a){var b=this.x,c=this.y,d=this.z,f=a.x,h=a.y,e=a.z;a=a.w;var l=a*b+h*d-e*c,k=a*c+e*b-f*d,m=a*d+f*c-h*b,b=-a*b-h*c-e*d;this.x=l*a+b*-f+k*-e-m*-h;this.y=k*a+b*-h+m*-f-l*-e;this.z=m*a+b*-e+l*-h-k*-f;return this},negate:function(){return this.multiplyScalar(-1)},dot:function(a){return this.x*
a.x+this.y*a.y+this.z*a.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},normalize:function(){return this.divideScalar(this.length())},cross:function(a){var b=this.x,c=this.y,d=this.z;this.x=c*a.z-d*a.y;this.y=d*a.x-b*a.z;this.z=b*a.y-c*a.x;return this},crossVectors:function(a,b){this.x=a.y*b.z-a.z*b.y;this.y=a.z*b.x-a.x*b.z;this.z=a.x*b.y-a.y*b.x;return this},getPositionFromMatrix:function(a){this.x=
a.elements[12];this.y=a.elements[13];this.z=a.elements[14];return this},setEulerFromRotationMatrix:function(a,b){var c=a.elements,d=c[0],f=c[4],h=c[8],e=c[5],l=c[9],k=c[6],c=c[10];void 0===b||"XYZ"===b?(this.y=Math.asin($3Dmol.Math.clamp(h,-1,1)),.99999>Math.abs(h)?(this.x=Math.atan2(-l,c),this.z=Math.atan2(-f,d)):(this.x=Math.atan2(k,e),this.z=0)):console.error("Error with vector's setEulerFromRotationMatrix: Unknown order: "+b);return this},clone:function(){return new $3Dmol.Vector3(this.x,this.y,
this.z)}};$3Dmol.Matrix3=function(a,b,c,d,f,h,e,l,k){this.elements=new Float32Array(9);this.set(void 0!==a?a:1,b||0,c||0,d||0,void 0!==f?f:1,h||0,e||0,l||0,void 0!==k?k:1)};
$3Dmol.Matrix3.prototype={constructor:$3Dmol.Matrix3,set:function(a,b,c,d,f,h,e,l,k){var m=this.elements;m[0]=a;m[3]=b;m[6]=c;m[1]=d;m[4]=f;m[7]=h;m[2]=e;m[5]=l;m[8]=k;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},getInverse:function(a,b){var c=a.elements,
d=this.elements;d[0]=c[10]*c[5]-c[6]*c[9];d[1]=-c[10]*c[1]+c[2]*c[9];d[2]=c[6]*c[1]-c[2]*c[5];d[3]=-c[10]*c[4]+c[6]*c[8];d[4]=c[10]*c[0]-c[2]*c[8];d[5]=-c[6]*c[0]+c[2]*c[4];d[6]=c[9]*c[4]-c[5]*c[8];d[7]=-c[9]*c[0]+c[1]*c[8];d[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*d[0]+c[1]*d[3]+c[2]*d[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},
transpose:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},clone:function(){var a=this.elements;return new $3Dmol.Matrix3(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};
$3Dmol.Matrix4=function(a,b,c,d,f,h,e,l,k,m,q,A,s,v,w,r){var n=this.elements=new Float32Array(16);n[0]=void 0!==a?a:1;n[4]=b||0;n[8]=c||0;n[12]=d||0;n[1]=f||0;n[5]=void 0!==h?h:1;n[9]=e||0;n[13]=l||0;n[2]=k||0;n[6]=m||0;n[10]=void 0!==q?q:1;n[14]=A||0;n[3]=s||0;n[7]=v||0;n[11]=w||0;n[15]=void 0!==r?r:1};
$3Dmol.Matrix4.prototype={constructor:$3Dmol.Matrix4,set:function(a,b,c,d,f,h,e,l,k,m,q,A,s,v,w,r){var n=this.elements;n[0]=a;n[4]=b;n[8]=c;n[12]=d;n[1]=f;n[5]=h;n[9]=e;n[13]=l;n[2]=k;n[6]=m;n[10]=q;n[14]=A;n[3]=s;n[7]=v;n[11]=w;n[15]=r;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(a){a=a.elements;this.set(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]);return this},setRotationFromEuler:function(a,b){var c=
this.elements,d=a.x,f=a.y,h=a.z,e=Math.cos(d),d=Math.sin(d),l=Math.cos(f),f=Math.sin(f),k=Math.cos(h),h=Math.sin(h);if(void 0===b||"XYZ"===b){var m=e*k,q=e*h,A=d*k,s=d*h;c[0]=l*k;c[4]=-l*h;c[8]=f;c[1]=q+A*f;c[5]=m-s*f;c[9]=-d*l;c[2]=s-m*f;c[6]=A+q*f;c[10]=e*l}else console.error("Error with matrix4 setRotationFromEuler. Order: "+b);return this},setRotationFromQuaternion:function(a){var b=this.elements,c=a.x,d=a.y,f=a.z,h=a.w,e=c+c,l=d+d,k=f+f;a=c*e;var m=c*l,c=c*k,q=d*l,d=d*k,f=f*k,e=h*e,l=h*l,h=h*
k;b[0]=1-(q+f);b[4]=m-h;b[8]=c+l;b[1]=m+h;b[5]=1-(a+f);b[9]=d-e;b[2]=c-l;b[6]=d+e;b[10]=1-(a+q);return this},lookAt:function(){var a=new $3Dmol.Vector3,b=new $3Dmol.Vector3,c=new $3Dmol.Vector3;return function(d,f,h){var e=this.elements;c.subVectors(d,f).normalize();0===c.length()&&(c.z=1);a.crossVectors(h,c).normalize();0===a.length()&&(c.x+=1E-4,a.crossVectors(h,c).normalize());b.crossVectors(c,a);e[0]=a.x;e[4]=b.x;e[8]=c.x;e[1]=a.y;e[5]=b.y;e[9]=c.y;e[2]=a.z;e[6]=b.z;e[10]=c.z;return this}}(),
multiplyMatrices:function(a,b){var c=a.elements,d=b.elements,f=this.elements,h=c[0],e=c[4],l=c[8],k=c[12],m=c[1],q=c[5],A=c[9],s=c[13],v=c[2],w=c[6],r=c[10],n=c[14],u=c[3],t=c[7],z=c[11],c=c[15],F=d[0],B=d[4],C=d[8],x=d[12],p=d[1],y=d[5],E=d[9],H=d[13],G=d[2],D=d[6],I=d[10],L=d[14],M=d[3],N=d[7],J=d[11],d=d[15];f[0]=h*F+e*p+l*G+k*M;f[4]=h*B+e*y+l*D+k*N;f[8]=h*C+e*E+l*I+k*J;f[12]=h*x+e*H+l*L+k*d;f[1]=m*F+q*p+A*G+s*M;f[5]=m*B+q*y+A*D+s*N;f[9]=m*C+q*E+A*I+s*J;f[13]=m*x+q*H+A*L+s*d;f[2]=v*F+w*p+r*G+n*
M;f[6]=v*B+w*y+r*D+n*N;f[10]=v*C+w*E+r*I+n*J;f[14]=v*x+w*H+r*L+n*d;f[3]=u*F+t*p+z*G+c*M;f[7]=u*B+t*y+z*D+c*N;f[11]=u*C+t*E+z*I+c*J;f[15]=u*x+t*H+z*L+c*d;return this},multiplyScalar:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=a;return this},transpose:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;
b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},getPosition:function(){var a=new $3Dmol.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var b=this.elements;return a.set(b[12],b[13],b[14])}}(),setPosition:function(a){var b=this.elements;b[12]=a.x;b[13]=a.y;b[14]=a.z;return this},getInverse:function(a,b){var c=this.elements,d=a.elements,f=d[0],h=d[4],e=d[8],l=d[12],k=d[1],m=d[5],
q=d[9],A=d[13],s=d[2],v=d[6],w=d[10],r=d[14],n=d[3],u=d[7],t=d[11],z=d[15];c[0]=q*r*u-A*w*u+A*v*t-m*r*t-q*v*z+m*w*z;c[4]=l*w*u-e*r*u-l*v*t+h*r*t+e*v*z-h*w*z;c[8]=e*A*u-l*q*u+l*m*t-h*A*t-e*m*z+h*q*z;c[12]=l*q*v-e*A*v-l*m*w+h*A*w+e*m*r-h*q*r;c[1]=A*w*n-q*r*n-A*s*t+k*r*t+q*s*z-k*w*z;c[5]=e*r*n-l*w*n+l*s*t-f*r*t-e*s*z+f*w*z;c[9]=l*q*n-e*A*n-l*k*t+f*A*t+e*k*z-f*q*z;c[13]=e*A*s-l*q*s+l*k*w-f*A*w-e*k*r+f*q*r;c[2]=m*r*n-A*v*n+A*s*u-k*r*u-m*s*z+k*v*z;c[6]=l*v*n-h*r*n-l*s*u+f*r*u+h*s*z-f*v*z;c[10]=h*A*n-l*
m*n+l*k*u-f*A*u-h*k*z+f*m*z;c[14]=l*m*s-h*A*s-l*k*v+f*A*v+h*k*r-f*m*r;c[3]=q*v*n-m*w*n-q*s*u+k*w*u+m*s*t-k*v*t;c[7]=h*w*n-e*v*n+e*s*u-f*w*u-h*s*t+f*v*t;c[11]=e*m*n-h*q*n-e*k*u+f*q*u+h*k*t-f*m*t;c[15]=h*q*s-e*m*s+e*k*v-f*q*v-h*k*w+f*m*w;c=d[0]*c[0]+d[1]*c[4]+d[2]*c[8]+d[3]*c[12];if(0===c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},
compose:function(){var a=new $3Dmol.Matrix4,b=new $3Dmol.Matrix4;return function(c,d,f){var h=this.elements;a.identity();a.setRotationFromQuaternion(d);b.makeScale(f.x,f.y,f.z);this.multiplyMatrices(a,b);h[12]=c.x;h[13]=c.y;h[14]=c.z;return this}}(),decompose:function(){var a=new $3Dmol.Vector3,b=new $3Dmol.Vector3,c=new $3Dmol.Vector3,d=new $3Dmol.Matrix4;return function(f,h,e){var l=this.elements;a.set(l[0],l[1],l[2]);b.set(l[4],l[5],l[6]);c.set(l[8],l[9],l[10]);f=f instanceof $3Dmol.Vector3?f:
new $3Dmol.Vector3;h=h instanceof $3Dmol.Quaternion?h:new $3Dmol.Quaternion;e=e instanceof Webmol.Vector3?e:new $3Dmol.Vector3;e.x=a.length();e.y=b.length();e.z=c.length();f.x=l[12];f.y=l[13];f.z=l[14];d.copy(this);d.elements[0]/=e.x;d.elements[1]/=e.x;d.elements[2]/=e.x;d.elements[4]/=e.y;d.elements[5]/=e.y;d.elements[6]/=e.y;d.elements[8]/=e.z;d.elements[9]/=e.z;d.elements[10]/=e.z;h.setFromRotationMatrix(d);return[f,h,e]}}(),scale:function(a){var b=this.elements,c=a.x,d=a.y;a=a.z;b[0]*=c;b[4]*=
d;b[8]*=a;b[1]*=c;b[5]*=d;b[9]*=a;b[2]*=c;b[6]*=d;b[10]*=a;b[3]*=c;b[7]*=d;b[11]*=a;return this},getMaxScaleOnAxis:function(){var a=this.elements;return Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])))},makeFrustum:function(a,b,c,d,f,h){var e=this.elements;e[0]=2*f/(b-a);e[4]=0;e[8]=(b+a)/(b-a);e[12]=0;e[1]=0;e[5]=2*f/(d-c);e[9]=(d+c)/(d-c);e[13]=0;e[2]=0;e[6]=0;e[10]=-(h+f)/(h-f);e[14]=-2*h*f/(h-f);e[3]=0;e[7]=0;e[11]=-1;e[15]=
0;return this},makePerspective:function(a,b,c,d){a=c*Math.tan($3Dmol.Math.degToRad(.5*a));var f=-a;return this.makeFrustum(f*b,a*b,f,a,c,d)},clone:function(){var a=this.elements;return new $3Dmol.Matrix4(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};$3Dmol.Ray=function(a,b){this.origin=void 0!==a?a:new $3Dmol.Vector3;this.direction=void 0!==b?b:new $3Dmol.Vector3};
$3Dmol.Ray.prototype={constructor:$3Dmol.Ray,set:function(a,b){this.origin.copy(a);this.direction.copy(b);return this},copy:function(a){this.origin.copy(a.origin);this.direction.copy(a.direction);return this},at:function(a,b){return(b||new $3Dmol.Vector3).copy(this.direction).multiplyScalar(a).add(this.origin)},recast:function(){var a=new $3Dmol.Vector3;return function(b){this.origin.copy(this.at(b,a));return this}}(),closestPointToPoint:function(a,b){var c=b||new $3Dmol.Vector3;c.subVectors(a,this.origin);
var d=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(){var a=new $3Dmol.Vector3;return function(b){var c=a.subVectors(b,this.origin).dot(this.direction);a.copy(this.direction).multiplyScalar(c).add(this.origin);return a.distanceTo(b)}}(),isIntersectionCylinder:function(){},isIntersectionSphere:function(a){return this.distanceToPoint(a.center)<=a.radius},isIntersectionPlane:function(a){return 0!==a.normal.dot(this.direction)||0===a.distanceToPoint(this.origin)?
!0:!1},distanceToPlane:function(a){var b=a.normal.dot(this.direction);if(0===b){if(0===a.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(a.normal)+a.constant)/b},intersectPlane:function(a,b){var c=this.distanceToPlane(a);return void 0===c?void 0:this.at(c,b)},applyMatrix4:function(a){this.direction.add(this.origin).applyMatrix4(a);this.origin.applyMatrix4(a);this.direction.sub(this.origin);return this},equals:function(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)},
clone:function(){return(new $3Dmol.Ray).copy(this)}};$3Dmol.Sphere=function(a,b){this.center=void 0!==a?a:new $3Dmol.Vector3;this.radius=void 0!==b?b:0};
$3Dmol.Sphere.prototype={constructor:$3Dmol.Sphere,set:function(a,b){this.center.copy(a);this.radius=b;return this},copy:function(a){this.center.copy(a.center);this.radius=a.radius;return this},applyMatrix4:function(a){this.center.applyMatrix4(a);this.radius*=a.getMaxScaleOnAxis();return this},translate:function(a){this.center.add(a);return this},equals:function(a){return a.center.equals(this.center)&&a.radius===this.radius},clone:function(){return(new $3Dmol.Sphere).copy(this)}};
$3Dmol.Cylinder=function(a,b,c){this.c1=void 0!==a?a:new $3Dmol.Vector3;this.c2=void 0!==b?b:new $3Dmol.Vector3;this.direction=(new $3Dmol.Vector3).subVectors(this.c2,this.c1).normalize();this.radius=void 0!==c?c:0};
$3Dmol.Cylinder.prototype={constructor:$3Dmol.Cylinder,copy:function(a){this.c1.copy(a.c1);this.c2.copy(a.c2);this.direction.copy(a.direction);this.radius=a.radius;return this},lengthSq:function(){var a=new $3Dmol.Vector3;return function(){return a.subVectors(this.c2,this.c1).lengthSq()}}(),applyMatrix4:function(a){this.direction.add(this.c1).applyMatrix4(a);this.c1.applyMatrix4(a);this.c2.applyMatrix4(a);this.direction.sub(this.c1).normalize();this.radius*=a.getMaxScaleOnAxis();return this}};
$3Dmol.Triangle=function(a,b,c){this.a=void 0!==a?a:new $3Dmol.Vector3;this.b=void 0!==b?b:new $3Dmol.Vector3;this.c=void 0!==c?c:new $3Dmol.Vector3};
$3Dmol.Triangle.prototype={constructor:$3Dmol.Triangle,copy:function(a){this.a.copy(a.a);this.b.copy(a.b);this.c.copy(a.c);return this},applyMatrix4:function(a){this.a.applyMatrix4(a);this.b.applyMatrix4(a);this.c.applyMatrix4(a);return this},getNormal:function(){var a=new $3Dmol.Vector3;return function(){var b=this.a.clone();b.sub(this.b);a.subVectors(this.c,this.b);b.cross(a);b.normalize();return b}}()};
$3Dmol.EventDispatcher=function(){var a={};this.addEventListener=function(b,c){void 0===a[b]&&(a[b]=[]);-1===a[b].indexOf(c)&&a[b].push(c)};this.removeEventListener=function(b,c){var d=a[b].indexOf(c);-1!==d&&a[b].splice(d,1)};this.dispatchEvent=function(b){var c=a[b.type];if(void 0!==c){b.target=this;for(var d=0,f=c.length;d<f;d++)c[d].call(this,b)}}};$3Dmol.Color=function(a){return 1<arguments.length?(this.r=arguments[0]||0,this.g=arguments[1]||0,this.b=arguments[2]||0,this):this.set(a)};
$3Dmol.Color.prototype={constructor:$3Dmol.Color,r:0,g:0,b:0,set:function(a){if(a instanceof $3Dmol.Color)return a.clone();"number"===typeof a&&this.setHex(a)},setHex:function(a){a=Math.floor(a);this.r=(a>>16&255)/255;this.g=(a>>8&255)/255;this.b=(a&255)/255;return this},clone:function(){return new $3Dmol.Color(this.r,this.g,this.b)},copy:function(a){this.r=a.r;this.g=a.g;this.b=a.b;return this},scaled:function(){var a={};a.r=Math.round(255*this.r);a.g=Math.round(255*this.g);a.b=Math.round(255*this.b);
a.a=1;return a}};
$3Dmol.Object3D=function(){this.id=$3Dmol.Object3DIDCount++;this.name="";this.parent=void 0;this.children=[];this.position=new $3Dmol.Vector3;this.rotation=new $3Dmol.Vector3;this.matrix=new $3Dmol.Matrix4;this.matrixWorld=new $3Dmol.Matrix4;this.quaternion=new $3Dmol.Quaternion;this.eulerOrder="XYZ";this.up=new $3Dmol.Vector3(0,1,0);this.scale=new $3Dmol.Vector3(1,1,1);this.rotationAutoUpdate=this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.useQuaternion=!1;this.visible=!0};
$3Dmol.Object3D.prototype={constructor:$3Dmol.Object3D,lookAt:function(a){this.matrix.lookAt(a,this.position,this.up);this.rotationAutoUpdate&&(!0===this.useQuaternion?this.quaternion.copy(this.matrix.decompose()[1]):this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder))},add:function(a){if(a===this)console.error("Can't add $3Dmol.Object3D to itself");else{a.parent=this;this.children.push(a);for(var b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof $3Dmol.Scene&&b.__addObject(a)}},
remove:function(a){var b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof $3Dmol.Scene&&b.__removeObject(a)}},updateMatrix:function(){this.matrix.setPosition(this.position);!1===this.useQuaternion?this.matrix.setRotationFromEuler(this.rotation,this.eulerOrder):this.matrix.setRotationFromQuaternion(this.quaternion);1===this.scale.x&&1===this.scale.y&&1===this.scale.z||this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=
!0},updateMatrixWorld:function(a){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===a)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix);this.matrixWorldNeedsUpdate=!1;for(a=0;a<this.children.length;a++)this.children[a].updateMatrixWorld(!0)},clone:function(a){void 0===a&&(a=new $3Dmol.Object3D);a.name=this.name;a.up.copy(this.up);a.position.copy(this.position);a.rotation.copy(this.rotation);
a.eulerOrder=this.eulerOrder;a.scale.copy(this.scale);a.rotationAutoUpdate=this.rotationAutoUpdate;a.matrix.copy(this.matrix);a.matrixWorld.copy(this.matrixWorld);a.quaternion.copy(this.quaternion);a.useQuaternion=this.useQuaternion;a.visible=this.visible;for(var b=0;b<this.children.length;b++)a.add(this.children[b].clone());return a}};$3Dmol.Object3DIDCount=0;
$3Dmol.Geometry=function(){var a=function(a){this.id=a||0;this.lineArray=this.faceArray=this.normalArray=this.colorArray=this.vertexArray=null;this.lineidx=this.faceidx=this.vertices=0};a.prototype.getNumVertices=function(){return this.vertices};a.prototype.getVertices=function(){return this.vertexArray};a.prototype.getCentroid=function(){for(var a=new $3Dmol.Vector3,b,c,e,l=0;l<this.vertices;++l)b=3*l,c=this.vertexArray[b],e=this.vertexArray[b+1],b=this.vertexArray[b+2],a.x+=c,a.y+=e,a.z+=b;a.divideScalar(this.vertices);
return a};a.prototype.setNormals=function(){var a=this.faceArray,b=this.vertexArray,c=this.normalArray;if(this.vertices&&this.faceidx)for(var e,l,k,m,q,A,s=0;s<a.length/3;++s)e=3*a[3*s],l=3*a[3*s+1],k=3*a[3*s+2],m=new $3Dmol.Vector3(b[e],b[e+1],b[e+2]),q=new $3Dmol.Vector3(b[l],b[l+1],b[l+2]),A=new $3Dmol.Vector3(b[k],b[k+1],b[k+2]),m.subVectors(m,q),A.subVectors(A,q),A.cross(m),m=A,m.normalize(),c[e]+=m.x,c[l]+=m.x,c[k]+=m.x,c[e+1]+=m.y,c[l+1]+=m.y,c[k+1]+=m.y,c[e+2]+=m.z,c[l+2]+=m.z,c[k+2]+=m.z};
a.prototype.setLineIndices=function(){if(this.faceidx){var a=this.faceArray,b=this.lineArray=new Uint16Array(2*this.faceidx);this.lineidx=2*this.faceidx;for(var c,e=0;e<this.faceidx/3;++e){c=3*e;lineoffset=2*c;var l=a[c],k=a[c+1];c=a[c+2];b[lineoffset]=l;b[lineoffset+1]=k;b[lineoffset+2]=l;b[lineoffset+3]=c;b[lineoffset+4]=k;b[lineoffset+5]=c}}};a.prototype.truncateArrayBuffers=function(a,b){a=!0===a?!0:!1;var c=this.colorArray,e=this.normalArray,l=this.faceArray,k=this.lineArray;this.vertexArray=
this.vertexArray.subarray(0,3*this.vertices);this.colorArray=c.subarray(0,3*this.vertices);a?(this.normalArray=e.subarray(0,3*this.vertices),this.faceArray=l.subarray(0,this.faceidx),this.lineArray=0<this.lineidx?k.subarray(0,this.lineidx):new Uint16Array):(this.normalArray=new Float32Array,this.faceArray=new Uint16Array,this.lineArray=new Uint16Array);b&&(this.normalArray&&(this.normalArray=new Float32Array(this.normalArray)),this.faceArray&&(this.faceArray=new Uint16Array(this.faceArray)),this.lineArray&&
(this.lineArray=new Uint16Array(this.lineArray)),this.vertexArray&&(this.vertexArray=new Float32Array(this.vertexArray)),this.colorArray&&(this.colorArray=new Float32Array(this.colorArray)));this.__inittedArrays=!0};var b=function(b){var c=new a(b.geometryGroups.length);b.geometryGroups.push(c);b.groups=b.geometryGroups.length;c.vertexArray=new Float32Array(196605);c.colorArray=new Float32Array(196605);b.mesh&&(c.normalArray=new Float32Array(196605),c.faceArray=new Uint16Array(393210),c.lineArray=
new Uint16Array(393210));return c},c=function(a){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.GeometryIDCount++;this.name="";this.hasTangents=!1;this.dynamic=!0;this.mesh=!0===a?!0:!1;this.buffersNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.elementsNeedUpdate=this.verticesNeedUpdate=!1;this.geometryGroups=[];this.groups=0};c.prototype={constructor:c,updateGeoGroup:function(a){var c=0<this.groups?this.geometryGroups[this.groups-1]:null;if(!c||65535<c.vertices+(a||0))c=b(this);return c},
addGeoGroup:function(){return b(this)},setUpNormals:function(a){a=a||!1;for(var b=0;b<this.groups;b++)this.geometryGroups[b].setNormals(a)},setUpWireframe:function(){for(var a=0;a<this.groups;a++)this.geometryGroups[a].setLineIndices()},initTypedArrays:function(){for(var a=0;a<this.groups;a++){var b=this.geometryGroups[a];!0!==b.__inittedArrays&&b.truncateArrayBuffers(this.mesh,!1)}},dispose:function(){this.dispatchEvent({type:"dispose"})}};return c}();
Object.defineProperty($3Dmol.Geometry.prototype,"vertices",{get:function(){for(var a=0,b=0;b<this.groups;b++)a+=this.geometryGroups[b].vertices;return a}});$3Dmol.GeometryIDCount=0;
$3Dmol.Raycaster=function(){var a=function(a,b,c,d){this.ray=new $3Dmol.Ray(a,b);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=d||0;this.far=c||Infinity},b=new $3Dmol.Sphere,c=new $3Dmol.Cylinder,d=new $3Dmol.Triangle,f=new $3Dmol.Vector3,h=new $3Dmol.Vector3,e=new $3Dmol.Vector3,l=new $3Dmol.Vector3;new $3Dmol.Ray;new $3Dmol.Vector3;var k=new $3Dmol.Vector3;new $3Dmol.Matrix4;var m=function(a,b){return a.distance-b.distance},q=function(a){return Math.min(Math.max(a,-1),
1)};a.prototype.precision=1E-4;a.prototype.linePrecision=.2;a.prototype.set=function(a,b){this.ray.set(a,b)};a.prototype.intersectObjects=function(a,s){for(var v=[],w=0,r=s.length;w<r;w++)a:{var n=a,u=s[w],t=v;k.getPositionFromMatrix(n.matrixWorld);if(!0===u.clickable&&void 0!==u.intersectionShape){var z=u.intersectionShape,F=this.linePrecision,F=F*n.matrixWorld.getMaxScaleOnAxis(),F=F*F;if(void 0!==u.boundingSphere&&u.boundingSphere instanceof $3Dmol.Sphere&&(b.copy(u.boundingSphere),b.applyMatrix4(n.matrixWorld),
!this.ray.isIntersectionSphere(b)))break a;for(var B=void 0,C=void 0,x=void 0,p=void 0,y=x=void 0,E=void 0,H=void 0,G=void 0,D=void 0,I=D=y=p=void 0,B=0,C=z.triangle.length;B<C;B++)z.triangle[B]instanceof $3Dmol.Triangle&&(d.copy(z.triangle[B]),d.applyMatrix4(n.matrixWorld),x=d.getNormal(),p=this.ray.direction.dot(x),0<=p||(f.subVectors(d.a,this.ray.origin),E=x.dot(f)/p,0>E||(h.copy(this.ray.direction).multiplyScalar(E).add(this.ray.origin),h.sub(d.a),e.copy(d.b).sub(d.a),l.copy(d.c).sub(d.a),p=e.dot(l),
x=e.lengthSq(),y=l.lengthSq(),y=(x*h.dot(l)-p*h.dot(e))/(x*y-p*p),0>y||1<y||(p=(h.dot(e)-y*p)/x,0>p||1<p||1<p+y||t.push({clickable:u,distance:E})))));B=0;for(C=z.cylinder.length;B<C;B++)z.cylinder[B]instanceof $3Dmol.Cylinder&&(c.copy(z.cylinder[B]),c.applyMatrix4(n.matrixWorld),f.subVectors(c.c1,this.ray.origin),x=f.dot(c.direction),y=f.dot(this.ray.direction),p=q(this.ray.direction.dot(c.direction)),G=1-p*p,0!==G&&(D=(p*y-x)/G,I=(y-p*x)/G,h.copy(c.direction).multiplyScalar(D).add(c.c1),e.copy(this.ray.direction).multiplyScalar(I).add(this.ray.origin),
H=l.subVectors(h,e).lengthSq(),D=c.radius*c.radius,H<=D&&(D=(p*x-y)*(p*x-y)-G*(f.lengthSq()-x*x-D),y=0>=D?E=Math.sqrt(H):E=(y-p*x-Math.sqrt(D))/G,p=p*y-x,0>p||p*p>c.lengthSq()||0>y||t.push({clickable:u,distance:E}))));B=0;for(C=z.line.length;B<C;B+=2)h.copy(z.line[B]),h.applyMatrix4(n.matrixWorld),e.copy(z.line[B+1]),e.applyMatrix4(n.matrixWorld),l.subVectors(e,h),E=l.lengthSq(),l.normalize(),f.subVectors(h,this.ray.origin),lineProj=f.dot(l),y=f.dot(this.ray.direction),p=q(this.ray.direction.dot(l)),
G=1-p*p,0!==G&&(D=(p*y-lineProj)/G,I=(y-p*lineProj)/G,h.add(l.multiplyScalar(D)),e.copy(this.ray.direction).multiplyScalar(I).add(this.ray.origin),H=l.subVectors(e,h).lengthSq(),H<F&&D*D<E&&t.push({clickable:u,distance:I}));B=0;for(C=z.sphere.length;B<C;B++)if(z.sphere[B]instanceof $3Dmol.Sphere&&(b.copy(z.sphere[B]),b.applyMatrix4(n.matrixWorld),this.ray.isIntersectionSphere(b))){h.subVectors(b.center,this.ray.origin);n=h.dot(this.ray.direction);D=n*n-(h.lengthSq()-b.radius*b.radius);if(0>n)break a;
E=0>=D?n:n-Math.sqrt(D);t.push({clickable:u,distance:E});break a}}}v.sort(m);return v};return a}();$3Dmol.Projector=function(){new $3Dmol.Matrix4;var a=new $3Dmol.Matrix4;this.projectVector=function(b,c){c.matrixWorldInverse.getInverse(c.matrixWorld);a.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);return b.applyProjection(a)};this.unprojectVector=function(b,c){c.projectionMatrixInverse.getInverse(c.projectionMatrix);a.multiplyMatrices(c.matrixWorld,c.projectionMatrixInverse);return b.applyProjection(a)}};
$3Dmol.Camera=function(a,b,c,d){$3Dmol.Object3D.call(this);this.fov=void 0!==a?a:50;this.aspect=void 0!==b?b:1;this.near=void 0!==c?c:.1;this.far=void 0!==d?d:2E3;this.projectionMatrix=new $3Dmol.Matrix4;this.projectionMatrixInverse=new $3Dmol.Matrix4;this.matrixWorldInverse=new $3Dmol.Matrix4;this.updateProjectionMatrix()};$3Dmol.Camera.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Camera.prototype.lookAt=function(a){this.matrix.lookAt(this.position,a,this.up);this.rotationAutoUpdate&&(!1===this.useQuaternion?this.rotation.setEulerFromRotationMatrix(this.matrix,this.eulerOrder):this.quaternion.copy(this.matrix.decompose()[1]))};$3Dmol.Camera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
$3Dmol.SpritePlugin=function(){function a(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var b,c,d,f,h,e,l,k,m,q;this.init=function(a){b=a.context;c=a;d=a.getPrecision();f=new Float32Array(16);h=new Uint16Array(6);a=0;f[a++]=-1;f[a++]=-1;f[a++]=0;f[a++]=0;f[a++]=1;f[a++]=-1;f[a++]=1;f[a++]=0;f[a++]=1;f[a++]=1;f[a++]=1;f[a++]=1;f[a++]=-1;f[a++]=1;f[a++]=0;f[a++]=1;a=0;h[a++]=0;h[a++]=1;h[a++]=2;h[a++]=0;h[a++]=2;h[a++]=3;e=b.createBuffer();l=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,e);b.bufferData(b.ARRAY_BUFFER,
f,b.STATIC_DRAW);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,l);b.bufferData(b.ELEMENT_ARRAY_BUFFER,h,b.STATIC_DRAW);a=$3Dmol.ShaderLib.sprite;var s=d,v=b.createProgram(),w=b.createShader(b.FRAGMENT_SHADER),r=b.createShader(b.VERTEX_SHADER),s="precision "+s+" float;\n";b.shaderSource(w,s+a.fragmentShader);b.shaderSource(r,s+a.vertexShader);b.compileShader(w);b.compileShader(r);b.getShaderParameter(w,b.COMPILE_STATUS)&&b.getShaderParameter(r,b.COMPILE_STATUS)?(b.attachShader(v,w),b.attachShader(v,r),b.linkProgram(v),
b.getProgramParameter(v,b.LINK_STATUS)||console.error("Could not initialize shader"),a=v):(console.error(b.getShaderInfoLog(w)),console.error("could not initialize shader"),a=null);k=a;m={};q={};m.position=b.getAttribLocation(k,"position");m.uv=b.getAttribLocation(k,"uv");q.uvOffset=b.getUniformLocation(k,"uvOffset");q.uvScale=b.getUniformLocation(k,"uvScale");q.rotation=b.getUniformLocation(k,"rotation");q.scale=b.getUniformLocation(k,"scale");q.alignment=b.getUniformLocation(k,"alignment");q.color=
b.getUniformLocation(k,"color");q.map=b.getUniformLocation(k,"map");q.opacity=b.getUniformLocation(k,"opacity");q.useScreenCoordinates=b.getUniformLocation(k,"useScreenCoordinates");q.sizeAttenuation=b.getUniformLocation(k,"sizeAttenuation");q.screenPosition=b.getUniformLocation(k,"screenPosition");q.modelViewMatrix=b.getUniformLocation(k,"modelViewMatrix");q.projectionMatrix=b.getUniformLocation(k,"projectionMatrix");q.fogType=b.getUniformLocation(k,"fogType");q.fogDensity=b.getUniformLocation(k,
"fogDensity");q.fogNear=b.getUniformLocation(k,"fogNear");q.fogFar=b.getUniformLocation(k,"fogFar");q.fogColor=b.getUniformLocation(k,"fogColor");q.alphaTest=b.getUniformLocation(k,"alphaTest")};this.render=function(d,f,h,w){var r=d.__webglSprites,n=r.length;if(n){var u=m,t=q,z=w/h;h*=.5;var F=.5*w;b.useProgram(k);b.enableVertexAttribArray(u.position);b.enableVertexAttribArray(u.uv);b.disable(b.CULL_FACE);b.enable(b.BLEND);b.bindBuffer(b.ARRAY_BUFFER,e);b.vertexAttribPointer(u.position,2,b.FLOAT,
!1,16,0);b.vertexAttribPointer(u.uv,2,b.FLOAT,!1,16,8);b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,l);b.uniformMatrix4fv(t.projectionMatrix,!1,f.projectionMatrix.elements);b.activeTexture(b.TEXTURE0);b.uniform1i(t.map,0);var B=u=0;(u=d.fog)?(b.uniform3f(t.fogColor,u.color.r,u.color.g,u.color.b),b.uniform1f(t.fogNear,u.near),b.uniform1f(t.fogFar,u.far),b.uniform1i(t.fogType,1),B=u=1):(b.uniform1i(t.fogType,0),B=u=0);var C,x,p,y=[];for(C=0;C<n;C++)x=r[C],p=x.material,x.visible&&0!==p.opacity&&(p.useScreenCoordinates?
x.z=-x.position.z:(x._modelViewMatrix.multiplyMatrices(f.matrixWorldInverse,x.matrixWorld),x.z=-x._modelViewMatrix.elements[14]));r.sort(a);for(C=0;C<n;C++)x=r[C],p=x.material,x.visible&&0!==p.opacity&&p.map&&p.map.image&&p.map.image.width&&(b.uniform1f(t.alphaTest,p.alphaTest),!0===p.useScreenCoordinates?(b.uniform1i(t.useScreenCoordinates,1),b.uniform3f(t.screenPosition,(x.position.x*c.devicePixelRatio-h)/h,(F-x.position.y*c.devicePixelRatio)/F,Math.max(0,Math.min(1,x.position.z))),y[0]=c.devicePixelRatio,
y[1]=c.devicePixelRatio):(b.uniform1i(t.useScreenCoordinates,0),b.uniform1i(t.sizeAttenuation,p.sizeAttenuation?1:0),b.uniformMatrix4fv(t.modelViewMatrix,!1,x._modelViewMatrix.elements),y[0]=1,y[1]=1),f=d.fog&&p.fog?B:0,u!==f&&(b.uniform1i(t.fogType,f),u=f),f=1/(p.scaleByViewport?w:1),y[0]=y[0]*f*z*x.scale.x,y[1]=y[1]*f*x.scale.y,b.uniform2f(t.uvScale,p.uvScale.x,p.uvScale.y),b.uniform2f(t.uvOffset,p.uvOffset.x,p.uvOffset.y),b.uniform2f(t.alignment,p.alignment.x,p.alignment.y),b.uniform1f(t.opacity,
p.opacity),b.uniform3f(t.color,p.color.r,p.color.g,p.color.b),b.uniform1f(t.rotation,x.rotation),b.uniform2fv(t.scale,y),c.setDepthTest(p.depthTest),c.setDepthWrite(p.depthWrite),c.setTexture(p.map,0),b.drawElements(b.TRIANGLES,6,b.UNSIGNED_SHORT,0));b.enable(b.CULL_FACE)}}};$3Dmol.Light=function(a,b){$3Dmol.Object3D.call(this);this.color=new $3Dmol.Color(a);this.position=new $3Dmol.Vector3(0,1,0);this.target=new $3Dmol.Object3D;this.intensity=void 0!==b?b:1;this.onlyShadow=this.castShadow=!1};
$3Dmol.Light.prototype=Object.create($3Dmol.Object3D.prototype);$3Dmol.Material=function(){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.MaterialIdCount++;this.name="";this.side=$3Dmol.FrontSide;this.opacity=1;this.transparent=!1;this.blending=$3Dmol.NormalBlending;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.needsUpdate=this.visible=!0};
$3Dmol.Material.prototype.setValues=function(a){if(void 0!==a)for(var b in a){var c=a[b];if(void 0===c)console.warn("$3Dmol.Material: '"+b+"' parameter is undefined.");else if(b in this){var d=this[b];d instanceof $3Dmol.Color&&c instanceof $3Dmol.Color?d.copy(c):d instanceof $3Dmol.Color?d.set(c):d instanceof $3Dmol.Vector3&&c instanceof $3Dmol.Vector3?d.copy(c):this[b]=c}}};
$3Dmol.Material.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Material);a.name=this.name;a.side=this.side;a.opacity=this.opacity;a.transparent=this.transparent;a.blending=this.blending;a.depthTest=this.depthTest;a.depthWrite=this.depthWrite;a.polygonOffset=this.polygonOffset;a.polygonOffsetFactor=this.polygonOffsetFactor;a.polygonOffsetUnits=this.polygonOffsetUnits;a.alphaTest=this.alphaTest;a.overdraw=this.overdraw;a.visible=this.visible;return a};$3Dmol.Material.prototype.dispose=function(){this.dispatchEvent({type:"dispose"})};
$3Dmol.MaterialIdCount=0;$3Dmol.LineBasicMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.shaderID="basic";this.setValues(a)};$3Dmol.LineBasicMaterial.prototype=Object.create($3Dmol.Material.prototype);$3Dmol.LineBasicMaterial.prototype.clone=function(){var a=new $3Dmol.LineBasicMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy();return a};
$3Dmol.MeshLambertMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.ambient=new $3Dmol.Color(1048575);this.emissive=new $3Dmol.Color(0);this.wrapAround=!1;this.wrapRGB=new $3Dmol.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.shading=$3Dmol.SmoothShading;this.shaderID="lambert";
this.vertexColors=$3Dmol.NoColors;this.skinning=!1;this.setValues(a)};$3Dmol.MeshLambertMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.MeshLambertMaterial.prototype.clone=function(a){"undefined"===typeof a&&(a=new $3Dmol.MeshLambertMaterial);$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;
a.shading=this.shading;a.shaderID=this.shaderID;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};$3Dmol.MeshDoubleLambertMaterial=function(a){$3Dmol.MeshLambertMaterial.call(this);this.shaderID="lambertdouble";this.side=$3Dmol.DoubleSide};$3Dmol.MeshDoubleLambertMaterial.prototype=Object.create($3Dmol.MeshLambertMaterial.prototype);
$3Dmol.MeshDoubleLambertMaterial.prototype.clone=function(){var a=new $3Dmol.MeshDoubleLambertMaterial;$3Dmol.MeshLambertMaterial.prototype.clone.call(this,a);return a};
$3Dmol.ImposterMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.ambient=new $3Dmol.Color(1048575);this.emissive=new $3Dmol.Color(0);this.wrapAround=!1;this.wrapRGB=new $3Dmol.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.reflectivity=1;this.refractionRatio=.98;this.fog=!0;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.shading=$3Dmol.SmoothShading;this.shaderID="sphereimposter";
this.vertexColors=$3Dmol.NoColors;this.skinning=!1;this.setValues(a)};$3Dmol.ImposterMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.ImposterMaterial.prototype.clone=function(){var a=new $3Dmol.ImposterMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.ambient.copy(this.ambient);a.emissive.copy(this.emissive);a.wrapAround=this.wrapAround;a.wrapRGB.copy(this.wrapRGB);a.map=this.map;a.lightMap=this.lightMap;a.specularMap=this.specularMap;a.envMap=this.envMap;a.combine=this.combine;a.reflectivity=this.reflectivity;a.refractionRatio=this.refractionRatio;a.fog=this.fog;a.shading=this.shading;a.shaderID=
this.shaderID;a.vertexColors=this.vertexColors;a.skinning=this.skinning;a.morphTargets=this.morphTargets;a.morphNormals=this.morphNormals;return a};
$3Dmol.SpriteMaterial=function(a){$3Dmol.Material.call(this);this.color=new $3Dmol.Color(16777215);this.map=new $3Dmol.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewPort=!this.sizeAttenuation;this.alignment=$3Dmol.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new $3Dmol.Vector2(0,0);this.uvScale=new $3Dmol.Vector2(1,1);this.setValues(a);a=a||{};void 0===a.depthTest&&(this.depthTest=!this.useScreenCoordinates);
void 0===a.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===a.scaleByViewPort&&(this.scaleByViewPort=!this.sizeAttenuation)};$3Dmol.SpriteMaterial.prototype=Object.create($3Dmol.Material.prototype);
$3Dmol.SpriteMaterial.prototype.clone=function(){var a=new $3Dmol.SpriteMaterial;$3Dmol.Material.prototype.clone.call(this,a);a.color.copy(this.color);a.map=this.map;a.useScreenCoordinates=useScreenCoordinates;a.sizeAttenuation=this.sizeAttenuation;a.scaleByViewport=this.scaleByViewPort;a.alignment.copy(this.alignment);a.uvOffset.copy(this.uvOffset);return a};$3Dmol.SpriteAlignment={};$3Dmol.SpriteAlignment.topLeft=new $3Dmol.Vector2(1,-1);$3Dmol.SpriteAlignment.topCenter=new $3Dmol.Vector2(0,-1);
$3Dmol.SpriteAlignment.topRight=new $3Dmol.Vector2(-1,-1);$3Dmol.SpriteAlignment.centerLeft=new $3Dmol.Vector2(1,0);$3Dmol.SpriteAlignment.center=new $3Dmol.Vector2(0,0);$3Dmol.SpriteAlignment.centerRight=new $3Dmol.Vector2(-1,0);$3Dmol.SpriteAlignment.bottomLeft=new $3Dmol.Vector2(1,1);$3Dmol.SpriteAlignment.bottomCenter=new $3Dmol.Vector2(0,1);$3Dmol.SpriteAlignment.bottomRight=new $3Dmol.Vector2(-1,1);
$3Dmol.Texture=function(a){$3Dmol.EventDispatcher.call(this);this.id=$3Dmol.TextureIdCount++;this.name="";this.image=a;this.mipmaps=[];this.mapping=new $3Dmol.UVMapping;this.wrapT=this.wrapS=$3Dmol.ClampToEdgeWrapping;this.magFilter=$3Dmol.LinearFilter;this.minFilter=$3Dmol.LinearMipMapLinearFilter;this.anisotropy=1;this.format=$3Dmol.RGBAFormat;this.type=$3Dmol.UnsignedByteType;this.offset=new $3Dmol.Vector2(0,0);this.repeat=new $3Dmol.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;
this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
$3Dmol.Texture.prototype={constructor:$3Dmol.Texture,clone:function(a){void 0===a&&(a=new $3Dmol.Texture);a.image=this.image;a.mipmaps=this.mipmaps.slice(0);a.mapping=this.mapping;a.wrapS=this.wrapS;a.wrapT=this.wrapT;a.magFilter=this.magFilter;a.minFilter=this.minFilter;a.anisotropy=this.anisotropy;a.format=this.format;a.type=this.type;a.offset.copy(this.offset);a.repeat.copy(this.repeat);a.generateMipmaps=this.generateMipmaps;a.premultiplyAlpha=this.premultiplyAlpha;a.flipY=this.flipY;a.unpackAlignment=
this.unpackAlignment;return a},dispose:function(){this.dispatchEvent({type:"dispose"})}};$3Dmol.TextureIdCount=0;$3Dmol.FrontSide=0;$3Dmol.BackSide=1;$3Dmol.DoubleSide=2;$3Dmol.NoBlending=0;$3Dmol.NormalBlending=1;$3Dmol.AdditiveBlending=2;$3Dmol.SubtractiveBlending=3;$3Dmol.MultiplyBlending=4;$3Dmol.CustomBlending=5;$3Dmol.NoShading=0;$3Dmol.FlatShading=1;$3Dmol.SmoothShading=2;$3Dmol.NoColors=0;$3Dmol.FaceColors=1;$3Dmol.VertexColors=2;$3Dmol.MultiplyOperation=0;$3Dmol.MixOperation=1;
$3Dmol.AddOperation=2;$3Dmol.UVMapping=function(){};$3Dmol.ClampToEdgeWrapping=1001;$3Dmol.LinearFilter=1006;$3Dmol.LinearMipMapLinearFilter=1008;$3Dmol.UnsignedByteType=1009;$3Dmol.RGBAFormat=1021;$3Dmol.Line=function(a,b,c){$3Dmol.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new $3Dmol.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:$3Dmol.LineStrip};$3Dmol.LineStrip=0;$3Dmol.LinePieces=1;$3Dmol.Line.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Line.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Line(this.geometry,this.material,this.type));$3Dmol.Object3D.prototype.clone.call(this,a);return a};$3Dmol.Mesh=function(a,b){$3Dmol.Object3D.call(this);this.geometry=a;this.material=void 0!==b?b:new $3Dmol.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})};$3Dmol.Mesh.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Mesh.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Mesh(this.geometry,this.material));$3Dmol.Object3D.prototype.clone.call(this,a);return a};$3Dmol.Sprite=function(a){$3Dmol.Object3D.call(this);this.material=void 0!==a?a:new $3Dmol.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};$3Dmol.Sprite.prototype=Object.create($3Dmol.Object3D.prototype);
$3Dmol.Sprite.prototype.updateMatrix=function(){this.matrix.setPosition(this.position);this.rotation3d.set(0,0,this.rotation);this.matrix.setRotationFromEuler(this.rotation3d);1===this.scale.x&&1===this.scale.y||this.matrix.scale(this.scale);this.matrixWorldNeedsUpdate=!0};$3Dmol.Sprite.prototype.clone=function(a){void 0===a&&(a=new $3Dmol.Sprite(this.material));$3Dmol.Object3D.prototype.clone.call(this,a);return a};
$3Dmol.Renderer=function(a){function b(a){J[a]||(g.enableVertexAttribArray(a),J[a]=!0)}function c(a,b){var c;"fragment"===a?c=g.createShader(g.FRAGMENT_SHADER):"vertex"===a&&(c=g.createShader(g.VERTEX_SHADER));g.shaderSource(c,b);g.compileShader(c);return g.getShaderParameter(c,g.COMPILE_STATUS)?c:(console.error(g.getShaderInfoLog(c)),console.error("could not initialize shader"),null)}function d(a,b,c,d,e,f,h,l){var k,n,m;b?(n=a.length-1,l=b=-1):(n=0,b=a.length,l=1);for(var p=n;p!==b;p+=l)if(k=a[p],
k.render&&(n=k.object,m=k.buffer,k=k[c])){h&&r.setBlending(k.blending);r.setDepthTest(k.depthTest);r.setDepthWrite(k.depthWrite);var q=k.polygonOffset;null!==q&&(q?g.enable(g.POLYGON_OFFSET_FILL):g.disable(g.POLYGON_OFFSET_FILL));r.setMaterialFaces(k);r.renderBuffer(d,e,f,k,m,n)}}function f(a){return 0===(a&a-1)}function h(a){return a===$3Dmol.UnsignedByteType?g.UNSIGNED_BYTE:a===$3Dmol.RGBAFormat?g.RGBA:0}a=a||{};var e=void 0!==a.canvas?a.canvas:document.createElement("canvas"),l=void 0!==a.precision?
a.precision:"highp",k=void 0!==a.alpha?a.alpha:!0,m=void 0!==a.premultipliedAlpha?a.premultipliedAlpha:!0,q=void 0!==a.antialias?a.antialias:!1,A=void 0!==a.stencil?a.stencil:!0,s=void 0!==a.preserveDrawingBuffer?a.preserveDrawingBuffer:!1,v=void 0!==a.clearColor?new $3Dmol.Color(a.clearColor):new $3Dmol.Color(0),w=void 0!==a.clearAlpha?a.clearAlpha:0;this.domElement=e;this.context=null;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:
1;this.autoUpdateScene=this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var r=this,n=[],u=0,t=null,z=-1,F=null,B=null,C=0,x=-1,p=-1,y=-1,E=-1,H=null,G=0,D=0,I=0,L=0,M=0,N=0,J={},X=new $3Dmol.Matrix4,S=new $3Dmol.Vector3,K=new $3Dmol.Vector3,O=!0,P=[0,0,0],Q=[],R=[],g;try{if(!(g=e.getContext("experimental-webgl",
{alpha:k,premultipliedAlpha:m,antialias:q,stencil:A,preserveDrawingBuffer:s})))throw"Error creating WebGL context.";}catch(Y){console.error(Y)}g.getExtension("EXT_frag_depth");g.clearColor(0,0,0,1);g.clearDepth(1);g.clearStencil(0);g.enable(g.DEPTH_TEST);g.depthFunc(g.LEQUAL);g.frontFace(g.CCW);g.cullFace(g.BACK);g.enable(g.CULL_FACE);g.enable(g.BLEND);g.blendEquation(g.FUNC_ADD);g.blendFunc(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA);g.clearColor(v.r,v.g,v.b,w);g.getExtension("EXT_frag_depth");this.context=
g;this.getContext=function(){return g};this.getPrecision=function(){return l};this.setClearColorHex=function(a,b){v.setHex(a);w=b;g.clearColor(v.r,v.g,v.b,w)};this.setSize=function(a,b){e.width=a*this.devicePixelRatio;e.height=b*this.devicePixelRatio;e.style.width=a+"px";e.style.height=b+"px";this.setViewport(0,0,e.width,e.height)};this.setViewport=function(a,b,c,d){G=void 0!==a?a:0;D=void 0!==b?b:0;I=void 0!==c?c:e.width;L=void 0!==d?d:e.height;g.viewport(G,D,I,L)};this.clear=function(a,b,c){var d=
0;if(void 0===a||a)d|=g.COLOR_BUFFER_BIT;if(void 0===b||b)d|=g.DEPTH_BUFFER_BIT;if(void 0===c||c)d|=g.STENCIL_BUFFER_BIT;g.clear(d)};this.clearTarget=function(a,b,c){this.clear(a,b,c)};this.setMaterialFaces=function(a){var b=a.side===$3Dmol.DoubleSide;a=a.side===$3Dmol.BackSide;x!==b&&(b?g.disable(g.CULL_FACE):g.enable(g.CULL_FACE),x=b);p!==a&&(a?g.frontFace(g.CW):g.frontFace(g.CCW),p=a)};this.setDepthTest=function(a){y!==a&&(a?g.enable(g.DEPTH_TEST):g.disable(g.DEPTH_TEST),y=a)};this.setDepthWrite=
function(a){E!==a&&(g.depthMask(a),E=a)};this.setBlending=function(a){a===$3Dmol.NoBlending?g.disable(g.BLEND):(g.enable(g.BLEND),g.blendEquationSeparate(g.FUNC_ADD,g.FUNC_ADD),g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA))};this.addPostPlugin=function(a){a.init(this);this.renderPluginsPost.push(a)};var T=function(a){a=a.target;a.removeEventListener("dispose",T);a.__webglInit=void 0;void 0!==a.__webglVertexBuffer&&g.deleteBuffer(a.__webglVertexBuffer);void 0!==
a.__webglColorBuffer&&g.deleteBuffer(a.__webglColorBuffer);if(void 0!==a.geometryGroups)for(var b=0,c=a.groups;b<c;b++){var d=a.geometryGroups[b];void 0!==d.__webglVertexBuffer&&g.deleteBuffer(d.__webglVertexBuffer);void 0!==d.__webglColorBuffer&&g.deleteBuffer(d.__webglColorBuffer);void 0!==d.__webglNormalBuffer&&g.deleteBuffer(d.__webglNormalBuffer);void 0!==d.__webglFaceBuffer&&g.deleteBuffer(d.__webglFaceBuffer);void 0!==d.__webglLineBuffer&&g.deleteBuffer(d.__webglLineBuffer)}r.info.memory.geometries--},
U=function(a){a=a.target;a.removeEventListener("dispose",U);a.image&&a.image.__webglTextureCube?g.deleteTexture(a.image.__webglTextureCube):a.__webglInit&&(a.__webglInit=!1,g.deleteTexture(a.__webglTexture));r.info.memory.textures--},V=function(a){a=a.target;a.removeEventListener("dispose",V);W(a)},W=function(a){var b=a.program;if(void 0!==b){a.program=void 0;var c,d,e=!1;a=0;for(c=n.length;a<c;a++)if(d=n[a],d.program===b){d.usedTimes--;0===d.usedTimes&&(e=!0);break}if(!0===e){e=[];a=0;for(c=n.length;a<
c;a++)d=n[a],d.program!==b&&e.push(d);n=e;g.deleteProgram(b);r.info.memory.programs--}}};this.initMaterial=function(a,b,d,e){a.addEventListener("dispose",V);if(b=a.shaderID)b=$3Dmol.ShaderLib[b],a.vertexShader=b.vertexShader,a.fragmentShader=b.fragmentShader,a.uniforms=$3Dmol.ShaderUtils.clone(b.uniforms);var f;a:{var h=a.fragmentShader;e=a.vertexShader;d=a.uniforms;var k={wireframe:a.wireframe},m,p;b=[];b.push(h);b.push(e);for(m in k)b.push(m),b.push(k[m]);b=b.join();m=0;for(p=n.length;m<p;m++){var q=
n[m];if(q.code===b){q.usedTimes++;f=q.program;break a}}m=g.createProgram();q="precision "+l+" float;";p=""+q;k=[k.wireframe?"#define WIREFRAME 1":"",q].join("\n");h=c("fragment",k+h);e=c("vertex",p+e);g.attachShader(m,e);g.attachShader(m,h);g.linkProgram(m);g.getProgramParameter(m,g.LINK_STATUS)||console.error("Could not initialize shader");m.uniforms={};m.attributes={};e="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition".split(" ");for(f in d)e.push(f);for(f=0;f<
e.length;f++)d=e[f],m.uniforms[d]=g.getUniformLocation(m,d);e=["position","normal","color","lineDistance"];for(f=0;f<e.length;f++)d=e[f],m.attributes[d]=g.getAttribLocation(m,d);m.id=u++;n.push({program:m,code:b,usedTimes:1});r.info.memory.programs=n.length;f=m}a.program=f};this.renderBuffer=function(a,c,d,e,f,h){if(e.visible){var k;e.needsUpdate&&(e.program&&W(e),r.initMaterial(e,c,d,h),e.needsUpdate=!1);var l=!1,m=e.program,n=m.uniforms;k=e.uniforms;m!=t&&(g.useProgram(m),t=m,l=!0);e.id!=z&&(z=
e.id,l=!0);a!=B&&(B=a,l=!0);if(l){g.uniformMatrix4fv(n.projectionMatrix,!1,a.projectionMatrix.elements);g.uniformMatrix4fv(n.modelViewMatrix,!1,h._modelViewMatrix.elements);k.fogColor.value=d.color;k.fogNear.value=d.near;k.fogFar.value=d.far;if(0===e.shaderID.lastIndexOf("lambert",0)){g.uniformMatrix4fv(n.viewMatrix,!1,a.matrixWorldInverse.elements);g.uniformMatrix3fv(n.normalMatrix,!1,h._normalMatrix.elements);if(O){var p,q,u=0,x=0,s=0;a=0;for(d=c.length;a<d;a++)if(l=c[a],p=l.color,q=l.intensity,
l instanceof $3Dmol.Light&&(u++,K.getPositionFromMatrix(l.matrixWorld),S.getPositionFromMatrix(l.target.matrixWorld),K.sub(S),K.normalize(),0!==K.x||0!==K.y||0!==K.z))R[s]=K.x,R[s+1]=K.y,R[s+2]=K.z,Q[s]=p.r*q,Q[s+1]=p.g*q,Q[s+2]=p.b*q,s+=3,x++;P[0]=0;P[1]=0;P[2]=0;O=!1}k.ambientLightColor.value=P;k.directionalLightColor.value=Q;k.directionalLightDirection.value=R;k.ambient.value=e.ambient;k.emissive.value=e.emissive}else"sphereimposter"===e.shaderID&&(g.uniformMatrix4fv(n.viewMatrix,!1,a.matrixWorldInverse.elements),
g.uniformMatrix3fv(n.normalMatrix,!1,h._normalMatrix.elements));k.opacity.value=e.opacity;k.diffuse.value=e.color;for(var v in k)n[v]&&(c=k[v].type,a=k[v].value,d=n[v],"f"===c?g.uniform1f(d,a):"fv"===c?g.uniform3fv(d,a):"c"===c&&g.uniform3f(d,a.r,a.g,a.b))}k=m.attributes;n=!1;m=16777215*f.id+2*m.id+(e.wireframe?1:0);m!==F&&(F=m,n=!0);if(n){for(var w in J)J[w]&&(g.disableVertexAttribArray(w),J[w]=!1);0<=k.position&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglVertexBuffer),b(k.position),g.vertexAttribPointer(k.position,
3,g.FLOAT,!1,0,0));0<=k.color&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglColorBuffer),b(k.color),g.vertexAttribPointer(k.color,3,g.FLOAT,!1,0,0));0<=k.normal&&(g.bindBuffer(g.ARRAY_BUFFER,f.__webglNormalBuffer),b(k.normal),g.vertexAttribPointer(k.normal,3,g.FLOAT,!1,0,0))}var y;h instanceof $3Dmol.Mesh?(e.wireframe?(h=f.lineidx,e=e.wireframeLinewidth,e!==H&&(g.lineWidth(e),H=e),n&&g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),g.drawElements(g.LINES,h,g.UNSIGNED_SHORT,0)):(y=f.faceidx,n&&g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,
f.__webglFaceBuffer),g.drawElements(g.TRIANGLES,y,g.UNSIGNED_SHORT,0)),r.info.render.calls++,r.info.render.vertices+=y,r.info.render.faces+=y/3):h instanceof $3Dmol.Line&&(h=f.vertices,f=e.linewidth,f!==H&&(g.lineWidth(f),H=f),g.drawArrays(g.LINES,0,h),r.info.render.calls++)}};this.render=function(a,b,c){if(!1===b instanceof $3Dmol.Camera)console.error("$3Dmol.Renderer.render: camera is not an instance of $3Dmol.Camera.");else{var g,e,f,k,h=a.__lights,l=a.fog;z=-1;O=!0;this.autoUpdateScene&&a.updateMatrixWorld();
void 0===b.parent&&b.updateMatrixWorld();b.matrixWorldInverse.getInverse(b.matrixWorld);X.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse);this.autoUpdateObjects&&this.initWebGLObjects(a);r.info.render.calls=0;r.info.render.vertices=0;r.info.render.faces=0;r.info.render.points=0;M=I;N=L;(this.autoClear||c)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);k=a.__webglObjects;c=0;for(g=k.length;c<g;c++)if(e=k[c],f=e.object,e.render=!1,f.visible){f._modelViewMatrix.multiplyMatrices(b.matrixWorldInverse,
f.matrixWorld);f._normalMatrix.getInverse(f._modelViewMatrix);f._normalMatrix.transpose();f=e;var m=f.object.material;m.transparent?(f.opaque=null,f.transparent=m,m=m.clone(),m.opacity=0,f.blank=m):(f.opaque=m,f.transparent=null);e.render=!0}this.setBlending($3Dmol.NoBlending);d(a.__webglObjects,!0,"opaque",b,h,l,!1,null);d(a.__webglObjects,!0,"blank",b,h,l,!0,null);d(a.__webglObjects,!1,"transparent",b,h,l,!0,null);h=this.renderPluginsPost;F=-1;B=t=null;p=z=x=y=E=-1;if(h.length)for(l=0,c=h.length;l<
c;l++)O=!0,h[l].render(a,b,M,N),F=-1,B=t=null,p=z=x=y=E=-1;this.setDepthTest(!0);this.setDepthWrite(!0)}};this.initWebGLObjects=function(a){a.__webglObjects||(a.__webglObjects=[],a.__webglObjectsImmediate=[],a.__webglSprites=[],a.__webglFlares=[]);if(a.__objectsAdded.length){for(;a.__objectsAdded.length;){var b=a.__objectsAdded[0],c=a,d=void 0,e=void 0,f=void 0,h=void 0;if(!b.__webglInit&&(b.__webglInit=!0,b._modelViewMatrix=new $3Dmol.Matrix4,b._normalMatrix=new $3Dmol.Matrix3,void 0!==b.geometry&&
void 0===b.geometry.__webglInit&&(b.geometry.__webglInit=!0,b.geometry.addEventListener("dispose",T)),b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line))for(f=b.geometry,d=0,e=f.geometryGroups.length;d<e;d++)h=f.geometryGroups[d],h.id=C++,h.__webglVertexBuffer||(b instanceof $3Dmol.Mesh?(h.__webglVertexBuffer=g.createBuffer(),h.__webglNormalBuffer=g.createBuffer(),h.__webglColorBuffer=g.createBuffer(),h.__webglFaceBuffer=g.createBuffer(),h.__webglLineBuffer=g.createBuffer(),r.info.memory.geometries++,
f.elementsNeedUpdate=!0,f.normalsNeedUpdate=!0):b instanceof $3Dmol.Line&&(h.__webglVertexBuffer=g.createBuffer(),h.__webglColorBuffer=g.createBuffer(),r.info.memory.geometries++),f.verticesNeedUpdate=!0,f.colorsNeedUpdate=!0);if(!b.__webglActive){if(b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line)for(f=b.geometry,d=0,e=f.geometryGroups.length;d<e;d++)h=f.geometryGroups[d],c.__webglObjects.push({buffer:h,object:b,opaque:null,transparent:null});else b instanceof $3Dmol.Sprite&&c.__webglSprites.push(b);
b.__webglActive=!0}a.__objectsAdded.splice(0,1)}F=-1}for(;a.__objectsRemoved.length;){b=a.__objectsRemoved[0];c=a;if(b instanceof $3Dmol.Mesh||b instanceof $3Dmol.Line)for(c=c.__webglObjects,d=b,e=c.length-1;0<=e;--e)c[e].object===d&&c.splice(e,1);else if(b instanceof $3Dmol.Sprite)for(c=c.__webglSprites,d=b,e=c.length-1;0<=e;--e)c[e]===d&&c.splice(e,1);b.__webglActive=!1;a.__objectsRemoved.splice(0,1)}b=0;for(c=a.__webglObjects.length;b<c;b++)if(e=a.__webglObjects[b].object,d=e.geometry,h=void 0,
e instanceof $3Dmol.Mesh||e instanceof $3Dmol.Line){e=0;for(f=d.geometryGroups.length;e<f;e++)if(h=d.geometryGroups[e],d.verticesNeedUpdate||d.elementsNeedUpdate||d.colorsNeedUpdate||d.normalsNeedUpdate){var k=g.STATIC_DRAW,l=h.vertexArray,m=h.colorArray;g.bindBuffer(g.ARRAY_BUFFER,h.__webglVertexBuffer);g.bufferData(g.ARRAY_BUFFER,l,k);g.bindBuffer(g.ARRAY_BUFFER,h.__webglColorBuffer);g.bufferData(g.ARRAY_BUFFER,m,k);void 0!==h.normalArray&&void 0!==h.__webglNormalBuffer&&(l=h.normalArray,g.bindBuffer(g.ARRAY_BUFFER,
h.__webglNormalBuffer),g.bufferData(g.ARRAY_BUFFER,l,k));void 0!==h.faceArray&&void 0!==h.__webglFaceBuffer&&(l=h.faceArray,g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h.__webglFaceBuffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l,k));void 0!==h.lineArray&&void 0!==h.__webglLineBuffer&&(l=h.lineArray,g.bindBuffer(g.ELEMENT_ARRAY_BUFFER,h.__webglLineBuffer),g.bufferData(g.ELEMENT_ARRAY_BUFFER,l,k))}d.verticesNeedUpdate=!1;d.elementsNeedUpdate=!1;d.normalsNeedUpdate=!1;d.colorsNeedUpdate=!1;d.buffersNeedUpdate=
!1}};this.setTexture=function(a,b){if(a.needsUpdate){a.__webglInit||(a.__webglInit=!0,a.addEventListener("dispose",U),a.__webglTexture=g.createTexture(),r.info.memory.textures++);g.activeTexture(g.TEXTURE0+b);g.bindTexture(g.TEXTURE_2D,a.__webglTexture);g.pixelStorei(g.UNPACK_FLIP_Y_WEBGL,a.flipY);g.pixelStorei(g.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha);g.pixelStorei(g.UNPACK_ALIGNMENT,a.unpackAlignment);var c=a.image,c=f(c.width)&&f(c.height),d=h(a.format),e=h(a.type),k=g.TEXTURE_2D;c?
(g.texParameteri(k,g.TEXTURE_WRAP_S,h(a.wrapS)),g.texParameteri(k,g.TEXTURE_WRAP_T,h(a.wrapT)),g.texParameteri(k,g.TEXTURE_MAG_FILTER,h(a.magFilter)),g.texParameteri(k,g.TEXTURE_MIN_FILTER,h(a.minFilter))):(g.texParameteri(k,g.TEXTURE_WRAP_S,g.CLAMP_TO_EDGE),g.texParameteri(k,g.TEXTURE_WRAP_T,g.CLAMP_TO_EDGE),g.texParameteri(k,g.TEXTURE_MAG_FILTER,g.LINEAR),g.texParameteri(k,g.TEXTURE_MIN_FILTER,g.LINEAR));var l=a.mipmaps;if(0<l.length&&c){for(var m=0,n=l.length;m<n;m++)k=l[m],g.texImage2D(g.TEXTURE_2D,
m,d,d,e,k);a.generateMipmaps=!1}else g.texImage2D(g.TEXTURE_2D,0,d,d,e,a.image);a.generateMipmaps&&c&&g.generateMipmap(g.TEXTURE_2D);a.needsUpdate=!1;if(a.onUpdate)a.onUpdate()}else g.activeTexture(g.TEXTURE0+b),g.bindTexture(g.TEXTURE_2D,a.__webglTexture)};this.addPostPlugin(new $3Dmol.SpritePlugin)};$3Dmol.Scene=function(){$3Dmol.Object3D.call(this);this.overrideMaterial=this.fog=null;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};
$3Dmol.Scene.prototype=Object.create($3Dmol.Object3D.prototype);$3Dmol.Scene.prototype.__addObject=function(a){a instanceof $3Dmol.Light?(-1===this.__lights.indexOf(a)&&this.__lights.push(a),a.target&&void 0===a.target.parent&&this.add(a.target)):-1===this.__objects.indexOf(a)&&(this.__objects.push(a),this.__objectsAdded.push(a),-1!==this.__objectsRemoved.indexOf(a)&&this.__objectsRemoved.splice(b,1));for(var b=0;b<a.children.length;b++)this.__addObject(a.children[b])};
$3Dmol.Scene.prototype.__removeObject=function(a){var b;a instanceof $3Dmol.Light?(b=this.__lights.indexOf(a),-1!==b&&this.__lights.splice(b,1)):(b=this.__objects.indexOf(a),-1!==b&&(this.__objects.splice(b,1),this.__objectsRemoved.push(a),-1!==this.__objectsAdded.indexOf(a)&&this.__objectsAdded.splice(b,1)));for(b=0;b<a.children.length;b++)this.__removeObject(a.children[b])};$3Dmol.Fog=function(a,b,c){this.name="";this.color=new $3Dmol.Color(a);this.near=void 0!==b?b:1;this.far=void 0!==c?c:1E3};
$3Dmol.Fog.prototype.clone=function(){return new $3Dmol.Fog(this.color.getHex(),this.near,this.far)};$3Dmol.ShaderUtils={clone:function(a){var b,c={};for(b in a){c[b]={};c[b].type=a[b].type;var d=a[b].value;d instanceof $3Dmol.Color?c[b].value=d.clone():"number"===typeof d?c[b].value=d:d instanceof Array?c[b].value=[]:console.error("Error copying shader uniforms from ShaderLib: unknown type for uniform")}return c}};
$3Dmol.ShaderLib={basic:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( diffuse, opacity );\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 color;\nvarying vec3 vColor;\nvoid main() {\n    vColor = color;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3}}},sphereimposter:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vColor;\nvarying vec2 mapping;\nvoid main() {\n\t float lensqr = dot(mapping,mapping);\n\t if(lensqr > 2.0)\n\t    discard;\n\t float w = sqrt(2.0 - lensqr);\n\t float z = sqrt(sqrt(2.0)-lensqr);\n\t gl_FragDepthEXT = -.1*z;\n    gl_FragColor = vec4( w*vColor, 1 );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec2 mapping;\nvarying vec3 vColor;\nvoid main() {\n    vColor = color;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vec4 projPosition = projectionMatrix * mvPosition;\n\t vec4 adjust = projectionMatrix*vec4(normal, 1.0);  adjust.y *= -1.0; adjust.z = 0.0; adjust.w = 0.0;\n\t mapping = normal.xy;\n\t gl_Position = projPosition+adjust;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3}}},lambert:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vLightFront;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n    #ifndef WIREFRAME\n    gl_FragColor.xyz *= vLightFront;\n    #endif\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\nuniform vec3 directionalLightColor[ 1 ];\nuniform vec3 directionalLightDirection[ 1 ];\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec3 vColor;\nvarying vec3 vLightFront;\nvoid main() {\n    vColor = color;\n    vec3 objectNormal = normal;\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vLightFront = vec3( 0.0 );\n    transformedNormal = normalize( transformedNormal );\n    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );\n    vec3 dirVector = normalize( lDirection.xyz );\n    float dotProduct = dot( transformedNormal, dirVector );\n    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;\n    vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},ambient:{type:"c",value:new $3Dmol.Color(1,1,1)},emissive:{type:"c",value:new $3Dmol.Color(1,1,1)},ambientLightColor:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},lambertdouble:{fragmentShader:"uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\nuniform float opacity;\nuniform vec3 fogColor;\nuniform float fogNear;\nuniform float fogFar;\nvarying vec3 vLightFront;\nvarying vec3 vLightBack;\nvarying vec3 vColor;\nvoid main() {\n    gl_FragColor = vec4( vec3 ( 1.0 ), opacity );\n    #ifndef WIREFRAME\n\t if ( gl_FrontFacing )\n\t\tgl_FragColor.xyz *= vLightFront;\n\t else\n\t\tgl_FragColor.xyz *= vLightBack;\n    #endif\n    gl_FragColor = gl_FragColor * vec4( vColor, opacity );\n    float depth = gl_FragCoord.z / gl_FragCoord.w;\n    float fogFactor = smoothstep( fogNear, fogFar, depth );\n    gl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}",
vertexShader:"uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nuniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\nuniform vec3 directionalLightColor[ 1 ];\nuniform vec3 directionalLightDirection[ 1 ];\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec3 color;\nvarying vec3 vColor;\nvarying vec3 vLightFront;\nvarying vec3 vLightBack;\nvoid main() {\n    vColor = color;\n    vec3 objectNormal = normal;\n    vec3 transformedNormal = normalMatrix * objectNormal;\n    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n    vLightFront = vec3( 0.0 );\n    vLightBack = vec3( 0.0 );\n    transformedNormal = normalize( transformedNormal );\n    vec4 lDirection = viewMatrix * vec4( directionalLightDirection[ 0 ], 0.0 );\n    vec3 dirVector = normalize( lDirection.xyz );\n    float dotProduct = dot( transformedNormal, dirVector );\n    vec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\t vec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n    vLightFront += directionalLightColor[ 0 ] * directionalLightWeighting;\n\t vLightBack += directionalLightColor[ 0 ] * directionalLightWeightingBack;\n    vLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\t vLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n    gl_Position = projectionMatrix * mvPosition;\n}",
uniforms:{opacity:{type:"f",value:1},diffuse:{type:"c",value:new $3Dmol.Color(1,1,1)},fogColor:{type:"c",value:new $3Dmol.Color(1,1,1)},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},ambient:{type:"c",value:new $3Dmol.Color(1,1,1)},emissive:{type:"c",value:new $3Dmol.Color(1,1,1)},ambientLightColor:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]}}},sprite:{fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\n    vec4 texture = texture2D(map, vUV);\n    if (texture.a < alphaTest) discard;\n    gl_FragColor = vec4(color * texture.xyz, texture.a * opacity);\n    if (fogType > 0) {\n        float depth = gl_FragCoord.z / gl_FragCoord.w;\n        float fogFactor = 0.0;\n        if (fogType == 1) {\n            fogFactor = smoothstep(fogNear, fogFar, depth);\n        }\n        else {\n            const float LOG2 = 1.442695;\n            float fogFactor = exp2(- fogDensity * fogDensity * depth * depth * LOG2);\n            fogFactor = 1.0 - clamp(fogFactor, 0.0, 1.0);\n        }\n        gl_FragColor = mix(gl_FragColor, vec4(fogColor, gl_FragColor.w), fogFactor);\n    }\n}",
vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\n    vUV = uvOffset + uv * uvScale;\n    vec2 alignedPosition = position + alignment;\n    vec2 rotatedPosition;\n    rotatedPosition.x = ( cos(rotation) * alignedPosition.x - sin(rotation) * alignedPosition.y ) * scale.x;\n    rotatedPosition.y = ( sin(rotation) * alignedPosition.x + cos(rotation) * alignedPosition.y ) * scale.y;\n    vec4 finalPosition;\n    if(useScreenCoordinates != 0) {\n        finalPosition = vec4(screenPosition.xy + rotatedPosition, screenPosition.z, 1.0);\n    }\n    else {\n        finalPosition = projectionMatrix * modelViewMatrix * vec4(0.0, 0.0, 0.0, 1.0);\n        finalPosition.xy += rotatedPosition * (sizeAttenuation == 1 ? 1.0 : finalPosition.z);\n    }\n    gl_Position = finalPosition;\n}",
uniforms:{}}};$3Dmol=$3Dmol||{};
$3Dmol.partialCharges=[{resn:"ALA",atom:"N",props:{partialCharge:-.15}},{resn:"ALA",atom:"CA",props:{partialCharge:.1}},{resn:"ALA",atom:"CB",props:{partialCharge:0}},{resn:"ALA",atom:"C",props:{partialCharge:.6}},{resn:"ALA",atom:"O",props:{partialCharge:-.55}},{resn:"ARG",atom:"N",props:{partialCharge:-.15}},{resn:"ARG",atom:"CA",props:{partialCharge:.1}},{resn:"ARG",atom:"CB",props:{partialCharge:0}},{resn:"ARG",atom:"CG",props:{partialCharge:0}},{resn:"ARG",atom:"CD",props:{partialCharge:.1}},
{resn:"ARG",atom:"NE",props:{partialCharge:-.1}},{resn:"ARG",atom:"CZ",props:{partialCharge:.5}},{resn:"ARG",atom:"NH1",props:{partialCharge:.25}},{resn:"ARG",atom:"NH2",props:{partialCharge:.25}},{resn:"ARG",atom:"C",props:{partialCharge:.6}},{resn:"ARG",atom:"O",props:{partialCharge:-.55}},{resn:"ASN",atom:"N",props:{partialCharge:-.15}},{resn:"ASN",atom:"CA",props:{partialCharge:.1}},{resn:"ASN",atom:"CB",props:{partialCharge:0}},{resn:"ASN",atom:"CG",props:{partialCharge:.55}},{resn:"ASN",atom:"OD1",
props:{partialCharge:-.55}},{resn:"ASN",atom:"ND2",props:{partialCharge:0}},{resn:"ASN",atom:"C",props:{partialCharge:.6}},{resn:"ASN",atom:"O",props:{partialCharge:-.55}},{resn:"ASP",atom:"N",props:{partialCharge:-.15}},{resn:"ASP",atom:"CA",props:{partialCharge:.1}},{resn:"ASP",atom:"CB",props:{partialCharge:0}},{resn:"ASP",atom:"CG",props:{partialCharge:.14}},{resn:"ASP",atom:"OD1",props:{partialCharge:-.57}},{resn:"ASP",atom:"OD2",props:{partialCharge:-.57}},{resn:"ASP",atom:"C",props:{partialCharge:.6}},
{resn:"ASP",atom:"O",props:{partialCharge:-.55}},{resn:"CYS",atom:"N",props:{partialCharge:-.15}},{resn:"CYS",atom:"CA",props:{partialCharge:.1}},{resn:"CYS",atom:"CB",props:{partialCharge:.19}},{resn:"CYS",atom:"SG",props:{partialCharge:-.19}},{resn:"CYS",atom:"C",props:{partialCharge:.6}},{resn:"CYS",atom:"O",props:{partialCharge:-.55}},{resn:"GLN",atom:"N",props:{partialCharge:-.15}},{resn:"GLN",atom:"CA",props:{partialCharge:.1}},{resn:"GLN",atom:"CB",props:{partialCharge:0}},{resn:"GLN",atom:"CG",
props:{partialCharge:0}},{resn:"GLN",atom:"CD",props:{partialCharge:.55}},{resn:"GLN",atom:"OE1",props:{partialCharge:-.55}},{resn:"GLN",atom:"NE2",props:{partialCharge:0}},{resn:"GLN",atom:"C",props:{partialCharge:.6}},{resn:"GLN",atom:"O",props:{partialCharge:-.55}},{resn:"GLU",atom:"N",props:{partialCharge:-.15}},{resn:"GLU",atom:"CA",props:{partialCharge:.1}},{resn:"GLU",atom:"CB",props:{partialCharge:0}},{resn:"GLU",atom:"CG",props:{partialCharge:0}},{resn:"GLU",atom:"CD",props:{partialCharge:.14}},
{resn:"GLU",atom:"OE1",props:{partialCharge:-.57}},{resn:"GLU",atom:"OE2",props:{partialCharge:-.57}},{resn:"GLU",atom:"C",props:{partialCharge:.6}},{resn:"GLU",atom:"O",props:{partialCharge:-.55}},{resn:"GLY",atom:"N",props:{partialCharge:-.15}},{resn:"GLY",atom:"CA",props:{partialCharge:.1}},{resn:"GLY",atom:"C",props:{partialCharge:.6}},{resn:"GLY",atom:"O",props:{partialCharge:-.55}},{resn:"HIS",atom:"N",props:{partialCharge:-.15}},{resn:"HIS",atom:"CA",props:{partialCharge:.1}},{resn:"HIS",atom:"CB",
props:{partialCharge:0}},{resn:"HIS",atom:"CG",props:{partialCharge:.1}},{resn:"HIS",atom:"ND1",props:{partialCharge:-.1}},{resn:"HIS",atom:"CD2",props:{partialCharge:.1}},{resn:"HIS",atom:"NE2",props:{partialCharge:-.4}},{resn:"HIS",atom:"CE1",props:{partialCharge:.3}},{resn:"HIS",atom:"C",props:{partialCharge:.6}},{resn:"HIS",atom:"O",props:{partialCharge:-.55}},{resn:"ILE",atom:"N",props:{partialCharge:-.15}},{resn:"ILE",atom:"CA",props:{partialCharge:.1}},{resn:"ILE",atom:"CB",props:{partialCharge:0}},
{resn:"ILE",atom:"CG2",props:{partialCharge:0}},{resn:"ILE",atom:"CG1",props:{partialCharge:0}},{resn:"ILE",atom:"CD",props:{partialCharge:0}},{resn:"ILE",atom:"C",props:{partialCharge:.6}},{resn:"ILE",atom:"O",props:{partialCharge:-.55}},{resn:"LEU",atom:"N",props:{partialCharge:-.15}},{resn:"LEU",atom:"CA",props:{partialCharge:.1}},{resn:"LEU",atom:"CB",props:{partialCharge:0}},{resn:"LEU",atom:"CG",props:{partialCharge:0}},{resn:"LEU",atom:"CD1",props:{partialCharge:0}},{resn:"LEU",atom:"CD2",
props:{partialCharge:0}},{resn:"LEU",atom:"C",props:{partialCharge:.6}},{resn:"LEU",atom:"O",props:{partialCharge:-.55}},{resn:"LYS",atom:"N",props:{partialCharge:-.15}},{resn:"LYS",atom:"CA",props:{partialCharge:.1}},{resn:"LYS",atom:"CB",props:{partialCharge:0}},{resn:"LYS",atom:"CG",props:{partialCharge:0}},{resn:"LYS",atom:"CD",props:{partialCharge:0}},{resn:"LYS",atom:"CE",props:{partialCharge:.25}},{resn:"LYS",atom:"NZ",props:{partialCharge:.75}},{resn:"LYS",atom:"C",props:{partialCharge:.6}},
{resn:"LYS",atom:"O",props:{partialCharge:-.55}},{resn:"MET",atom:"N",props:{partialCharge:-.15}},{resn:"MET",atom:"CA",props:{partialCharge:.1}},{resn:"MET",atom:"CB",props:{partialCharge:0}},{resn:"MET",atom:"CG",props:{partialCharge:.06}},{resn:"MET",atom:"SD",props:{partialCharge:-.12}},{resn:"MET",atom:"CE",props:{partialCharge:.06}},{resn:"MET",atom:"C",props:{partialCharge:.6}},{resn:"MET",atom:"O",props:{partialCharge:-.55}},{resn:"PHE",atom:"N",props:{partialCharge:-.15}},{resn:"PHE",atom:"CA",
props:{partialCharge:.1}},{resn:"PHE",atom:"CB",props:{partialCharge:0}},{resn:"PHE",atom:"CG",props:{partialCharge:0}},{resn:"PHE",atom:"CD1",props:{partialCharge:0}},{resn:"PHE",atom:"CD2",props:{partialCharge:0}},{resn:"PHE",atom:"CE1",props:{partialCharge:0}},{resn:"PHE",atom:"CE2",props:{partialCharge:0}},{resn:"PHE",atom:"CZ",props:{partialCharge:0}},{resn:"PHE",atom:"C",props:{partialCharge:.6}},{resn:"PHE",atom:"O",props:{partialCharge:-.55}},{resn:"PRO",atom:"N",props:{partialCharge:-.25}},
{resn:"PRO",atom:"CD",props:{partialCharge:.1}},{resn:"PRO",atom:"CA",props:{partialCharge:.1}},{resn:"PRO",atom:"CB",props:{partialCharge:0}},{resn:"PRO",atom:"CG",props:{partialCharge:0}},{resn:"PRO",atom:"C",props:{partialCharge:.6}},{resn:"PRO",atom:"O",props:{partialCharge:-.55}},{resn:"SER",atom:"N",props:{partialCharge:-.15}},{resn:"SER",atom:"CA",props:{partialCharge:.1}},{resn:"SER",atom:"CB",props:{partialCharge:.25}},{resn:"SER",atom:"OG",props:{partialCharge:-.25}},{resn:"SER",atom:"C",
props:{partialCharge:.6}},{resn:"SER",atom:"O",props:{partialCharge:-.55}},{resn:"THR",atom:"N",props:{partialCharge:-.15}},{resn:"THR",atom:"CA",props:{partialCharge:.1}},{resn:"THR",atom:"CB",props:{partialCharge:.25}},{resn:"THR",atom:"OG1",props:{partialCharge:-.25}},{resn:"THR",atom:"CG2",props:{partialCharge:0}},{resn:"THR",atom:"C",props:{partialCharge:.6}},{resn:"THR",atom:"O",props:{partialCharge:-.55}},{resn:"TRP",atom:"N",props:{partialCharge:-.15}},{resn:"TRP",atom:"CA",props:{partialCharge:.1}},
{resn:"TRP",atom:"CB",props:{partialCharge:0}},{resn:"TRP",atom:"CG",props:{partialCharge:-.03}},{resn:"TRP",atom:"CD2",props:{partialCharge:.1}},{resn:"TRP",atom:"CE2",props:{partialCharge:-.04}},{resn:"TRP",atom:"CE3",props:{partialCharge:-.03}},{resn:"TRP",atom:"CD1",props:{partialCharge:.06}},{resn:"TRP",atom:"NE1",props:{partialCharge:-.06}},{resn:"TRP",atom:"CZ2",props:{partialCharge:0}},{resn:"TRP",atom:"CZ3",props:{partialCharge:0}},{resn:"TRP",atom:"CH2",props:{partialCharge:0}},{resn:"TRP",
atom:"C",props:{partialCharge:.6}},{resn:"TRP",atom:"O",props:{partialCharge:-.55}},{resn:"TYR",atom:"N",props:{partialCharge:-.15}},{resn:"TYR",atom:"CA",props:{partialCharge:.1}},{resn:"TYR",atom:"CB",props:{partialCharge:0}},{resn:"TYR",atom:"CG",props:{partialCharge:0}},{resn:"TYR",atom:"CD1",props:{partialCharge:0}},{resn:"TYR",atom:"CE1",props:{partialCharge:0}},{resn:"TYR",atom:"CD2",props:{partialCharge:0}},{resn:"TYR",atom:"CE2",props:{partialCharge:0}},{resn:"TYR",atom:"CZ",props:{partialCharge:.25}},
{resn:"TYR",atom:"OH",props:{partialCharge:-.25}},{resn:"TYR",atom:"C",props:{partialCharge:.6}},{resn:"TYR",atom:"O",props:{partialCharge:-.55}},{resn:"VAL",atom:"N",props:{partialCharge:-.15}},{resn:"VAL",atom:"CA",props:{partialCharge:.1}},{resn:"VAL",atom:"CB",props:{partialCharge:0}},{resn:"VAL",atom:"CG1",props:{partialCharge:0}},{resn:"VAL",atom:"CG2",props:{partialCharge:0}},{resn:"VAL",atom:"C",props:{partialCharge:.6}},{resn:"VAL",atom:"O",props:{partialCharge:-.55}}];
$3Dmol.partialCharges=$3Dmol.partialCharges;
$3Dmol=$3Dmol||{};
$3Dmol.sa=function(){var l={mb:function(p,f,e,a){function d(b,a,c,d,s,q){var w=new $3Dmol.Vector3;w.copy(g);var u=s;d&1<<s||!(d&1<<q)||(u=q);u&1&&c++;u&2&&a++;u&4&&b++;w.x+=E.x*b;w.y+=E.y*a;w.z+=E.z*c;b=(h*b+a)*n+c;if(t)return f.push(w),f.length-1;0>D[b]&&(D[b]=f.length,f.push(w));return D[b]}var b=!!a.eb,g=a.hasOwnProperty("origin")&&a.origin.hasOwnProperty("x")?a.origin:{x:0,y:0,z:0},t=!!a.Ma,c=a.nb||0,h=a.ob||0,n=a.pb||0;a=a.scale||1;var E=(new $3Dmol.Vector3(1,1,1)).multiplyScalar(a),D=new Int32Array(c*
h*n),s;a=0;for(s=D.length;a<s;++a)D[a]=-1;s=new Int32Array(12);var q=b?I:F,b=b?C:A;for(a=0;a<c-1;++a)for(var w=0;w<h-1;++w)for(var G=0;G<n-1;++G){for(var x=0,u=0;8>u;++u)x|=!!(p[(h*(a+((u&4)>>2))+w+((u&2)>>1))*n+G+(u&1)]&2)<<u;if(0!==x&&255!==x){var z=q[x];if(0!==z)for(u=b[x],z&1&&(s[0]=d(a,w,G,x,0,1)),z&2&&(s[1]=d(a,w,G,x,1,3)),z&4&&(s[2]=d(a,w,G,x,3,2)),z&8&&(s[3]=d(a,w,G,x,2,0)),z&16&&(s[4]=d(a,w,G,x,4,5)),z&32&&(s[5]=d(a,w,G,x,5,7)),z&64&&(s[6]=d(a,w,G,x,7,6)),z&128&&(s[7]=d(a,w,G,x,6,4)),z&256&&
(s[8]=d(a,w,G,x,0,4)),z&512&&(s[9]=d(a,w,G,x,1,5)),z&1024&&(s[10]=d(a,w,G,x,3,7)),z&2048&&(s[11]=d(a,w,G,x,2,6)),x=0;x<u.length;x+=3){var z=s[u[x]],m=s[u[x+1]],J=s[u[x+2]];t&&3<=x&&(f.push(f[z]),z=f.length-1,f.push(f[m]),m=f.length-1,f.push(f[J]),J=f.length-1);e.push(z);e.push(m);e.push(J)}}}},kb:function(p,f,e){var a=Array(f.length),d,b,g,t;d=0;for(b=f.length;d<b;d++)a[d]={x:0,y:0,z:0};var c=Array(20),h;for(d=0;20>d;d++)c[d]=Array(f.length);d=0;for(b=f.length;d<b;d++)c[0][d]=0;d=0;for(b=e.length/
3;d<b;d++){var n=3*d,E=3*d+1,D=3*d+2;h=!0;g=0;for(t=c[0][e[n]];g<t;g++)if(e[E]==c[g+1][e[n]]){h=!1;break}h&&(c[0][e[n]]++,c[c[0][e[n]]][e[n]]=e[E]);h=!0;g=0;for(t=c[0][e[n]];g<t;g++)if(e[D]==c[g+1][e[n]]){h=!1;break}h&&(c[0][e[n]]++,c[c[0][e[n]]][e[n]]=e[D]);h=!0;g=0;for(t=c[0][e[E]];g<t;g++)if(e[n]==c[g+1][e[E]]){h=!1;break}h&&(c[0][e[E]]++,c[c[0][e[E]]][e[E]]=e[n]);h=!0;g=0;for(t=c[0][e[E]];g<t;g++)if(e[D]==c[g+1][e[E]]){h=!1;break}h&&(c[0][e[E]]++,c[c[0][e[E]]][e[E]]=e[D]);h=!0;for(g=0;g<c[0][e[D]];g++)if(e[n]==
c[g+1][e[D]]){h=!1;break}h&&(c[0][e[D]]++,c[c[0][e[D]]][e[D]]=e[n]);h=!0;g=0;for(t=c[0][e[D]];g<t;g++)if(e[E]==c[g+1][e[D]]){h=!1;break}h&&(c[0][e[D]]++,c[c[0][e[D]]][e[D]]=e[E])}for(e=0;e<p;e++){d=0;for(b=f.length;d<b;d++)if(3>c[0][d])a[d].x=f[d].x,a[d].y=f[d].y,a[d].z=f[d].z;else if(3==c[0][d]||4==c[0][d]){a[d].x=0;a[d].y=0;g=a[d].z=0;for(t=c[0][d];g<t;g++)a[d].x+=f[c[g+1][d]].x,a[d].y+=f[c[g+1][d]].y,a[d].z+=f[c[g+1][d]].z;a[d].x+=.5*f[d].x;a[d].y+=.5*f[d].y;a[d].z+=.5*f[d].z;a[d].x/=.5+c[0][d];
a[d].y/=.5+c[0][d];a[d].z/=.5+c[0][d]}else{a[d].x=0;a[d].y=0;g=a[d].z=0;for(t=c[0][d];g<t;g++)a[d].x+=f[c[g+1][d]].x,a[d].y+=f[c[g+1][d]].y,a[d].z+=f[c[g+1][d]].z;a[d].x+=1*f[d].x;a[d].y+=1*f[d].y;a[d].z+=1*f[d].z;a[d].x/=1+c[0][d];a[d].y/=1+c[0][d];a[d].z/=1+c[0][d]}d=0;for(b=f.length;d<b;d++)f[d].x=a[d].x,f[d].y=a[d].y,f[d].z=a[d].z}},bb:[0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,
2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,
2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]},F=new Uint32Array(l.bb),A=l.cc=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,
4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,
4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,
1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,
1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,
7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,
3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]],I=[0,265,515,778,2060,2309,2575,2822,1030,1295,1541,1804,3082,3331,3593,3840,400,153,915,666,2460,2197,2975,2710,1430,1183,1941,1692,3482,3219,3993,3728,560,825,51,314,2620,2869,2111,2358,1590,1855,1077,1340,3642,3891,3129,3376,928,681,419,170,2988,
2725,2479,2214,1958,1711,1445,1196,4010,3747,3497,3232,2240,2505,2755,3018,204,453,719,966,3270,3535,3781,4044,1226,1475,1737,1984,2384,2137,2899,2650,348,85,863,598,3414,3167,3925,3676,1370,1107,1881,1616,2800,3065,2291,2554,764,1013,255,502,3830,4095,3317,3580,1786,2035,1273,1520,2912,2665,2403,2154,876,613,367,102,3942,3695,3429,3180,1898,1635,1385,1120,1120,1385,1635,1898,3180,3429,3695,3942,102,367,613,876,2154,2403,2665,2912,1520,1273,2035,1786,3580,3317,4095,3830,502,255,1013,764,2554,2291,
3065,2800,1616,1881,1107,1370,3676,3925,3167,3414,598,863,85,348,2650,2899,2137,2384,1984,1737,1475,1226,4044,3781,3535,3270,966,719,453,204,3018,2755,2505,2240,3232,3497,3747,4010,1196,1445,1711,1958,2214,2479,2725,2988,170,419,681,928,3376,3129,3891,3642,1340,1077,1855,1590,2358,2111,2869,2620,314,51,825,560,3728,3993,3219,3482,1692,1941,1183,1430,2710,2975,2197,2460,666,915,153,400,3840,3593,3331,3082,1804,1541,1295,1030,2822,2575,2309,2060,778,515,265,0],C=[[],[8,3,0],[9,0,1],[8,3,1,8,1,9],[11,
2,3],[11,2,0,11,0,8],[11,2,3,0,1,9],[2,1,11,1,9,11,11,9,8],[10,1,2],[8,3,0,1,2,10],[9,0,2,9,2,10],[3,2,8,2,10,8,8,10,9],[10,1,3,10,3,11],[1,0,10,0,8,10,10,8,11],[0,3,9,3,11,9,9,11,10],[8,10,9,8,11,10],[8,4,7],[3,0,4,3,4,7],[1,9,0,8,4,7],[9,4,1,4,7,1,1,7,3],[2,3,11,7,8,4],[7,11,4,11,2,4,4,2,0],[3,11,2,4,7,8,9,0,1],[2,7,11,2,1,7,1,4,7,1,9,4],[10,1,2,8,4,7],[2,10,1,0,4,7,0,7,3],[4,7,8,0,2,10,0,10,9],[2,7,3,2,9,7,7,9,4,2,10,9],[8,4,7,11,10,1,11,1,3],[11,4,7,1,4,11,1,11,10,1,0,4],[3,8,0,7,11,4,11,9,4,
11,10,9],[7,11,4,4,11,9,11,10,9],[9,5,4],[3,0,8,4,9,5],[5,4,0,5,0,1],[4,8,5,8,3,5,5,3,1],[11,2,3,9,5,4],[9,5,4,8,11,2,8,2,0],[3,11,2,1,5,4,1,4,0],[8,5,4,2,5,8,2,8,11,2,1,5],[2,10,1,9,5,4],[0,8,3,5,4,9,10,1,2],[10,5,2,5,4,2,2,4,0],[3,4,8,3,2,4,2,5,4,2,10,5],[5,4,9,1,3,11,1,11,10],[0,9,1,4,8,5,8,10,5,8,11,10],[3,4,0,3,10,4,4,10,5,3,11,10],[4,8,5,5,8,10,8,11,10],[9,5,7,9,7,8],[0,9,3,9,5,3,3,5,7],[8,0,7,0,1,7,7,1,5],[1,7,3,1,5,7],[11,2,3,8,9,5,8,5,7],[9,2,0,9,7,2,2,7,11,9,5,7],[0,3,8,2,1,11,1,7,11,1,
5,7],[2,1,11,11,1,7,1,5,7],[1,2,10,5,7,8,5,8,9],[9,1,0,10,5,2,5,3,2,5,7,3],[5,2,10,8,2,5,8,5,7,8,0,2],[10,5,2,2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[11,7,6],[0,8,3,11,7,6],[9,0,1,11,7,6],[7,6,11,3,1,9,3,9,8],[2,3,7,2,7,6],[8,7,0,7,6,0,0,6,2],[1,9,0,3,7,6,3,6,2],[7,6,2,7,2,9,2,1,9,7,9,8],[1,2,10,6,11,7],[2,10,1,7,6,11,8,3,0],[11,7,6,10,9,0,10,0,2],[7,6,11,3,2,8,8,2,10,8,10,9],[6,10,7,10,1,7,7,1,3],[6,10,1,6,1,7,7,1,0,7,0,8],[9,0,3,
6,9,3,6,10,9,6,3,7],[6,10,7,7,10,8,10,9,8],[8,4,6,8,6,11],[11,3,6,3,0,6,6,0,4],[0,1,9,4,6,11,4,11,8],[1,9,4,11,1,4,11,3,1,11,4,6],[3,8,2,8,4,2,2,4,6],[2,0,4,2,4,6],[1,9,0,3,8,2,2,8,4,2,4,6],[9,4,1,1,4,2,4,6,2],[10,1,2,11,8,4,11,4,6],[10,1,2,11,3,6,6,3,0,6,0,4],[0,2,10,0,10,9,4,11,8,4,6,11],[2,11,3,6,9,4,6,10,9],[8,4,6,8,6,1,6,10,1,8,1,3],[1,0,10,10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[9,5,4,7,6,11],[4,9,5,3,0,8,11,7,6],[6,11,7,4,0,1,4,1,5],[6,11,7,4,8,5,5,8,3,5,3,1],[4,9,5,6,2,3,6,3,7],
[9,5,4,8,7,0,0,7,6,0,6,2],[4,0,1,4,1,5,6,3,7,6,2,3],[7,4,8,5,2,1,5,6,2],[6,11,7,1,2,10,9,5,4],[11,7,6,8,3,0,1,2,10,9,5,4],[11,7,6,10,5,2,2,5,4,2,4,0],[7,4,8,2,11,3,10,5,6],[4,9,5,6,10,7,7,10,1,7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[5,6,9,6,11,9,9,11,8],[0,9,5,0,5,3,3,5,6,3,6,11],[0,1,5,0,5,11,5,6,11,0,11,8],[11,3,6,6,3,5,3,1,5],[9,5,6,3,9,6,3,8,9,3,6,2],[5,6,9,9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[1,2,10,5,6,9,9,6,11,9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,
2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[10,6,5],[8,3,0,10,6,5],[0,1,9,5,10,6],[10,6,5,9,8,3,9,3,1],[3,11,2,10,6,5],[6,5,10,2,0,8,2,8,11],[1,9,0,6,5,10,11,2,3],[1,10,2,5,9,6,9,11,6,9,8,11],[1,2,6,1,6,5],[0,8,3,2,6,5,2,5,1],[5,9,6,9,0,6,6,0,2],[9,6,5,3,6,9,3,9,8,3,2,6],[11,6,3,6,5,3,3,5,1],[0,5,1,0,11,5,5,11,6,0,8,11],[0,5,9,0,3,5,3,6,5,3,11,6],[5,9,6,6,9,11,9,8,11],[10,6,5,4,7,8],[5,10,6,7,3,0,7,0,4],[5,10,6,0,1,9,8,4,7],[4,5,9,6,7,10,7,1,10,7,3,1],[7,8,
4,2,3,11,10,6,5],[11,6,7,10,2,5,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[7,8,4,5,1,2,5,2,6],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,8,0,7,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,4,5,8,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[10,6,4,10,4,9],[8,3,0,9,10,6,9,6,4],[1,10,0,10,6,0,0,6,4],[8,6,4,8,1,6,6,1,10,8,3,1],[2,3,11,6,4,9,6,9,10],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,11,6,3,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[9,1,4,1,2,4,4,2,6],[1,0,9,3,2,8,2,4,8,2,
6,4],[2,4,0,2,6,4],[3,2,8,8,2,4,2,6,4],[1,4,9,11,4,1,11,1,3,11,6,4],[0,9,1,4,11,6,4,8,11],[11,6,3,3,6,0,6,4,0],[8,6,4,8,11,6],[6,7,10,7,8,10,10,8,9],[9,3,0,6,3,9,6,9,10,6,7,3],[6,1,10,6,7,1,7,0,1,7,8,0],[6,7,10,10,7,1,7,3,1],[7,11,6,3,8,2,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2,2,9,1,7,8,9],[1,0,9,3,6,7,3,2,6],[8,0,7,7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[11,7,5,11,5,10],[3,0,8,7,5,10,7,10,11],[9,0,1,
10,11,7,10,7,5],[3,1,9,3,9,8,7,10,11,7,5,10],[10,2,5,2,3,5,5,3,7],[5,10,2,8,5,2,8,7,5,8,2,0],[9,0,1,10,2,5,5,2,3,5,3,7],[1,10,2,5,8,7,5,9,8],[2,11,1,11,7,1,1,7,5],[0,8,3,2,11,1,1,11,7,1,7,5],[9,0,2,9,2,7,2,11,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[8,7,0,0,7,1,7,5,1],[0,3,9,9,3,5,3,7,5],[9,7,5,9,8,7],[4,5,8,5,10,8,8,10,11],[3,0,4,3,4,10,4,5,10,3,10,11],[0,1,9,4,5,8,8,5,10,8,10,11],[5,9,4,1,11,3,1,10,11],[3,8,4,3,4,2,2,4,5,2,5,10],[10,2,5,5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[8,4,
5,2,8,5,2,11,8,2,5,1],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[4,5,8,8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[7,4,11,4,9,11,11,9,10],[3,0,8,7,4,11,11,4,9,11,9,10],[11,7,4,1,11,4,1,10,11,1,4,0],[8,7,4,11,1,10,11,3,1],[2,3,7,2,7,9,7,4,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[2,11,7,2,7,1,1,7,4,1,4,9],[3,2,11,4,8,7,9,1,0],[7,4,11,11,4,2,4,0,2],[2,11,3,7,4,8],[9,1,4,4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[0,9,3,3,9,11,9,
10,11],[1,10,0,0,10,8,10,11,8],[10,3,1,10,11,3],[3,8,2,2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[2,11,1,1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]];return l}();"undefined"===typeof console&&(console={log:function(){}});
$3Dmol.Kb=function(){new Int32Array([1,0,0]);new Int32Array([-1,0,0]);new Int32Array([0,1,0]);new Int32Array([0,-1,0]);new Int32Array([0,0,1]);new Int32Array([0,0,-1]);new Int32Array([1,1,0]);new Int32Array([1,-1,0]);new Int32Array([-1,1,0]);new Int32Array([-1,-1,0]);new Int32Array([1,0,1]);new Int32Array([1,0,-1]);new Int32Array([-1,0,1]);new Int32Array([-1,0,-1]);new Int32Array([0,1,1]);new Int32Array([0,1,-1]);new Int32Array([0,-1,1]);new Int32Array([0,-1,-1]);new Int32Array([1,1,1]);new Int32Array([1,
1,-1]);new Int32Array([1,-1,1]);new Int32Array([-1,1,1]);new Int32Array([1,-1,-1]);new Int32Array([-1,-1,1]);new Int32Array([-1,1,-1]);new Int32Array([-1,-1,-1])};$3Dmol=window.$3Dmol||{};$3Dmol.Ya=function(l,F){"string"===$.type(l)&&(l=$("#"+l));if(l){F=F||{};F.ca||(F.ca=$3Dmol.h.t);try{return new $3Dmol.ra(l,F.A,F.ca,F.Yb)}catch(A){console.log("error with "+kind+":"+A)}alert("Unable to instantiate 3Dmol viewer: "+F.Zb);return null}};
$3Dmol.Rb=function(l,F){var A="";if("pdb:"===l.substr(0,4)){A="pdb";l=l.substr(4).toUpperCase();if(!l.match(/^[1-9][A-Za-z0-9]{3}$/)){alert("Wrong PDB ID");return}uri="http://www.pdb.org/pdb/files/"+l+".pdb"}else if("cid:"==l.substr(0,4)){A="sdf";l=l.substr(4);if(!l.match(/^[1-9]+$/)){alert("Wrong Compound ID");return}uri="http://pubchem.ncbi.nlm.nih.gov/rest/pug/compound/cid/"+l+"/SDF?record_type=3d"}$.get(uri,function(l){F.Z(l,A);F.qa();F.render()});return null};$3Dmol.Pb={Qb:1,Jb:2,Nb:3,Ob:4};
$3Dmol.m={q:{},color:function(l){if("undefined"!==typeof this.q[l])return this.q[l];l=this.fb(l);var F=new $3Dmol.Color(l);return this.q[l]=F},Xa:{white:16777215,silver:12632256,gray:8421504,grey:8421504,black:0,red:16711680,maroon:8388608,yellow:16776960,orange:16737792,olive:8421376,lime:65280,green:32768,aqua:65535,cyan:65535,teal:32896,blue:255,navy:128,fuchsia:16711935,magenta:16711935,purple:8388736},fb:function(l){if(parseInt(l))return l;if("string"===typeof l)return this.Xa[l.trim().toLowerCase()]||
0}};$3Dmol.CC=$3Dmol.m;$3Dmol.CC.color=$3Dmol.m.color;$3Dmol.Wb=function(l,F){var A=F.geometry;void 0!==A&&l.geometryGroups.push(A.geometryGroups[0])};$3Dmol.Xb=function(l){return l.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"")};$3Dmol.Cb=!1;if(0<=window.navigator.userAgent.indexOf("MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/"))$3Dmol.Cb=!0;$3Dmol.Oa='self.onmessage=function(oEvent){var obj=oEvent.data,type=obj.type;if(0>type)self.atomData=obj.atoms,self.volume=obj.volume,self.ps=new ProteinSurface;else{var ps=self.ps;ps.initparm(obj.expandedExtent,1==type?!1:!0,self.volume),ps.fillvoxels(self.atomData,obj.extendedAtoms),ps.buildboundary(),(4===type||2===type)&&(ps.fastdistancemap(),ps.boundingatom(!1),ps.fillvoxelswaals(self.atomData,obj.extendedAtoms)),ps.marchingcube(type);var VandF=ps.getFacesAndVertices(obj.atomsToShow);self.postMessage(VandF)}};var Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0};Vector3.prototype={constructor:Vector3,copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},multiplyScalar:function(s){return this.x*=s,this.y*=s,this.z*=s,this}};var ISDONE=2,ProteinSurface=function (){var faces,verts,origextent,INOUT=1,ISDONE=2,ISBOUND=4,ptranx=0,ptrany=0,ptranz=0,probeRadius=1.4,defaultScaleFactor=2,scaleFactor=defaultScaleFactor,pHeight=0,pWidth=0,pLength=0,cutRadius=0,vpBits=null,vpDistance=null,vpAtomID=null,pminx=0,pminy=0,pminz=0,pmaxx=0,pmaxy=0,pmaxz=0,vdwRadii={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63,X:2},getVDWIndex=function(atom){return atom.elem&&"undefined"!=typeof vdwRadii[atom.elem]?atom.elem:"X"},depty={},widxz={},nb=[new Int32Array([1,0,0]),new Int32Array([-1,0,0]),new Int32Array([0,1,0]),new Int32Array([0,-1,0]),new Int32Array([0,0,1]),new Int32Array([0,0,-1]),new Int32Array([1,1,0]),new Int32Array([1,-1,0]),new Int32Array([-1,1,0]),new Int32Array([-1,-1,0]),new Int32Array([1,0,1]),new Int32Array([1,0,-1]),new Int32Array([-1,0,1]),new Int32Array([-1,0,-1]),new Int32Array([0,1,1]),new Int32Array([0,1,-1]),new Int32Array([0,-1,1]),new Int32Array([0,-1,-1]),new Int32Array([1,1,1]),new Int32Array([1,1,-1]),new Int32Array([1,-1,1]),new Int32Array([-1,1,1]),new Int32Array([1,-1,-1]),new Int32Array([-1,-1,1]),new Int32Array([-1,1,-1]),new Int32Array([-1,-1,-1])];this.getFacesAndVertices=function(atomlist){var i,il,atomsToShow={};for(i=0,il=atomlist.length;il>i;i++)atomsToShow[atomlist[i]]=!0;var vertices=verts;for(i=0,il=vertices.length;il>i;i++)vertices[i].x=vertices[i].x/scaleFactor-ptranx,vertices[i].y=vertices[i].y/scaleFactor-ptrany,vertices[i].z=vertices[i].z/scaleFactor-ptranz;var finalfaces=[];for(i=0,il=faces.length;il>i;i+=3){var fa=faces[i],fb=faces[i+1],fc=faces[i+2],a=vertices[fa].atomid,b=vertices[fb].atomid,c=vertices[fc].atomid,which=a;if(which>b&&(which=b),which>c&&(which=c),atomsToShow[which]){{vertices[faces[i]],vertices[faces[i+1]],vertices[faces[i+2]]}fa!==fb&&fb!==fc&&fa!==fc&&(finalfaces.push(fa),finalfaces.push(fb),finalfaces.push(fc))}}return vpBits=null,vpDistance=null,vpAtomID=null,{vertices:vertices,faces:finalfaces}},this.initparm=function(extent,btype,volume){volume>1e6&&(scaleFactor=defaultScaleFactor/2);var margin=1/scaleFactor*5.5;origextent=extent,pminx=extent[0][0],pmaxx=extent[1][0],pminy=extent[0][1],pmaxy=extent[1][1],pminz=extent[0][2],pmaxz=extent[1][2],btype?(pminx-=probeRadius+margin,pminy-=probeRadius+margin,pminz-=probeRadius+margin,pmaxx+=probeRadius+margin,pmaxy+=probeRadius+margin,pmaxz+=probeRadius+margin):(pminx-=margin,pminy-=margin,pminz-=margin,pmaxx+=margin,pmaxy+=margin,pmaxz+=margin),pminx=Math.floor(pminx*scaleFactor)/scaleFactor,pminy=Math.floor(pminy*scaleFactor)/scaleFactor,pminz=Math.floor(pminz*scaleFactor)/scaleFactor,pmaxx=Math.ceil(pmaxx*scaleFactor)/scaleFactor,pmaxy=Math.ceil(pmaxy*scaleFactor)/scaleFactor,pmaxz=Math.ceil(pmaxz*scaleFactor)/scaleFactor,ptranx=-pminx,ptrany=-pminy,ptranz=-pminz,pLength=Math.ceil(scaleFactor*(pmaxx-pminx))+1,pWidth=Math.ceil(scaleFactor*(pmaxy-pminy))+1,pHeight=Math.ceil(scaleFactor*(pmaxz-pminz))+1,this.boundingatom(btype),cutRadius=probeRadius*scaleFactor,vpBits=new Uint8Array(pLength*pWidth*pHeight),vpDistance=new Float64Array(pLength*pWidth*pHeight),vpAtomID=new Int32Array(pLength*pWidth*pHeight)},this.boundingatom=function(btype){var txz,tdept,sradius,tradius=[];flagradius=btype;for(var i in vdwRadii)if(vdwRadii.hasOwnProperty(i)){var r=vdwRadii[i];for(tradius[i]=btype?(r+probeRadius)*scaleFactor+.5:r*scaleFactor+.5,sradius=tradius[i]*tradius[i],widxz[i]=Math.floor(tradius[i])+1,depty[i]=new Int32Array(widxz[i]*widxz[i]),indx=0,j=0;j<widxz[i];j++)for(k=0;k<widxz[i];k++)txz=j*j+k*k,txz>sradius?depty[i][indx]=-1:(tdept=Math.sqrt(sradius-txz),depty[i][indx]=Math.floor(tdept)),indx++}},this.fillvoxels=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]=0,vpDistance[i]=-1,vpAtomID[i]=-1;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtom(atom,atoms)}for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&INOUT&&(vpBits[i]|=ISDONE)},this.fillAtom=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,i,j,k,si,sj,sk,ii,jj,kk,n;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),nind=0,pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&INOUT){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=INOUT,vpAtomID[index]=atom.serial}nind++}},this.fillvoxelswaals=function(atoms,atomlist){var i,il;for(i=0,il=vpBits.length;il>i;i++)vpBits[i]&=~ISDONE;for(i in atomlist){var atom=atoms[atomlist[i]];void 0!==atom&&this.fillAtomWaals(atom,atoms)}},this.fillAtomWaals=function(atom,atoms){var cx,cy,cz,ox,oy,oz,mi,mj,mk,si,sj,sk,i,j,k,ii,jj,kk,n,nind=0;cx=Math.floor(.5+scaleFactor*(atom.x+ptranx)),cy=Math.floor(.5+scaleFactor*(atom.y+ptrany)),cz=Math.floor(.5+scaleFactor*(atom.z+ptranz));var at=getVDWIndex(atom),pWH=pWidth*pHeight;for(i=0,n=widxz[at];n>i;i++)for(j=0;n>j;j++){if(-1!=depty[at][nind])for(ii=-1;2>ii;ii++)for(jj=-1;2>jj;jj++)for(kk=-1;2>kk;kk++)if(0!==ii&&0!==jj&&0!==kk)for(mi=ii*i,mk=kk*j,k=0;k<=depty[at][nind];k++)if(mj=k*jj,si=cx+mi,sj=cy+mj,sk=cz+mk,!(0>si||0>sj||0>sk||si>=pLength||sj>=pWidth||sk>=pHeight)){var index=si*pWH+sj*pHeight+sk;if(vpBits[index]&ISDONE){var atom2=atoms[vpAtomID[index]];ox=Math.floor(.5+scaleFactor*(atom2.x+ptranx)),oy=Math.floor(.5+scaleFactor*(atom2.y+ptrany)),oz=Math.floor(.5+scaleFactor*(atom2.z+ptranz)),ox*ox+oy*oy+oz*oz>mi*mi+mj*mj+mk*mk&&(vpAtomID[index]=atom.serial)}else vpBits[index]|=ISDONE,vpAtomID[index]=atom.serial}nind++}},this.buildboundary=function(){var pWH=pWidth*pHeight;for(i=0;pLength>i;i++)for(j=0;pHeight>j;j++)for(k=0;pWidth>k;k++){var index=i*pWH+k*pHeight+j;if(vpBits[index]&INOUT)for(var ii=0;26>ii;){var ti=i+nb[ii][0],tj=j+nb[ii][2],tk=k+nb[ii][1];if(ti>-1&&pLength>ti&&tk>-1&&pWidth>tk&&tj>-1&&pHeight>tj&&!(vpBits[ti*pWH+tk*pHeight+tj]&INOUT)){vpBits[index]|=ISBOUND;break}ii++}}};var PointGrid=function(length,width,height){var data=new Int32Array(length*width*height*3);this.set=function(x,y,z,pt){var index=3*((x*width+y)*height+z);data[index]=pt.ix,data[index+1]=pt.iy,data[index+2]=pt.iz},this.get=function(x,y,z){var index=3*((x*width+y)*height+z);return{ix:data[index],iy:data[index+1],iz:data[index+2]}}};this.fastdistancemap=function(){var i,j,k,n,index,boundPoint=new PointGrid(pLength,pWidth,pHeight),pWH=pWidth*pHeight,cutRSq=cutRadius*cutRadius,inarray=[],outarray=[];for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)if(index=i*pWH+j*pHeight+k,vpBits[index]&=~ISDONE,vpBits[index]&INOUT&&vpBits[index]&ISBOUND){var triple={ix:i,iy:j,iz:k};boundPoint.set(i,j,k,triple),inarray.push(triple),vpDistance[index]=0,vpBits[index]|=ISDONE,vpBits[index]&=~ISBOUND}do for(outarray=this.fastoneshell(inarray,boundPoint),inarray=[],i=0,n=outarray.length;n>i;i++)index=pWH*outarray[i].ix+pHeight*outarray[i].iy+outarray[i].iz,vpBits[index]&=~ISBOUND,vpDistance[index]<=1.0404*cutRSq&&inarray.push({ix:outarray[i].ix,iy:outarray[i].iy,iz:outarray[i].iz});while(0!==inarray.length);inarray=[],outarray=[],boundPoint=null;var cutsf=scaleFactor-.5;0>cutsf&&(cutsf=0);var cutoff=cutRSq-.5/(.1+cutsf);for(i=0;pLength>i;i++)for(j=0;pWidth>j;j++)for(k=0;pHeight>k;k++)index=i*pWH+j*pHeight+k,vpBits[index]&=~ISBOUND,vpBits[index]&INOUT&&(!(vpBits[index]&ISDONE)||vpBits[index]&ISDONE&&vpDistance[index]>=cutoff)&&(vpBits[index]|=ISBOUND)},this.fastoneshell=function(inarray,boundPoint){var tx,ty,tz,dx,dy,dz,i,j,n,square,bp,index,outarray=[];if(0===inarray.length)return outarray;tnv={ix:-1,iy:-1,iz:-1};var pWH=pWidth*pHeight;for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=0;6>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=6;18>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));for(i=0,n=inarray.length;n>i;i++)for(tx=inarray[i].ix,ty=inarray[i].iy,tz=inarray[i].iz,bp=boundPoint.get(tx,ty,tz),j=18;26>j;j++)tnv.ix=tx+nb[j][0],tnv.iy=ty+nb[j][1],tnv.iz=tz+nb[j][2],tnv.ix<pLength&&tnv.ix>-1&&tnv.iy<pWidth&&tnv.iy>-1&&tnv.iz<pHeight&&tnv.iz>-1&&(index=tnv.ix*pWH+pHeight*tnv.iy+tnv.iz,vpBits[index]&INOUT&&!(vpBits[index]&ISDONE)?(boundPoint.set(tnv.ix,tnv.iy,tz+nb[j][2],bp),dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,vpDistance[index]=square,vpBits[index]|=ISDONE,vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})):vpBits[index]&INOUT&&vpBits[index]&ISDONE&&(dx=tnv.ix-bp.ix,dy=tnv.iy-bp.iy,dz=tnv.iz-bp.iz,square=dx*dx+dy*dy+dz*dz,square<vpDistance[index]&&(boundPoint.set(tnv.ix,tnv.iy,tnv.iz,bp),vpDistance[index]=square,vpBits[index]&ISBOUND||(vpBits[index]|=ISBOUND,outarray.push({ix:tnv.ix,iy:tnv.iy,iz:tnv.iz})))));return outarray},this.marchingcubeinit=function(stype){for(var i=0,lim=vpBits.length;lim>i;i++)1==stype?vpBits[i]&=~ISBOUND:4==stype?(vpBits[i]&=~ISDONE,vpBits[i]&ISBOUND&&(vpBits[i]|=ISDONE),vpBits[i]&=~ISBOUND):2==stype?vpBits[i]&ISBOUND&&vpBits[i]&ISDONE?vpBits[i]&=~ISBOUND:vpBits[i]&ISBOUND&&!(vpBits[i]&ISDONE)&&(vpBits[i]|=ISDONE):3==stype&&(vpBits[i]&=~ISBOUND)};this.marchingcube=function(stype){this.marchingcubeinit(stype),verts=[],faces=[],march(vpBits,verts,faces,{smooth:1,nX:pLength,nY:pWidth,nZ:pHeight});for(var pWH=pWidth*pHeight,i=0,vlen=verts.length;vlen>i;i++)verts[i].atomid=vpAtomID[verts[i].x*pWH+pHeight*verts[i].y+verts[i].z];laplacianSmooth(1,verts,faces)}},march=function (data,verts,faces,spec){var i,il,fulltable=!!spec.fulltable,origin=spec.hasOwnProperty("origin")&&spec.origin.hasOwnProperty("x")?spec.origin:{x:0,y:0,z:0},voxel=!!spec.voxel,nX=spec.nX||0,nY=spec.nY||0,nZ=spec.nZ||0,scale=spec.scale||1,unitCube=new Vector3(1,1,1).multiplyScalar(scale),vertnums=new Int32Array(nX*nY*nZ);for(i=0,il=vertnums.length;il>i;++i)vertnums[i]=-1;var getVertex=function(i,j,k,code,p1,p2){var pt=new Vector3;pt.copy(origin);var val1=!!(code&1<<p1),val2=!!(code&1<<p2),p=p1;!val1&&val2&&(p=p2),1&p&&k++,2&p&&j++,4&p&&i++,pt.x+=unitCube.x*i,pt.y+=unitCube.y*j,pt.z+=unitCube.z*k;var index=(nY*i+j)*nZ+k;return voxel?(verts.push(pt),verts.length-1):(vertnums[index]<0&&(vertnums[index]=verts.length,verts.push(pt)),vertnums[index])},intersects=new Int32Array(12),etable=fulltable?edgeTable2:edgeTable,tritable=fulltable?triTable2:triTable;for(i=0;nX-1>i;++i)for(var j=0;nY-1>j;++j)for(var k=0;nZ-1>k;++k){for(var code=0,p=0;8>p;++p){var index=(nY*(i+((4&p)>>2))+j+((2&p)>>1))*nZ+k+(1&p),val=!!(data[index]&ISDONE);code|=val<<p}if(0!==code&&255!==code){var ecode=etable[code];if(0!==ecode){var ttable=tritable[code];1&ecode&&(intersects[0]=getVertex(i,j,k,code,0,1)),2&ecode&&(intersects[1]=getVertex(i,j,k,code,1,3)),4&ecode&&(intersects[2]=getVertex(i,j,k,code,3,2)),8&ecode&&(intersects[3]=getVertex(i,j,k,code,2,0)),16&ecode&&(intersects[4]=getVertex(i,j,k,code,4,5)),32&ecode&&(intersects[5]=getVertex(i,j,k,code,5,7)),64&ecode&&(intersects[6]=getVertex(i,j,k,code,7,6)),128&ecode&&(intersects[7]=getVertex(i,j,k,code,6,4)),256&ecode&&(intersects[8]=getVertex(i,j,k,code,0,4)),512&ecode&&(intersects[9]=getVertex(i,j,k,code,1,5)),1024&ecode&&(intersects[10]=getVertex(i,j,k,code,3,7)),2048&ecode&&(intersects[11]=getVertex(i,j,k,code,2,6));for(var t=0;t<ttable.length;t+=3){var a=intersects[ttable[t]],b=intersects[ttable[t+1]],c=intersects[ttable[t+2]];voxel&&t>=3&&(verts.push(verts[a]),a=verts.length-1,verts.push(verts[b]),b=verts.length-1,verts.push(verts[c]),c=verts.length-1),faces.push(a),faces.push(b),faces.push(c)}}}}},laplacianSmooth=function (numiter,verts,faces){var i,il,j,jl,k,tps=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)tps[i]={x:0,y:0,z:0};var flagvert,vertdeg=new Array(20);for(i=0;20>i;i++)vertdeg[i]=new Array(verts.length);for(i=0,il=verts.length;il>i;i++)vertdeg[0][i]=0;for(i=0,il=faces.length/3;il>i;i++){var aoffset=3*i,boffset=3*i+1,coffset=3*i+2;for(flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[boffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[aoffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[aoffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[aoffset]]++,vertdeg[vertdeg[0][faces[aoffset]]][faces[aoffset]]=faces[coffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[aoffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[boffset]];jl>j;j++)if(faces[coffset]==vertdeg[j+1][faces[boffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[boffset]]++,vertdeg[vertdeg[0][faces[boffset]]][faces[boffset]]=faces[coffset]),flagvert=!0,j=0;j<vertdeg[0][faces[coffset]];j++)if(faces[aoffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}for(flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[aoffset]),flagvert=!0,j=0,jl=vertdeg[0][faces[coffset]];jl>j;j++)if(faces[boffset]==vertdeg[j+1][faces[coffset]]){flagvert=!1;break}flagvert&&(vertdeg[0][faces[coffset]]++,vertdeg[vertdeg[0][faces[coffset]]][faces[coffset]]=faces[boffset])}var wt=1,wt2=.5;for(k=0;numiter>k;k++){for(i=0,il=verts.length;il>i;i++)if(vertdeg[0][i]<3)tps[i].x=verts[i].x,tps[i].y=verts[i].y,tps[i].z=verts[i].z;else if(3==vertdeg[0][i]||4==vertdeg[0][i]){for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt2*verts[i].x,tps[i].y+=wt2*verts[i].y,tps[i].z+=wt2*verts[i].z,tps[i].x/=wt2+vertdeg[0][i],tps[i].y/=wt2+vertdeg[0][i],tps[i].z/=wt2+vertdeg[0][i]}else{for(tps[i].x=0,tps[i].y=0,tps[i].z=0,j=0,jl=vertdeg[0][i];jl>j;j++)tps[i].x+=verts[vertdeg[j+1][i]].x,tps[i].y+=verts[vertdeg[j+1][i]].y,tps[i].z+=verts[vertdeg[j+1][i]].z;tps[i].x+=wt*verts[i].x,tps[i].y+=wt*verts[i].y,tps[i].z+=wt*verts[i].z,tps[i].x/=wt+vertdeg[0][i],tps[i].y/=wt+vertdeg[0][i],tps[i].z/=wt+vertdeg[0][i]}for(i=0,il=verts.length;il>i;i++)verts[i].x=tps[i].x,verts[i].y=tps[i].y,verts[i].z=tps[i].z}},edgeTable=new Uint32Array([0,0,0,0,0,0,0,2816,0,0,0,1792,0,3328,3584,3840,0,0,0,138,0,21,0,134,0,0,0,652,0,2067,3865,3600,0,0,0,42,0,0,0,294,0,0,21,28,0,3875,1049,3360,0,168,162,170,0,645,2475,2210,0,687,293,172,4010,3747,3497,3232,0,0,0,0,0,69,0,900,0,0,0,1792,138,131,1608,1920,0,81,0,2074,84,85,84,86,0,81,0,3676,330,1105,1881,1616,0,0,0,42,0,69,0,502,0,0,21,3580,138,2035,1273,1520,2816,104,2337,106,840,581,367,102,2816,3695,3429,3180,1898,1635,1385,1120,0,0,0,0,0,0,0,3910,0,0,69,588,42,2083,41,2880,0,0,0,1722,0,2293,4095,3830,0,255,757,764,2538,2291,3065,2800,0,0,81,338,0,3925,1119,3414,84,855,85,340,2130,2899,89,2384,1792,712,194,1162,4036,3781,3535,3270,708,719,197,204,3018,2755,2505,2240,0,0,0,0,168,420,168,1958,162,162,676,2988,170,163,680,928,3328,3096,3328,3642,52,53,1855,1590,2340,2111,2869,2620,298,51,825,560,3584,3584,3090,3482,1668,1941,1183,1430,146,2975,2069,2460,154,915,153,400,3840,3592,3329,3082,1796,1541,1295,1030,2818,2575,2309,2060,778,515,265,0]),triTable=[[],[],[],[],[],[],[],[11,9,8],[],[],[],[8,10,9],[],[10,8,11],[9,11,10],[8,10,9,8,11,10],[],[],[],[1,7,3],[],[4,2,0],[],[2,1,7],[],[],[],[2,7,3,2,9,7],[],[1,4,11,1,0,4],[3,8,0,11,9,4,11,10,9],[4,11,9,11,10,9],[],[],[],[5,3,1],[],[],[],[2,5,8,2,1,5],[],[],[2,4,0],[3,2,4],[],[0,9,1,8,10,5,8,11,10],[3,4,0,3,10,4],[5,8,10,8,11,10],[],[3,5,7],[7,1,5],[1,7,3,1,5,7],[],[9,2,0,9,7,2],[0,3,8,1,7,11,1,5,7],[11,1,7,1,5,7],[],[9,1,0,5,3,2,5,7,3],[8,2,5,8,0,2],[2,5,3,5,7,3],[3,9,1,3,8,9,7,11,10,7,10,5],[9,1,0,10,7,11,10,5,7],[3,8,0,7,10,5,7,11,10],[11,5,7,11,10,5],[],[],[],[],[],[0,6,2],[],[7,2,9,7,9,8],[],[],[],[8,10,9],[7,1,3],[7,1,0],[6,9,3,6,10,9],[7,10,8,10,9,8],[],[6,0,4],[],[11,1,4,11,3,1],[2,4,6],[2,0,4,2,4,6],[2,4,6],[1,4,2,4,6,2],[],[6,0,4],[],[2,11,3,6,9,4,6,10,9],[8,6,1,8,1,3],[10,0,6,0,4,6],[8,0,3,9,6,10,9,4,6],[10,4,6,10,9,4],[],[],[],[5,3,1],[],[0,6,2],[],[7,4,8,5,2,1,5,6,2],[],[],[2,4,0],[7,4,8,2,11,3,10,5,6],[7,1,3],[5,6,10,0,9,1,8,7,4],[5,6,10,7,0,3,7,4,0],[10,5,6,4,8,7],[9,11,8],[3,5,6],[0,5,11,0,11,8],[6,3,5,3,1,5],[3,9,6,3,8,9],[9,6,0,6,2,0],[0,3,8,2,5,6,2,1,5],[1,6,2,1,5,6],[9,11,8],[1,0,9,6,10,5,11,3,2],[6,10,5,2,8,0,2,11,8],[3,2,11,10,5,6],[10,5,6,9,3,8,9,1,3],[0,9,1,5,6,10],[8,0,3,10,5,6],[10,5,6],[],[],[],[],[],[],[],[1,10,2,9,11,6,9,8,11],[],[],[6,0,2],[3,6,9,3,2,6],[3,5,1],[0,5,1,0,11,5],[0,3,5],[6,9,11,9,8,11],[],[],[],[4,5,9,7,1,10,7,3,1],[],[11,6,7,2,4,5,2,0,4],[11,6,7,8,0,3,1,10,2,9,4,5],[6,7,11,1,10,2,9,4,5],[],[4,1,0,4,5,1,6,7,3,6,3,2],[9,4,5,0,6,7,0,2,6],[4,5,9,6,3,2,6,7,3],[6,7,11,5,3,8,5,1,3],[6,7,11,4,1,0,4,5,1],[4,5,9,3,8,0,11,6,7],[9,4,5,7,11,6],[],[],[0,6,4],[8,6,4,8,1,6],[],[0,10,2,0,9,10,4,8,11,4,11,6],[10,2,1,6,0,3,6,4,0],[10,2,1,11,4,8,11,6,4],[4,2,6],[1,0,9,2,4,8,2,6,4],[2,4,0,2,6,4],[8,2,4,2,6,4],[11,4,1,11,6,4],[0,9,1,4,11,6,4,8,11],[3,6,0,6,4,0],[8,6,4,8,11,6],[10,8,9],[6,3,9,6,7,3],[6,7,1],[10,7,1,7,3,1],[7,11,6,8,10,2,8,9,10],[11,6,7,10,0,9,10,2,0],[2,1,10,7,11,6,8,0,3],[1,10,2,6,7,11],[7,2,6,7,9,2],[1,0,9,3,6,7,3,2,6],[7,0,6,0,2,6],[2,7,3,2,6,7],[7,11,6,3,9,1,3,8,9],[9,1,0,11,6,7],[0,3,8,11,6,7],[11,6,7],[],[],[],[],[5,3,7],[8,5,2,8,7,5],[5,3,7],[1,10,2,5,8,7,5,9,8],[1,7,5],[1,7,5],[9,2,7,9,7,5],[11,3,2,8,5,9,8,7,5],[1,3,7,1,7,5],[0,7,1,7,5,1],[9,3,5,3,7,5],[9,7,5,9,8,7],[8,10,11],[3,4,10,3,10,11],[8,10,11],[5,9,4,1,11,3,1,10,11],[2,4,5],[5,2,4,2,0,4],[0,3,8,5,9,4,10,2,1],[2,1,10,9,4,5],[2,8,5,2,11,8],[3,2,11,1,4,5,1,0,4],[9,4,5,8,2,11,8,0,2],[11,3,2,9,4,5],[8,5,3,5,1,3],[5,0,4,5,1,0],[3,8,0,4,5,9],[9,4,5],[11,9,10],[11,9,10],[1,11,4,1,10,11],[8,7,4,11,1,10,11,3,1],[2,7,9,2,9,10],[4,8,7,0,10,2,0,9,10],[2,1,10,0,7,4,0,3,7],[10,2,1,8,7,4],[1,7,4],[3,2,11,4,8,7,9,1,0],[11,4,2,4,0,2],[2,11,3,7,4,8],[4,1,7,1,3,7],[1,0,9,8,7,4],[3,4,0,3,7,4],[8,7,4],[8,9,10,8,10,11],[3,9,11,9,10,11],[0,10,8,10,11,8],[10,3,1,10,11,3],[2,8,10,8,9,10],[9,2,0,9,10,2],[8,0,3,1,10,2],[10,2,1],[1,11,9,11,8,9],[11,3,2,0,9,1],[11,0,2,11,8,0],[11,3,2],[8,1,3,8,9,1],[9,1,0],[8,0,3],[]]';
$3Dmol.Ua=window.URL.createObjectURL(new Blob([$3Dmol.Oa]));$3Dmol.workerString=$3Dmol.Oa;$3Dmol.SurfaceWorker=$3Dmol.Ua;
$(document).ready(function(){void 0!==$(".viewer_3Dmoljs")[0]&&($3Dmol.Wa=!0);if($3Dmol.Wa){$3Dmol.Eb={};var l=0;$(".viewer_3Dmoljs").each(function(){var F=$(this),A=null;"undefined"===typeof $(F).css("position")&&$(F).css("position","relative");var I="function"===typeof window[F.data("callback")]?window[F.data("callback")]:null;F.data("pdb")?A="http://www.pdb.org/pdb/files/"+F.data("pdb")+".pdb":F.data("href")&&(A=F.data("href"));var C=Number(F.data("backgroundcolor"))||0,p=F.data("style")||{line:{}},
f=F.data("select")||{},e=$3Dmol.Eb[this.id||l++]=$3Dmol.Ya(F,{ca:$3Dmol.$b,A:function(f){f.yb(C)}});if(A){var a=F.data("datatype")||"pdb";$.get(A,function(d){e.Z(d,a);e.ma(f,p);I&&I(e);e.qa();e.render()},"text")}else F.data("element")&&(A=$("#"+F.data("element")).val()||"",a=F.data("datatype"),a||(console.log("Warning: No type specified for embedded viewer with moldata from "+F.data("element")+"\n assuming type 'pdb'"),a="pdb"),e.Z(A,a),e.ma(f,p)),I&&I(e),e.qa(),e.render()})}});
$3Dmol.h=$3Dmol.h||{};$3Dmol.h.$a=16716947;
$3Dmol.h.Ib={H:16777215,He:14286847,HE:14286847,Li:13402367,LI:13402367,B:16758197,C:9474192,N:3166456,O:16715021,F:9494608,Na:11230450,NA:11230450,Mg:9109248,MG:9109248,Al:12560038,AL:12560038,Si:1578E4,SI:1578E4,P:16744448,S:16777008,Cl:2093087,CL:2093087,Ca:4062976,CA:4062976,Ti:12567239,TI:12567239,Cr:9083335,CR:9083335,Mn:10255047,MN:10255047,Fe:14706227,FE:14706227,Ni:5296208,NI:5296208,Cu:13140019,CU:13140019,Zn:8224944,ZN:8224944,Br:10889513,BR:10889513,Ag:12632256,AG:12632256,I:9699476,Ba:51456,
BA:51456,Au:16765219,AU:16765219};
$3Dmol.h.tb={H:16777215,He:16761035,HE:16761035,Li:11674146,LI:11674146,B:65280,C:13158600,N:9408511,O:15728640,F:14329120,Na:255,NA:255,Mg:2263842,MG:2263842,Al:8421520,AL:8421520,Si:14329120,SI:14329120,P:16753920,S:16762930,Cl:65280,CL:65280,Ca:8421520,CA:8421520,Ti:8421520,TI:8421520,Cr:8421520,CR:8421520,Mn:8421520,MN:8421520,Fe:16753920,FE:16753920,Ni:10824234,NI:10824234,Cu:10824234,CU:10824234,Zn:10824234,ZN:10824234,Br:10824234,BR:10824234,Ag:8421520,AG:8421520,I:10494192,Ba:16753920,BA:16753920,
Au:14329120,AU:14329120};$3Dmol.h.t=$3Dmol.h.tb;$3Dmol.h.hb=$.extend({},$3Dmol.h.t);$3Dmol.h.hb.C=65280;$3Dmol.h.Za=$.extend({},$3Dmol.h.t);$3Dmol.h.Za.C=65535;$3Dmol.h.lb=$.extend({},$3Dmol.h.t);$3Dmol.h.lb.C=16711935;$3Dmol.h.Gb=$.extend({},$3Dmol.h.t);$3Dmol.h.Gb.C=16776960;$3Dmol.h.Fb=$.extend({},$3Dmol.h.t);$3Dmol.h.Fb.C=16777215;$3Dmol.h.qb=$.extend({},$3Dmol.h.t);$3Dmol.h.qb.C=16737792;$3Dmol.h.sb=$.extend({},$3Dmol.h.t);$3Dmol.h.sb.C=8388736;var $3Dmol=$3Dmol||{};
$3Dmol.Mb=function(l,F){this.oa=function(A,I){var C,p;I?(C=I[0],p=I[1]):(C=l,p=F);if(void 0===A)return 16777215;A<C&&(A=C);A>p&&(A=p);var f=(p+C)/2;A<=f?(C=Math.floor(255*Math.sqrt((A-C)/(f-C))),C=16711680+256*C+C):(C=Math.floor(255*Math.sqrt(1-(A-f)/(p-f))),C=65536*C+256*C+255);return C};this.ka=function(){return"undefined"!=typeof l&&"undefined"!=typeof F?[l,F]:null}};
$3Dmol.Lb=function(l,F){this.oa=function(A,I){var C,p;I?(C=I[0],p=I[1]):(C=l,p=F);if("undefined"==typeof A)return 16777215;A<C&&(A=C);A>p&&(A=p);var f=(C+p)/2,e=(C+f)/2,a=(f+p)/2;A<e?(C=Math.floor(255*Math.sqrt((A-C)/(e-C))),C=256*C+16711680):A<f?(C=Math.floor(255*Math.sqrt(1-(A-e)/(f-e))),C=65536*C+65280):A<a?(C=Math.floor(255*Math.sqrt((A-f)/(a-f))),C=65280+1*C):(C=Math.floor(255*Math.sqrt(1-(A-a)/(p-a))),C=256*C+255);return C};this.ka=function(){return"undefined"!=typeof l&&"undefined"!=typeof F?
[l,F]:null}};$3Dmol.Ta=function(l,F){this.oa=function(A,I){var C,p;I?(C=I[0],p=I[1]):(C=l,p=F);if("undefined"==typeof A)return 16777215;A<C&&(A=C);A>p&&(A=p);var f=(A-C)/(p-C)*5/6+.5;C=Math.sin(Math.PI*f);p=Math.sin(Math.PI*(f+1/3));f=Math.sin(Math.PI*(f+2/3));return 65536*Math.floor(255*C*C)+256*Math.floor(255*f*f)+1*Math.floor(255*p*p)};this.ka=function(){return"undefined"!=typeof l&&"undefined"!=typeof F?[l,F]:null}};$3Dmol=$3Dmol||{};
$3Dmol.ab=function(){function l(A,l,C,p,f){if(!(2>l.length)){f=f||5;l=F(l,f);C=F(C,f);var e=new $3Dmol.Geometry(!0),a=[],d,b,g,t,c,h=[[0,2,-6,-8],[-4,-2,6,4],[7,-1,-5,3],[-3,5,1,-7]],n,E,D,s,q,w,G,x,u,z;w=0;for(G=l.length;w<G;w++){D=$3Dmol.m.color(p[Math.round((w-1)/f)]);a.push(b=l[w]);a.push(b);a.push(g=C[w]);a.push(g);w<G-1&&(n=l[w+1].clone().sub(l[w]),d=C[w].clone().sub(l[w]).cross(n).normalize().multiplyScalar(.4));a.push(t=l[w].clone().add(d));a.push(t);a.push(c=C[w].clone().add(d));a.push(c);
void 0!==b.a&&(s=b.a);z=e.updateGeoGroup(8);x=z.vertexArray;u=z.colorArray;var m=z.faceArray;n=z.vertices;E=3*n;x[E]=b.x;x[E+1]=b.y;x[E+2]=b.z;x[E+3]=b.x;x[E+4]=b.y;x[E+5]=b.z;x[E+6]=g.x;x[E+7]=g.y;x[E+8]=g.z;x[E+9]=g.x;x[E+10]=g.y;x[E+11]=g.z;x[E+12]=t.x;x[E+13]=t.y;x[E+14]=t.z;x[E+15]=t.x;x[E+16]=t.y;x[E+17]=t.z;x[E+18]=c.x;x[E+19]=c.y;x[E+20]=c.z;x[E+21]=c.x;x[E+22]=c.y;x[E+23]=c.z;for(x=0;8>x;++x)u[E+3*x]=D.r,u[E+1+3*x]=D.g,u[E+2+3*x]=D.b;if(0<w)for(E=void 0!==q&&void 0!==s&&q.u!==s.u,x=0;4>x;x++)if(u=
[n+h[x][0],n+h[x][1],n+h[x][2],n+h[x][3]],g=z.faceidx,m[g]=u[0],m[g+1]=u[1],m[g+2]=u[3],m[g+3]=u[1],m[g+4]=u[2],m[g+5]=u[3],z.faceidx+=6,s.f||q.f){c=a[u[3]].clone();g=a[u[0]].clone();var J=a[u[2]].clone();t=a[u[1]].clone();c.a=a[u[3]].a||null;J.a=a[u[2]].a||null;g.a=a[u[0]].a||null;t.a=a[u[1]].a||null;if(E){var Ba=c.clone().add(g).multiplyScalar(.5),B=J.clone().add(t).multiplyScalar(.5),H=c.clone().add(t).multiplyScalar(.5);0===x%2?(q.f&&(u=new $3Dmol.Triangle(Ba,H,c),b=new $3Dmol.Triangle(B,J,H),
c=new $3Dmol.Triangle(H,J,c),q.d.triangle.push(u),q.d.triangle.push(b),q.d.triangle.push(c)),s.f&&(u=new $3Dmol.Triangle(g,t,H),b=new $3Dmol.Triangle(t,B,H),c=new $3Dmol.Triangle(g,H,Ba),s.d.triangle.push(u),s.d.triangle.push(b),s.d.triangle.push(c))):(s.f&&(u=new $3Dmol.Triangle(Ba,H,c),b=new $3Dmol.Triangle(B,J,H),c=new $3Dmol.Triangle(H,J,c),s.d.triangle.push(u),s.d.triangle.push(b),s.d.triangle.push(c)),q.f&&(u=new $3Dmol.Triangle(g,t,H),b=new $3Dmol.Triangle(t,B,H),c=new $3Dmol.Triangle(g,H,
Ba),q.d.triangle.push(u),q.d.triangle.push(b),q.d.triangle.push(c)))}else s.f&&(u=new $3Dmol.Triangle(g,t,c),b=new $3Dmol.Triangle(t,J,c),s.d.triangle.push(u),s.d.triangle.push(b))}z.vertices+=8;q=s}l=a.length-8;z=e.updateGeoGroup(8);x=z.vertexArray;u=z.colorArray;m=z.faceArray;n=z.vertices;E=3*n;g=z.faceidx;for(w=0;4>w;w++)a.push(a[2*w]),a.push(a[l+2*w]),C=a[2*w],p=a[l+2*w],x[E+6*w]=C.x,x[E+1+6*w]=C.y,x[E+2+6*w]=C.z,x[E+3+6*w]=p.x,x[E+4+6*w]=p.y,x[E+5+6*w]=p.z,u[E+6*w]=D.r,u[E+1+6*w]=D.g,u[E+2+6*
w]=D.b,u[E+3+6*w]=D.r,u[E+4+6*w]=D.g,u[E+5+6*w]=D.b;u=[n,n+2,n+6,n+4];b=[n+1,n+5,n+7,n+3];m[g]=u[0];m[g+1]=u[1];m[g+2]=u[3];m[g+3]=u[1];m[g+4]=u[2];m[g+5]=u[3];m[g+6]=b[0];m[g+7]=b[1];m[g+8]=b[3];m[g+9]=b[1];m[g+10]=b[2];m[g+11]=b[3];z.faceidx+=12;z.vertices+=8;e.initTypedArrays();e.setUpNormals();a=new $3Dmol.MeshLambertMaterial;a.vertexColors=$3Dmol.FaceColors;a.side=$3Dmol.DoubleSide;e=new $3Dmol.Mesh(e,a);A.add(e)}}function F(A,l){var C=[],p=A,p=[];p.push(A[0]);var f,e,a,d,b,g;f=1;for(e=A.length-
1;f<e;f++)d=A[f],b=A[f+1],d.Ab?p.push(new $3Dmol.Vector3((d.x+b.x)/2,(d.y+b.y)/2,(d.z+b.z)/2)):p.push(d);p.push(A[A.length-1]);f=-1;for(e=p.length;f<=e-3;f++){a=p[-1===f?0:f];d=p[f+1];b=p[f+2];g=p[f===e-3?e-1:f+3];a=(new $3Dmol.Vector3).subVectors(b,a).multiplyScalar(.5);g=(new $3Dmol.Vector3).subVectors(g,d).multiplyScalar(.5);for(var t=0;t<l;t++){var c=1/l*t,c=new $3Dmol.Vector3(d.x+c*a.x+c*c*(-3*d.x+3*b.x-2*a.x-g.x)+c*c*c*(2*d.x-2*b.x+a.x+g.x),d.y+c*a.y+c*c*(-3*d.y+3*b.y-2*a.y-g.y)+c*c*c*(2*d.y-
2*b.y+a.y+g.y),d.z+c*a.z+c*c*(-3*d.z+3*b.z-2*a.z-g.z)+c*c*c*(2*d.z-2*b.z+a.z+g.z)),h=Math.floor((C.length+2)/l);void 0!==A[h]&&void 0!==A[h].a&&(c.a=A[h].a);C.push(c)}}C.push(p[p.length-1]);return C}return function(A,F,C){var p,f,e;p=2;f=5;e=!1;var a=[],d,b,g;for(g=0;g<p;g++)a[g]=[];g=[];var t,c,h,n,E,D=null,s=null;for(d in F)if(b=F[d],void 0!==b&&("O"==b.a||"CA"==b.a)&&!b.L)if("CA"==b.a){if(t!=b.o||h+1!=b.e||c!=b.Ha){l(A,a[0],a[p-1],g,f);a=[];for(g=0;g<p;g++)a[g]=[];g=[];D=null}n=new $3Dmol.Vector3(b.x,
b.y,b.z);E=b;t=b.o;c=b.Ha;h=b.e;var s=b.na,q=b.color;C?q=C.oa(b.e,C.ka()):"undefined"!==typeof b.style.Q.color&&(q=b.style.Q.color);g.push(q);!0!==b.f||void 0!==b.d&&void 0!==b.d.triangle||(b.d={sphere:null,cylinder:[],line:[],triangle:[]})}else for(b=new $3Dmol.Vector3(b.x,b.y,b.z),b.sub(n),b.normalize(),b.multiplyScalar("c"==s?.3:1.3),null!==D&&0>b.dot(D)&&b.negate(),D=b,b=0;b<p;b++)q=-1+2/(p-1)*b,q=new $3Dmol.Vector3(n.x+D.x*q,n.y+D.y*q,n.z+D.z*q),q.a=E,e||"s"!=s||(q.Ab=!0),a[b].push(q);l(A,a[0],
a[p-1],g,f)}}();$3Dmol=$3Dmol||{};
$3Dmol.j=function(){var l={},F=function(){var f=new $3Dmol.Vector3;return function(e){f.set(e[0],e[1],e[2]);var a=f.x,d=f.y,b=f.z,g=Math.sqrt(a*a+d*d);1E-4>g?(e=0,g=1):(e=-a/g,g=d/g);d=-e*a+g*d;a=Math.sqrt(d*d+b*b);1E-4>a?(b=0,d=1):(b/=a,d/=a);a=new Float32Array(9);a[0]=g;a[1]=e;a[2]=0;a[3]=-e*d;a[4]=g*d;a[5]=b;a[6]=e*b;a[7]=-g*b;a[8]=d;return a}}(),A=function(){var f=[];f[0]=new $3Dmol.Vector3(-1,0,0);f[4]=new $3Dmol.Vector3(0,0,1);f[8]=new $3Dmol.Vector3(1,0,0);f[12]=new $3Dmol.Vector3(0,0,-1);
f[2]=f[0].clone().add(f[4]).normalize();f[6]=f[4].clone().add(f[8]).normalize();f[10]=f[8].clone().add(f[12]).normalize();f[14]=f[12].clone().add(f[0]).normalize();f[1]=f[0].clone().add(f[2]).normalize();f[3]=f[2].clone().add(f[4]).normalize();f[5]=f[4].clone().add(f[6]).normalize();f[7]=f[6].clone().add(f[8]).normalize();f[9]=f[8].clone().add(f[10]).normalize();f[11]=f[10].clone().add(f[12]).normalize();f[13]=f[12].clone().add(f[14]).normalize();f[15]=f[14].clone().add(f[0]).normalize();return f}(),
I={q:{},ea:function(f){if(void 0!==this.q[f])return this.q[f];new $3Dmol.Vector3(0,1,0);for(var e=A.length,a=[],d=[],b,g=0;g<e;g++)a.push(A[g].clone().multiplyScalar(f)),a.push(A[g].clone().multiplyScalar(f)),b=A[g].clone().normalize(),d.push(b),d.push(b);var g=[],t=2*Math.PI,c=Math.PI,h,n,E=!1,D=!1;for(n=0;10>=n;n++){var E=0===n||10===n?!0:!1,D=5===n?!0:!1,s=[],q=[];for(h=0;h<=e;h++)if(D){var w=h<e?2*h:0;q.push(w+1);s.push(w)}else{b=h/e;var G=n/10;E&&0!==h?E&&s.push(a.length-1):h<e?(w=new $3Dmol.Vector3,
w.x=-f*Math.cos(0+b*t)*Math.sin(0+G*c),w.y=f*Math.cos(0+G*c),w.z=f*Math.sin(0+b*t)*Math.sin(0+G*c),1E-5>Math.abs(w.x)&&(w.x=0),1E-5>Math.abs(w.y)&&(w.y=0),1E-5>Math.abs(w.z)&&(w.z=0),b=new $3Dmol.Vector3(w.x,w.y,w.z),b.normalize(),a.push(w),d.push(b),s.push(a.length-1)):s.push(a.length-e)}D&&g.push(q);g.push(s)}e={vertices:a,W:d,Y:g,w:e,ib:10};return this.q[f]=e}},C=0;l.n=function(f,e,a,d,b,g,t){if(e&&a){C++;var c=g||t;b=b||{r:0,g:0,b:0};var h=[a.x,a.y,a.z];h[0]-=e.x;h[1]-=e.y;h[2]-=e.z;var h=F(h),
n=I.ea(d);d=n.w;var E=n.ib,D=c?E*d+2:2*d;f=f.updateGeoGroup(D);var s=n.vertices,q=n.W,n=n.Y,w=n[E/2],G=n[E/2+1],x=f.vertices,u,z,m,J,p,B,H=f.vertexArray,y=f.normalArray,l=f.colorArray,A=f.faceArray;for(m=0;m<d;++m)z=2*m,J=h[0]*s[z].x+h[3]*s[z].y+h[6]*s[z].z,p=h[1]*s[z].x+h[4]*s[z].y+h[7]*s[z].z,B=h[5]*s[z].y+h[8]*s[z].z,u=3*(x+z),z=f.faceidx,H[u]=J+e.x,H[u+1]=p+e.y,H[u+2]=B+e.z,H[u+3]=J+a.x,H[u+4]=p+a.y,H[u+5]=B+a.z,y[u]=J,y[u+3]=J,y[u+1]=p,y[u+4]=p,y[u+2]=B,y[u+5]=B,l[u]=b.r,l[u+3]=b.r,l[u+1]=b.g,
l[u+4]=b.g,l[u+2]=b.b,l[u+5]=b.b,A[z]=G[m]+x,A[z+1]=G[m+1]+x,A[z+2]=w[m]+x,A[z+3]=w[m]+x,A[z+4]=G[m+1]+x,A[z+5]=w[m+1]+x,f.faceidx+=6;if(c){g=g?E+1:E/2+1;var T,O,S,M,N,L,P,Z,aa,Y,U,ga,V;for(p=t?0:E/2;p<g;p++)if(p!==E/2){var R=p<=E/2?a:e;for(J=0;J<d;J++)z=f.faceidx,t=n[p][J+1],m=3*(t+x),c=n[p][J],B=3*(c+x),w=n[p+1][J],u=3*(w+x),G=n[p+1][J+1],V=3*(G+x),T=h[0]*s[t].x+h[3]*s[t].y+h[6]*s[t].z,O=h[0]*s[c].x+h[3]*s[c].y+h[6]*s[c].z,S=h[0]*s[w].x+h[3]*s[w].y+h[6]*s[w].z,M=h[0]*s[G].x+h[3]*s[G].y+h[6]*s[G].z,
N=h[1]*s[t].x+h[4]*s[t].y+h[7]*s[t].z,L=h[1]*s[c].x+h[4]*s[c].y+h[7]*s[c].z,P=h[1]*s[w].x+h[4]*s[w].y+h[7]*s[w].z,Z=h[1]*s[G].x+h[4]*s[G].y+h[7]*s[G].z,aa=h[5]*s[t].y+h[8]*s[t].z,Y=h[5]*s[c].y+h[8]*s[c].z,U=h[5]*s[w].y+h[8]*s[w].z,ga=h[5]*s[G].y+h[8]*s[G].z,H[m]=T+R.x,H[B]=O+R.x,H[u]=S+R.x,H[V]=M+R.x,H[m+1]=N+R.y,H[B+1]=L+R.y,H[u+1]=P+R.y,H[V+1]=Z+R.y,H[m+2]=aa+R.z,H[B+2]=Y+R.z,H[u+2]=U+R.z,H[V+2]=ga+R.z,l[m]=b.r,l[B]=b.r,l[u]=b.r,l[V]=b.r,l[m+1]=b.g,l[B+1]=b.g,l[u+1]=b.g,l[V+1]=b.g,l[m+2]=b.b,l[B+
2]=b.b,l[u+2]=b.b,l[V+2]=b.b,T=h[0]*q[t].x+h[3]*q[t].y+h[6]*q[t].z,O=h[0]*q[c].x+h[3]*q[c].y+h[6]*q[c].z,S=h[0]*q[w].x+h[3]*q[w].y+h[6]*q[w].z,M=h[0]*q[G].x+h[3]*q[G].y+h[6]*q[G].z,N=h[1]*q[t].x+h[4]*q[t].y+h[7]*q[t].z,L=h[1]*q[c].x+h[4]*q[c].y+h[7]*q[c].z,P=h[1]*q[w].x+h[4]*q[w].y+h[7]*q[w].z,Z=h[1]*q[G].x+h[4]*q[G].y+h[7]*q[G].z,aa=h[5]*q[t].y+h[8]*q[t].z,Y=h[5]*q[c].y+h[8]*q[c].z,U=h[5]*q[w].y+h[8]*q[w].z,ga=h[5]*q[G].y+h[8]*q[G].z,0===p?(y[m]=T,y[u]=S,y[V]=M,y[m+1]=N,y[u+1]=P,y[V+1]=Z,y[m+2]=
aa,y[u+2]=U,y[V+2]=ga,A[z]=t+x,A[z+1]=w+x,A[z+2]=G+x,f.faceidx+=3):p===g-1?(y[m]=T,y[B]=O,y[u]=S,y[m+1]=N,y[B+1]=L,y[u+1]=P,y[m+2]=aa,y[B+2]=Y,y[u+2]=U,A[z]=t+x,A[z+1]=c+x,A[z+2]=w+x,f.faceidx+=3):(y[m]=T,y[B]=O,y[V]=M,y[m+1]=N,y[B+1]=L,y[V+1]=Z,y[m+2]=aa,y[B+2]=Y,y[V+2]=ga,y[B]=O,y[u]=S,y[V]=M,y[B+1]=L,y[u+1]=P,y[V+1]=Z,y[B+2]=Y,y[u+2]=U,y[V+2]=ga,A[z]=t+x,A[z+1]=c+x,A[z+2]=G+x,A[z+3]=c+x,A[z+4]=w+x,A[z+5]=G+x,f.faceidx+=6)}}f.vertices+=D}};l.Sb=function(f,e,a,d,b){if(e&&a){b=b||{r:0,g:0,b:0};var g=
[a.x,a.y,a.z];g.x-=e.x;g.y-=e.y;g.z-=e.z;var t=F(g),c=A.length;f=f.updateGeoGroup(c+2);var h=f.vertices,n,p,D,s=f.vertexArray,q=f.normalArray,w=f.colorArray,G=f.faceArray;n=3*h;g=(new $3Dmol.Vector3(g[0],g[1],g[2])).normalize();s[n]=e.x;s[n+1]=e.y;s[n+2]=e.z;q[n]=-g.x;q[n+1]=-g.y;q[n+2]=-g.z;w[n]=b.r;w[n+1]=b.g;w[n+2]=b.b;s[n+3]=a.x;s[n+4]=a.y;s[n+5]=a.z;q[n+3]=g.x;q[n+4]=g.y;q[n+5]=g.z;w[n+3]=b.r;w[n+4]=b.g;w[n+5]=b.b;n+=6;for(a=0;a<c;++a)D=A[a].clone(),D.multiplyScalar(d),g=t[0]*D.x+t[3]*D.y+t[6]*
D.z,p=t[1]*D.x+t[4]*D.y+t[7]*D.z,D=t[5]*D.y+t[8]*D.z,s[n]=g+e.x,s[n+1]=p+e.y,s[n+2]=D+e.z,q[n]=g,q[n+1]=p,q[n+2]=D,w[n]=b.r,w[n+1]=b.g,w[n+2]=b.b,n+=3;f.vertices+=c+2;e=f.faceidx;for(a=0;a<c;a++)d=h+2+a,b=h+2+(a+1)%c,G[e]=d,G[e+1]=b,G[e+2]=0,e+=3,G[e]=d,G[e+1]=b,G[e+2]=1,e+=3;f.faceidx+=6*c}};var p={q:{},ea:function(f){if("undefined"!==typeof this.q[f])return this.q[f];var e={vertices:[],Y:[],W:[]},a=16,d=10;1>f&&(a=10,d=8);var b=2*Math.PI,g=Math.PI,t,c;for(c=0;c<=d;c++){var h=[];for(t=0;t<=a;t++){var n=
t/a,p=c/d,D={};D.x=-f*Math.cos(0+n*b)*Math.sin(0+p*g);D.y=f*Math.cos(0+p*g);D.z=f*Math.sin(0+n*b)*Math.sin(0+p*g);n=new $3Dmol.Vector3(D.x,D.y,D.z);n.normalize();e.vertices.push(D);e.W.push(n);h.push(e.vertices.length-1)}e.Y.push(h)}return this.q[f]=e}};l.Aa=function(f,e,a,d){new $3Dmol.Vector3(e.x,e.y,e.z);var b=p.ea(a),g=b.vertices,t=b.W;f=f.updateGeoGroup(g.length);for(var c=f.vertices,h=f.vertexArray,n=f.colorArray,E=f.faceArray,D=f.lineArray,s=f.normalArray,q=0,w=g.length;q<w;++q){var G=3*(c+
q),x=g[q];h[G]=x.x+e.x;h[G+1]=x.y+e.y;h[G+2]=x.z+e.z;n[G]=d.r;n[G+1]=d.g;n[G+2]=d.b}f.vertices+=g.length;b=b.Y;h=b.length-1;for(d=0;d<h;d++)for(n=b[d].length-1,e=0;e<n;e++){var q=f.faceidx,w=f.lineidx,G=b[d][e+1]+c,x=3*G,u=b[d][e]+c,z=3*u,m=b[d+1][e]+c,J=3*m,l=b[d+1][e+1]+c,B=3*l,A=t[G-c],y=t[u-c],C=t[m-c],F=t[l-c];Math.abs(g[G-c].y)===a?(s[x]=A.x,s[J]=C.x,s[B]=F.x,s[x+1]=A.y,s[J+1]=C.y,s[B+1]=F.y,s[x+2]=A.z,s[J+2]=C.z,s[B+2]=F.z,E[q]=G,E[q+1]=m,E[q+2]=l,D[w]=G,D[w+1]=m,D[w+2]=G,D[w+3]=l,D[w+4]=m,
D[w+5]=l,f.faceidx+=3,f.lineidx+=6):Math.abs(g[m-c].y)===a?(s[x]=A.x,s[z]=y.x,s[J]=C.x,s[x+1]=A.y,s[z+1]=y.y,s[J+1]=C.y,s[x+2]=A.z,s[z+2]=y.z,s[J+2]=C.z,E[q]=G,E[q+1]=u,E[q+2]=m,D[w]=G,D[w+1]=u,D[w+2]=G,D[w+3]=m,D[w+4]=u,D[w+5]=m,f.faceidx+=3,f.lineidx+=6):(s[x]=A.x,s[z]=y.x,s[B]=F.x,s[x+1]=A.y,s[z+1]=y.y,s[B+1]=F.y,s[x+2]=A.z,s[z+2]=y.z,s[B+2]=F.z,s[z]=y.x,s[J]=C.x,s[B]=F.x,s[z+1]=y.y,s[J+1]=C.y,s[B+1]=F.y,s[z+2]=y.z,s[J+2]=C.z,s[B+2]=F.z,E[q]=G,E[q+1]=u,E[q+2]=l,E[q+3]=u,E[q+4]=m,E[q+5]=l,D[w]=
G,D[w+1]=u,D[w+2]=G,D[w+3]=l,D[w+4]=u,D[w+5]=m,D[w+6]=m,D[w+7]=l,f.faceidx+=6,f.lineidx+=8)}};return l}();$3Dmol=$3Dmol||{};
$3Dmol.Pa=function(){function l(f){var e=[],a,d;a=0;for(d=f.length;a<d;a++){f[a].index=a;var b=f[a];b.L||"N"!==b.a&&"O"!==b.a||(e.push(b),b.ga=null,b.J=Number.POSITIVE_INFINITY)}e.sort(function(b,g){return b.z-g.z});a=0;for(d=e.length;a<d;a++)for(b=e[a],f=a+1;f<d;f++){var g=e[f],t=g.z-b.z;if(3.2<t)break;if(g.a!=b.a){var c=Math.abs(g.y-b.y);if(!(3.2<c)){var h=Math.abs(g.x-b.x);3.2<h||(t=h*h+c*c+t*t,10.24<t||g.o==b.o&&4>Math.abs(g.e-b.e)||(t<b.J&&(b.ga=g,b.J=t),t<g.J&&(g.ga=b,g.J=t)))}}}}function F(f){var e=
[],a=[],d,b;d=0;for(b=f.length;d<b;d++){var g=f[d];g.index=d;g.L?a.push(g):e.push(g)}A(a);e.sort(function(b,g){return b.o!=g.o?b.o<g.o?-1:1:b.e-g.e});var a=f=-1,t;d=0;for(b=e.length;d<b;d++){g=e[d];g.e!==f&&(f=g.e,t||a++,t=!1);g.Ha=a;for(var c=d+1;c<e.length;c++){var h=e[c];if(h.o!=g.o)break;if(1<h.e-g.e)break;I(g,h)&&(-1===g.i.indexOf(h.index)&&(g.i.push(h.index),g.k.push(1),h.i.push(g.index),h.k.push(1)),g.e!==h.e&&(t=!0))}}}function A(f){var e=f.slice(0),a,d;a=0;for(d=f.length;a<d;a++)f[a].index||
(f[a].index=a);e.sort(function(b,g){return b.z-g.z});a=0;for(d=e.length;a<d;a++){var b=e[a];for(f=a+1;f<d;f++){var g=e[f];if(1.9<g.z-b.z)break;I(b,g)&&-1==b.i.indexOf(g.index)&&(b.i.push(g.index),b.k.push(1),g.i.push(b.index),g.k.push(1))}}}function I(f,e){var a=f.x-e.x,a=a*a;if(3.6<a)return!1;var d=f.y-e.y,d=d*d;if(3.6<d)return!1;var b=f.z-e.z,b=b*b;if(3.6<b)return!1;a=a+d+b;return isNaN(a)||.5>a||1.3<a&&("H"==f.p||"H"==e.p||"D"==f.p||"D"==e.p)?!1:3.6>a&&("S"==f.p||"S"==e.p)?!0:2.78<a?!1:!0}var C=
{line:{}},p={H:1.2,Li:1.82,Na:2.27,K:2.75,C:1.7,N:1.55,O:1.52,F:1.47,P:1.8,S:1.8,CL:1.75,BR:1.85,SE:1.9,ZN:1.39,CU:1.4,NI:1.63};return function(f,e){function a(b,f){if(b.style.sphere){var a=b.style.sphere;if(!a.hidden){var c=b.color;"undefined"!=typeof a.color&&(c=a.color);c=$3Dmol.m.color(c);a=g(b,a);if(!0===b.f&&void 0!==b.d){var d=new $3Dmol.Vector3(b.x,b.y,b.z);b.d.sphere.push(new $3Dmol.Sphere(d,a))}$3Dmol.j.Aa(f,b,a,c)}}}function d(b,g,a,f,c,d){b[a]=f.x;b[a+1]=f.y;b[a+2]=f.z;g[a]=d.r;g[a+1]=
d.g;g[a+2]=d.b;b[a+3]=c.x;b[a+4]=c.y;b[a+5]=c.z;g[a+3]=d.r;g[a+4]=d.g;g[a+5]=d.b}function b(b,g,a){var f=new $3Dmol.Vector3(b.x,b.y,b.z),c=(new $3Dmol.Vector3(g.x,g.y,g.z)).clone(),d=null;c.sub(f);1===b.i.length?1===g.i.length?(d=c.clone(),1E-4<Math.abs(d.x)?d.y+=1:d.x+=1):(a=(a+1)%g.i.length,b=g.i[a],b=t[b],b=new $3Dmol.Vector3(b.x,b.y,b.z),b=b.clone(),b.sub(f),d=b.clone(),d.cross(c)):(a=(a+1)%b.i.length,b=b.i[a],b=t[b],b=new $3Dmol.Vector3(b.x,b.y,b.z),b=b.clone(),b.sub(f),d=b.clone(),d.cross(c));
.01>d.lengthSq()&&(d=c.clone(),1E-4<Math.abs(d.x)?d.y+=1:d.x+=1);d.cross(c);d.normalize();return d}function g(b,g){var a=1.5;"undefined"!=typeof g.l?a=g.l:p[b.p]&&(a=p[b.p]);"undefined"!=typeof g.scale&&(a*=g.scale);return a}var t=[],c=null,h=null,n=null,E=$3Dmol.h.$a,D=e?e:$3Dmol.h.t;this.Va=function(b,g){var a;a=a||{};b||console.error("Erorr with addMolData: No input data specified");switch(g){case "xyz":var d=b.split("\n");if(!(3>d.length)){var c=parseInt(d[0].substr(0,3));if(!(isNaN(c)||0>=c||
d.length<c+2)){a=2;for(var e=t.length,c=e+c;e<c;e++){var h=d[a++].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),m={};m.u=e;m.a=m.p=h[0];m.x=parseFloat(h[1]);m.y=parseFloat(h[2]);m.z=parseFloat(h[3]);m.L=!0;m.i=[];m.k=[];m.ja={};t[e]=m}A(t)}}break;case "pdb":h=!a.Vb;a=t.length;var n,c=[],e=[],m=[],p=b.split("\n"),B,H,y;for(B=0;B<p.length;B++){y=p[B].replace(/^\s*/,"");n=y.substr(0,6);var ma;if("ATOM  "==n||"HETATM"==n){var I,T,O,S,M,N,L,P,Z;n=y.substr(16,1);if(" "==n||"A"==n)if(P=parseInt(y.substr(6,
5)),n=y.substr(12,4).replace(/ /g,""),H=y.substr(17,3),ma=y.substr(21,1),I=parseInt(y.substr(22,4)),T=y.substr(26,1),O=parseFloat(y.substr(30,8)),S=parseFloat(y.substr(38,8)),M=parseFloat(y.substr(46,8)),Z=parseFloat(y.substr(60,8)),L=y.substr(76,2).replace(/ /g,""),""===L&&(L=y.substr(12,2).replace(/ /g,"")),"H"!=L&&"HH"!=L&&"HD"!=L||!h)N="H"==y[0]?!0:!1,m[P]=t.length,t.push({resn:H,x:O,y:S,z:M,elem:L,hetflag:N,chain:ma,resi:I,icode:T,rescode:I+(" "!=T?"^"+T:""),serial:P,atom:n,bonds:[],ss:"c",bondOrder:[],
properties:{},b:Z,pdbline:y})}else if("SHEET "==n)n=y.substr(21,1),H=parseInt(y.substr(22,4)),ma=y.substr(32,1),y=parseInt(y.substr(33,4)),c.push([n,H,ma,y]);else if("CONECT"==n)for(n=t[m[parseInt(y.substr(6,5))]],H=0;4>H;H++)ma=parseInt(y.substr([11,16,21,26][H],5)),I=t[m[ma]],void 0!==n&&void 0!==I&&(n.i.push(m[ma]),n.k.push(1));else"HELIX "==n&&(n=y.substr(19,1),H=parseInt(y.substr(21,4)),ma=y.substr(31,1),y=parseInt(y.substr(33,4)),e.push([n,H,ma,y]))}h=(new Date).getTime();F(t);console.log("bond connecting "+
((new Date).getTime()-h));h=(new Date).getTime();l(t);m={};B=0;for(y=t.length;B<y;B++)n=t[B],"undefined"===typeof m[n.o]&&(m[n.o]=[]),isFinite(n.J)&&(m[n.o][n.e]=4===Math.abs(n.ga.e-n.e)?"h":"s");for(d in m){for(B=1;B<m[d].length-1;B++)y=m[d][B-1],n=m[d][B+1],p=m[d][B],y==n&&p!=y&&(m[d][B]=y);for(B=0;B<m[d].length;B++)p=m[d][B],"h"!=p&&"s"!=p||m[d][B-1]==p||m[d][B+1]==p||delete m[d][B]}B=0;for(y=t.length;B<y;B++)n=t[B],p=m[n.o][n.e],"undefined"!=typeof p&&(n.na=p,m[n.o][n.e-1]!=p&&(n.Ka=!0),m[n.o][n.e+
1]!=p&&(n.La=!0));console.log("secondary structure "+((new Date).getTime()-h));for(B=a;B<t.length;B++)if(n=t[B],void 0!==n){for(H=0;H<c.length;H++)n.o!=c[H][0]||n.e<c[H][1]||n.e>c[H][3]||(n.na="s",n.e==c[H][1]&&(n.Ka=!0),n.e==c[H][3]&&(n.La=!0));for(H=0;H<e.length;H++)n.o!=e[H][0]||n.e<e[H][1]||n.e>e[H][3]||(n.na="h",n.e==e[H][1]?n.Ka=!0:n.e==e[H][3]&&(n.La=!0))}break;case "sdf":d=b.split("\n");if(!(4>d.length||(h=parseInt(d[3].substr(0,3)),isNaN(h)||0>=h||(a=parseInt(d[3].substr(3,3)),c=4,d.length<
4+h+a)))){e=t.length;p=e+h;for(h=e;h<p;h++)m=d[c],c++,B={},B.u=h,B.x=parseFloat(m.substr(0,10)),B.y=parseFloat(m.substr(10,10)),B.z=parseFloat(m.substr(20,10)),B.L=!0,B.a=B.p=m.substr(31,3).replace(/ /g,""),B.i=[],B.k=[],B.ja={},t[h]=B;for(h=0;h<a;h++)m=d[c],c++,p=parseInt(m.substr(0,3))-1+e,B=parseInt(m.substr(3,3))-1+e,m=parseInt(m.substr(6,3)),t[p].i.push(B),t[p].k.push(m),t[B].i.push(p),t[B].k.push(m)}break;case "mol2":a=b.search(/@<TRIPOS>MOLECULE/);d=b.search(/@<TRIPOS>ATOM/);if(-1!=a&&-1!=
d){d=[];a=b.substr(a,b.length).split("\n");m=a[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");p=parseInt(m[0]);c=0;1<m.length&&(c=parseInt(m[1]));e=4;for(h=3;h<a.length;h++)if("@<TRIPOS>ATOM"==a[h]){e=h+1;break}h=t.length;for(p=h+p;h<p;h++)m=a[e++],m=m.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),B={},y=h,n=parseInt(m[0]),B.u=n,B.x=parseFloat(m[2]),B.y=parseFloat(m[3]),B.z=parseFloat(m[4]),B.a=B.p=m[5].split(".")[0],"H"!=B.p&&(B.i=[],B.k=[],B.ja={},d[n]=y,t.push(B));for(h=!1;e<a.length;)if("@<TRIPOS>BOND"==
a[e++]){h=!0;break}if(h&&c)for(h=0;h<c;h++)m=a[e++],m=m.replace(/^\s+/,"").replace(/\s+/g," ").split(" "),p=parseInt(m[1]),fromAtom=t[d[p]],B=parseInt(m[2]),toAtom=t[d[B]],m=parseInt(m[3]),isNaN(m)&&(m=1),void 0!==fromAtom&&void 0!==toAtom&&(fromAtom.i.push(d[B]),fromAtom.k.push(m),toAtom.i.push(d[p]),toAtom.k.push(m))}break;case "cube":if(d=b.replace(/^\s+/,"").split(/[\n\r]+/),!(6>d.length)){a=d[2].replace(/^\s+/,"").replace(/\s+/g," ").split(" ");c=Math.abs(parseFloat(a[0]));a=d[3].replace(/^\s+/,
"").replace(/\s+/g," ").split(" ");a=0<parseFloat(a[0])?.529177:1;d=d.splice(6,c);c=t.length;e=c+d.length;for(h=c;h<e;++h)m={},m.u=h,p=d[h-c].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),6==p[0]?m.p="C":1==p[0]?m.p="H":8==p[0]?m.p="O":17==p[0]&&(m.p="CL"),m.x=parseFloat(p[2])*a,m.y=parseFloat(p[3])*a,m.z=parseFloat(p[4])*a,m.L=!0,m.i=[],m.k=[],m.ja={},t.push(m);A(t)}}for(d=0;d<t.length;d++)if(a=t[d])a.style=a.style||C,a.color=a.color||D[a.p]||E,a.Fa=f,a.f&&(a.d={sphere:[],cylinder:[],line:[],
triangle:[]})};this.ya=function(b,a){if("undefined"===typeof a)return!0;var d=!!a.Ub,g=!0,c;for(c in a)if(a.hasOwnProperty(c)&&"props"!=c&&"invert"!=c&&"model"!=c){if("undefined"===typeof b[c]){g=!1;break}var f=!1;if($.isArray(a[c])){for(var h=a[c],e=0;e<h.length;e++)if(b[c]==h[e]){f=!0;break}if(!f){g=!1;break}}else if(b[c]!=a[c]){g=!1;break}}return d?!g:g};this.Ia=function(b){for(var a=[],d=0;d<t.length;d++){var g=t[d];g&&this.ya(g,b)&&a.push(g)}return a};this.ma=function(b,a,d){var g;(g=d||null===
c)||(g=n,g=!(a&&g?JSON.stringify(a)==JSON.stringify(g):a==g));if(g){n=d?null:a;a=$.extend(!0,{},a);g=!1;for(var f=0;f<t.length;f++)if(t[f].za=!1,this.ya(t[f],b)){g=!0;t[f].f&&(t[f].d={sphere:[],cylinder:[],line:[],triangle:[]});d||(t[f].style={});for(var h in a)a.hasOwnProperty(h)&&(t[f].style[h]=a[h])}g&&(c=null)}};this.fa=function(e){var n=new Date;if(null===c){console.log("creating for "+f);var p=new $3Dmol.Object3D,D=[],x={},u={},z=new $3Dmol.Geometry(!0),m=new $3Dmol.Geometry(!0),E=new $3Dmol.Geometry(!0),
l,B,A=[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY];l=0;for(B=t.length;l<B;l++){var y=t[l];if(y&&y.style){y.f&&void 0===y.d&&(y.d={sphere:[],cylinder:[],line:[],triangle:[]});a(y,z);var C=y,F=m;if(C.style.Bb){var I=C.style.Bb;if(!I.hidden){var O=g(C,I),S=C.color;"undefined"!=typeof I.color&&(S=I.color);for(var M=$3Dmol.m.color(S),N=F.updateGeoGroup(4),L=N.vertices,P=3*L,Z=N.vertexArray,aa=N.colorArray,Y=0;4>Y;Y++)Z[P+3*Y]=C.x,Z[P+3*Y+1]=C.y,Z[P+3*Y+2]=C.z;for(var U=N.normalArray,aa=N.colorArray,
Y=0;4>Y;Y++)aa[P+3*Y]=M.r,aa[P+3*Y+1]=M.g,aa[P+3*Y+2]=M.b;U[P+0]=-O;U[P+1]=-O;U[P+2]=0;U[P+3]=-O;U[P+4]=O;U[P+5]=0;U[P+6]=O;U[P+7]=O;U[P+8]=0;U[P+9]=O;U[P+10]=-O;U[P+11]=0;N.vertices+=4;var ga=N.faceArray,V=N.faceidx;ga[V+0]=L;ga[V+1]=L+1;ga[V+2]=L+2;ga[V+3]=L+2;ga[V+4]=L+3;ga[V+5]=L;N.faceidx+=6}}var R=y,ab=u;if(R.style.cross){var Ra=R.style.cross;if(!Ra.hidden){var bb=Ra.linewidth||1;ab[bb]||(ab[bb]=new $3Dmol.Geometry);var Ya=ab[bb].updateGeoGroup(6),Ka=g(R,Ra),La=[[Ka,0,0],[-Ka,0,0],[0,Ka,0],
[0,-Ka,0],[0,0,Ka],[0,0,-Ka]],kb=R.f;kb&&void 0===R.d&&(R.d={sphere:[],cylinder:[],line:[]});var Za=$3Dmol.m.color(R.color);Ra.color&&(Za=$3Dmol.m.color(Ra.color));for(var cb=Ya.vertexArray,db=Ya.colorArray,Da=0;6>Da;Da++){var Ma=3*Ya.vertices;Ya.vertices++;cb[Ma]=R.x+La[Da][0];cb[Ma+1]=R.y+La[Da][1];cb[Ma+2]=R.z+La[Da][2];db[Ma]=Za.r;db[Ma+1]=Za.g;db[Ma+2]=Za.b;if(kb){var Na=new $3Dmol.Vector3(La[Da][0],La[Da][1],La[Da][2]);Na.multiplyScalar(.1);Na.set(Na.x+R.x,Na.y+R.y,Na.z+R.z);R.d.line.push(Na)}}}}var W=
y,rb=t,eb=x;if(W.style.line){var lb=W.style.line;if(!lb.hidden){var fb=lb.linewidth||1;eb[fb]||(eb[fb]=new $3Dmol.Geometry);for(var na=eb[fb].updateGeoGroup(2*W.i.length),ca=na.vertexArray,da=na.colorArray,ya=0;ya<W.i.length;ya++){var Fa=rb[W.i[ya]];if(Fa.style.line&&!(W.u>=Fa.u)){var wa=new $3Dmol.Vector3(W.x,W.y,W.z),Ga=new $3Dmol.Vector3(Fa.x,Fa.y,Fa.z),$a=wa.clone().add(Ga).multiplyScalar(.5),mb=!1;W.f&&(void 0===W.d&&(W.d={sphere:[],cylinder:[],line:[],triangle:[]}),W.d.line.push(wa),W.d.line.push(Ga));
var ia=$3Dmol.m.color(W.color),za=$3Dmol.m.color(Fa.color);if(W.v&&W.v[ya]){var Ea=W.v[ya];if(!Ea.jb)continue;Ea.l&&(bondR=Ea.l);Ea.Ja&&(mb=!0);"undefined"!=typeof Ea.aa&&(ia=$3Dmol.m.color(Ea.aa));"undefined"!=typeof Ea.ba&&(za=$3Dmol.m.color(Ea.ba))}var ea=3*na.vertices;if(1<W.k[ya]&&4>W.k[ya]&&!mb){var Oa=b(W,Fa,ya),xa=Ga.clone();xa.sub(wa);if(2==W.k[ya])if(Oa.multiplyScalar(.1),p1a=wa.clone(),p1a.add(Oa),p1b=wa.clone(),p1b.sub(Oa),p2a=p1a.clone(),p2a.add(xa),p2b=p1b.clone(),p2b.add(xa),ia==za)na.vertices+=
4,d(ca,da,ea,p1a,p2a,ia),d(ca,da,ea+6,p1b,p2b,ia);else{na.vertices+=8;xa.multiplyScalar(.5);var Ha=p1a.clone();Ha.add(xa);var Ia=p1b.clone();Ia.add(xa);d(ca,da,ea,p1a,Ha,ia);d(ca,da,ea+6,Ha,p2a,za);d(ca,da,ea+12,p1b,Ia,ia);d(ca,da,ea+18,Ia,p2b,za)}else 3==W.k[ya]&&(Oa.multiplyScalar(.1),p1a=wa.clone(),p1a.add(Oa),p1b=wa.clone(),p1b.sub(Oa),p2a=p1a.clone(),p2a.add(xa),p2b=p1b.clone(),p2b.add(xa),ia==za?(na.vertices+=6,d(ca,da,ea,wa,Ga,ia),d(ca,da,ea+6,p1a,p2a,ia),d(ca,da,ea+12,p1b,p2b,ia)):(na.vertices+=
12,xa.multiplyScalar(.5),Ha=p1a.clone(),Ha.add(xa),Ia=p1b.clone(),Ia.add(xa),d(ca,da,ea,wa,$a,ia),d(ca,da,ea+6,$a,Ga,za),d(ca,da,ea+12,p1a,Ha,ia),d(ca,da,ea+18,Ha,p2a,za),d(ca,da,ea+24,p1b,Ia,ia),d(ca,da,ea+30,Ia,p2b,za)))}else ia==za?(na.vertices+=2,d(ca,da,ea,wa,Ga,ia)):(na.vertices+=4,d(ca,da,ea,wa,$a,ia),d(ca,da,ea+6,$a,Ga,za))}}}}var K=y,sb=t,ba=E;if(K.style.X){var Sa=K.style.X;if(!Sa.hidden){var Ta=Sa.l||.25,oa=Ta,nb=Sa.ac||!1,Ua=!1,Va=!1,Pa=K.color;"undefined"!=typeof Sa.color&&(Pa=Sa.color);
var ra=$3Dmol.m.color(Pa),fa=void 0,ta=void 0;!K.za&&4>K.i.length&&(Ua=!0);for(var ha=0;ha<K.i.length;ha++){var X=sb[K.i[ha]];if(K.u<X.u){var gb=X.style;if(gb.X){var Wa=X.color;"undefined"!=typeof gb.X.color&&(Wa=gb.X.color);var Ja=$3Dmol.m.color(Wa),oa=Ta,Xa=nb;if(K.v&&K.v[ha]){var ua=K.v[ha];if(ua.jb)continue;ua.l&&(oa=ua.l);ua.Ja&&(Xa=!0);"undefined"!=typeof ua.aa&&(ra=$3Dmol.m.color(ua.aa));"undefined"!=typeof ua.ba&&(Ja=$3Dmol.m.color(ua.ba))}var ja=new $3Dmol.Vector3(K.x,K.y,K.z),va=new $3Dmol.Vector3(X.x,
X.y,X.z);if(1===K.k[ha]||Xa){if(!X.za&&4>X.i.length&&(Va=!0),Pa!=Wa?(fa=(new $3Dmol.Vector3).addVectors(ja,va).multiplyScalar(.5),$3Dmol.j.n(ba,ja,fa,oa,ra,Ua,!1),$3Dmol.j.n(ba,fa,va,oa,Ja,!1,Va)):$3Dmol.j.n(ba,ja,va,oa,ra,Ua,Va),K.f||X.f){fa=(new $3Dmol.Vector3).addVectors(ja,va).multiplyScalar(.5);if(K.f){var tb=new $3Dmol.Cylinder(ja,fa,oa),ub=new $3Dmol.Sphere(ja,oa);K.d.cylinder.push(tb);K.d.sphere.push(ub)}if(X.f){var vb=new $3Dmol.Cylinder(va,fa,oa),wb=new $3Dmol.Sphere(va,oa);X.d.cylinder.push(vb);
X.d.sphere.push(wb)}}}else if(1<K.k[ha]){var Ca=!1;mtoCap=!1;oa!=Ta&&(mtoCap=Ca=!0);var Qa=va.clone(),Aa=null;Qa.sub(ja);var Q,ka,la,pa,qa,Aa=b(K,X,ha);if(2==K.k[ha]){if(Q=oa/2.5,Aa=b(K,X,ha),Aa.multiplyScalar(1.5*Q),ka=ja.clone(),ka.add(Aa),la=ja.clone(),la.sub(Aa),pa=ka.clone(),pa.add(Qa),qa=la.clone(),qa.add(Qa),Pa!=Wa?(fa=(new $3Dmol.Vector3).addVectors(ka,pa).multiplyScalar(.5),ta=(new $3Dmol.Vector3).addVectors(la,qa).multiplyScalar(.5),$3Dmol.j.n(ba,ka,fa,Q,ra,Ca,!1),$3Dmol.j.n(ba,fa,pa,Q,
Ja,!1,mtoCap),$3Dmol.j.n(ba,la,ta,Q,ra,Ca,!1),$3Dmol.j.n(ba,ta,qa,Q,Ja,!1,mtoCap)):($3Dmol.j.n(ba,ka,pa,Q,ra,Ca,mtoCap),$3Dmol.j.n(ba,la,qa,Q,ra,Ca,mtoCap)),K.f||X.f)fa=(new $3Dmol.Vector3).addVectors(ka,pa).multiplyScalar(.5),ta=(new $3Dmol.Vector3).addVectors(la,qa).multiplyScalar(.5),K.f&&(cylinder1a=new $3Dmol.Cylinder(ka,fa,Q),cylinder1b=new $3Dmol.Cylinder(la,ta,Q),K.d.cylinder.push(cylinder1a),K.d.cylinder.push(cylinder1b)),X.f&&(cylinder2a=new $3Dmol.Cylinder(pa,fa,Q),cylinder2b=new $3Dmol.Cylinder(qa,
ta,Q),X.d.cylinder.push(cylinder2a),X.d.cylinder.push(cylinder2b))}else 3==K.k[ha]&&(Q=oa/4,Aa.cross(Qa),Aa.normalize(),Aa.multiplyScalar(3*Q),ka=ja.clone(),ka.add(Aa),la=ja.clone(),la.sub(Aa),pa=ka.clone(),pa.add(Qa),qa=la.clone(),qa.add(Qa),Pa!=Wa?(fa=(new $3Dmol.Vector3).addVectors(ka,pa).multiplyScalar(.5),ta=(new $3Dmol.Vector3).addVectors(la,qa).multiplyScalar(.5),mp3=(new $3Dmol.Vector3).addVectors(ja,va).multiplyScalar(.5),$3Dmol.j.n(ba,ka,fa,Q,ra,Ca,!1),$3Dmol.j.n(ba,fa,pa,Q,Ja,!1,mtoCap),
$3Dmol.j.n(ba,ja,mp3,Q,ra,Ua,!1),$3Dmol.j.n(ba,mp3,va,Q,Ja,!1,Va),$3Dmol.j.n(ba,la,ta,Q,ra,Ca,!1),$3Dmol.j.n(ba,ta,qa,Q,Ja,!1,mtoCap)):($3Dmol.j.n(ba,ka,pa,Q,ra,Ca,mtoCap),$3Dmol.j.n(ba,ja,va,Q,ra,Ua,Va),$3Dmol.j.n(ba,la,qa,Q,ra,Ca,mtoCap)),K.f||X.f)&&(fa=(new $3Dmol.Vector3).addVectors(ka,pa).multiplyScalar(.5),ta=(new $3Dmol.Vector3).addVectors(la,qa).multiplyScalar(.5),mp3=(new $3Dmol.Vector3).addVectors(ja,va).multiplyScalar(.5),K.f&&(cylinder1a=new $3Dmol.Cylinder(ka.clone(),fa.clone(),Q),cylinder1b=
new $3Dmol.Cylinder(la.clone(),ta.clone(),Q),cylinder1c=new $3Dmol.Cylinder(ja.clone(),mp3.clone(),Q),K.d.cylinder.push(cylinder1a),K.d.cylinder.push(cylinder1b),K.d.cylinder.push(cylinder1c)),X.f&&(cylinder2a=new $3Dmol.Cylinder(pa.clone(),fa.clone(),Q),cylinder2b=new $3Dmol.Cylinder(qa.clone(),ta.clone(),Q),cylinder2c=new $3Dmol.Cylinder(va.clone(),mp3.clone(),Q),X.d.cylinder.push(cylinder2a),X.d.cylinder.push(cylinder2b),X.d.cylinder.push(cylinder2c)))}}}}for(var hb=0==K.i.length,ib=0,ob=!1,ha=
0;ha<K.i.length;ha++)Xa=nb,K.v&&K.v[ha]&&(ua=K.v[ha],ua.Ja&&(Xa=!0),ua.l&&ua.l!=Ta&&(ob=!0)),(Xa||1==K.k[ha])&&ib++;ob?0<ib&&(hb=!0):0==ib&&(hb=!0);if(hb){var xb=K.style,oa=Ta;K.style={sphere:{l:oa,color:Pa}};a(K,ba);K.style=xb}}}"undefined"===typeof y.style.Q||y.style.Q.hidden||("spectrum"===y.style.Q.color&&"number"===typeof y.e&&(y.e<A[0]&&(A[0]=y.e),y.e>A[1]&&(A[1]=y.e)),D.push(y))}}if(0<D.length){var pb=null;A[0]<A[1]&&(pb=new $3Dmol.Ta(A[0],A[1]));$3Dmol.ab(p,D,pb);for(l=0;l<p.children.length;l++);
}if(0<z.vertices){var yb=new $3Dmol.MeshLambertMaterial({ambient:0,vertexColors:!0,reflectivity:0});z.initTypedArrays();var zb=new $3Dmol.Mesh(z,yb);p.add(zb)}if(0<m.vertices){var Ab=new $3Dmol.Hb({ambient:0,vertexColors:!0,reflectivity:0});m.initTypedArrays();var Bb=new $3Dmol.Mesh(m,Ab);console.log("spherei geometry "+m.vertices.length);p.add(Bb)}if(0<E.vertices){var qb=new $3Dmol.MeshLambertMaterial({vertexColors:!0,ambient:0,reflectivity:0});E.initTypedArrays();qb.wireframe&&E.setUpWireframe();
var Cb=new $3Dmol.Mesh(E,qb);p.add(Cb)}for(l in x)if(x.hasOwnProperty(l)){var jb=l,Db=new $3Dmol.LineBasicMaterial({linewidth:jb,vertexColors:!0});x[l].initTypedArrays();var Eb=new $3Dmol.Line(x[l],Db,$3Dmol.LinePieces);p.add(Eb)}for(l in u)if(u.hasOwnProperty(l)){var jb=l,Fb=new $3Dmol.LineBasicMaterial({linewidth:jb,vertexColors:!0});u[l].initTypedArrays();var Gb=new $3Dmol.Line(u[l],Fb,$3Dmol.LinePieces);p.add(Gb)}c=p;console.log("object creation time: "+(new Date-n));h&&(e.remove(h),h=null);h=
c.clone();e.add(h)}};this.la=function(b){h&&(void 0!==h.geometry&&h.geometry.dispose(),void 0!==h.material&&h.material.dispose(),b.remove(h),h=null);c=null}}}();
$3Dmol.D=function(){function l(l,p){p=p||{};$3Dmol.Sa++;this.id=l;this.s=new $3Dmol.Sphere;this.d={sphere:[],cylinder:[],line:[],triangle:[]};F(this,p);var f=[],e=null,a=null,d=new $3Dmol.Geometry(!0);this.Db=function(b){for(var a in b)p[a]=b[a];F(this,p)};this.ua=function(b){b.pa=b.pa||[];b.da=b.da||[];b.ia=b.ia||[];b.ha=b.ha||[];var a=d.addGeoGroup();I(this,a,b);a.truncateArrayBuffers(!0,!0);for(b=0;b<a.colorArray.length/3;++b)a.colorArray[3*b]=this.color.r,a.colorArray[3*b+1]=this.color.g,a.colorArray[3*
b+2]=this.color.b;f.push({id:a.id,R:a,G:a.getCentroid()});A(this.s,f,a.vertexArray)};this.wa=function(b){b.center=b.center||{x:0,y:0,z:0};b.l=b.l?$3Dmol.Math.clamp(b.l,0,Infinity):1.5;b.color=$3Dmol.m.color(b.color);this.d.sphere.push(new $3Dmol.Sphere(b.center,b.l));var a=d.addGeoGroup();$3Dmol.j.Aa(d,b.center,b.l,b.color);a.truncateArrayBuffers(!0,!0);f.push({id:a.id,R:a,G:new $3Dmol.Vector3(b.center.x,b.center.y,b.center.z)});A(this.s,f,a.vertexArray)};this.va=function(b){b.start=b.start||{};b.end=
b.end||{};var a=new $3Dmol.Vector3(b.start.x||0,b.start.y||0,b.start.z||0),e=new $3Dmol.Vector3(b.end.x||3,b.end.y||0,b.end.z||0),c=b.l||.1,h=$3Dmol.m.color(b.color),n=d.addGeoGroup();$3Dmol.j.n(d,a,e,c,h,b.Tb,b.bc);n.truncateArrayBuffers(!0,!0);a=new $3Dmol.Vector3;f.push({id:n.id,R:n,G:a.addVectors(b.start,b.end).multiplyScalar(.5)});A(this.s,f,n.vertexArray)};this.ta=function(b){b.start=b.start||{};b.end=b.end||{};b.start=new $3Dmol.Vector3(b.start.x||0,b.start.y||0,b.start.z||0);if(b.dir instanceof
$3Dmol.Vector3&&b.length instanceof number){var a=b.dir.clone().multiplyScalar(length).add(start);b.end=a}else b.end=new $3Dmol.Vector3(b.end.x||3,b.end.y||0,b.end.z||0);b.l=b.l||.1;b.Ga=b.Ga||1.618034;b.V=0<b.V&&1>b.V?b.V:.618034;var a=d.addGeoGroup(),e=b.start,c=b.end,h=b.l,n=b.Ga,p=b.V;if(e&&c){var D=c.clone();D.sub(e).multiplyScalar(p);var s=e.clone().add(D),p=D.clone().negate();this.d.cylinder.push(new $3Dmol.Cylinder(e.clone(),s.clone(),h));this.d.sphere.push(new $3Dmol.Sphere(e.clone(),h));
var q=[];q[0]=D.clone();1E-4<Math.abs(q[0].x)?q[0].y+=1:q[0].x+=1;q[0].cross(D);q[0].normalize();q[0]=q[0];q[4]=q[0].clone();q[4].crossVectors(q[0],D);q[4].normalize();q[8]=q[0].clone().negate();q[12]=q[4].clone().negate();q[2]=q[0].clone().add(q[4]).normalize();q[6]=q[4].clone().add(q[8]).normalize();q[10]=q[8].clone().add(q[12]).normalize();q[14]=q[12].clone().add(q[0]).normalize();q[1]=q[0].clone().add(q[2]).normalize();q[3]=q[2].clone().add(q[4]).normalize();q[5]=q[4].clone().add(q[6]).normalize();
q[7]=q[6].clone().add(q[8]).normalize();q[9]=q[8].clone().add(q[10]).normalize();q[11]=q[10].clone().add(q[12]).normalize();q[13]=q[12].clone().add(q[14]).normalize();q[15]=q[14].clone().add(q[0]).normalize();var w=a.vertices,l=a.vertexArray,x=a.faceArray,u=a.normalArray,z=a.lineArray,m,C,F;C=0;for(F=q.length;C<F;++C){m=3*(w+3*C);var B=q[C].clone().multiplyScalar(h).add(e),H=q[C].clone().multiplyScalar(h).add(s),y=q[C].clone().multiplyScalar(h*n).add(s);l[m]=B.x;l[m+1]=B.y;l[m+2]=B.z;l[m+3]=H.x;l[m+
4]=H.y;l[m+5]=H.z;l[m+6]=y.x;l[m+7]=y.y;l[m+8]=y.z;0<C&&(m=new $3Dmol.Vector3(l[m-3],l[m-2],l[m-1]),B=c.clone(),H=s.clone(),y=new $3Dmol.Vector3(y.x,y.y,y.z),this.d.triangle.push(new $3Dmol.Triangle(y,B,m)),this.d.triangle.push(new $3Dmol.Triangle(m.clone(),H,y.clone())))}a.vertices+=48;m=3*a.vertices;l[m]=e.x;l[m+1]=e.y;l[m+2]=e.z;l[m+3]=s.x;l[m+4]=s.y;l[m+5]=s.z;l[m+6]=c.x;l[m+7]=c.y;l[m+8]=c.z;a.vertices+=3;var I,sa,T,O,S,M,N,L,P=a.vertices-3,Z=a.vertices-2,aa=a.vertices-1,Y=3*P,U=3*Z,ga=3*aa;
C=0;for(F=q.length-1;C<F;++C)I=w+3*C,e=a.faceidx,c=a.lineidx,h=I,m=3*h,n=I+1,B=3*n,s=I+2,H=3*s,l=I+4,sa=3*l,y=I+5,T=3*y,I+=3,O=3*I,S=M=q[C],N=L=q[C+1],u[m]=S.x,u[B]=M.x,u[O]=L.x,u[m+1]=S.y,u[B+1]=M.y,u[O+1]=L.y,u[m+2]=S.z,u[B+2]=M.z,u[O+2]=L.z,u[B]=M.x,u[sa]=N.x,u[O]=L.x,u[B+1]=M.y,u[sa+1]=N.y,u[O+1]=L.y,u[B+2]=M.z,u[sa+2]=N.z,u[O+2]=L.z,u[H]=M.x,u[T]=N.x,u[H+1]=M.y,u[T+1]=N.y,u[H+2]=M.z,u[T+2]=N.z,x[e]=h,x[e+1]=n,x[e+2]=I,x[e+3]=n,x[e+4]=l,x[e+5]=I,x[e+6]=h,x[e+7]=I,x[e+8]=P,x[e+9]=s,x[e+10]=Z,x[e+
11]=y,x[e+12]=s,x[e+13]=aa,x[e+14]=y,z[c]=h,z[c+1]=n,z[c+2]=h,z[c+3]=I,z[c+4]=l,z[c+5]=I,z[c+6]=h,z[c+7]=I,z[c+8]=s,z[c+9]=n,z[c+10]=s,z[c+11]=y,z[c+12]=l,z[c+13]=y,z[c+14]=s,z[c+15]=aa,z[c+16]=s,z[c+17]=y,z[c+18]=aa,z[c+19]=y,a.faceidx+=15,a.lineidx+=20;w=[w+45,w+46,w+1,w,w+47,w+2];e=a.faceidx;c=a.lineidx;h=w[0];m=3*h;n=w[1];B=3*n;s=w[4];H=3*s;l=w[2];sa=3*l;y=w[5];T=3*y;I=w[3];O=3*I;S=M=q[15];N=L=q[0];u[m]=S.x;u[B]=M.x;u[O]=L.x;u[m+1]=S.y;u[B+1]=M.y;u[O+1]=L.y;u[m+2]=S.z;u[B+2]=M.z;u[O+2]=L.z;u[B]=
M.x;u[sa]=N.x;u[O]=L.x;u[B+1]=M.y;u[sa+1]=N.y;u[O+1]=L.y;u[B+2]=M.z;u[sa+2]=N.z;u[O+2]=L.z;u[H]=M.x;u[T]=N.x;u[H+1]=M.y;u[T+1]=N.y;u[H+2]=M.z;u[T+2]=N.z;D.normalize();p.normalize();u[Y]=p.x;u[U]=u[ga]=D.x;u[Y+1]=p.y;u[U+1]=u[ga+1]=D.y;u[Y+2]=p.z;u[U+2]=u[ga+2]=D.z;x[e]=h;x[e+1]=n;x[e+2]=I;x[e+3]=n;x[e+4]=l;x[e+5]=I;x[e+6]=h;x[e+7]=I;x[e+8]=P;x[e+9]=s;x[e+10]=Z;x[e+11]=y;x[e+12]=s;x[e+13]=aa;x[e+14]=y;z[c]=h;z[c+1]=n;z[c+2]=h;z[c+3]=I;z[c+4]=l;z[c+5]=I;z[c+6]=h;z[c+7]=I;z[c+8]=s;z[c+9]=n;z[c+10]=s;
z[c+11]=y;z[c+12]=l;z[c+13]=y;z[c+14]=s;z[c+15]=aa;z[c+16]=s;z[c+17]=y;z[c+18]=aa;z[c+19]=y;a.faceidx+=15;a.lineidx+=20}a.truncateArrayBuffers(!0,!0);D=new $3Dmol.Vector3;f.push({id:a.id,R:a,G:D.addVectors(b.start,b.end).multiplyScalar(.5)});A(this.s,f,a.vertexArray)};this.xa=function(a,g,e){var c=void 0!==e.Ea&&"number"===typeof e.Ea?e.Ea:0,h=e.Ma?!0:!1,n=d.addGeoGroup();switch(g){case "cube":var p=a.replace(/^\s+/,"").split(/[\n\r]+/);if(!(6>p.length)){var l=p[2].replace(/^\s+/,"").replace(/\s+/g,
" ").split(" "),s=Math.abs(parseFloat(l[0]));a=new $3Dmol.Vector3(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));var l=p[3].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),q=0<parseFloat(l[0])?.529177:1;a.multiplyScalar(q);g=Math.abs(l[0]);var w=(new $3Dmol.Vector3(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]))).multiplyScalar(q),l=p[4].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),C=Math.abs(l[0]);(new $3Dmol.Vector3(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]))).multiplyScalar(q);
var l=p[5].replace(/^\s+/,"").replace(/\s+/g," ").split(" "),x=Math.abs(l[0]);(new $3Dmol.Vector3(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]))).multiplyScalar(q);p=new Float32Array(p.splice(s+7).join(" ").replace(/^\s+/,"").split(/[\s\r]+/));l=new Int16Array(g*C*x);s=0;for(q=l.length;s<q;++s)l[s]=-1;l=new Uint8Array(g*C*x);s=0;for(q=p.length;s<q;++s)0<(0<=c?p[s]-c:c-p[s])&&(l[s]|=2);c=[];p=[];$3Dmol.sa.mb(l,c,p,{eb:!0,Ma:h,scale:w.length(),origin:a,nb:g,ob:C,pb:x});h||$3Dmol.sa.kb(10,c,p);
I(this,n,{pa:c,da:p,ia:[],ha:[]})}}f.push({id:n.id,R:n,G:n.getCentroid()});this.Db(e);A(this.s,f,n.vertexArray)};this.fa=function(b){d.initTypedArrays();var f=this.color,f=f||$3Dmol.m.color(f);d.colorsNeedUpdate=!0;for(var p in d.geometryGroups)for(var c=d.geometryGroups[p],h=c.colorArray,n=0,c=c.vertices;n<c;++n)h[3*n]=f.r,h[3*n+1]=f.g,h[3*n+2]=f.b;e=new $3Dmol.Object3D;p=new $3Dmol.MeshLambertMaterial({wireframe:this.wireframe,vertexColors:!0,ambient:0,reflectivity:0,side:this.side,transparent:1>
this.alpha?!0:!1,opacity:this.alpha});p=new $3Dmol.Mesh(d,p);e.add(p);a&&(b.remove(a),a=null);a=e.clone();b.add(a)};this.la=function(b){a&&(void 0!==a.geometry&&a.geometry.dispose(),void 0!==a.material&&a.material.dispose(),b.remove(a),a=null);e=null}}function F(l,p){l.color=p.color||new $3Dmol.Color;l.wireframe=p.wireframe?!0:!1;l.alpha=p.alpha?$3Dmol.Math.clamp(p.alpha,0,1):1;l.side=void 0!==p.side?p.side:$3Dmol.DoubleSide;l.f=p.f?!0:!1;l.A="function"===typeof p.A?p.A:null}function A(l,p,f){l.center.set(0,
0,0);var e,a;if(0<p.length){e=0;for(a=p.length;e<a;++e)l.center.add(p[e].G);l.center.divideScalar(p.length)}p=l.l*l.l;e=0;for(a=f.length/3;e<a;e++){var d=l.center.distanceToSquared({x:f[3*e],y:f[3*e+1],z:f[3*e+2]});p=Math.max(p,d)}l.l=Math.sqrt(p)}function I(l,p,f){var e=f.pa,a=f.ia,d=f.da;f=f.ha;0!==e.length&&0!==d.length||console.warn("Error adding custom shape component: No vertices and/or face indices supplied!");p.vertices=e.length;p.faceidx=d.length;var b,g,t,c,h;c=0;for(h=p.vertices;c<h;++c)b=
3*c,g=e[c],p.vertexArray[b]=g.x,p.vertexArray[b+1]=g.y,p.vertexArray[b+2]=g.z;c=0;for(h=p.faceidx/3;c<h;++c){b=3*c;g=d[b];t=d[b+1];b=d[b+2];var n=new $3Dmol.Vector3,A=new $3Dmol.Vector3,D=new $3Dmol.Vector3;l.d.triangle.push(new $3Dmol.Triangle(n.copy(e[g]),A.copy(e[t]),D.copy(e[b])))}p.faceArray=new Uint16Array(d);p.truncateArrayBuffers(!0,!0);if(a.length<p.vertices)p.setNormals();else for(p.normalArray=new Float32Array(3*p.vertices),c=0,h=p.vertices;c<h;++c)b=3*c,l=a[c],p.normalArray[b]=l.x,p.normalArray[b+
1]=l.y,p.normalArray[b+2]=l.z;f.length?p.lineArray=new Uint16Array(f):p.setLineIndices();p.lineidx=p.lineArray.length}Object.defineProperty(l.prototype,"position",{get:function(){return this.s.center}});Object.defineProperty(l.prototype,"x",{get:function(){return this.s.center.x}});Object.defineProperty(l.prototype,"y",{get:function(){return this.s.center.y}});Object.defineProperty(l.prototype,"z",{get:function(){return this.s.center.z}});return l}();$3Dmol.Sa=0;$3Dmol.Ra=0;
$3Dmol.Qa=function(l){this.id=$3Dmol.Ra++;this.canvas=document.createElement("canvas");this.context=this.canvas.getContext("2d");this.M=new $3Dmol.Sprite;this.text=l};$3Dmol.Qa.prototype={dispose:function(){void 0!==this.M.material.map&&this.M.material.map.dispose();void 0!==this.M.material&&this.M.material.dispose()}};
$3Dmol.ra=function(){function l(l){var A,I,C,p,f,e,a,d,b,g;A=I=C=9999;p=f=e=-9999;a=d=b=g=0;if(0===l.length)return[[0,0,0],[0,0,0],[0,0,0]];for(var t=0;t<l.length;t++){var c=l[t];void 0!==c&&(g++,a+=c.x,d+=c.y,b+=c.z,A=A<c.x?A:c.x,I=I<c.y?I:c.y,C=C<c.z?C:c.z,p=p>c.x?p:c.x,f=f>c.y?f:c.y,e=e>c.z?e:c.z)}return[[A,I,C],[p,f,e],[a/g,d/g,b/g]]}return function(F,A,I,C){function p(a){var b=a.originalEvent.targetTouches[0].pageX-a.originalEvent.targetTouches[1].pageX;a=a.originalEvent.targetTouches[0].pageY-
a.originalEvent.targetTouches[1].pageY;return Math.sqrt(b*b+a*a)}function f(){if(z){var a=q.position.z-m.position.z;1>a&&(a=1);q.near=a+B;1>q.near&&(q.near=1);q.far=a+H;q.near+1>q.far&&(q.far=q.near+1);q instanceof $3Dmol.Camera?q.fov=20:(q.right=a*Math.tan(Math.PI/180*20),q.left=-q.right,q.top=q.right/D,q.bottom=-q.top);q.updateProjectionMatrix();z.fog.near=q.near+.4*(q.far-q.near);z.fog.far=q.far;s.render(z,q)}}function e(a){var d=[];"undefined"===typeof a&&(a={});var c=[],f;if("undefined"===typeof a.Fa)for(f=
0;f<b.length;f++)b[f]&&c.push(b[f]);else c=a.Fa,$.isArray(c)||(c=[c]);for(f=0;f<c.length;f++)d=d.concat(c[f].Ia(a));return d}var a=this,d=F.id,b=[],g=[],t=[],c=[],h=F.width(),n=F.height(),E=$('<div class="glviewerSpinnerWrap" style = "position: absolute; width: 100%; height: 100%; display: table; z-index: 1;"><div class="glviewerSpinner" style="display: table-cell; text-align: center; vertical-align: middle; z-index:1"><img src="3Dmol/spinner.gif"></div></div>');$(F).append(E);E.hide();var D=h/n,
s=new $3Dmol.Renderer({antialias:!0});s.domElement.style.width="100%";s.domElement.style.height="100%";s.domElement.style.position="absolute";s.domElement.style.top="0px";s.domElement.style.zIndex="0";F.append(s.domElement);s.setSize(h,n);var q=new $3Dmol.Camera(10,D,1,800);q.position=new $3Dmol.Vector3(0,0,150);var w=new $3Dmol.Vector3;q.lookAt(w);var G=new $3Dmol.Raycaster(new $3Dmol.Vector3(0,0,0),new $3Dmol.Vector3(0,0,0)),x=new $3Dmol.Projector,u=new $3Dmol.Vector3(0,0,0),z=null,m=null,J=null,
Ba=0,B=-50,H=50,y=new $3Dmol.Quaternion(0,0,0,1),ma=new $3Dmol.Quaternion(0,0,0,1),sa=!1,T=0,O=0,S=0,M=0,N=0,L=0,P=0;(function(){z=new $3Dmol.Scene;z.fog=new $3Dmol.Fog(Ba,100,200);J=new $3Dmol.Object3D;m=new $3Dmol.Object3D;m.useQuaternion=!0;m.quaternion=new $3Dmol.Quaternion(0,0,0,1);m.add(J);z.add(m);var a=new $3Dmol.Light(16777215);a.position=(new $3Dmol.Vector3(.2,.2,1)).normalize();a.intensity=1;z.add(a)})();s.setClearColorHex(Ba,1);z.fog.color=$3Dmol.m.color(Ba);w=$(s.domElement);C||(w.bind("mousedown touchstart",
function(d){d.preventDefault();if(z){var c=d.pageX,e=d.pageY;d.originalEvent.targetTouches&&d.originalEvent.targetTouches[0]&&(c=d.originalEvent.targetTouches[0].pageX,e=d.originalEvent.targetTouches[0].pageY);if(void 0!==c){sa=!0;mouseButton=d.which;T=c;O=e;S=0;d.originalEvent.targetTouches&&2==d.originalEvent.targetTouches.length&&(S=p(d));y=m.quaternion;N=m.position.z;M=J.position.clone();L=B;P=H;d=c/$(window).width()*2-1;u.set(d,2*-(e/n)+1,-1);x.unprojectVector(u,q);u.sub(q.position).normalize();
G.set(q.position,u);e=[];d=[];d=0;for(c=b.length;d<c;d++)var g=b[d].Ia({f:!0}),e=e.concat(g);d=0;for(c=t.length;d<c;d++)g=t[d],g.f&&e.push(g);d=G.intersectObjects(J,e);d.length&&(e=d[0].f,void 0!==e.A&&"function"===typeof e.A&&e.A(e,a));f()}}}),w.bind("DOMMouseScroll mousewheel",function(a){a.preventDefault();if(z){var b=.85*(150-m.position.z);a.originalEvent.detail?m.position.z+=b*a.originalEvent.detail/10:a.originalEvent.wheelDelta&&(m.position.z-=b*a.originalEvent.wheelDelta/400);f()}}),w.bind("contextmenu",
function(a){a.preventDefault()}),$("body").bind("mouseup touchend",function(){sa=!1}),w.bind("mousemove touchmove",function(a){a.preventDefault();if(z&&sa){var b=0,c=$("input[name="+d+"_mouseMode]:checked");0<c.length&&(b=parseInt(c.val()));var c=a.pageX,e=a.pageY;a.originalEvent.targetTouches&&a.originalEvent.targetTouches[0]&&(c=a.originalEvent.targetTouches[0].pageX,e=a.originalEvent.targetTouches[0].pageY);if(void 0!==c){c=(c-T)/h;e=(e-O)/n;0!=S&&a.originalEvent.targetTouches&&2==a.originalEvent.targetTouches.length?
(e=p(a),b=2,e=2*(S-e)/(h+n)):a.originalEvent.targetTouches&&3==a.originalEvent.targetTouches.length&&(b=1);var g=Math.sqrt(c*c+e*e);3==b||3==mouseButton&&a.ctrlKey?(B=L+100*c,H=P+100*e):2==b||3==mouseButton||a.shiftKey?(a=.85*(150-m.position.z),80>a&&(a=80),m.position.z=N-e*a):1==b||2==mouseButton||a.ctrlKey?(a=.85*(150-m.position.z),20>a&&(a=20),a=new $3Dmol.Vector3(c*a,-e*a,0),b=m.quaternion,b=(new $3Dmol.Quaternion(b.x,b.y,b.z,b.w)).inverse().normalize(),a=a.applyQuaternion(b),J.position.x=M.x+
a.x,J.position.y=M.y+a.y,J.position.z=M.z+a.z):0!==b&&1!=mouseButton||0===g||(a=Math.sin(g*Math.PI)/g,ma.x=Math.cos(g*Math.PI),ma.y=0,ma.z=a*c,ma.w=-a*e,m.quaternion=new $3Dmol.Quaternion(1,0,0,0),m.quaternion.multiply(ma),m.quaternion.multiply(y));f()}}}));this.yb=function(a){var b;Ba=a;s.setClearColorHex(a,b|1);z.fog.color=$3Dmol.m.color(a);f()};this.resize=function(){h=F.width();n=F.height();D=h/n;s.setSize(h,n);q.aspect=D;q.updateProjectionMatrix();f()};$(window).resize(this.resize);this.rotate=
function(a,b){"undefined"===typeof b&&(b="y");var d=0,c=0,e=0,g=Math.PI*a/180,h=Math.sin(g/2),g=Math.cos(g/2);"x"==b&&(d=h);"y"==b&&(c=h);"z"==b&&(e=h);d=(new $3Dmol.Quaternion(d,c,e,g)).normalize();m.quaternion.multiply(d);f()};this.gb=function(){if(!J)return[0,0,0,0,0,0,0,1];var a=J.position,b=m.quaternion;return[a.x,a.y,a.z,m.position.z,b.x,b.y,b.z,b.w]};this.zb=function(a){void 0!==a&&(a instanceof Array||8!==a.length)&&J&&m&&(J.position.x=a[0],J.position.y=a[1],J.position.z=a[2],m.position.z=
a[3],m.quaternion.x=a[4],m.quaternion.y=a[5],m.quaternion.z=a[6],m.quaternion.w=a[7],"undefined"!=typeof a[8]&&(m.position.x=a[8],m.position.y=a[9]),f())};this.render=function(){var a=new Date,d=this.gb(),c;for(c=0;c<b.length;c++)b[c]&&b[c].fa(J);for(c=0;c<t.length;c++)t[c]&&t[c].fa(J);for(c in g)if(g.hasOwnProperty(c)){var e=g[c].Da;if(!g[c].cb){e.verticesNeedUpdate=!0;e.elementsNeedUpdate=!0;e.normalsNeedUpdate=!0;e.colorsNeedUpdate=!0;e.buffersNeedUpdate=!0;e.s=null;g[c].done&&(g[c].cb=!0);g[c].T&&
J.remove(g[c].T);var f=null,f=g[c].U instanceof $3Dmol.LineBasicMaterial?new $3Dmol.Line(e,g[c].U):new $3Dmol.Mesh(e,g[c].U);g[c].T=f;J.add(f)}}this.zb(d);d=new Date;E.hide();console.log("render time: "+(d-a))};this.zoom=function(a){m.position.z=150-(150-m.position.z)/(a||2);f()};this.qa=function(){var a=e(void 0).concat(t),b=e({}).concat(t),a=l(a),b=l(b),d=new $3Dmol.Vector3(a[2][0],a[2][1],a[2][2]);J.position=d.multiplyScalar(-1);var d=b[1][0]-b[0][0],c=b[1][1]-b[0][1],b=b[1][2]-b[0][2],b=Math.sqrt(d*
d+c*c+b*b);25>b&&(b=25);B=-b/1.9;H=b/3;d=a[1][0]-a[0][0];c=a[1][1]-a[0][1];b=a[1][2]-a[0][2];b=Math.sqrt(d*d+c*c+b*b);25>b&&(b=25);m.position.z=-(.35*b/Math.tan(Math.PI/180*q.fov/2)-150);f()};this.ub=function(){for(var a=0;a<c.length;a++)J.remove(c[a].M);c=[]};this.wb=function(){for(var a=0;a<t.length;a++)t[a].la(J);t=[]};this.wa=function(a){var b=new $3Dmol.D(t.length);a=a||{};b.wa(a);t.push(b);return b};this.ta=function(a){var b=new $3Dmol.D(t.length);a=a||{};b.ta(a);t.push(b);return b};this.va=
function(a){var b=new $3Dmol.D(t.length);a=a||{};b.va(a);t.push(b);return b};this.ua=function(a){var b=new $3Dmol.D(t.length);a=a||{};b.ua(a);t.push(b);return b};this.xa=function(a,b,d){var c=new $3Dmol.D(t.length);d=d||{};c.xa(a,b,d);t.push(c);return c};this.Z=function(a,d){var c=new $3Dmol.Pa(b.length,I);c.Va(a,d);b.push(c)};this.vb=function(){for(var a=0;a<b.length;a++)b[a].la(J);b=[]};this.ma=function(a,d){for(var c=0;c<b.length;c++)b[c]&&b[c].setStyle(a,d,!1)};this.xb=function(){for(var a=0;a<
g.length;a++)g[a]&&g[a].T&&(void 0!==g[a].Da&&g[a].Da.dispose(),void 0!==g[a].U&&g[a].U.dispose(),J.remove(g[a].T)),delete g[a];f()};this.clear=function(){this.xb();this.vb();this.ub();this.wb();f()};try{"function"===typeof A&&A(this)}catch(Z){console.log("error with glviewer callback: "+Z)}}}();$3Dmol.glmolViewer=$3Dmol.ra;$3Dmol=$3Dmol||{};
$3Dmol.rb=[{c:"ALA",a:"N",props:{partialCharge:-.15}},{c:"ALA",a:"CA",props:{partialCharge:.1}},{c:"ALA",a:"CB",props:{partialCharge:0}},{c:"ALA",a:"C",props:{partialCharge:.6}},{c:"ALA",a:"O",props:{partialCharge:-.55}},{c:"ARG",a:"N",props:{partialCharge:-.15}},{c:"ARG",a:"CA",props:{partialCharge:.1}},{c:"ARG",a:"CB",props:{partialCharge:0}},{c:"ARG",a:"CG",props:{partialCharge:0}},{c:"ARG",a:"CD",props:{partialCharge:.1}},{c:"ARG",a:"NE",props:{partialCharge:-.1}},{c:"ARG",a:"CZ",props:{partialCharge:.5}},
{c:"ARG",a:"NH1",props:{partialCharge:.25}},{c:"ARG",a:"NH2",props:{partialCharge:.25}},{c:"ARG",a:"C",props:{partialCharge:.6}},{c:"ARG",a:"O",props:{partialCharge:-.55}},{c:"ASN",a:"N",props:{partialCharge:-.15}},{c:"ASN",a:"CA",props:{partialCharge:.1}},{c:"ASN",a:"CB",props:{partialCharge:0}},{c:"ASN",a:"CG",props:{partialCharge:.55}},{c:"ASN",a:"OD1",props:{partialCharge:-.55}},{c:"ASN",a:"ND2",props:{partialCharge:0}},{c:"ASN",a:"C",props:{partialCharge:.6}},{c:"ASN",a:"O",props:{partialCharge:-.55}},
{c:"ASP",a:"N",props:{partialCharge:-.15}},{c:"ASP",a:"CA",props:{partialCharge:.1}},{c:"ASP",a:"CB",props:{partialCharge:0}},{c:"ASP",a:"CG",props:{partialCharge:.14}},{c:"ASP",a:"OD1",props:{partialCharge:-.57}},{c:"ASP",a:"OD2",props:{partialCharge:-.57}},{c:"ASP",a:"C",props:{partialCharge:.6}},{c:"ASP",a:"O",props:{partialCharge:-.55}},{c:"CYS",a:"N",props:{partialCharge:-.15}},{c:"CYS",a:"CA",props:{partialCharge:.1}},{c:"CYS",a:"CB",props:{partialCharge:.19}},{c:"CYS",a:"SG",props:{partialCharge:-.19}},
{c:"CYS",a:"C",props:{partialCharge:.6}},{c:"CYS",a:"O",props:{partialCharge:-.55}},{c:"GLN",a:"N",props:{partialCharge:-.15}},{c:"GLN",a:"CA",props:{partialCharge:.1}},{c:"GLN",a:"CB",props:{partialCharge:0}},{c:"GLN",a:"CG",props:{partialCharge:0}},{c:"GLN",a:"CD",props:{partialCharge:.55}},{c:"GLN",a:"OE1",props:{partialCharge:-.55}},{c:"GLN",a:"NE2",props:{partialCharge:0}},{c:"GLN",a:"C",props:{partialCharge:.6}},{c:"GLN",a:"O",props:{partialCharge:-.55}},{c:"GLU",a:"N",props:{partialCharge:-.15}},
{c:"GLU",a:"CA",props:{partialCharge:.1}},{c:"GLU",a:"CB",props:{partialCharge:0}},{c:"GLU",a:"CG",props:{partialCharge:0}},{c:"GLU",a:"CD",props:{partialCharge:.14}},{c:"GLU",a:"OE1",props:{partialCharge:-.57}},{c:"GLU",a:"OE2",props:{partialCharge:-.57}},{c:"GLU",a:"C",props:{partialCharge:.6}},{c:"GLU",a:"O",props:{partialCharge:-.55}},{c:"GLY",a:"N",props:{partialCharge:-.15}},{c:"GLY",a:"CA",props:{partialCharge:.1}},{c:"GLY",a:"C",props:{partialCharge:.6}},{c:"GLY",a:"O",props:{partialCharge:-.55}},
{c:"HIS",a:"N",props:{partialCharge:-.15}},{c:"HIS",a:"CA",props:{partialCharge:.1}},{c:"HIS",a:"CB",props:{partialCharge:0}},{c:"HIS",a:"CG",props:{partialCharge:.1}},{c:"HIS",a:"ND1",props:{partialCharge:-.1}},{c:"HIS",a:"CD2",props:{partialCharge:.1}},{c:"HIS",a:"NE2",props:{partialCharge:-.4}},{c:"HIS",a:"CE1",props:{partialCharge:.3}},{c:"HIS",a:"C",props:{partialCharge:.6}},{c:"HIS",a:"O",props:{partialCharge:-.55}},{c:"ILE",a:"N",props:{partialCharge:-.15}},{c:"ILE",a:"CA",props:{partialCharge:.1}},
{c:"ILE",a:"CB",props:{partialCharge:0}},{c:"ILE",a:"CG2",props:{partialCharge:0}},{c:"ILE",a:"CG1",props:{partialCharge:0}},{c:"ILE",a:"CD",props:{partialCharge:0}},{c:"ILE",a:"C",props:{partialCharge:.6}},{c:"ILE",a:"O",props:{partialCharge:-.55}},{c:"LEU",a:"N",props:{partialCharge:-.15}},{c:"LEU",a:"CA",props:{partialCharge:.1}},{c:"LEU",a:"CB",props:{partialCharge:0}},{c:"LEU",a:"CG",props:{partialCharge:0}},{c:"LEU",a:"CD1",props:{partialCharge:0}},{c:"LEU",a:"CD2",props:{partialCharge:0}},
{c:"LEU",a:"C",props:{partialCharge:.6}},{c:"LEU",a:"O",props:{partialCharge:-.55}},{c:"LYS",a:"N",props:{partialCharge:-.15}},{c:"LYS",a:"CA",props:{partialCharge:.1}},{c:"LYS",a:"CB",props:{partialCharge:0}},{c:"LYS",a:"CG",props:{partialCharge:0}},{c:"LYS",a:"CD",props:{partialCharge:0}},{c:"LYS",a:"CE",props:{partialCharge:.25}},{c:"LYS",a:"NZ",props:{partialCharge:.75}},{c:"LYS",a:"C",props:{partialCharge:.6}},{c:"LYS",a:"O",props:{partialCharge:-.55}},{c:"MET",a:"N",props:{partialCharge:-.15}},
{c:"MET",a:"CA",props:{partialCharge:.1}},{c:"MET",a:"CB",props:{partialCharge:0}},{c:"MET",a:"CG",props:{partialCharge:.06}},{c:"MET",a:"SD",props:{partialCharge:-.12}},{c:"MET",a:"CE",props:{partialCharge:.06}},{c:"MET",a:"C",props:{partialCharge:.6}},{c:"MET",a:"O",props:{partialCharge:-.55}},{c:"PHE",a:"N",props:{partialCharge:-.15}},{c:"PHE",a:"CA",props:{partialCharge:.1}},{c:"PHE",a:"CB",props:{partialCharge:0}},{c:"PHE",a:"CG",props:{partialCharge:0}},{c:"PHE",a:"CD1",props:{partialCharge:0}},
{c:"PHE",a:"CD2",props:{partialCharge:0}},{c:"PHE",a:"CE1",props:{partialCharge:0}},{c:"PHE",a:"CE2",props:{partialCharge:0}},{c:"PHE",a:"CZ",props:{partialCharge:0}},{c:"PHE",a:"C",props:{partialCharge:.6}},{c:"PHE",a:"O",props:{partialCharge:-.55}},{c:"PRO",a:"N",props:{partialCharge:-.25}},{c:"PRO",a:"CD",props:{partialCharge:.1}},{c:"PRO",a:"CA",props:{partialCharge:.1}},{c:"PRO",a:"CB",props:{partialCharge:0}},{c:"PRO",a:"CG",props:{partialCharge:0}},{c:"PRO",a:"C",props:{partialCharge:.6}},
{c:"PRO",a:"O",props:{partialCharge:-.55}},{c:"SER",a:"N",props:{partialCharge:-.15}},{c:"SER",a:"CA",props:{partialCharge:.1}},{c:"SER",a:"CB",props:{partialCharge:.25}},{c:"SER",a:"OG",props:{partialCharge:-.25}},{c:"SER",a:"C",props:{partialCharge:.6}},{c:"SER",a:"O",props:{partialCharge:-.55}},{c:"THR",a:"N",props:{partialCharge:-.15}},{c:"THR",a:"CA",props:{partialCharge:.1}},{c:"THR",a:"CB",props:{partialCharge:.25}},{c:"THR",a:"OG1",props:{partialCharge:-.25}},{c:"THR",a:"CG2",props:{partialCharge:0}},
{c:"THR",a:"C",props:{partialCharge:.6}},{c:"THR",a:"O",props:{partialCharge:-.55}},{c:"TRP",a:"N",props:{partialCharge:-.15}},{c:"TRP",a:"CA",props:{partialCharge:.1}},{c:"TRP",a:"CB",props:{partialCharge:0}},{c:"TRP",a:"CG",props:{partialCharge:-.03}},{c:"TRP",a:"CD2",props:{partialCharge:.1}},{c:"TRP",a:"CE2",props:{partialCharge:-.04}},{c:"TRP",a:"CE3",props:{partialCharge:-.03}},{c:"TRP",a:"CD1",props:{partialCharge:.06}},{c:"TRP",a:"NE1",props:{partialCharge:-.06}},{c:"TRP",a:"CZ2",props:{partialCharge:0}},
{c:"TRP",a:"CZ3",props:{partialCharge:0}},{c:"TRP",a:"CH2",props:{partialCharge:0}},{c:"TRP",a:"C",props:{partialCharge:.6}},{c:"TRP",a:"O",props:{partialCharge:-.55}},{c:"TYR",a:"N",props:{partialCharge:-.15}},{c:"TYR",a:"CA",props:{partialCharge:.1}},{c:"TYR",a:"CB",props:{partialCharge:0}},{c:"TYR",a:"CG",props:{partialCharge:0}},{c:"TYR",a:"CD1",props:{partialCharge:0}},{c:"TYR",a:"CE1",props:{partialCharge:0}},{c:"TYR",a:"CD2",props:{partialCharge:0}},{c:"TYR",a:"CE2",props:{partialCharge:0}},
{c:"TYR",a:"CZ",props:{partialCharge:.25}},{c:"TYR",a:"OH",props:{partialCharge:-.25}},{c:"TYR",a:"C",props:{partialCharge:.6}},{c:"TYR",a:"O",props:{partialCharge:-.55}},{c:"VAL",a:"N",props:{partialCharge:-.15}},{c:"VAL",a:"CA",props:{partialCharge:.1}},{c:"VAL",a:"CB",props:{partialCharge:0}},{c:"VAL",a:"CG1",props:{partialCharge:0}},{c:"VAL",a:"CG2",props:{partialCharge:0}},{c:"VAL",a:"C",props:{partialCharge:.6}},{c:"VAL",a:"O",props:{partialCharge:-.55}}];$3Dmol.partialCharges=$3Dmol.rb;
